(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();function bm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Db(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var hh={exports:{}},Zl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xv;function Mb(){if(Xv)return Zl;Xv=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,a,i){var l=null;if(i!==void 0&&(l=""+i),a.key!==void 0&&(l=""+a.key),"key"in a){i={};for(var c in a)c!=="key"&&(i[c]=a[c])}else i=a;return a=i.ref,{$$typeof:t,type:r,key:l,ref:a!==void 0?a:null,props:i}}return Zl.Fragment=e,Zl.jsx=n,Zl.jsxs=n,Zl}var Zv;function Ib(){return Zv||(Zv=1,hh.exports=Mb()),hh.exports}var x=Ib(),mh={exports:{}},ft={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qv;function Fb(){if(Qv)return ft;Qv=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.iterator;function T(U){return U===null||typeof U!="object"?null:(U=y&&U[y]||U["@@iterator"],typeof U=="function"?U:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function b(U,G,R){this.props=U,this.context=G,this.refs=S,this.updater=R||w}b.prototype.isReactComponent={},b.prototype.setState=function(U,G){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,G,"setState")},b.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function N(){}N.prototype=b.prototype;function k(U,G,R){this.props=U,this.context=G,this.refs=S,this.updater=R||w}var C=k.prototype=new N;C.constructor=k,E(C,b.prototype),C.isPureReactComponent=!0;var P=Array.isArray,j={H:null,A:null,T:null,S:null,V:null},H=Object.prototype.hasOwnProperty;function L(U,G,R,z,J,q){return R=q.ref,{$$typeof:t,type:U,key:G,ref:R!==void 0?R:null,props:q}}function K(U,G){return L(U.type,G,void 0,void 0,void 0,U.props)}function M(U){return typeof U=="object"&&U!==null&&U.$$typeof===t}function Q(U){var G={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(R){return G[R]})}var X=/\/+/g;function ee(U,G){return typeof U=="object"&&U!==null&&U.key!=null?Q(""+U.key):G.toString(36)}function ye(){}function Ie(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(ye,ye):(U.status="pending",U.then(function(G){U.status==="pending"&&(U.status="fulfilled",U.value=G)},function(G){U.status==="pending"&&(U.status="rejected",U.reason=G)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function Te(U,G,R,z,J){var q=typeof U;(q==="undefined"||q==="boolean")&&(U=null);var ie=!1;if(U===null)ie=!0;else switch(q){case"bigint":case"string":case"number":ie=!0;break;case"object":switch(U.$$typeof){case t:case e:ie=!0;break;case g:return ie=U._init,Te(ie(U._payload),G,R,z,J)}}if(ie)return J=J(U),ie=z===""?"."+ee(U,0):z,P(J)?(R="",ie!=null&&(R=ie.replace(X,"$&/")+"/"),Te(J,G,R,"",function(ke){return ke})):J!=null&&(M(J)&&(J=K(J,R+(J.key==null||U&&U.key===J.key?"":(""+J.key).replace(X,"$&/")+"/")+ie)),G.push(J)),1;ie=0;var we=z===""?".":z+":";if(P(U))for(var _e=0;_e<U.length;_e++)z=U[_e],q=we+ee(z,_e),ie+=Te(z,G,R,q,J);else if(_e=T(U),typeof _e=="function")for(U=_e.call(U),_e=0;!(z=U.next()).done;)z=z.value,q=we+ee(z,_e++),ie+=Te(z,G,R,q,J);else if(q==="object"){if(typeof U.then=="function")return Te(Ie(U),G,R,z,J);throw G=String(U),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return ie}function re(U,G,R){if(U==null)return U;var z=[],J=0;return Te(U,z,"","",function(q){return G.call(R,q,J++)}),z}function ue(U){if(U._status===-1){var G=U._result;G=G(),G.then(function(R){(U._status===0||U._status===-1)&&(U._status=1,U._result=R)},function(R){(U._status===0||U._status===-1)&&(U._status=2,U._result=R)}),U._status===-1&&(U._status=0,U._result=G)}if(U._status===1)return U._result.default;throw U._result}var ne=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)};function W(){}return ft.Children={map:re,forEach:function(U,G,R){re(U,function(){G.apply(this,arguments)},R)},count:function(U){var G=0;return re(U,function(){G++}),G},toArray:function(U){return re(U,function(G){return G})||[]},only:function(U){if(!M(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},ft.Component=b,ft.Fragment=n,ft.Profiler=a,ft.PureComponent=k,ft.StrictMode=r,ft.Suspense=d,ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,ft.__COMPILER_RUNTIME={__proto__:null,c:function(U){return j.H.useMemoCache(U)}},ft.cache=function(U){return function(){return U.apply(null,arguments)}},ft.cloneElement=function(U,G,R){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var z=E({},U.props),J=U.key,q=void 0;if(G!=null)for(ie in G.ref!==void 0&&(q=void 0),G.key!==void 0&&(J=""+G.key),G)!H.call(G,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&G.ref===void 0||(z[ie]=G[ie]);var ie=arguments.length-2;if(ie===1)z.children=R;else if(1<ie){for(var we=Array(ie),_e=0;_e<ie;_e++)we[_e]=arguments[_e+2];z.children=we}return L(U.type,J,void 0,void 0,q,z)},ft.createContext=function(U){return U={$$typeof:l,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:i,_context:U},U},ft.createElement=function(U,G,R){var z,J={},q=null;if(G!=null)for(z in G.key!==void 0&&(q=""+G.key),G)H.call(G,z)&&z!=="key"&&z!=="__self"&&z!=="__source"&&(J[z]=G[z]);var ie=arguments.length-2;if(ie===1)J.children=R;else if(1<ie){for(var we=Array(ie),_e=0;_e<ie;_e++)we[_e]=arguments[_e+2];J.children=we}if(U&&U.defaultProps)for(z in ie=U.defaultProps,ie)J[z]===void 0&&(J[z]=ie[z]);return L(U,q,void 0,void 0,null,J)},ft.createRef=function(){return{current:null}},ft.forwardRef=function(U){return{$$typeof:c,render:U}},ft.isValidElement=M,ft.lazy=function(U){return{$$typeof:g,_payload:{_status:-1,_result:U},_init:ue}},ft.memo=function(U,G){return{$$typeof:f,type:U,compare:G===void 0?null:G}},ft.startTransition=function(U){var G=j.T,R={};j.T=R;try{var z=U(),J=j.S;J!==null&&J(R,z),typeof z=="object"&&z!==null&&typeof z.then=="function"&&z.then(W,ne)}catch(q){ne(q)}finally{j.T=G}},ft.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},ft.use=function(U){return j.H.use(U)},ft.useActionState=function(U,G,R){return j.H.useActionState(U,G,R)},ft.useCallback=function(U,G){return j.H.useCallback(U,G)},ft.useContext=function(U){return j.H.useContext(U)},ft.useDebugValue=function(){},ft.useDeferredValue=function(U,G){return j.H.useDeferredValue(U,G)},ft.useEffect=function(U,G,R){var z=j.H;if(typeof R=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return z.useEffect(U,G)},ft.useId=function(){return j.H.useId()},ft.useImperativeHandle=function(U,G,R){return j.H.useImperativeHandle(U,G,R)},ft.useInsertionEffect=function(U,G){return j.H.useInsertionEffect(U,G)},ft.useLayoutEffect=function(U,G){return j.H.useLayoutEffect(U,G)},ft.useMemo=function(U,G){return j.H.useMemo(U,G)},ft.useOptimistic=function(U,G){return j.H.useOptimistic(U,G)},ft.useReducer=function(U,G,R){return j.H.useReducer(U,G,R)},ft.useRef=function(U){return j.H.useRef(U)},ft.useState=function(U){return j.H.useState(U)},ft.useSyncExternalStore=function(U,G,R){return j.H.useSyncExternalStore(U,G,R)},ft.useTransition=function(){return j.H.useTransition()},ft.version="19.1.0",ft}var e1;function Cm(){return e1||(e1=1,mh.exports=Fb()),mh.exports}var se=Cm();const Bo=bm(se);var ph={exports:{}},Ql={},gh={exports:{}},xh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1;function Ob(){return t1||(t1=1,function(t){function e(re,ue){var ne=re.length;re.push(ue);e:for(;0<ne;){var W=ne-1>>>1,U=re[W];if(0<a(U,ue))re[W]=ue,re[ne]=U,ne=W;else break e}}function n(re){return re.length===0?null:re[0]}function r(re){if(re.length===0)return null;var ue=re[0],ne=re.pop();if(ne!==ue){re[0]=ne;e:for(var W=0,U=re.length,G=U>>>1;W<G;){var R=2*(W+1)-1,z=re[R],J=R+1,q=re[J];if(0>a(z,ne))J<U&&0>a(q,z)?(re[W]=q,re[J]=ne,W=J):(re[W]=z,re[R]=ne,W=R);else if(J<U&&0>a(q,ne))re[W]=q,re[J]=ne,W=J;else break e}}return ue}function a(re,ue){var ne=re.sortIndex-ue.sortIndex;return ne!==0?ne:re.id-ue.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var d=[],f=[],g=1,y=null,T=3,w=!1,E=!1,S=!1,b=!1,N=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function P(re){for(var ue=n(f);ue!==null;){if(ue.callback===null)r(f);else if(ue.startTime<=re)r(f),ue.sortIndex=ue.expirationTime,e(d,ue);else break;ue=n(f)}}function j(re){if(S=!1,P(re),!E)if(n(d)!==null)E=!0,H||(H=!0,ee());else{var ue=n(f);ue!==null&&Te(j,ue.startTime-re)}}var H=!1,L=-1,K=5,M=-1;function Q(){return b?!0:!(t.unstable_now()-M<K)}function X(){if(b=!1,H){var re=t.unstable_now();M=re;var ue=!0;try{e:{E=!1,S&&(S=!1,k(L),L=-1),w=!0;var ne=T;try{t:{for(P(re),y=n(d);y!==null&&!(y.expirationTime>re&&Q());){var W=y.callback;if(typeof W=="function"){y.callback=null,T=y.priorityLevel;var U=W(y.expirationTime<=re);if(re=t.unstable_now(),typeof U=="function"){y.callback=U,P(re),ue=!0;break t}y===n(d)&&r(d),P(re)}else r(d);y=n(d)}if(y!==null)ue=!0;else{var G=n(f);G!==null&&Te(j,G.startTime-re),ue=!1}}break e}finally{y=null,T=ne,w=!1}ue=void 0}}finally{ue?ee():H=!1}}}var ee;if(typeof C=="function")ee=function(){C(X)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,Ie=ye.port2;ye.port1.onmessage=X,ee=function(){Ie.postMessage(null)}}else ee=function(){N(X,0)};function Te(re,ue){L=N(function(){re(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(re){re.callback=null},t.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<re?Math.floor(1e3/re):5},t.unstable_getCurrentPriorityLevel=function(){return T},t.unstable_next=function(re){switch(T){case 1:case 2:case 3:var ue=3;break;default:ue=T}var ne=T;T=ue;try{return re()}finally{T=ne}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(re,ue){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var ne=T;T=re;try{return ue()}finally{T=ne}},t.unstable_scheduleCallback=function(re,ue,ne){var W=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?W+ne:W):ne=W,re){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=ne+U,re={id:g++,callback:ue,priorityLevel:re,startTime:ne,expirationTime:U,sortIndex:-1},ne>W?(re.sortIndex=ne,e(f,re),n(d)===null&&re===n(f)&&(S?(k(L),L=-1):S=!0,Te(j,ne-W))):(re.sortIndex=U,e(d,re),E||w||(E=!0,H||(H=!0,ee()))),re},t.unstable_shouldYield=Q,t.unstable_wrapCallback=function(re){var ue=T;return function(){var ne=T;T=ue;try{return re.apply(this,arguments)}finally{T=ne}}}}(xh)),xh}var n1;function Lb(){return n1||(n1=1,gh.exports=Ob()),gh.exports}var vh={exports:{}},zn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r1;function Pb(){if(r1)return zn;r1=1;var t=Cm();function e(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(d,f,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:d,containerInfo:f,implementation:g}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return zn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,zn.createPortal=function(d,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return i(d,f,null,g)},zn.flushSync=function(d){var f=l.T,g=r.p;try{if(l.T=null,r.p=2,d)return d()}finally{l.T=f,r.p=g,r.d.f()}},zn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(d,f))},zn.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},zn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var g=f.as,y=c(g,f.crossOrigin),T=typeof f.integrity=="string"?f.integrity:void 0,w=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?r.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:T,fetchPriority:w}):g==="script"&&r.d.X(d,{crossOrigin:y,integrity:T,fetchPriority:w,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},zn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=c(f.as,f.crossOrigin);r.d.M(d,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(d)},zn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,y=c(g,f.crossOrigin);r.d.L(d,g,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},zn.preloadModule=function(d,f){if(typeof d=="string")if(f){var g=c(f.as,f.crossOrigin);r.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(d)},zn.requestFormReset=function(d){r.d.r(d)},zn.unstable_batchedUpdates=function(d,f){return d(f)},zn.useFormState=function(d,f,g){return l.H.useFormState(d,f,g)},zn.useFormStatus=function(){return l.H.useHostTransitionStatus()},zn.version="19.1.0",zn}var a1;function Ub(){if(a1)return vh.exports;a1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),vh.exports=Pb(),vh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s1;function Bb(){if(s1)return Ql;s1=1;var t=Lb(),e=Cm(),n=Ub();function r(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var o=s,u=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(u=o.return),s=o.return;while(s)}return o.tag===3?u:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function c(s){if(i(s)!==s)throw Error(r(188))}function d(s){var o=s.alternate;if(!o){if(o=i(s),o===null)throw Error(r(188));return o!==s?null:s}for(var u=s,p=o;;){var v=u.return;if(v===null)break;var _=v.alternate;if(_===null){if(p=v.return,p!==null){u=p;continue}break}if(v.child===_.child){for(_=v.child;_;){if(_===u)return c(v),s;if(_===p)return c(v),o;_=_.sibling}throw Error(r(188))}if(u.return!==p.return)u=v,p=_;else{for(var A=!1,O=v.child;O;){if(O===u){A=!0,u=v,p=_;break}if(O===p){A=!0,p=v,u=_;break}O=O.sibling}if(!A){for(O=_.child;O;){if(O===u){A=!0,u=_,p=v;break}if(O===p){A=!0,p=_,u=v;break}O=O.sibling}if(!A)throw Error(r(189))}}if(u.alternate!==p)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?s:o}function f(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=f(s),o!==null)return o;s=s.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),k=Symbol.for("react.consumer"),C=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),X=Symbol.iterator;function ee(s){return s===null||typeof s!="object"?null:(s=X&&s[X]||s["@@iterator"],typeof s=="function"?s:null)}var ye=Symbol.for("react.client.reference");function Ie(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ye?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case E:return"Fragment";case b:return"Profiler";case S:return"StrictMode";case j:return"Suspense";case H:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case C:return(s.displayName||"Context")+".Provider";case k:return(s._context.displayName||"Context")+".Consumer";case P:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case L:return o=s.displayName||null,o!==null?o:Ie(s.type)||"Memo";case K:o=s._payload,s=s._init;try{return Ie(s(o))}catch{}}return null}var Te=Array.isArray,re=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},W=[],U=-1;function G(s){return{current:s}}function R(s){0>U||(s.current=W[U],W[U]=null,U--)}function z(s,o){U++,W[U]=s.current,s.current=o}var J=G(null),q=G(null),ie=G(null),we=G(null);function _e(s,o){switch(z(ie,o),z(q,s),z(J,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?bv(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=bv(o),s=Cv(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}R(J),z(J,s)}function ke(){R(J),R(q),R(ie)}function Ce(s){s.memoizedState!==null&&z(we,s);var o=J.current,u=Cv(o,s.type);o!==u&&(z(q,s),z(J,u))}function He(s){q.current===s&&(R(J),R(q)),we.current===s&&(R(we),Yl._currentValue=ne)}var Z=Object.prototype.hasOwnProperty,yt=t.unstable_scheduleCallback,qe=t.unstable_cancelCallback,it=t.unstable_shouldYield,rt=t.unstable_requestPaint,Re=t.unstable_now,Dt=t.unstable_getCurrentPriorityLevel,$t=t.unstable_ImmediatePriority,dn=t.unstable_UserBlockingPriority,en=t.unstable_NormalPriority,Gn=t.unstable_LowPriority,Nn=t.unstable_IdlePriority,on=t.log,wn=t.unstable_setDisableYieldValue,ln=null,qt=null;function Ne(s){if(typeof on=="function"&&wn(s),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(ln,s)}catch{}}var Pe=Math.clz32?Math.clz32:Tt,De=Math.log,Be=Math.LN2;function Tt(s){return s>>>=0,s===0?32:31-(De(s)/Be|0)|0}var ot=256,Bt=4194304;function hn(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function vr(s,o,u){var p=s.pendingLanes;if(p===0)return 0;var v=0,_=s.suspendedLanes,A=s.pingedLanes;s=s.warmLanes;var O=p&134217727;return O!==0?(p=O&~_,p!==0?v=hn(p):(A&=O,A!==0?v=hn(A):u||(u=O&~s,u!==0&&(v=hn(u))))):(O=p&~_,O!==0?v=hn(O):A!==0?v=hn(A):u||(u=p&~s,u!==0&&(v=hn(u)))),v===0?0:o!==0&&o!==v&&(o&_)===0&&(_=v&-v,u=o&-o,_>=u||_===32&&(u&4194048)!==0)?o:v}function cr(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function Rr(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ve(){var s=ot;return ot<<=1,(ot&4194048)===0&&(ot=256),s}function Ve(){var s=Bt;return Bt<<=1,(Bt&62914560)===0&&(Bt=4194304),s}function Ke(s){for(var o=[],u=0;31>u;u++)o.push(s);return o}function Fe(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function lt(s,o,u,p,v,_){var A=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var O=s.entanglements,te=s.expirationTimes,de=s.hiddenUpdates;for(u=A&~u;0<u;){var Ee=31-Pe(u),be=1<<Ee;O[Ee]=0,te[Ee]=-1;var pe=de[Ee];if(pe!==null)for(de[Ee]=null,Ee=0;Ee<pe.length;Ee++){var ge=pe[Ee];ge!==null&&(ge.lane&=-536870913)}u&=~be}p!==0&&mt(s,p,0),_!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=_&~(A&~o))}function mt(s,o,u){s.pendingLanes|=o,s.suspendedLanes&=~o;var p=31-Pe(o);s.entangledLanes|=o,s.entanglements[p]=s.entanglements[p]|1073741824|u&4194090}function Xt(s,o){var u=s.entangledLanes|=o;for(s=s.entanglements;u;){var p=31-Pe(u),v=1<<p;v&o|s[p]&o&&(s[p]|=o),u&=~v}}function Dr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ea(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Oi(){var s=ue.p;return s!==0?s:(s=window.event,s===void 0?32:zv(s.type))}function al(s,o){var u=ue.p;try{return ue.p=s,o()}finally{ue.p=u}}var Mr=Math.random().toString(36).slice(2),mn="__reactFiber$"+Mr,pn="__reactProps$"+Mr,ga="__reactContainer$"+Mr,zs="__reactEvents$"+Mr,sl="__reactListeners$"+Mr,D="__reactHandles$"+Mr,F="__reactResources$"+Mr,I="__reactMarker$"+Mr;function B(s){delete s[mn],delete s[pn],delete s[zs],delete s[sl],delete s[D]}function V(s){var o=s[mn];if(o)return o;for(var u=s.parentNode;u;){if(o=u[ga]||u[mn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(s=Rv(s);s!==null;){if(u=s[mn])return u;s=Rv(s)}return o}s=u,u=s.parentNode}return null}function Y(s){if(s=s[mn]||s[ga]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function ce(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(r(33))}function xe(s){var o=s[F];return o||(o=s[F]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function le(s){s[I]=!0}var he=new Set,me={};function Ae(s,o){Oe(s,o),Oe(s+"Capture",o)}function Oe(s,o){for(me[s]=o,s=0;s<o.length;s++)he.add(o[s])}var je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Me={},Ue={};function tt(s){return Z.call(Ue,s)?!0:Z.call(Me,s)?!1:je.test(s)?Ue[s]=!0:(Me[s]=!0,!1)}function It(s,o,u){if(tt(o))if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+u)}}function Ft(s,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+u)}}function Ot(s,o,u,p){if(p===null)s.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(o,u,""+p)}}var Ir,xa;function Fr(s){if(Ir===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);Ir=o&&o[1]||"",xa=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ir+s+xa}var ta=!1;function qs(s,o){if(!s||ta)return"";ta=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(ge){var pe=ge}Reflect.construct(s,[],be)}else{try{be.call()}catch(ge){pe=ge}s.call(be.prototype)}}else{try{throw Error()}catch(ge){pe=ge}(be=s())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(ge){if(ge&&pe&&typeof ge.stack=="string")return[ge.stack,pe.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=p.DetermineComponentFrameRoot(),A=_[0],O=_[1];if(A&&O){var te=A.split(`
`),de=O.split(`
`);for(v=p=0;p<te.length&&!te[p].includes("DetermineComponentFrameRoot");)p++;for(;v<de.length&&!de[v].includes("DetermineComponentFrameRoot");)v++;if(p===te.length||v===de.length)for(p=te.length-1,v=de.length-1;1<=p&&0<=v&&te[p]!==de[v];)v--;for(;1<=p&&0<=v;p--,v--)if(te[p]!==de[v]){if(p!==1||v!==1)do if(p--,v--,0>v||te[p]!==de[v]){var Ee=`
`+te[p].replace(" at new "," at ");return s.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",s.displayName)),Ee}while(1<=p&&0<=v);break}}}finally{ta=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?Fr(u):""}function na(s){switch(s.tag){case 26:case 27:case 5:return Fr(s.type);case 16:return Fr("Lazy");case 13:return Fr("Suspense");case 19:return Fr("SuspenseList");case 0:case 15:return qs(s.type,!1);case 11:return qs(s.type.render,!1);case 1:return qs(s.type,!0);case 31:return Fr("Activity");default:return""}}function yp(s){try{var o="";do o+=na(s),s=s.return;while(s);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function Or(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function _p(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function CE(s){var o=_p(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),p=""+s[o];if(!s.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var v=u.get,_=u.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return v.call(this)},set:function(A){p=""+A,_.call(this,A)}}),Object.defineProperty(s,o,{enumerable:u.enumerable}),{getValue:function(){return p},setValue:function(A){p=""+A},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Kc(s){s._valueTracker||(s._valueTracker=CE(s))}function Tp(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var u=o.getValue(),p="";return s&&(p=_p(s)?s.checked?"true":"false":s.value),s=p,s!==u?(o.setValue(s),!0):!1}function Xc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var AE=/[\n"\\]/g;function Lr(s){return s.replace(AE,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function ud(s,o,u,p,v,_,A,O){s.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.type=A:s.removeAttribute("type"),o!=null?A==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+Or(o)):s.value!==""+Or(o)&&(s.value=""+Or(o)):A!=="submit"&&A!=="reset"||s.removeAttribute("value"),o!=null?fd(s,A,Or(o)):u!=null?fd(s,A,Or(u)):p!=null&&s.removeAttribute("value"),v==null&&_!=null&&(s.defaultChecked=!!_),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?s.name=""+Or(O):s.removeAttribute("name")}function wp(s,o,u,p,v,_,A,O){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),o!=null||u!=null){if(!(_!=="submit"&&_!=="reset"||o!=null))return;u=u!=null?""+Or(u):"",o=o!=null?""+Or(o):u,O||o===s.value||(s.value=o),s.defaultValue=o}p=p??v,p=typeof p!="function"&&typeof p!="symbol"&&!!p,s.checked=O?s.checked:!!p,s.defaultChecked=!!p,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.name=A)}function fd(s,o,u){o==="number"&&Xc(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Li(s,o,u,p){if(s=s.options,o){o={};for(var v=0;v<u.length;v++)o["$"+u[v]]=!0;for(u=0;u<s.length;u++)v=o.hasOwnProperty("$"+s[u].value),s[u].selected!==v&&(s[u].selected=v),v&&p&&(s[u].defaultSelected=!0)}else{for(u=""+Or(u),o=null,v=0;v<s.length;v++){if(s[v].value===u){s[v].selected=!0,p&&(s[v].defaultSelected=!0);return}o!==null||s[v].disabled||(o=s[v])}o!==null&&(o.selected=!0)}}function Ep(s,o,u){if(o!=null&&(o=""+Or(o),o!==s.value&&(s.value=o),u==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=u!=null?""+Or(u):""}function Sp(s,o,u,p){if(o==null){if(p!=null){if(u!=null)throw Error(r(92));if(Te(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),o=u}u=Or(o),s.defaultValue=u,p=s.textContent,p===u&&p!==""&&p!==null&&(s.value=p)}function Pi(s,o){if(o){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=o;return}}s.textContent=o}var kE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bp(s,o,u){var p=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":p?s.setProperty(o,u):typeof u!="number"||u===0||kE.has(o)?o==="float"?s.cssFloat=u:s[o]=(""+u).trim():s[o]=u+"px"}function Cp(s,o,u){if(o!=null&&typeof o!="object")throw Error(r(62));if(s=s.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?s.setProperty(p,""):p==="float"?s.cssFloat="":s[p]="");for(var v in o)p=o[v],o.hasOwnProperty(v)&&u[v]!==p&&bp(s,v,p)}else for(var _ in o)o.hasOwnProperty(_)&&bp(s,_,o[_])}function dd(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var NE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),RE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zc(s){return RE.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var hd=null;function md(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ui=null,Bi=null;function Ap(s){var o=Y(s);if(o&&(s=o.stateNode)){var u=s[pn]||null;e:switch(s=o.stateNode,o.type){case"input":if(ud(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Lr(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var p=u[o];if(p!==s&&p.form===s.form){var v=p[pn]||null;if(!v)throw Error(r(90));ud(p,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(o=0;o<u.length;o++)p=u[o],p.form===s.form&&Tp(p)}break e;case"textarea":Ep(s,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Li(s,!!u.multiple,o,!1)}}}var pd=!1;function kp(s,o,u){if(pd)return s(o,u);pd=!0;try{var p=s(o);return p}finally{if(pd=!1,(Ui!==null||Bi!==null)&&(Pu(),Ui&&(o=Ui,s=Bi,Bi=Ui=null,Ap(o),s)))for(o=0;o<s.length;o++)Ap(s[o])}}function il(s,o){var u=s.stateNode;if(u===null)return null;var p=u[pn]||null;if(p===null)return null;u=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(s=s.type,p=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!p;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var Ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gd=!1;if(Ia)try{var ol={};Object.defineProperty(ol,"passive",{get:function(){gd=!0}}),window.addEventListener("test",ol,ol),window.removeEventListener("test",ol,ol)}catch{gd=!1}var ss=null,xd=null,Qc=null;function Np(){if(Qc)return Qc;var s,o=xd,u=o.length,p,v="value"in ss?ss.value:ss.textContent,_=v.length;for(s=0;s<u&&o[s]===v[s];s++);var A=u-s;for(p=1;p<=A&&o[u-p]===v[_-p];p++);return Qc=v.slice(s,1<p?1-p:void 0)}function eu(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function tu(){return!0}function Rp(){return!1}function ur(s){function o(u,p,v,_,A){this._reactName=u,this._targetInst=v,this.type=p,this.nativeEvent=_,this.target=A,this.currentTarget=null;for(var O in s)s.hasOwnProperty(O)&&(u=s[O],this[O]=u?u(_):_[O]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?tu:Rp,this.isPropagationStopped=Rp,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=tu)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=tu)},persist:function(){},isPersistent:tu}),o}var Ys={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nu=ur(Ys),ll=g({},Ys,{view:0,detail:0}),DE=ur(ll),vd,yd,cl,ru=g({},ll,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Td,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==cl&&(cl&&s.type==="mousemove"?(vd=s.screenX-cl.screenX,yd=s.screenY-cl.screenY):yd=vd=0,cl=s),vd)},movementY:function(s){return"movementY"in s?s.movementY:yd}}),Dp=ur(ru),ME=g({},ru,{dataTransfer:0}),IE=ur(ME),FE=g({},ll,{relatedTarget:0}),_d=ur(FE),OE=g({},Ys,{animationName:0,elapsedTime:0,pseudoElement:0}),LE=ur(OE),PE=g({},Ys,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),UE=ur(PE),BE=g({},Ys,{data:0}),Mp=ur(BE),jE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},HE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GE(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=HE[s])?!!o[s]:!1}function Td(){return GE}var $E=g({},ll,{key:function(s){if(s.key){var o=jE[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=eu(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?VE[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Td,charCode:function(s){return s.type==="keypress"?eu(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?eu(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),zE=ur($E),qE=g({},ru,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ip=ur(qE),YE=g({},ll,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Td}),JE=ur(YE),WE=g({},Ys,{propertyName:0,elapsedTime:0,pseudoElement:0}),KE=ur(WE),XE=g({},ru,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ZE=ur(XE),QE=g({},Ys,{newState:0,oldState:0}),eS=ur(QE),tS=[9,13,27,32],wd=Ia&&"CompositionEvent"in window,ul=null;Ia&&"documentMode"in document&&(ul=document.documentMode);var nS=Ia&&"TextEvent"in window&&!ul,Fp=Ia&&(!wd||ul&&8<ul&&11>=ul),Op=" ",Lp=!1;function Pp(s,o){switch(s){case"keyup":return tS.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Up(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ji=!1;function rS(s,o){switch(s){case"compositionend":return Up(o);case"keypress":return o.which!==32?null:(Lp=!0,Op);case"textInput":return s=o.data,s===Op&&Lp?null:s;default:return null}}function aS(s,o){if(ji)return s==="compositionend"||!wd&&Pp(s,o)?(s=Np(),Qc=xd=ss=null,ji=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Fp&&o.locale!=="ko"?null:o.data;default:return null}}var sS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bp(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!sS[s.type]:o==="textarea"}function jp(s,o,u,p){Ui?Bi?Bi.push(p):Bi=[p]:Ui=p,o=Gu(o,"onChange"),0<o.length&&(u=new nu("onChange","change",null,u,p),s.push({event:u,listeners:o}))}var fl=null,dl=null;function iS(s){_v(s,0)}function au(s){var o=ce(s);if(Tp(o))return s}function Vp(s,o){if(s==="change")return o}var Hp=!1;if(Ia){var Ed;if(Ia){var Sd="oninput"in document;if(!Sd){var Gp=document.createElement("div");Gp.setAttribute("oninput","return;"),Sd=typeof Gp.oninput=="function"}Ed=Sd}else Ed=!1;Hp=Ed&&(!document.documentMode||9<document.documentMode)}function $p(){fl&&(fl.detachEvent("onpropertychange",zp),dl=fl=null)}function zp(s){if(s.propertyName==="value"&&au(dl)){var o=[];jp(o,dl,s,md(s)),kp(iS,o)}}function oS(s,o,u){s==="focusin"?($p(),fl=o,dl=u,fl.attachEvent("onpropertychange",zp)):s==="focusout"&&$p()}function lS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return au(dl)}function cS(s,o){if(s==="click")return au(o)}function uS(s,o){if(s==="input"||s==="change")return au(o)}function fS(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var yr=typeof Object.is=="function"?Object.is:fS;function hl(s,o){if(yr(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var u=Object.keys(s),p=Object.keys(o);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var v=u[p];if(!Z.call(o,v)||!yr(s[v],o[v]))return!1}return!0}function qp(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Yp(s,o){var u=qp(s);s=0;for(var p;u;){if(u.nodeType===3){if(p=s+u.textContent.length,s<=o&&p>=o)return{node:u,offset:o-s};s=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=qp(u)}}function Jp(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Jp(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Wp(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Xc(s.document);o instanceof s.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)s=o.contentWindow;else break;o=Xc(s.document)}return o}function bd(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var dS=Ia&&"documentMode"in document&&11>=document.documentMode,Vi=null,Cd=null,ml=null,Ad=!1;function Kp(s,o,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Ad||Vi==null||Vi!==Xc(p)||(p=Vi,"selectionStart"in p&&bd(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),ml&&hl(ml,p)||(ml=p,p=Gu(Cd,"onSelect"),0<p.length&&(o=new nu("onSelect","select",null,o,u),s.push({event:o,listeners:p}),o.target=Vi)))}function Js(s,o){var u={};return u[s.toLowerCase()]=o.toLowerCase(),u["Webkit"+s]="webkit"+o,u["Moz"+s]="moz"+o,u}var Hi={animationend:Js("Animation","AnimationEnd"),animationiteration:Js("Animation","AnimationIteration"),animationstart:Js("Animation","AnimationStart"),transitionrun:Js("Transition","TransitionRun"),transitionstart:Js("Transition","TransitionStart"),transitioncancel:Js("Transition","TransitionCancel"),transitionend:Js("Transition","TransitionEnd")},kd={},Xp={};Ia&&(Xp=document.createElement("div").style,"AnimationEvent"in window||(delete Hi.animationend.animation,delete Hi.animationiteration.animation,delete Hi.animationstart.animation),"TransitionEvent"in window||delete Hi.transitionend.transition);function Ws(s){if(kd[s])return kd[s];if(!Hi[s])return s;var o=Hi[s],u;for(u in o)if(o.hasOwnProperty(u)&&u in Xp)return kd[s]=o[u];return s}var Zp=Ws("animationend"),Qp=Ws("animationiteration"),eg=Ws("animationstart"),hS=Ws("transitionrun"),mS=Ws("transitionstart"),pS=Ws("transitioncancel"),tg=Ws("transitionend"),ng=new Map,Nd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Nd.push("scrollEnd");function ra(s,o){ng.set(s,o),Ae(o,[s])}var rg=new WeakMap;function Pr(s,o){if(typeof s=="object"&&s!==null){var u=rg.get(s);return u!==void 0?u:(o={value:s,source:o,stack:yp(o)},rg.set(s,o),o)}return{value:s,source:o,stack:yp(o)}}var Ur=[],Gi=0,Rd=0;function su(){for(var s=Gi,o=Rd=Gi=0;o<s;){var u=Ur[o];Ur[o++]=null;var p=Ur[o];Ur[o++]=null;var v=Ur[o];Ur[o++]=null;var _=Ur[o];if(Ur[o++]=null,p!==null&&v!==null){var A=p.pending;A===null?v.next=v:(v.next=A.next,A.next=v),p.pending=v}_!==0&&ag(u,v,_)}}function iu(s,o,u,p){Ur[Gi++]=s,Ur[Gi++]=o,Ur[Gi++]=u,Ur[Gi++]=p,Rd|=p,s.lanes|=p,s=s.alternate,s!==null&&(s.lanes|=p)}function Dd(s,o,u,p){return iu(s,o,u,p),ou(s)}function $i(s,o){return iu(s,null,null,o),ou(s)}function ag(s,o,u){s.lanes|=u;var p=s.alternate;p!==null&&(p.lanes|=u);for(var v=!1,_=s.return;_!==null;)_.childLanes|=u,p=_.alternate,p!==null&&(p.childLanes|=u),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(v=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,v&&o!==null&&(v=31-Pe(u),s=_.hiddenUpdates,p=s[v],p===null?s[v]=[o]:p.push(o),o.lane=u|536870912),_):null}function ou(s){if(50<Bl)throw Bl=0,P0=null,Error(r(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var zi={};function gS(s,o,u,p){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _r(s,o,u,p){return new gS(s,o,u,p)}function Md(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Fa(s,o){var u=s.alternate;return u===null?(u=_r(s.tag,o,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=o,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,o=s.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function sg(s,o){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,o=u.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function lu(s,o,u,p,v,_){var A=0;if(p=s,typeof s=="function")Md(s)&&(A=1);else if(typeof s=="string")A=vb(s,u,J.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case M:return s=_r(31,u,o,v),s.elementType=M,s.lanes=_,s;case E:return Ks(u.children,v,_,o);case S:A=8,v|=24;break;case b:return s=_r(12,u,o,v|2),s.elementType=b,s.lanes=_,s;case j:return s=_r(13,u,o,v),s.elementType=j,s.lanes=_,s;case H:return s=_r(19,u,o,v),s.elementType=H,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case N:case C:A=10;break e;case k:A=9;break e;case P:A=11;break e;case L:A=14;break e;case K:A=16,p=null;break e}A=29,u=Error(r(130,s===null?"null":typeof s,"")),p=null}return o=_r(A,u,o,v),o.elementType=s,o.type=p,o.lanes=_,o}function Ks(s,o,u,p){return s=_r(7,s,p,o),s.lanes=u,s}function Id(s,o,u){return s=_r(6,s,null,o),s.lanes=u,s}function Fd(s,o,u){return o=_r(4,s.children!==null?s.children:[],s.key,o),o.lanes=u,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var qi=[],Yi=0,cu=null,uu=0,Br=[],jr=0,Xs=null,Oa=1,La="";function Zs(s,o){qi[Yi++]=uu,qi[Yi++]=cu,cu=s,uu=o}function ig(s,o,u){Br[jr++]=Oa,Br[jr++]=La,Br[jr++]=Xs,Xs=s;var p=Oa;s=La;var v=32-Pe(p)-1;p&=~(1<<v),u+=1;var _=32-Pe(o)+v;if(30<_){var A=v-v%5;_=(p&(1<<A)-1).toString(32),p>>=A,v-=A,Oa=1<<32-Pe(o)+v|u<<v|p,La=_+s}else Oa=1<<_|u<<v|p,La=s}function Od(s){s.return!==null&&(Zs(s,1),ig(s,1,0))}function Ld(s){for(;s===cu;)cu=qi[--Yi],qi[Yi]=null,uu=qi[--Yi],qi[Yi]=null;for(;s===Xs;)Xs=Br[--jr],Br[jr]=null,La=Br[--jr],Br[jr]=null,Oa=Br[--jr],Br[jr]=null}var nr=null,nn=null,Mt=!1,Qs=null,va=!1,Pd=Error(r(519));function ei(s){var o=Error(r(418,""));throw xl(Pr(o,s)),Pd}function og(s){var o=s.stateNode,u=s.type,p=s.memoizedProps;switch(o[mn]=s,o[pn]=p,u){case"dialog":xt("cancel",o),xt("close",o);break;case"iframe":case"object":case"embed":xt("load",o);break;case"video":case"audio":for(u=0;u<Vl.length;u++)xt(Vl[u],o);break;case"source":xt("error",o);break;case"img":case"image":case"link":xt("error",o),xt("load",o);break;case"details":xt("toggle",o);break;case"input":xt("invalid",o),wp(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),Kc(o);break;case"select":xt("invalid",o);break;case"textarea":xt("invalid",o),Sp(o,p.value,p.defaultValue,p.children),Kc(o)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||p.suppressHydrationWarning===!0||Sv(o.textContent,u)?(p.popover!=null&&(xt("beforetoggle",o),xt("toggle",o)),p.onScroll!=null&&xt("scroll",o),p.onScrollEnd!=null&&xt("scrollend",o),p.onClick!=null&&(o.onclick=$u),o=!0):o=!1,o||ei(s)}function lg(s){for(nr=s.return;nr;)switch(nr.tag){case 5:case 13:va=!1;return;case 27:case 3:va=!0;return;default:nr=nr.return}}function pl(s){if(s!==nr)return!1;if(!Mt)return lg(s),Mt=!0,!1;var o=s.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||Q0(s.type,s.memoizedProps)),u=!u),u&&nn&&ei(s),lg(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(o===0){nn=sa(s.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;s=s.nextSibling}nn=null}}else o===27?(o=nn,Ts(s.type)?(s=rh,rh=null,nn=s):nn=o):nn=nr?sa(s.stateNode.nextSibling):null;return!0}function gl(){nn=nr=null,Mt=!1}function cg(){var s=Qs;return s!==null&&(hr===null?hr=s:hr.push.apply(hr,s),Qs=null),s}function xl(s){Qs===null?Qs=[s]:Qs.push(s)}var Ud=G(null),ti=null,Pa=null;function is(s,o,u){z(Ud,o._currentValue),o._currentValue=u}function Ua(s){s._currentValue=Ud.current,R(Ud)}function Bd(s,o,u){for(;s!==null;){var p=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),s===u)break;s=s.return}}function jd(s,o,u,p){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var _=v.dependencies;if(_!==null){var A=v.child;_=_.firstContext;e:for(;_!==null;){var O=_;_=v;for(var te=0;te<o.length;te++)if(O.context===o[te]){_.lanes|=u,O=_.alternate,O!==null&&(O.lanes|=u),Bd(_.return,u,s),p||(A=null);break e}_=O.next}}else if(v.tag===18){if(A=v.return,A===null)throw Error(r(341));A.lanes|=u,_=A.alternate,_!==null&&(_.lanes|=u),Bd(A,u,s),A=null}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===s){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}}function vl(s,o,u,p){s=null;for(var v=o,_=!1;v!==null;){if(!_){if((v.flags&524288)!==0)_=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var A=v.alternate;if(A===null)throw Error(r(387));if(A=A.memoizedProps,A!==null){var O=v.type;yr(v.pendingProps.value,A.value)||(s!==null?s.push(O):s=[O])}}else if(v===we.current){if(A=v.alternate,A===null)throw Error(r(387));A.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(Yl):s=[Yl])}v=v.return}s!==null&&jd(o,s,u,p),o.flags|=262144}function fu(s){for(s=s.firstContext;s!==null;){if(!yr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ni(s){ti=s,Pa=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function $n(s){return ug(ti,s)}function du(s,o){return ti===null&&ni(s),ug(s,o)}function ug(s,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Pa===null){if(s===null)throw Error(r(308));Pa=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Pa=Pa.next=o;return u}var xS=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(u,p){s.push(p)}};this.abort=function(){o.aborted=!0,s.forEach(function(u){return u()})}},vS=t.unstable_scheduleCallback,yS=t.unstable_NormalPriority,En={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vd(){return{controller:new xS,data:new Map,refCount:0}}function yl(s){s.refCount--,s.refCount===0&&vS(yS,function(){s.controller.abort()})}var _l=null,Hd=0,Ji=0,Wi=null;function _S(s,o){if(_l===null){var u=_l=[];Hd=0,Ji=$0(),Wi={status:"pending",value:void 0,then:function(p){u.push(p)}}}return Hd++,o.then(fg,fg),o}function fg(){if(--Hd===0&&_l!==null){Wi!==null&&(Wi.status="fulfilled");var s=_l;_l=null,Ji=0,Wi=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function TS(s,o){var u=[],p={status:"pending",value:null,reason:null,then:function(v){u.push(v)}};return s.then(function(){p.status="fulfilled",p.value=o;for(var v=0;v<u.length;v++)(0,u[v])(o)},function(v){for(p.status="rejected",p.reason=v,v=0;v<u.length;v++)(0,u[v])(void 0)}),p}var dg=re.S;re.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&_S(s,o),dg!==null&&dg(s,o)};var ri=G(null);function Gd(){var s=ri.current;return s!==null?s:Yt.pooledCache}function hu(s,o){o===null?z(ri,ri.current):z(ri,o.pool)}function hg(){var s=Gd();return s===null?null:{parent:En._currentValue,pool:s}}var Tl=Error(r(460)),mg=Error(r(474)),mu=Error(r(542)),$d={then:function(){}};function pg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function pu(){}function gg(s,o,u){switch(u=s[u],u===void 0?s.push(o):u!==o&&(o.then(pu,pu),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,vg(s),s;default:if(typeof o.status=="string")o.then(pu,pu);else{if(s=Yt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=o,s.status="pending",s.then(function(p){if(o.status==="pending"){var v=o;v.status="fulfilled",v.value=p}},function(p){if(o.status==="pending"){var v=o;v.status="rejected",v.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,vg(s),s}throw wl=o,Tl}}var wl=null;function xg(){if(wl===null)throw Error(r(459));var s=wl;return wl=null,s}function vg(s){if(s===Tl||s===mu)throw Error(r(483))}var os=!1;function zd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qd(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ls(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function cs(s,o,u){var p=s.updateQueue;if(p===null)return null;if(p=p.shared,(Lt&2)!==0){var v=p.pending;return v===null?o.next=o:(o.next=v.next,v.next=o),p.pending=o,o=ou(s),ag(s,null,u),o}return iu(s,p,o,u),ou(s)}function El(s,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var p=o.lanes;p&=s.pendingLanes,u|=p,o.lanes=u,Xt(s,u)}}function Yd(s,o){var u=s.updateQueue,p=s.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var v=null,_=null;if(u=u.firstBaseUpdate,u!==null){do{var A={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};_===null?v=_=A:_=_.next=A,u=u.next}while(u!==null);_===null?v=_=o:_=_.next=o}else v=_=o;u={baseState:p.baseState,firstBaseUpdate:v,lastBaseUpdate:_,shared:p.shared,callbacks:p.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=o:s.next=o,u.lastBaseUpdate=o}var Jd=!1;function Sl(){if(Jd){var s=Wi;if(s!==null)throw s}}function bl(s,o,u,p){Jd=!1;var v=s.updateQueue;os=!1;var _=v.firstBaseUpdate,A=v.lastBaseUpdate,O=v.shared.pending;if(O!==null){v.shared.pending=null;var te=O,de=te.next;te.next=null,A===null?_=de:A.next=de,A=te;var Ee=s.alternate;Ee!==null&&(Ee=Ee.updateQueue,O=Ee.lastBaseUpdate,O!==A&&(O===null?Ee.firstBaseUpdate=de:O.next=de,Ee.lastBaseUpdate=te))}if(_!==null){var be=v.baseState;A=0,Ee=de=te=null,O=_;do{var pe=O.lane&-536870913,ge=pe!==O.lane;if(ge?(St&pe)===pe:(p&pe)===pe){pe!==0&&pe===Ji&&(Jd=!0),Ee!==null&&(Ee=Ee.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Qe=s,Xe=O;pe=o;var Ht=u;switch(Xe.tag){case 1:if(Qe=Xe.payload,typeof Qe=="function"){be=Qe.call(Ht,be,pe);break e}be=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=Xe.payload,pe=typeof Qe=="function"?Qe.call(Ht,be,pe):Qe,pe==null)break e;be=g({},be,pe);break e;case 2:os=!0}}pe=O.callback,pe!==null&&(s.flags|=64,ge&&(s.flags|=8192),ge=v.callbacks,ge===null?v.callbacks=[pe]:ge.push(pe))}else ge={lane:pe,tag:O.tag,payload:O.payload,callback:O.callback,next:null},Ee===null?(de=Ee=ge,te=be):Ee=Ee.next=ge,A|=pe;if(O=O.next,O===null){if(O=v.shared.pending,O===null)break;ge=O,O=ge.next,ge.next=null,v.lastBaseUpdate=ge,v.shared.pending=null}}while(!0);Ee===null&&(te=be),v.baseState=te,v.firstBaseUpdate=de,v.lastBaseUpdate=Ee,_===null&&(v.shared.lanes=0),xs|=A,s.lanes=A,s.memoizedState=be}}function yg(s,o){if(typeof s!="function")throw Error(r(191,s));s.call(o)}function _g(s,o){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)yg(u[s],o)}var Ki=G(null),gu=G(0);function Tg(s,o){s=za,z(gu,s),z(Ki,o),za=s|o.baseLanes}function Wd(){z(gu,za),z(Ki,Ki.current)}function Kd(){za=gu.current,R(Ki),R(gu)}var us=0,ht=null,jt=null,gn=null,xu=!1,Xi=!1,ai=!1,vu=0,Cl=0,Zi=null,wS=0;function cn(){throw Error(r(321))}function Xd(s,o){if(o===null)return!1;for(var u=0;u<o.length&&u<s.length;u++)if(!yr(s[u],o[u]))return!1;return!0}function Zd(s,o,u,p,v,_){return us=_,ht=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,re.H=s===null||s.memoizedState===null?ax:sx,ai=!1,_=u(p,v),ai=!1,Xi&&(_=Eg(o,u,p,v)),wg(s),_}function wg(s){re.H=Su;var o=jt!==null&&jt.next!==null;if(us=0,gn=jt=ht=null,xu=!1,Cl=0,Zi=null,o)throw Error(r(300));s===null||Rn||(s=s.dependencies,s!==null&&fu(s)&&(Rn=!0))}function Eg(s,o,u,p){ht=s;var v=0;do{if(Xi&&(Zi=null),Cl=0,Xi=!1,25<=v)throw Error(r(301));if(v+=1,gn=jt=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}re.H=NS,_=o(u,p)}while(Xi);return _}function ES(){var s=re.H,o=s.useState()[0];return o=typeof o.then=="function"?Al(o):o,s=s.useState()[0],(jt!==null?jt.memoizedState:null)!==s&&(ht.flags|=1024),o}function Qd(){var s=vu!==0;return vu=0,s}function e0(s,o,u){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~u}function t0(s){if(xu){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}xu=!1}us=0,gn=jt=ht=null,Xi=!1,Cl=vu=0,Zi=null}function fr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?ht.memoizedState=gn=s:gn=gn.next=s,gn}function xn(){if(jt===null){var s=ht.alternate;s=s!==null?s.memoizedState:null}else s=jt.next;var o=gn===null?ht.memoizedState:gn.next;if(o!==null)gn=o,jt=s;else{if(s===null)throw ht.alternate===null?Error(r(467)):Error(r(310));jt=s,s={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},gn===null?ht.memoizedState=gn=s:gn=gn.next=s}return gn}function n0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Al(s){var o=Cl;return Cl+=1,Zi===null&&(Zi=[]),s=gg(Zi,s,o),o=ht,(gn===null?o.memoizedState:gn.next)===null&&(o=o.alternate,re.H=o===null||o.memoizedState===null?ax:sx),s}function yu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Al(s);if(s.$$typeof===C)return $n(s)}throw Error(r(438,String(s)))}function r0(s){var o=null,u=ht.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var p=ht.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(v){return v.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=n0(),ht.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(s),p=0;p<s;p++)u[p]=Q;return o.index++,u}function Ba(s,o){return typeof o=="function"?o(s):o}function _u(s){var o=xn();return a0(o,jt,s)}function a0(s,o,u){var p=s.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=u;var v=s.baseQueue,_=p.pending;if(_!==null){if(v!==null){var A=v.next;v.next=_.next,_.next=A}o.baseQueue=v=_,p.pending=null}if(_=s.baseState,v===null)s.memoizedState=_;else{o=v.next;var O=A=null,te=null,de=o,Ee=!1;do{var be=de.lane&-536870913;if(be!==de.lane?(St&be)===be:(us&be)===be){var pe=de.revertLane;if(pe===0)te!==null&&(te=te.next={lane:0,revertLane:0,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),be===Ji&&(Ee=!0);else if((us&pe)===pe){de=de.next,pe===Ji&&(Ee=!0);continue}else be={lane:0,revertLane:de.revertLane,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},te===null?(O=te=be,A=_):te=te.next=be,ht.lanes|=pe,xs|=pe;be=de.action,ai&&u(_,be),_=de.hasEagerState?de.eagerState:u(_,be)}else pe={lane:be,revertLane:de.revertLane,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},te===null?(O=te=pe,A=_):te=te.next=pe,ht.lanes|=be,xs|=be;de=de.next}while(de!==null&&de!==o);if(te===null?A=_:te.next=O,!yr(_,s.memoizedState)&&(Rn=!0,Ee&&(u=Wi,u!==null)))throw u;s.memoizedState=_,s.baseState=A,s.baseQueue=te,p.lastRenderedState=_}return v===null&&(p.lanes=0),[s.memoizedState,p.dispatch]}function s0(s){var o=xn(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=s;var p=u.dispatch,v=u.pending,_=o.memoizedState;if(v!==null){u.pending=null;var A=v=v.next;do _=s(_,A.action),A=A.next;while(A!==v);yr(_,o.memoizedState)||(Rn=!0),o.memoizedState=_,o.baseQueue===null&&(o.baseState=_),u.lastRenderedState=_}return[_,p]}function Sg(s,o,u){var p=ht,v=xn(),_=Mt;if(_){if(u===void 0)throw Error(r(407));u=u()}else u=o();var A=!yr((jt||v).memoizedState,u);A&&(v.memoizedState=u,Rn=!0),v=v.queue;var O=Ag.bind(null,p,v,s);if(kl(2048,8,O,[s]),v.getSnapshot!==o||A||gn!==null&&gn.memoizedState.tag&1){if(p.flags|=2048,Qi(9,Tu(),Cg.bind(null,p,v,u,o),null),Yt===null)throw Error(r(349));_||(us&124)!==0||bg(p,o,u)}return u}function bg(s,o,u){s.flags|=16384,s={getSnapshot:o,value:u},o=ht.updateQueue,o===null?(o=n0(),ht.updateQueue=o,o.stores=[s]):(u=o.stores,u===null?o.stores=[s]:u.push(s))}function Cg(s,o,u,p){o.value=u,o.getSnapshot=p,kg(o)&&Ng(s)}function Ag(s,o,u){return u(function(){kg(o)&&Ng(s)})}function kg(s){var o=s.getSnapshot;s=s.value;try{var u=o();return!yr(s,u)}catch{return!0}}function Ng(s){var o=$i(s,2);o!==null&&br(o,s,2)}function i0(s){var o=fr();if(typeof s=="function"){var u=s;if(s=u(),ai){Ne(!0);try{u()}finally{Ne(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ba,lastRenderedState:s},o}function Rg(s,o,u,p){return s.baseState=u,a0(s,jt,typeof p=="function"?p:Ba)}function SS(s,o,u,p,v){if(Eu(s))throw Error(r(485));if(s=o.action,s!==null){var _={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){_.listeners.push(A)}};re.T!==null?u(!0):_.isTransition=!1,p(_),u=o.pending,u===null?(_.next=o.pending=_,Dg(o,_)):(_.next=u.next,o.pending=u.next=_)}}function Dg(s,o){var u=o.action,p=o.payload,v=s.state;if(o.isTransition){var _=re.T,A={};re.T=A;try{var O=u(v,p),te=re.S;te!==null&&te(A,O),Mg(s,o,O)}catch(de){o0(s,o,de)}finally{re.T=_}}else try{_=u(v,p),Mg(s,o,_)}catch(de){o0(s,o,de)}}function Mg(s,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){Ig(s,o,p)},function(p){return o0(s,o,p)}):Ig(s,o,u)}function Ig(s,o,u){o.status="fulfilled",o.value=u,Fg(o),s.state=u,o=s.pending,o!==null&&(u=o.next,u===o?s.pending=null:(u=u.next,o.next=u,Dg(s,u)))}function o0(s,o,u){var p=s.pending;if(s.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=u,Fg(o),o=o.next;while(o!==p)}s.action=null}function Fg(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function Og(s,o){return o}function Lg(s,o){if(Mt){var u=Yt.formState;if(u!==null){e:{var p=ht;if(Mt){if(nn){t:{for(var v=nn,_=va;v.nodeType!==8;){if(!_){v=null;break t}if(v=sa(v.nextSibling),v===null){v=null;break t}}_=v.data,v=_==="F!"||_==="F"?v:null}if(v){nn=sa(v.nextSibling),p=v.data==="F!";break e}}ei(p)}p=!1}p&&(o=u[0])}}return u=fr(),u.memoizedState=u.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Og,lastRenderedState:o},u.queue=p,u=tx.bind(null,ht,p),p.dispatch=u,p=i0(!1),_=d0.bind(null,ht,!1,p.queue),p=fr(),v={state:o,dispatch:null,action:s,pending:null},p.queue=v,u=SS.bind(null,ht,v,_,u),v.dispatch=u,p.memoizedState=s,[o,u,!1]}function Pg(s){var o=xn();return Ug(o,jt,s)}function Ug(s,o,u){if(o=a0(s,o,Og)[0],s=_u(Ba)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=Al(o)}catch(A){throw A===Tl?mu:A}else p=o;o=xn();var v=o.queue,_=v.dispatch;return u!==o.memoizedState&&(ht.flags|=2048,Qi(9,Tu(),bS.bind(null,v,u),null)),[p,_,s]}function bS(s,o){s.action=o}function Bg(s){var o=xn(),u=jt;if(u!==null)return Ug(o,u,s);xn(),o=o.memoizedState,u=xn();var p=u.queue.dispatch;return u.memoizedState=s,[o,p,!1]}function Qi(s,o,u,p){return s={tag:s,create:u,deps:p,inst:o,next:null},o=ht.updateQueue,o===null&&(o=n0(),ht.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=s.next=s:(p=u.next,u.next=s,s.next=p,o.lastEffect=s),s}function Tu(){return{destroy:void 0,resource:void 0}}function jg(){return xn().memoizedState}function wu(s,o,u,p){var v=fr();p=p===void 0?null:p,ht.flags|=s,v.memoizedState=Qi(1|o,Tu(),u,p)}function kl(s,o,u,p){var v=xn();p=p===void 0?null:p;var _=v.memoizedState.inst;jt!==null&&p!==null&&Xd(p,jt.memoizedState.deps)?v.memoizedState=Qi(o,_,u,p):(ht.flags|=s,v.memoizedState=Qi(1|o,_,u,p))}function Vg(s,o){wu(8390656,8,s,o)}function Hg(s,o){kl(2048,8,s,o)}function Gg(s,o){return kl(4,2,s,o)}function $g(s,o){return kl(4,4,s,o)}function zg(s,o){if(typeof o=="function"){s=s();var u=o(s);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function qg(s,o,u){u=u!=null?u.concat([s]):null,kl(4,4,zg.bind(null,o,s),u)}function l0(){}function Yg(s,o){var u=xn();o=o===void 0?null:o;var p=u.memoizedState;return o!==null&&Xd(o,p[1])?p[0]:(u.memoizedState=[s,o],s)}function Jg(s,o){var u=xn();o=o===void 0?null:o;var p=u.memoizedState;if(o!==null&&Xd(o,p[1]))return p[0];if(p=s(),ai){Ne(!0);try{s()}finally{Ne(!1)}}return u.memoizedState=[p,o],p}function c0(s,o,u){return u===void 0||(us&1073741824)!==0?s.memoizedState=o:(s.memoizedState=u,s=Xx(),ht.lanes|=s,xs|=s,u)}function Wg(s,o,u,p){return yr(u,o)?u:Ki.current!==null?(s=c0(s,u,p),yr(s,o)||(Rn=!0),s):(us&42)===0?(Rn=!0,s.memoizedState=u):(s=Xx(),ht.lanes|=s,xs|=s,o)}function Kg(s,o,u,p,v){var _=ue.p;ue.p=_!==0&&8>_?_:8;var A=re.T,O={};re.T=O,d0(s,!1,o,u);try{var te=v(),de=re.S;if(de!==null&&de(O,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var Ee=TS(te,p);Nl(s,o,Ee,Sr(s))}else Nl(s,o,p,Sr(s))}catch(be){Nl(s,o,{then:function(){},status:"rejected",reason:be},Sr())}finally{ue.p=_,re.T=A}}function CS(){}function u0(s,o,u,p){if(s.tag!==5)throw Error(r(476));var v=Xg(s).queue;Kg(s,v,o,ne,u===null?CS:function(){return Zg(s),u(p)})}function Xg(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ba,lastRenderedState:ne},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ba,lastRenderedState:u},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Zg(s){var o=Xg(s).next.queue;Nl(s,o,{},Sr())}function f0(){return $n(Yl)}function Qg(){return xn().memoizedState}function ex(){return xn().memoizedState}function AS(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var u=Sr();s=ls(u);var p=cs(o,s,u);p!==null&&(br(p,o,u),El(p,o,u)),o={cache:Vd()},s.payload=o;return}o=o.return}}function kS(s,o,u){var p=Sr();u={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Eu(s)?nx(o,u):(u=Dd(s,o,u,p),u!==null&&(br(u,s,p),rx(u,o,p)))}function tx(s,o,u){var p=Sr();Nl(s,o,u,p)}function Nl(s,o,u,p){var v={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Eu(s))nx(o,v);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=o.lastRenderedReducer,_!==null))try{var A=o.lastRenderedState,O=_(A,u);if(v.hasEagerState=!0,v.eagerState=O,yr(O,A))return iu(s,o,v,0),Yt===null&&su(),!1}catch{}finally{}if(u=Dd(s,o,v,p),u!==null)return br(u,s,p),rx(u,o,p),!0}return!1}function d0(s,o,u,p){if(p={lane:2,revertLane:$0(),action:p,hasEagerState:!1,eagerState:null,next:null},Eu(s)){if(o)throw Error(r(479))}else o=Dd(s,u,p,2),o!==null&&br(o,s,2)}function Eu(s){var o=s.alternate;return s===ht||o!==null&&o===ht}function nx(s,o){Xi=xu=!0;var u=s.pending;u===null?o.next=o:(o.next=u.next,u.next=o),s.pending=o}function rx(s,o,u){if((u&4194048)!==0){var p=o.lanes;p&=s.pendingLanes,u|=p,o.lanes=u,Xt(s,u)}}var Su={readContext:$n,use:yu,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useLayoutEffect:cn,useInsertionEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useSyncExternalStore:cn,useId:cn,useHostTransitionStatus:cn,useFormState:cn,useActionState:cn,useOptimistic:cn,useMemoCache:cn,useCacheRefresh:cn},ax={readContext:$n,use:yu,useCallback:function(s,o){return fr().memoizedState=[s,o===void 0?null:o],s},useContext:$n,useEffect:Vg,useImperativeHandle:function(s,o,u){u=u!=null?u.concat([s]):null,wu(4194308,4,zg.bind(null,o,s),u)},useLayoutEffect:function(s,o){return wu(4194308,4,s,o)},useInsertionEffect:function(s,o){wu(4,2,s,o)},useMemo:function(s,o){var u=fr();o=o===void 0?null:o;var p=s();if(ai){Ne(!0);try{s()}finally{Ne(!1)}}return u.memoizedState=[p,o],p},useReducer:function(s,o,u){var p=fr();if(u!==void 0){var v=u(o);if(ai){Ne(!0);try{u(o)}finally{Ne(!1)}}}else v=o;return p.memoizedState=p.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},p.queue=s,s=s.dispatch=kS.bind(null,ht,s),[p.memoizedState,s]},useRef:function(s){var o=fr();return s={current:s},o.memoizedState=s},useState:function(s){s=i0(s);var o=s.queue,u=tx.bind(null,ht,o);return o.dispatch=u,[s.memoizedState,u]},useDebugValue:l0,useDeferredValue:function(s,o){var u=fr();return c0(u,s,o)},useTransition:function(){var s=i0(!1);return s=Kg.bind(null,ht,s.queue,!0,!1),fr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,u){var p=ht,v=fr();if(Mt){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),Yt===null)throw Error(r(349));(St&124)!==0||bg(p,o,u)}v.memoizedState=u;var _={value:u,getSnapshot:o};return v.queue=_,Vg(Ag.bind(null,p,_,s),[s]),p.flags|=2048,Qi(9,Tu(),Cg.bind(null,p,_,u,o),null),u},useId:function(){var s=fr(),o=Yt.identifierPrefix;if(Mt){var u=La,p=Oa;u=(p&~(1<<32-Pe(p)-1)).toString(32)+u,o="«"+o+"R"+u,u=vu++,0<u&&(o+="H"+u.toString(32)),o+="»"}else u=wS++,o="«"+o+"r"+u.toString(32)+"»";return s.memoizedState=o},useHostTransitionStatus:f0,useFormState:Lg,useActionState:Lg,useOptimistic:function(s){var o=fr();o.memoizedState=o.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=d0.bind(null,ht,!0,u),u.dispatch=o,[s,o]},useMemoCache:r0,useCacheRefresh:function(){return fr().memoizedState=AS.bind(null,ht)}},sx={readContext:$n,use:yu,useCallback:Yg,useContext:$n,useEffect:Hg,useImperativeHandle:qg,useInsertionEffect:Gg,useLayoutEffect:$g,useMemo:Jg,useReducer:_u,useRef:jg,useState:function(){return _u(Ba)},useDebugValue:l0,useDeferredValue:function(s,o){var u=xn();return Wg(u,jt.memoizedState,s,o)},useTransition:function(){var s=_u(Ba)[0],o=xn().memoizedState;return[typeof s=="boolean"?s:Al(s),o]},useSyncExternalStore:Sg,useId:Qg,useHostTransitionStatus:f0,useFormState:Pg,useActionState:Pg,useOptimistic:function(s,o){var u=xn();return Rg(u,jt,s,o)},useMemoCache:r0,useCacheRefresh:ex},NS={readContext:$n,use:yu,useCallback:Yg,useContext:$n,useEffect:Hg,useImperativeHandle:qg,useInsertionEffect:Gg,useLayoutEffect:$g,useMemo:Jg,useReducer:s0,useRef:jg,useState:function(){return s0(Ba)},useDebugValue:l0,useDeferredValue:function(s,o){var u=xn();return jt===null?c0(u,s,o):Wg(u,jt.memoizedState,s,o)},useTransition:function(){var s=s0(Ba)[0],o=xn().memoizedState;return[typeof s=="boolean"?s:Al(s),o]},useSyncExternalStore:Sg,useId:Qg,useHostTransitionStatus:f0,useFormState:Bg,useActionState:Bg,useOptimistic:function(s,o){var u=xn();return jt!==null?Rg(u,jt,s,o):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:r0,useCacheRefresh:ex},eo=null,Rl=0;function bu(s){var o=Rl;return Rl+=1,eo===null&&(eo=[]),gg(eo,s,o)}function Dl(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Cu(s,o){throw o.$$typeof===y?Error(r(525)):(s=Object.prototype.toString.call(o),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function ix(s){var o=s._init;return o(s._payload)}function ox(s){function o(oe,ae){if(s){var fe=oe.deletions;fe===null?(oe.deletions=[ae],oe.flags|=16):fe.push(ae)}}function u(oe,ae){if(!s)return null;for(;ae!==null;)o(oe,ae),ae=ae.sibling;return null}function p(oe){for(var ae=new Map;oe!==null;)oe.key!==null?ae.set(oe.key,oe):ae.set(oe.index,oe),oe=oe.sibling;return ae}function v(oe,ae){return oe=Fa(oe,ae),oe.index=0,oe.sibling=null,oe}function _(oe,ae,fe){return oe.index=fe,s?(fe=oe.alternate,fe!==null?(fe=fe.index,fe<ae?(oe.flags|=67108866,ae):fe):(oe.flags|=67108866,ae)):(oe.flags|=1048576,ae)}function A(oe){return s&&oe.alternate===null&&(oe.flags|=67108866),oe}function O(oe,ae,fe,Se){return ae===null||ae.tag!==6?(ae=Id(fe,oe.mode,Se),ae.return=oe,ae):(ae=v(ae,fe),ae.return=oe,ae)}function te(oe,ae,fe,Se){var $e=fe.type;return $e===E?Ee(oe,ae,fe.props.children,Se,fe.key):ae!==null&&(ae.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===K&&ix($e)===ae.type)?(ae=v(ae,fe.props),Dl(ae,fe),ae.return=oe,ae):(ae=lu(fe.type,fe.key,fe.props,null,oe.mode,Se),Dl(ae,fe),ae.return=oe,ae)}function de(oe,ae,fe,Se){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==fe.containerInfo||ae.stateNode.implementation!==fe.implementation?(ae=Fd(fe,oe.mode,Se),ae.return=oe,ae):(ae=v(ae,fe.children||[]),ae.return=oe,ae)}function Ee(oe,ae,fe,Se,$e){return ae===null||ae.tag!==7?(ae=Ks(fe,oe.mode,Se,$e),ae.return=oe,ae):(ae=v(ae,fe),ae.return=oe,ae)}function be(oe,ae,fe){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=Id(""+ae,oe.mode,fe),ae.return=oe,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case T:return fe=lu(ae.type,ae.key,ae.props,null,oe.mode,fe),Dl(fe,ae),fe.return=oe,fe;case w:return ae=Fd(ae,oe.mode,fe),ae.return=oe,ae;case K:var Se=ae._init;return ae=Se(ae._payload),be(oe,ae,fe)}if(Te(ae)||ee(ae))return ae=Ks(ae,oe.mode,fe,null),ae.return=oe,ae;if(typeof ae.then=="function")return be(oe,bu(ae),fe);if(ae.$$typeof===C)return be(oe,du(oe,ae),fe);Cu(oe,ae)}return null}function pe(oe,ae,fe,Se){var $e=ae!==null?ae.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return $e!==null?null:O(oe,ae,""+fe,Se);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case T:return fe.key===$e?te(oe,ae,fe,Se):null;case w:return fe.key===$e?de(oe,ae,fe,Se):null;case K:return $e=fe._init,fe=$e(fe._payload),pe(oe,ae,fe,Se)}if(Te(fe)||ee(fe))return $e!==null?null:Ee(oe,ae,fe,Se,null);if(typeof fe.then=="function")return pe(oe,ae,bu(fe),Se);if(fe.$$typeof===C)return pe(oe,ae,du(oe,fe),Se);Cu(oe,fe)}return null}function ge(oe,ae,fe,Se,$e){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return oe=oe.get(fe)||null,O(ae,oe,""+Se,$e);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case T:return oe=oe.get(Se.key===null?fe:Se.key)||null,te(ae,oe,Se,$e);case w:return oe=oe.get(Se.key===null?fe:Se.key)||null,de(ae,oe,Se,$e);case K:var pt=Se._init;return Se=pt(Se._payload),ge(oe,ae,fe,Se,$e)}if(Te(Se)||ee(Se))return oe=oe.get(fe)||null,Ee(ae,oe,Se,$e,null);if(typeof Se.then=="function")return ge(oe,ae,fe,bu(Se),$e);if(Se.$$typeof===C)return ge(oe,ae,fe,du(ae,Se),$e);Cu(ae,Se)}return null}function Qe(oe,ae,fe,Se){for(var $e=null,pt=null,We=ae,Ze=ae=0,Mn=null;We!==null&&Ze<fe.length;Ze++){We.index>Ze?(Mn=We,We=null):Mn=We.sibling;var Nt=pe(oe,We,fe[Ze],Se);if(Nt===null){We===null&&(We=Mn);break}s&&We&&Nt.alternate===null&&o(oe,We),ae=_(Nt,ae,Ze),pt===null?$e=Nt:pt.sibling=Nt,pt=Nt,We=Mn}if(Ze===fe.length)return u(oe,We),Mt&&Zs(oe,Ze),$e;if(We===null){for(;Ze<fe.length;Ze++)We=be(oe,fe[Ze],Se),We!==null&&(ae=_(We,ae,Ze),pt===null?$e=We:pt.sibling=We,pt=We);return Mt&&Zs(oe,Ze),$e}for(We=p(We);Ze<fe.length;Ze++)Mn=ge(We,oe,Ze,fe[Ze],Se),Mn!==null&&(s&&Mn.alternate!==null&&We.delete(Mn.key===null?Ze:Mn.key),ae=_(Mn,ae,Ze),pt===null?$e=Mn:pt.sibling=Mn,pt=Mn);return s&&We.forEach(function(Cs){return o(oe,Cs)}),Mt&&Zs(oe,Ze),$e}function Xe(oe,ae,fe,Se){if(fe==null)throw Error(r(151));for(var $e=null,pt=null,We=ae,Ze=ae=0,Mn=null,Nt=fe.next();We!==null&&!Nt.done;Ze++,Nt=fe.next()){We.index>Ze?(Mn=We,We=null):Mn=We.sibling;var Cs=pe(oe,We,Nt.value,Se);if(Cs===null){We===null&&(We=Mn);break}s&&We&&Cs.alternate===null&&o(oe,We),ae=_(Cs,ae,Ze),pt===null?$e=Cs:pt.sibling=Cs,pt=Cs,We=Mn}if(Nt.done)return u(oe,We),Mt&&Zs(oe,Ze),$e;if(We===null){for(;!Nt.done;Ze++,Nt=fe.next())Nt=be(oe,Nt.value,Se),Nt!==null&&(ae=_(Nt,ae,Ze),pt===null?$e=Nt:pt.sibling=Nt,pt=Nt);return Mt&&Zs(oe,Ze),$e}for(We=p(We);!Nt.done;Ze++,Nt=fe.next())Nt=ge(We,oe,Ze,Nt.value,Se),Nt!==null&&(s&&Nt.alternate!==null&&We.delete(Nt.key===null?Ze:Nt.key),ae=_(Nt,ae,Ze),pt===null?$e=Nt:pt.sibling=Nt,pt=Nt);return s&&We.forEach(function(Rb){return o(oe,Rb)}),Mt&&Zs(oe,Ze),$e}function Ht(oe,ae,fe,Se){if(typeof fe=="object"&&fe!==null&&fe.type===E&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case T:e:{for(var $e=fe.key;ae!==null;){if(ae.key===$e){if($e=fe.type,$e===E){if(ae.tag===7){u(oe,ae.sibling),Se=v(ae,fe.props.children),Se.return=oe,oe=Se;break e}}else if(ae.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===K&&ix($e)===ae.type){u(oe,ae.sibling),Se=v(ae,fe.props),Dl(Se,fe),Se.return=oe,oe=Se;break e}u(oe,ae);break}else o(oe,ae);ae=ae.sibling}fe.type===E?(Se=Ks(fe.props.children,oe.mode,Se,fe.key),Se.return=oe,oe=Se):(Se=lu(fe.type,fe.key,fe.props,null,oe.mode,Se),Dl(Se,fe),Se.return=oe,oe=Se)}return A(oe);case w:e:{for($e=fe.key;ae!==null;){if(ae.key===$e)if(ae.tag===4&&ae.stateNode.containerInfo===fe.containerInfo&&ae.stateNode.implementation===fe.implementation){u(oe,ae.sibling),Se=v(ae,fe.children||[]),Se.return=oe,oe=Se;break e}else{u(oe,ae);break}else o(oe,ae);ae=ae.sibling}Se=Fd(fe,oe.mode,Se),Se.return=oe,oe=Se}return A(oe);case K:return $e=fe._init,fe=$e(fe._payload),Ht(oe,ae,fe,Se)}if(Te(fe))return Qe(oe,ae,fe,Se);if(ee(fe)){if($e=ee(fe),typeof $e!="function")throw Error(r(150));return fe=$e.call(fe),Xe(oe,ae,fe,Se)}if(typeof fe.then=="function")return Ht(oe,ae,bu(fe),Se);if(fe.$$typeof===C)return Ht(oe,ae,du(oe,fe),Se);Cu(oe,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,ae!==null&&ae.tag===6?(u(oe,ae.sibling),Se=v(ae,fe),Se.return=oe,oe=Se):(u(oe,ae),Se=Id(fe,oe.mode,Se),Se.return=oe,oe=Se),A(oe)):u(oe,ae)}return function(oe,ae,fe,Se){try{Rl=0;var $e=Ht(oe,ae,fe,Se);return eo=null,$e}catch(We){if(We===Tl||We===mu)throw We;var pt=_r(29,We,null,oe.mode);return pt.lanes=Se,pt.return=oe,pt}finally{}}}var to=ox(!0),lx=ox(!1),Vr=G(null),ya=null;function fs(s){var o=s.alternate;z(Sn,Sn.current&1),z(Vr,s),ya===null&&(o===null||Ki.current!==null||o.memoizedState!==null)&&(ya=s)}function cx(s){if(s.tag===22){if(z(Sn,Sn.current),z(Vr,s),ya===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(ya=s)}}else ds()}function ds(){z(Sn,Sn.current),z(Vr,Vr.current)}function ja(s){R(Vr),ya===s&&(ya=null),R(Sn)}var Sn=G(0);function Au(s){for(var o=s;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||nh(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function h0(s,o,u,p){o=s.memoizedState,u=u(p,o),u=u==null?o:g({},o,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var m0={enqueueSetState:function(s,o,u){s=s._reactInternals;var p=Sr(),v=ls(p);v.payload=o,u!=null&&(v.callback=u),o=cs(s,v,p),o!==null&&(br(o,s,p),El(o,s,p))},enqueueReplaceState:function(s,o,u){s=s._reactInternals;var p=Sr(),v=ls(p);v.tag=1,v.payload=o,u!=null&&(v.callback=u),o=cs(s,v,p),o!==null&&(br(o,s,p),El(o,s,p))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var u=Sr(),p=ls(u);p.tag=2,o!=null&&(p.callback=o),o=cs(s,p,u),o!==null&&(br(o,s,u),El(o,s,u))}};function ux(s,o,u,p,v,_,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(p,_,A):o.prototype&&o.prototype.isPureReactComponent?!hl(u,p)||!hl(v,_):!0}function fx(s,o,u,p){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,p),o.state!==s&&m0.enqueueReplaceState(o,o.state,null)}function si(s,o){var u=o;if("ref"in o){u={};for(var p in o)p!=="ref"&&(u[p]=o[p])}if(s=s.defaultProps){u===o&&(u=g({},u));for(var v in s)u[v]===void 0&&(u[v]=s[v])}return u}var ku=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function dx(s){ku(s)}function hx(s){console.error(s)}function mx(s){ku(s)}function Nu(s,o){try{var u=s.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function px(s,o,u){try{var p=s.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function p0(s,o,u){return u=ls(u),u.tag=3,u.payload={element:null},u.callback=function(){Nu(s,o)},u}function gx(s){return s=ls(s),s.tag=3,s}function xx(s,o,u,p){var v=u.type.getDerivedStateFromError;if(typeof v=="function"){var _=p.value;s.payload=function(){return v(_)},s.callback=function(){px(o,u,p)}}var A=u.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(s.callback=function(){px(o,u,p),typeof v!="function"&&(vs===null?vs=new Set([this]):vs.add(this));var O=p.stack;this.componentDidCatch(p.value,{componentStack:O!==null?O:""})})}function RS(s,o,u,p,v){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=u.alternate,o!==null&&vl(o,u,v,!0),u=Vr.current,u!==null){switch(u.tag){case 13:return ya===null?B0():u.alternate===null&&rn===0&&(rn=3),u.flags&=-257,u.flags|=65536,u.lanes=v,p===$d?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([p]):o.add(p),V0(s,p,v)),!1;case 22:return u.flags|=65536,p===$d?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([p]):u.add(p)),V0(s,p,v)),!1}throw Error(r(435,u.tag))}return V0(s,p,v),B0(),!1}if(Mt)return o=Vr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=v,p!==Pd&&(s=Error(r(422),{cause:p}),xl(Pr(s,u)))):(p!==Pd&&(o=Error(r(423),{cause:p}),xl(Pr(o,u))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,p=Pr(p,u),v=p0(s.stateNode,p,v),Yd(s,v),rn!==4&&(rn=2)),!1;var _=Error(r(520),{cause:p});if(_=Pr(_,u),Ul===null?Ul=[_]:Ul.push(_),rn!==4&&(rn=2),o===null)return!0;p=Pr(p,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,s=v&-v,u.lanes|=s,s=p0(u.stateNode,p,s),Yd(u,s),!1;case 1:if(o=u.type,_=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(vs===null||!vs.has(_))))return u.flags|=65536,v&=-v,u.lanes|=v,v=gx(v),xx(v,s,u,p),Yd(u,v),!1}u=u.return}while(u!==null);return!1}var vx=Error(r(461)),Rn=!1;function Pn(s,o,u,p){o.child=s===null?lx(o,null,u,p):to(o,s.child,u,p)}function yx(s,o,u,p,v){u=u.render;var _=o.ref;if("ref"in p){var A={};for(var O in p)O!=="ref"&&(A[O]=p[O])}else A=p;return ni(o),p=Zd(s,o,u,A,_,v),O=Qd(),s!==null&&!Rn?(e0(s,o,v),Va(s,o,v)):(Mt&&O&&Od(o),o.flags|=1,Pn(s,o,p,v),o.child)}function _x(s,o,u,p,v){if(s===null){var _=u.type;return typeof _=="function"&&!Md(_)&&_.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=_,Tx(s,o,_,p,v)):(s=lu(u.type,null,p,o,o.mode,v),s.ref=o.ref,s.return=o,o.child=s)}if(_=s.child,!E0(s,v)){var A=_.memoizedProps;if(u=u.compare,u=u!==null?u:hl,u(A,p)&&s.ref===o.ref)return Va(s,o,v)}return o.flags|=1,s=Fa(_,p),s.ref=o.ref,s.return=o,o.child=s}function Tx(s,o,u,p,v){if(s!==null){var _=s.memoizedProps;if(hl(_,p)&&s.ref===o.ref)if(Rn=!1,o.pendingProps=p=_,E0(s,v))(s.flags&131072)!==0&&(Rn=!0);else return o.lanes=s.lanes,Va(s,o,v)}return g0(s,o,u,p,v)}function wx(s,o,u){var p=o.pendingProps,v=p.children,_=s!==null?s.memoizedState:null;if(p.mode==="hidden"){if((o.flags&128)!==0){if(p=_!==null?_.baseLanes|u:u,s!==null){for(v=o.child=s.child,_=0;v!==null;)_=_|v.lanes|v.childLanes,v=v.sibling;o.childLanes=_&~p}else o.childLanes=0,o.child=null;return Ex(s,o,p,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&hu(o,_!==null?_.cachePool:null),_!==null?Tg(o,_):Wd(),cx(o);else return o.lanes=o.childLanes=536870912,Ex(s,o,_!==null?_.baseLanes|u:u,u)}else _!==null?(hu(o,_.cachePool),Tg(o,_),ds(),o.memoizedState=null):(s!==null&&hu(o,null),Wd(),ds());return Pn(s,o,v,u),o.child}function Ex(s,o,u,p){var v=Gd();return v=v===null?null:{parent:En._currentValue,pool:v},o.memoizedState={baseLanes:u,cachePool:v},s!==null&&hu(o,null),Wd(),cx(o),s!==null&&vl(s,o,p,!0),null}function Ru(s,o){var u=o.ref;if(u===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(s===null||s.ref!==u)&&(o.flags|=4194816)}}function g0(s,o,u,p,v){return ni(o),u=Zd(s,o,u,p,void 0,v),p=Qd(),s!==null&&!Rn?(e0(s,o,v),Va(s,o,v)):(Mt&&p&&Od(o),o.flags|=1,Pn(s,o,u,v),o.child)}function Sx(s,o,u,p,v,_){return ni(o),o.updateQueue=null,u=Eg(o,p,u,v),wg(s),p=Qd(),s!==null&&!Rn?(e0(s,o,_),Va(s,o,_)):(Mt&&p&&Od(o),o.flags|=1,Pn(s,o,u,_),o.child)}function bx(s,o,u,p,v){if(ni(o),o.stateNode===null){var _=zi,A=u.contextType;typeof A=="object"&&A!==null&&(_=$n(A)),_=new u(p,_),o.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=m0,o.stateNode=_,_._reactInternals=o,_=o.stateNode,_.props=p,_.state=o.memoizedState,_.refs={},zd(o),A=u.contextType,_.context=typeof A=="object"&&A!==null?$n(A):zi,_.state=o.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(h0(o,u,A,p),_.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(A=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),A!==_.state&&m0.enqueueReplaceState(_,_.state,null),bl(o,p,_,v),Sl(),_.state=o.memoizedState),typeof _.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(s===null){_=o.stateNode;var O=o.memoizedProps,te=si(u,O);_.props=te;var de=_.context,Ee=u.contextType;A=zi,typeof Ee=="object"&&Ee!==null&&(A=$n(Ee));var be=u.getDerivedStateFromProps;Ee=typeof be=="function"||typeof _.getSnapshotBeforeUpdate=="function",O=o.pendingProps!==O,Ee||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(O||de!==A)&&fx(o,_,p,A),os=!1;var pe=o.memoizedState;_.state=pe,bl(o,p,_,v),Sl(),de=o.memoizedState,O||pe!==de||os?(typeof be=="function"&&(h0(o,u,be,p),de=o.memoizedState),(te=os||ux(o,u,te,p,pe,de,A))?(Ee||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(o.flags|=4194308)):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=de),_.props=p,_.state=de,_.context=A,p=te):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{_=o.stateNode,qd(s,o),A=o.memoizedProps,Ee=si(u,A),_.props=Ee,be=o.pendingProps,pe=_.context,de=u.contextType,te=zi,typeof de=="object"&&de!==null&&(te=$n(de)),O=u.getDerivedStateFromProps,(de=typeof O=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(A!==be||pe!==te)&&fx(o,_,p,te),os=!1,pe=o.memoizedState,_.state=pe,bl(o,p,_,v),Sl();var ge=o.memoizedState;A!==be||pe!==ge||os||s!==null&&s.dependencies!==null&&fu(s.dependencies)?(typeof O=="function"&&(h0(o,u,O,p),ge=o.memoizedState),(Ee=os||ux(o,u,Ee,p,pe,ge,te)||s!==null&&s.dependencies!==null&&fu(s.dependencies))?(de||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(p,ge,te),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(p,ge,te)),typeof _.componentDidUpdate=="function"&&(o.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof _.componentDidUpdate!="function"||A===s.memoizedProps&&pe===s.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&pe===s.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=ge),_.props=p,_.state=ge,_.context=te,p=Ee):(typeof _.componentDidUpdate!="function"||A===s.memoizedProps&&pe===s.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&pe===s.memoizedState||(o.flags|=1024),p=!1)}return _=p,Ru(s,o),p=(o.flags&128)!==0,_||p?(_=o.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:_.render(),o.flags|=1,s!==null&&p?(o.child=to(o,s.child,null,v),o.child=to(o,null,u,v)):Pn(s,o,u,v),o.memoizedState=_.state,s=o.child):s=Va(s,o,v),s}function Cx(s,o,u,p){return gl(),o.flags|=256,Pn(s,o,u,p),o.child}var x0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function v0(s){return{baseLanes:s,cachePool:hg()}}function y0(s,o,u){return s=s!==null?s.childLanes&~u:0,o&&(s|=Hr),s}function Ax(s,o,u){var p=o.pendingProps,v=!1,_=(o.flags&128)!==0,A;if((A=_)||(A=s!==null&&s.memoizedState===null?!1:(Sn.current&2)!==0),A&&(v=!0,o.flags&=-129),A=(o.flags&32)!==0,o.flags&=-33,s===null){if(Mt){if(v?fs(o):ds(),Mt){var O=nn,te;if(te=O){e:{for(te=O,O=va;te.nodeType!==8;){if(!O){O=null;break e}if(te=sa(te.nextSibling),te===null){O=null;break e}}O=te}O!==null?(o.memoizedState={dehydrated:O,treeContext:Xs!==null?{id:Oa,overflow:La}:null,retryLane:536870912,hydrationErrors:null},te=_r(18,null,null,0),te.stateNode=O,te.return=o,o.child=te,nr=o,nn=null,te=!0):te=!1}te||ei(o)}if(O=o.memoizedState,O!==null&&(O=O.dehydrated,O!==null))return nh(O)?o.lanes=32:o.lanes=536870912,null;ja(o)}return O=p.children,p=p.fallback,v?(ds(),v=o.mode,O=Du({mode:"hidden",children:O},v),p=Ks(p,v,u,null),O.return=o,p.return=o,O.sibling=p,o.child=O,v=o.child,v.memoizedState=v0(u),v.childLanes=y0(s,A,u),o.memoizedState=x0,p):(fs(o),_0(o,O))}if(te=s.memoizedState,te!==null&&(O=te.dehydrated,O!==null)){if(_)o.flags&256?(fs(o),o.flags&=-257,o=T0(s,o,u)):o.memoizedState!==null?(ds(),o.child=s.child,o.flags|=128,o=null):(ds(),v=p.fallback,O=o.mode,p=Du({mode:"visible",children:p.children},O),v=Ks(v,O,u,null),v.flags|=2,p.return=o,v.return=o,p.sibling=v,o.child=p,to(o,s.child,null,u),p=o.child,p.memoizedState=v0(u),p.childLanes=y0(s,A,u),o.memoizedState=x0,o=v);else if(fs(o),nh(O)){if(A=O.nextSibling&&O.nextSibling.dataset,A)var de=A.dgst;A=de,p=Error(r(419)),p.stack="",p.digest=A,xl({value:p,source:null,stack:null}),o=T0(s,o,u)}else if(Rn||vl(s,o,u,!1),A=(u&s.childLanes)!==0,Rn||A){if(A=Yt,A!==null&&(p=u&-u,p=(p&42)!==0?1:Dr(p),p=(p&(A.suspendedLanes|u))!==0?0:p,p!==0&&p!==te.retryLane))throw te.retryLane=p,$i(s,p),br(A,s,p),vx;O.data==="$?"||B0(),o=T0(s,o,u)}else O.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=te.treeContext,nn=sa(O.nextSibling),nr=o,Mt=!0,Qs=null,va=!1,s!==null&&(Br[jr++]=Oa,Br[jr++]=La,Br[jr++]=Xs,Oa=s.id,La=s.overflow,Xs=o),o=_0(o,p.children),o.flags|=4096);return o}return v?(ds(),v=p.fallback,O=o.mode,te=s.child,de=te.sibling,p=Fa(te,{mode:"hidden",children:p.children}),p.subtreeFlags=te.subtreeFlags&65011712,de!==null?v=Fa(de,v):(v=Ks(v,O,u,null),v.flags|=2),v.return=o,p.return=o,p.sibling=v,o.child=p,p=v,v=o.child,O=s.child.memoizedState,O===null?O=v0(u):(te=O.cachePool,te!==null?(de=En._currentValue,te=te.parent!==de?{parent:de,pool:de}:te):te=hg(),O={baseLanes:O.baseLanes|u,cachePool:te}),v.memoizedState=O,v.childLanes=y0(s,A,u),o.memoizedState=x0,p):(fs(o),u=s.child,s=u.sibling,u=Fa(u,{mode:"visible",children:p.children}),u.return=o,u.sibling=null,s!==null&&(A=o.deletions,A===null?(o.deletions=[s],o.flags|=16):A.push(s)),o.child=u,o.memoizedState=null,u)}function _0(s,o){return o=Du({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Du(s,o){return s=_r(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function T0(s,o,u){return to(o,s.child,null,u),s=_0(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function kx(s,o,u){s.lanes|=o;var p=s.alternate;p!==null&&(p.lanes|=o),Bd(s.return,o,u)}function w0(s,o,u,p,v){var _=s.memoizedState;_===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:v}:(_.isBackwards=o,_.rendering=null,_.renderingStartTime=0,_.last=p,_.tail=u,_.tailMode=v)}function Nx(s,o,u){var p=o.pendingProps,v=p.revealOrder,_=p.tail;if(Pn(s,o,p.children,u),p=Sn.current,(p&2)!==0)p=p&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&kx(s,u,o);else if(s.tag===19)kx(s,u,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}p&=1}switch(z(Sn,p),v){case"forwards":for(u=o.child,v=null;u!==null;)s=u.alternate,s!==null&&Au(s)===null&&(v=u),u=u.sibling;u=v,u===null?(v=o.child,o.child=null):(v=u.sibling,u.sibling=null),w0(o,!1,v,u,_);break;case"backwards":for(u=null,v=o.child,o.child=null;v!==null;){if(s=v.alternate,s!==null&&Au(s)===null){o.child=v;break}s=v.sibling,v.sibling=u,u=v,v=s}w0(o,!0,u,null,_);break;case"together":w0(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Va(s,o,u){if(s!==null&&(o.dependencies=s.dependencies),xs|=o.lanes,(u&o.childLanes)===0)if(s!==null){if(vl(s,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(r(153));if(o.child!==null){for(s=o.child,u=Fa(s,s.pendingProps),o.child=u,u.return=o;s.sibling!==null;)s=s.sibling,u=u.sibling=Fa(s,s.pendingProps),u.return=o;u.sibling=null}return o.child}function E0(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&fu(s)))}function DS(s,o,u){switch(o.tag){case 3:_e(o,o.stateNode.containerInfo),is(o,En,s.memoizedState.cache),gl();break;case 27:case 5:Ce(o);break;case 4:_e(o,o.stateNode.containerInfo);break;case 10:is(o,o.type,o.memoizedProps.value);break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(fs(o),o.flags|=128,null):(u&o.child.childLanes)!==0?Ax(s,o,u):(fs(o),s=Va(s,o,u),s!==null?s.sibling:null);fs(o);break;case 19:var v=(s.flags&128)!==0;if(p=(u&o.childLanes)!==0,p||(vl(s,o,u,!1),p=(u&o.childLanes)!==0),v){if(p)return Nx(s,o,u);o.flags|=128}if(v=o.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),z(Sn,Sn.current),p)break;return null;case 22:case 23:return o.lanes=0,wx(s,o,u);case 24:is(o,En,s.memoizedState.cache)}return Va(s,o,u)}function Rx(s,o,u){if(s!==null)if(s.memoizedProps!==o.pendingProps)Rn=!0;else{if(!E0(s,u)&&(o.flags&128)===0)return Rn=!1,DS(s,o,u);Rn=(s.flags&131072)!==0}else Rn=!1,Mt&&(o.flags&1048576)!==0&&ig(o,uu,o.index);switch(o.lanes=0,o.tag){case 16:e:{s=o.pendingProps;var p=o.elementType,v=p._init;if(p=v(p._payload),o.type=p,typeof p=="function")Md(p)?(s=si(p,s),o.tag=1,o=bx(null,o,p,s,u)):(o.tag=0,o=g0(null,o,p,s,u));else{if(p!=null){if(v=p.$$typeof,v===P){o.tag=11,o=yx(null,o,p,s,u);break e}else if(v===L){o.tag=14,o=_x(null,o,p,s,u);break e}}throw o=Ie(p)||p,Error(r(306,o,""))}}return o;case 0:return g0(s,o,o.type,o.pendingProps,u);case 1:return p=o.type,v=si(p,o.pendingProps),bx(s,o,p,v,u);case 3:e:{if(_e(o,o.stateNode.containerInfo),s===null)throw Error(r(387));p=o.pendingProps;var _=o.memoizedState;v=_.element,qd(s,o),bl(o,p,null,u);var A=o.memoizedState;if(p=A.cache,is(o,En,p),p!==_.cache&&jd(o,[En],u,!0),Sl(),p=A.element,_.isDehydrated)if(_={element:p,isDehydrated:!1,cache:A.cache},o.updateQueue.baseState=_,o.memoizedState=_,o.flags&256){o=Cx(s,o,p,u);break e}else if(p!==v){v=Pr(Error(r(424)),o),xl(v),o=Cx(s,o,p,u);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(nn=sa(s.firstChild),nr=o,Mt=!0,Qs=null,va=!0,u=lx(o,null,p,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(gl(),p===v){o=Va(s,o,u);break e}Pn(s,o,p,u)}o=o.child}return o;case 26:return Ru(s,o),s===null?(u=Fv(o.type,null,o.pendingProps,null))?o.memoizedState=u:Mt||(u=o.type,s=o.pendingProps,p=zu(ie.current).createElement(u),p[mn]=o,p[pn]=s,Bn(p,u,s),le(p),o.stateNode=p):o.memoizedState=Fv(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Ce(o),s===null&&Mt&&(p=o.stateNode=Dv(o.type,o.pendingProps,ie.current),nr=o,va=!0,v=nn,Ts(o.type)?(rh=v,nn=sa(p.firstChild)):nn=v),Pn(s,o,o.pendingProps.children,u),Ru(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&Mt&&((v=p=nn)&&(p=sb(p,o.type,o.pendingProps,va),p!==null?(o.stateNode=p,nr=o,nn=sa(p.firstChild),va=!1,v=!0):v=!1),v||ei(o)),Ce(o),v=o.type,_=o.pendingProps,A=s!==null?s.memoizedProps:null,p=_.children,Q0(v,_)?p=null:A!==null&&Q0(v,A)&&(o.flags|=32),o.memoizedState!==null&&(v=Zd(s,o,ES,null,null,u),Yl._currentValue=v),Ru(s,o),Pn(s,o,p,u),o.child;case 6:return s===null&&Mt&&((s=u=nn)&&(u=ib(u,o.pendingProps,va),u!==null?(o.stateNode=u,nr=o,nn=null,s=!0):s=!1),s||ei(o)),null;case 13:return Ax(s,o,u);case 4:return _e(o,o.stateNode.containerInfo),p=o.pendingProps,s===null?o.child=to(o,null,p,u):Pn(s,o,p,u),o.child;case 11:return yx(s,o,o.type,o.pendingProps,u);case 7:return Pn(s,o,o.pendingProps,u),o.child;case 8:return Pn(s,o,o.pendingProps.children,u),o.child;case 12:return Pn(s,o,o.pendingProps.children,u),o.child;case 10:return p=o.pendingProps,is(o,o.type,p.value),Pn(s,o,p.children,u),o.child;case 9:return v=o.type._context,p=o.pendingProps.children,ni(o),v=$n(v),p=p(v),o.flags|=1,Pn(s,o,p,u),o.child;case 14:return _x(s,o,o.type,o.pendingProps,u);case 15:return Tx(s,o,o.type,o.pendingProps,u);case 19:return Nx(s,o,u);case 31:return p=o.pendingProps,u=o.mode,p={mode:p.mode,children:p.children},s===null?(u=Du(p,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=Fa(s.child,p),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return wx(s,o,u);case 24:return ni(o),p=$n(En),s===null?(v=Gd(),v===null&&(v=Yt,_=Vd(),v.pooledCache=_,_.refCount++,_!==null&&(v.pooledCacheLanes|=u),v=_),o.memoizedState={parent:p,cache:v},zd(o),is(o,En,v)):((s.lanes&u)!==0&&(qd(s,o),bl(o,null,null,u),Sl()),v=s.memoizedState,_=o.memoizedState,v.parent!==p?(v={parent:p,cache:p},o.memoizedState=v,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=v),is(o,En,p)):(p=_.cache,is(o,En,p),p!==v.cache&&jd(o,[En],u,!0))),Pn(s,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function Ha(s){s.flags|=4}function Dx(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Bv(o)){if(o=Vr.current,o!==null&&((St&4194048)===St?ya!==null:(St&62914560)!==St&&(St&536870912)===0||o!==ya))throw wl=$d,mg;s.flags|=8192}}function Mu(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?Ve():536870912,s.lanes|=o,so|=o)}function Ml(s,o){if(!Mt)switch(s.tailMode){case"hidden":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:p.sibling=null}}function tn(s){var o=s.alternate!==null&&s.alternate.child===s.child,u=0,p=0;if(o)for(var v=s.child;v!==null;)u|=v.lanes|v.childLanes,p|=v.subtreeFlags&65011712,p|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)u|=v.lanes|v.childLanes,p|=v.subtreeFlags,p|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=p,s.childLanes=u,o}function MS(s,o,u){var p=o.pendingProps;switch(Ld(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(o),null;case 1:return tn(o),null;case 3:return u=o.stateNode,p=null,s!==null&&(p=s.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),Ua(En),ke(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(pl(o)?Ha(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,cg())),tn(o),null;case 26:return u=o.memoizedState,s===null?(Ha(o),u!==null?(tn(o),Dx(o,u)):(tn(o),o.flags&=-16777217)):u?u!==s.memoizedState?(Ha(o),tn(o),Dx(o,u)):(tn(o),o.flags&=-16777217):(s.memoizedProps!==p&&Ha(o),tn(o),o.flags&=-16777217),null;case 27:He(o),u=ie.current;var v=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==p&&Ha(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return tn(o),null}s=J.current,pl(o)?og(o):(s=Dv(v,p,u),o.stateNode=s,Ha(o))}return tn(o),null;case 5:if(He(o),u=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==p&&Ha(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return tn(o),null}if(s=J.current,pl(o))og(o);else{switch(v=zu(ie.current),s){case 1:s=v.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=v.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=v.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=v.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=v.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof p.is=="string"?v.createElement("select",{is:p.is}):v.createElement("select"),p.multiple?s.multiple=!0:p.size&&(s.size=p.size);break;default:s=typeof p.is=="string"?v.createElement(u,{is:p.is}):v.createElement(u)}}s[mn]=o,s[pn]=p;e:for(v=o.child;v!==null;){if(v.tag===5||v.tag===6)s.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===o)break e;for(;v.sibling===null;){if(v.return===null||v.return===o)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}o.stateNode=s;e:switch(Bn(s,u,p),u){case"button":case"input":case"select":case"textarea":s=!!p.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Ha(o)}}return tn(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==p&&Ha(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(r(166));if(s=ie.current,pl(o)){if(s=o.stateNode,u=o.memoizedProps,p=null,v=nr,v!==null)switch(v.tag){case 27:case 5:p=v.memoizedProps}s[mn]=o,s=!!(s.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||Sv(s.nodeValue,u)),s||ei(o)}else s=zu(s).createTextNode(p),s[mn]=o,o.stateNode=s}return tn(o),null;case 13:if(p=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=pl(o),p!==null&&p.dehydrated!==null){if(s===null){if(!v)throw Error(r(318));if(v=o.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(r(317));v[mn]=o}else gl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;tn(o),v=!1}else v=cg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return o.flags&256?(ja(o),o):(ja(o),null)}if(ja(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=p!==null,s=s!==null&&s.memoizedState!==null,u){p=o.child,v=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(v=p.alternate.memoizedState.cachePool.pool);var _=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),_!==v&&(p.flags|=2048)}return u!==s&&u&&(o.child.flags|=8192),Mu(o,o.updateQueue),tn(o),null;case 4:return ke(),s===null&&J0(o.stateNode.containerInfo),tn(o),null;case 10:return Ua(o.type),tn(o),null;case 19:if(R(Sn),v=o.memoizedState,v===null)return tn(o),null;if(p=(o.flags&128)!==0,_=v.rendering,_===null)if(p)Ml(v,!1);else{if(rn!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(_=Au(s),_!==null){for(o.flags|=128,Ml(v,!1),s=_.updateQueue,o.updateQueue=s,Mu(o,s),o.subtreeFlags=0,s=u,u=o.child;u!==null;)sg(u,s),u=u.sibling;return z(Sn,Sn.current&1|2),o.child}s=s.sibling}v.tail!==null&&Re()>Ou&&(o.flags|=128,p=!0,Ml(v,!1),o.lanes=4194304)}else{if(!p)if(s=Au(_),s!==null){if(o.flags|=128,p=!0,s=s.updateQueue,o.updateQueue=s,Mu(o,s),Ml(v,!0),v.tail===null&&v.tailMode==="hidden"&&!_.alternate&&!Mt)return tn(o),null}else 2*Re()-v.renderingStartTime>Ou&&u!==536870912&&(o.flags|=128,p=!0,Ml(v,!1),o.lanes=4194304);v.isBackwards?(_.sibling=o.child,o.child=_):(s=v.last,s!==null?s.sibling=_:o.child=_,v.last=_)}return v.tail!==null?(o=v.tail,v.rendering=o,v.tail=o.sibling,v.renderingStartTime=Re(),o.sibling=null,s=Sn.current,z(Sn,p?s&1|2:s&1),o):(tn(o),null);case 22:case 23:return ja(o),Kd(),p=o.memoizedState!==null,s!==null?s.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(u&536870912)!==0&&(o.flags&128)===0&&(tn(o),o.subtreeFlags&6&&(o.flags|=8192)):tn(o),u=o.updateQueue,u!==null&&Mu(o,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==u&&(o.flags|=2048),s!==null&&R(ri),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Ua(En),tn(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function IS(s,o){switch(Ld(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Ua(En),ke(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return He(o),null;case 13:if(ja(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(r(340));gl()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return R(Sn),null;case 4:return ke(),null;case 10:return Ua(o.type),null;case 22:case 23:return ja(o),Kd(),s!==null&&R(ri),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return Ua(En),null;case 25:return null;default:return null}}function Mx(s,o){switch(Ld(o),o.tag){case 3:Ua(En),ke();break;case 26:case 27:case 5:He(o);break;case 4:ke();break;case 13:ja(o);break;case 19:R(Sn);break;case 10:Ua(o.type);break;case 22:case 23:ja(o),Kd(),s!==null&&R(ri);break;case 24:Ua(En)}}function Il(s,o){try{var u=o.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var v=p.next;u=v;do{if((u.tag&s)===s){p=void 0;var _=u.create,A=u.inst;p=_(),A.destroy=p}u=u.next}while(u!==v)}}catch(O){zt(o,o.return,O)}}function hs(s,o,u){try{var p=o.updateQueue,v=p!==null?p.lastEffect:null;if(v!==null){var _=v.next;p=_;do{if((p.tag&s)===s){var A=p.inst,O=A.destroy;if(O!==void 0){A.destroy=void 0,v=o;var te=u,de=O;try{de()}catch(Ee){zt(v,te,Ee)}}}p=p.next}while(p!==_)}}catch(Ee){zt(o,o.return,Ee)}}function Ix(s){var o=s.updateQueue;if(o!==null){var u=s.stateNode;try{_g(o,u)}catch(p){zt(s,s.return,p)}}}function Fx(s,o,u){u.props=si(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(p){zt(s,o,p)}}function Fl(s,o){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var p=s.stateNode;break;case 30:p=s.stateNode;break;default:p=s.stateNode}typeof u=="function"?s.refCleanup=u(p):u.current=p}}catch(v){zt(s,o,v)}}function _a(s,o){var u=s.ref,p=s.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(v){zt(s,o,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(v){zt(s,o,v)}else u.current=null}function Ox(s){var o=s.type,u=s.memoizedProps,p=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(v){zt(s,s.return,v)}}function S0(s,o,u){try{var p=s.stateNode;eb(p,s.type,u,o),p[pn]=o}catch(v){zt(s,s.return,v)}}function Lx(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Ts(s.type)||s.tag===4}function b0(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Lx(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Ts(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function C0(s,o,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(s),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=$u));else if(p!==4&&(p===27&&Ts(s.type)&&(u=s.stateNode,o=null),s=s.child,s!==null))for(C0(s,o,u),s=s.sibling;s!==null;)C0(s,o,u),s=s.sibling}function Iu(s,o,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,o?u.insertBefore(s,o):u.appendChild(s);else if(p!==4&&(p===27&&Ts(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(Iu(s,o,u),s=s.sibling;s!==null;)Iu(s,o,u),s=s.sibling}function Px(s){var o=s.stateNode,u=s.memoizedProps;try{for(var p=s.type,v=o.attributes;v.length;)o.removeAttributeNode(v[0]);Bn(o,p,u),o[mn]=s,o[pn]=u}catch(_){zt(s,s.return,_)}}var Ga=!1,un=!1,A0=!1,Ux=typeof WeakSet=="function"?WeakSet:Set,Dn=null;function FS(s,o){if(s=s.containerInfo,X0=Xu,s=Wp(s),bd(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var v=p.anchorOffset,_=p.focusNode;p=p.focusOffset;try{u.nodeType,_.nodeType}catch{u=null;break e}var A=0,O=-1,te=-1,de=0,Ee=0,be=s,pe=null;t:for(;;){for(var ge;be!==u||v!==0&&be.nodeType!==3||(O=A+v),be!==_||p!==0&&be.nodeType!==3||(te=A+p),be.nodeType===3&&(A+=be.nodeValue.length),(ge=be.firstChild)!==null;)pe=be,be=ge;for(;;){if(be===s)break t;if(pe===u&&++de===v&&(O=A),pe===_&&++Ee===p&&(te=A),(ge=be.nextSibling)!==null)break;be=pe,pe=be.parentNode}be=ge}u=O===-1||te===-1?null:{start:O,end:te}}else u=null}u=u||{start:0,end:0}}else u=null;for(Z0={focusedElem:s,selectionRange:u},Xu=!1,Dn=o;Dn!==null;)if(o=Dn,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,Dn=s;else for(;Dn!==null;){switch(o=Dn,_=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,u=o,v=_.memoizedProps,_=_.memoizedState,p=u.stateNode;try{var Qe=si(u.type,v,u.elementType===u.type);s=p.getSnapshotBeforeUpdate(Qe,_),p.__reactInternalSnapshotBeforeUpdate=s}catch(Xe){zt(u,u.return,Xe)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,u=s.nodeType,u===9)th(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":th(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=o.sibling,s!==null){s.return=o.return,Dn=s;break}Dn=o.return}}function Bx(s,o,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:ms(s,u),p&4&&Il(5,u);break;case 1:if(ms(s,u),p&4)if(s=u.stateNode,o===null)try{s.componentDidMount()}catch(A){zt(u,u.return,A)}else{var v=si(u.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(v,o,s.__reactInternalSnapshotBeforeUpdate)}catch(A){zt(u,u.return,A)}}p&64&&Ix(u),p&512&&Fl(u,u.return);break;case 3:if(ms(s,u),p&64&&(s=u.updateQueue,s!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{_g(s,o)}catch(A){zt(u,u.return,A)}}break;case 27:o===null&&p&4&&Px(u);case 26:case 5:ms(s,u),o===null&&p&4&&Ox(u),p&512&&Fl(u,u.return);break;case 12:ms(s,u);break;case 13:ms(s,u),p&4&&Hx(s,u),p&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=GS.bind(null,u),ob(s,u))));break;case 22:if(p=u.memoizedState!==null||Ga,!p){o=o!==null&&o.memoizedState!==null||un,v=Ga;var _=un;Ga=p,(un=o)&&!_?ps(s,u,(u.subtreeFlags&8772)!==0):ms(s,u),Ga=v,un=_}break;case 30:break;default:ms(s,u)}}function jx(s){var o=s.alternate;o!==null&&(s.alternate=null,jx(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&B(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Zt=null,dr=!1;function $a(s,o,u){for(u=u.child;u!==null;)Vx(s,o,u),u=u.sibling}function Vx(s,o,u){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(ln,u)}catch{}switch(u.tag){case 26:un||_a(u,o),$a(s,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:un||_a(u,o);var p=Zt,v=dr;Ts(u.type)&&(Zt=u.stateNode,dr=!1),$a(s,o,u),Gl(u.stateNode),Zt=p,dr=v;break;case 5:un||_a(u,o);case 6:if(p=Zt,v=dr,Zt=null,$a(s,o,u),Zt=p,dr=v,Zt!==null)if(dr)try{(Zt.nodeType===9?Zt.body:Zt.nodeName==="HTML"?Zt.ownerDocument.body:Zt).removeChild(u.stateNode)}catch(_){zt(u,o,_)}else try{Zt.removeChild(u.stateNode)}catch(_){zt(u,o,_)}break;case 18:Zt!==null&&(dr?(s=Zt,Nv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),Xl(s)):Nv(Zt,u.stateNode));break;case 4:p=Zt,v=dr,Zt=u.stateNode.containerInfo,dr=!0,$a(s,o,u),Zt=p,dr=v;break;case 0:case 11:case 14:case 15:un||hs(2,u,o),un||hs(4,u,o),$a(s,o,u);break;case 1:un||(_a(u,o),p=u.stateNode,typeof p.componentWillUnmount=="function"&&Fx(u,o,p)),$a(s,o,u);break;case 21:$a(s,o,u);break;case 22:un=(p=un)||u.memoizedState!==null,$a(s,o,u),un=p;break;default:$a(s,o,u)}}function Hx(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Xl(s)}catch(u){zt(o,o.return,u)}}function OS(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new Ux),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new Ux),o;default:throw Error(r(435,s.tag))}}function k0(s,o){var u=OS(s);o.forEach(function(p){var v=$S.bind(null,s,p);u.has(p)||(u.add(p),p.then(v,v))})}function Tr(s,o){var u=o.deletions;if(u!==null)for(var p=0;p<u.length;p++){var v=u[p],_=s,A=o,O=A;e:for(;O!==null;){switch(O.tag){case 27:if(Ts(O.type)){Zt=O.stateNode,dr=!1;break e}break;case 5:Zt=O.stateNode,dr=!1;break e;case 3:case 4:Zt=O.stateNode.containerInfo,dr=!0;break e}O=O.return}if(Zt===null)throw Error(r(160));Vx(_,A,v),Zt=null,dr=!1,_=v.alternate,_!==null&&(_.return=null),v.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)Gx(o,s),o=o.sibling}var aa=null;function Gx(s,o){var u=s.alternate,p=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Tr(o,s),wr(s),p&4&&(hs(3,s,s.return),Il(3,s),hs(5,s,s.return));break;case 1:Tr(o,s),wr(s),p&512&&(un||u===null||_a(u,u.return)),p&64&&Ga&&(s=s.updateQueue,s!==null&&(p=s.callbacks,p!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var v=aa;if(Tr(o,s),wr(s),p&512&&(un||u===null||_a(u,u.return)),p&4){var _=u!==null?u.memoizedState:null;if(p=s.memoizedState,u===null)if(p===null)if(s.stateNode===null){e:{p=s.type,u=s.memoizedProps,v=v.ownerDocument||v;t:switch(p){case"title":_=v.getElementsByTagName("title")[0],(!_||_[I]||_[mn]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=v.createElement(p),v.head.insertBefore(_,v.querySelector("head > title"))),Bn(_,p,u),_[mn]=s,le(_),p=_;break e;case"link":var A=Pv("link","href",v).get(p+(u.href||""));if(A){for(var O=0;O<A.length;O++)if(_=A[O],_.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&_.getAttribute("rel")===(u.rel==null?null:u.rel)&&_.getAttribute("title")===(u.title==null?null:u.title)&&_.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){A.splice(O,1);break t}}_=v.createElement(p),Bn(_,p,u),v.head.appendChild(_);break;case"meta":if(A=Pv("meta","content",v).get(p+(u.content||""))){for(O=0;O<A.length;O++)if(_=A[O],_.getAttribute("content")===(u.content==null?null:""+u.content)&&_.getAttribute("name")===(u.name==null?null:u.name)&&_.getAttribute("property")===(u.property==null?null:u.property)&&_.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&_.getAttribute("charset")===(u.charSet==null?null:u.charSet)){A.splice(O,1);break t}}_=v.createElement(p),Bn(_,p,u),v.head.appendChild(_);break;default:throw Error(r(468,p))}_[mn]=s,le(_),p=_}s.stateNode=p}else Uv(v,s.type,s.stateNode);else s.stateNode=Lv(v,p,s.memoizedProps);else _!==p?(_===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):_.count--,p===null?Uv(v,s.type,s.stateNode):Lv(v,p,s.memoizedProps)):p===null&&s.stateNode!==null&&S0(s,s.memoizedProps,u.memoizedProps)}break;case 27:Tr(o,s),wr(s),p&512&&(un||u===null||_a(u,u.return)),u!==null&&p&4&&S0(s,s.memoizedProps,u.memoizedProps);break;case 5:if(Tr(o,s),wr(s),p&512&&(un||u===null||_a(u,u.return)),s.flags&32){v=s.stateNode;try{Pi(v,"")}catch(ge){zt(s,s.return,ge)}}p&4&&s.stateNode!=null&&(v=s.memoizedProps,S0(s,v,u!==null?u.memoizedProps:v)),p&1024&&(A0=!0);break;case 6:if(Tr(o,s),wr(s),p&4){if(s.stateNode===null)throw Error(r(162));p=s.memoizedProps,u=s.stateNode;try{u.nodeValue=p}catch(ge){zt(s,s.return,ge)}}break;case 3:if(Ju=null,v=aa,aa=qu(o.containerInfo),Tr(o,s),aa=v,wr(s),p&4&&u!==null&&u.memoizedState.isDehydrated)try{Xl(o.containerInfo)}catch(ge){zt(s,s.return,ge)}A0&&(A0=!1,$x(s));break;case 4:p=aa,aa=qu(s.stateNode.containerInfo),Tr(o,s),wr(s),aa=p;break;case 12:Tr(o,s),wr(s);break;case 13:Tr(o,s),wr(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(F0=Re()),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,k0(s,p)));break;case 22:v=s.memoizedState!==null;var te=u!==null&&u.memoizedState!==null,de=Ga,Ee=un;if(Ga=de||v,un=Ee||te,Tr(o,s),un=Ee,Ga=de,wr(s),p&8192)e:for(o=s.stateNode,o._visibility=v?o._visibility&-2:o._visibility|1,v&&(u===null||te||Ga||un||ii(s)),u=null,o=s;;){if(o.tag===5||o.tag===26){if(u===null){te=u=o;try{if(_=te.stateNode,v)A=_.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{O=te.stateNode;var be=te.memoizedProps.style,pe=be!=null&&be.hasOwnProperty("display")?be.display:null;O.style.display=pe==null||typeof pe=="boolean"?"":(""+pe).trim()}}catch(ge){zt(te,te.return,ge)}}}else if(o.tag===6){if(u===null){te=o;try{te.stateNode.nodeValue=v?"":te.memoizedProps}catch(ge){zt(te,te.return,ge)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=s.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,k0(s,u))));break;case 19:Tr(o,s),wr(s),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,k0(s,p)));break;case 30:break;case 21:break;default:Tr(o,s),wr(s)}}function wr(s){var o=s.flags;if(o&2){try{for(var u,p=s.return;p!==null;){if(Lx(p)){u=p;break}p=p.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var v=u.stateNode,_=b0(s);Iu(s,_,v);break;case 5:var A=u.stateNode;u.flags&32&&(Pi(A,""),u.flags&=-33);var O=b0(s);Iu(s,O,A);break;case 3:case 4:var te=u.stateNode.containerInfo,de=b0(s);C0(s,de,te);break;default:throw Error(r(161))}}catch(Ee){zt(s,s.return,Ee)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function $x(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;$x(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function ms(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Bx(s,o.alternate,o),o=o.sibling}function ii(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:hs(4,o,o.return),ii(o);break;case 1:_a(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&Fx(o,o.return,u),ii(o);break;case 27:Gl(o.stateNode);case 26:case 5:_a(o,o.return),ii(o);break;case 22:o.memoizedState===null&&ii(o);break;case 30:ii(o);break;default:ii(o)}s=s.sibling}}function ps(s,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,v=s,_=o,A=_.flags;switch(_.tag){case 0:case 11:case 15:ps(v,_,u),Il(4,_);break;case 1:if(ps(v,_,u),p=_,v=p.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(de){zt(p,p.return,de)}if(p=_,v=p.updateQueue,v!==null){var O=p.stateNode;try{var te=v.shared.hiddenCallbacks;if(te!==null)for(v.shared.hiddenCallbacks=null,v=0;v<te.length;v++)yg(te[v],O)}catch(de){zt(p,p.return,de)}}u&&A&64&&Ix(_),Fl(_,_.return);break;case 27:Px(_);case 26:case 5:ps(v,_,u),u&&p===null&&A&4&&Ox(_),Fl(_,_.return);break;case 12:ps(v,_,u);break;case 13:ps(v,_,u),u&&A&4&&Hx(v,_);break;case 22:_.memoizedState===null&&ps(v,_,u),Fl(_,_.return);break;case 30:break;default:ps(v,_,u)}o=o.sibling}}function N0(s,o){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&yl(u))}function R0(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&yl(s))}function Ta(s,o,u,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)zx(s,o,u,p),o=o.sibling}function zx(s,o,u,p){var v=o.flags;switch(o.tag){case 0:case 11:case 15:Ta(s,o,u,p),v&2048&&Il(9,o);break;case 1:Ta(s,o,u,p);break;case 3:Ta(s,o,u,p),v&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&yl(s)));break;case 12:if(v&2048){Ta(s,o,u,p),s=o.stateNode;try{var _=o.memoizedProps,A=_.id,O=_.onPostCommit;typeof O=="function"&&O(A,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(te){zt(o,o.return,te)}}else Ta(s,o,u,p);break;case 13:Ta(s,o,u,p);break;case 23:break;case 22:_=o.stateNode,A=o.alternate,o.memoizedState!==null?_._visibility&2?Ta(s,o,u,p):Ol(s,o):_._visibility&2?Ta(s,o,u,p):(_._visibility|=2,no(s,o,u,p,(o.subtreeFlags&10256)!==0)),v&2048&&N0(A,o);break;case 24:Ta(s,o,u,p),v&2048&&R0(o.alternate,o);break;default:Ta(s,o,u,p)}}function no(s,o,u,p,v){for(v=v&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var _=s,A=o,O=u,te=p,de=A.flags;switch(A.tag){case 0:case 11:case 15:no(_,A,O,te,v),Il(8,A);break;case 23:break;case 22:var Ee=A.stateNode;A.memoizedState!==null?Ee._visibility&2?no(_,A,O,te,v):Ol(_,A):(Ee._visibility|=2,no(_,A,O,te,v)),v&&de&2048&&N0(A.alternate,A);break;case 24:no(_,A,O,te,v),v&&de&2048&&R0(A.alternate,A);break;default:no(_,A,O,te,v)}o=o.sibling}}function Ol(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=s,p=o,v=p.flags;switch(p.tag){case 22:Ol(u,p),v&2048&&N0(p.alternate,p);break;case 24:Ol(u,p),v&2048&&R0(p.alternate,p);break;default:Ol(u,p)}o=o.sibling}}var Ll=8192;function ro(s){if(s.subtreeFlags&Ll)for(s=s.child;s!==null;)qx(s),s=s.sibling}function qx(s){switch(s.tag){case 26:ro(s),s.flags&Ll&&s.memoizedState!==null&&_b(aa,s.memoizedState,s.memoizedProps);break;case 5:ro(s);break;case 3:case 4:var o=aa;aa=qu(s.stateNode.containerInfo),ro(s),aa=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=Ll,Ll=16777216,ro(s),Ll=o):ro(s));break;default:ro(s)}}function Yx(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function Pl(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Dn=p,Wx(p,s)}Yx(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Jx(s),s=s.sibling}function Jx(s){switch(s.tag){case 0:case 11:case 15:Pl(s),s.flags&2048&&hs(9,s,s.return);break;case 3:Pl(s);break;case 12:Pl(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,Fu(s)):Pl(s);break;default:Pl(s)}}function Fu(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Dn=p,Wx(p,s)}Yx(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:hs(8,o,o.return),Fu(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,Fu(o));break;default:Fu(o)}s=s.sibling}}function Wx(s,o){for(;Dn!==null;){var u=Dn;switch(u.tag){case 0:case 11:case 15:hs(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:yl(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Dn=p;else e:for(u=s;Dn!==null;){p=Dn;var v=p.sibling,_=p.return;if(jx(p),p===u){Dn=null;break e}if(v!==null){v.return=_,Dn=v;break e}Dn=_}}}var LS={getCacheForType:function(s){var o=$n(En),u=o.data.get(s);return u===void 0&&(u=s(),o.data.set(s,u)),u}},PS=typeof WeakMap=="function"?WeakMap:Map,Lt=0,Yt=null,gt=null,St=0,Pt=0,Er=null,gs=!1,ao=!1,D0=!1,za=0,rn=0,xs=0,oi=0,M0=0,Hr=0,so=0,Ul=null,hr=null,I0=!1,F0=0,Ou=1/0,Lu=null,vs=null,Un=0,ys=null,io=null,oo=0,O0=0,L0=null,Kx=null,Bl=0,P0=null;function Sr(){if((Lt&2)!==0&&St!==0)return St&-St;if(re.T!==null){var s=Ji;return s!==0?s:$0()}return Oi()}function Xx(){Hr===0&&(Hr=(St&536870912)===0||Mt?ve():536870912);var s=Vr.current;return s!==null&&(s.flags|=32),Hr}function br(s,o,u){(s===Yt&&(Pt===2||Pt===9)||s.cancelPendingCommit!==null)&&(lo(s,0),_s(s,St,Hr,!1)),Fe(s,u),((Lt&2)===0||s!==Yt)&&(s===Yt&&((Lt&2)===0&&(oi|=u),rn===4&&_s(s,St,Hr,!1)),wa(s))}function Zx(s,o,u){if((Lt&6)!==0)throw Error(r(327));var p=!u&&(o&124)===0&&(o&s.expiredLanes)===0||cr(s,o),v=p?jS(s,o):j0(s,o,!0),_=p;do{if(v===0){ao&&!p&&_s(s,o,0,!1);break}else{if(u=s.current.alternate,_&&!US(u)){v=j0(s,o,!1),_=!1;continue}if(v===2){if(_=o,s.errorRecoveryDisabledLanes&_)var A=0;else A=s.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){o=A;e:{var O=s;v=Ul;var te=O.current.memoizedState.isDehydrated;if(te&&(lo(O,A).flags|=256),A=j0(O,A,!1),A!==2){if(D0&&!te){O.errorRecoveryDisabledLanes|=_,oi|=_,v=4;break e}_=hr,hr=v,_!==null&&(hr===null?hr=_:hr.push.apply(hr,_))}v=A}if(_=!1,v!==2)continue}}if(v===1){lo(s,0),_s(s,o,0,!0);break}e:{switch(p=s,_=v,_){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:_s(p,o,Hr,!gs);break e;case 2:hr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(v=F0+300-Re(),10<v)){if(_s(p,o,Hr,!gs),vr(p,0,!0)!==0)break e;p.timeoutHandle=Av(Qx.bind(null,p,u,hr,Lu,I0,o,Hr,oi,so,gs,_,2,-0,0),v);break e}Qx(p,u,hr,Lu,I0,o,Hr,oi,so,gs,_,0,-0,0)}}break}while(!0);wa(s)}function Qx(s,o,u,p,v,_,A,O,te,de,Ee,be,pe,ge){if(s.timeoutHandle=-1,be=o.subtreeFlags,(be&8192||(be&16785408)===16785408)&&(ql={stylesheets:null,count:0,unsuspend:yb},qx(o),be=Tb(),be!==null)){s.cancelPendingCommit=be(iv.bind(null,s,o,_,u,p,v,A,O,te,Ee,1,pe,ge)),_s(s,_,A,!de);return}iv(s,o,_,u,p,v,A,O,te)}function US(s){for(var o=s;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var v=u[p],_=v.getSnapshot;v=v.value;try{if(!yr(_(),v))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function _s(s,o,u,p){o&=~M0,o&=~oi,s.suspendedLanes|=o,s.pingedLanes&=~o,p&&(s.warmLanes|=o),p=s.expirationTimes;for(var v=o;0<v;){var _=31-Pe(v),A=1<<_;p[_]=-1,v&=~A}u!==0&&mt(s,u,o)}function Pu(){return(Lt&6)===0?(jl(0),!1):!0}function U0(){if(gt!==null){if(Pt===0)var s=gt.return;else s=gt,Pa=ti=null,t0(s),eo=null,Rl=0,s=gt;for(;s!==null;)Mx(s.alternate,s),s=s.return;gt=null}}function lo(s,o){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,nb(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),U0(),Yt=s,gt=u=Fa(s.current,null),St=o,Pt=0,Er=null,gs=!1,ao=cr(s,o),D0=!1,so=Hr=M0=oi=xs=rn=0,hr=Ul=null,I0=!1,(o&8)!==0&&(o|=o&32);var p=s.entangledLanes;if(p!==0)for(s=s.entanglements,p&=o;0<p;){var v=31-Pe(p),_=1<<v;o|=s[v],p&=~_}return za=o,su(),u}function ev(s,o){ht=null,re.H=Su,o===Tl||o===mu?(o=xg(),Pt=3):o===mg?(o=xg(),Pt=4):Pt=o===vx?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Er=o,gt===null&&(rn=1,Nu(s,Pr(o,s.current)))}function tv(){var s=re.H;return re.H=Su,s===null?Su:s}function nv(){var s=re.A;return re.A=LS,s}function B0(){rn=4,gs||(St&4194048)!==St&&Vr.current!==null||(ao=!0),(xs&134217727)===0&&(oi&134217727)===0||Yt===null||_s(Yt,St,Hr,!1)}function j0(s,o,u){var p=Lt;Lt|=2;var v=tv(),_=nv();(Yt!==s||St!==o)&&(Lu=null,lo(s,o)),o=!1;var A=rn;e:do try{if(Pt!==0&&gt!==null){var O=gt,te=Er;switch(Pt){case 8:U0(),A=6;break e;case 3:case 2:case 9:case 6:Vr.current===null&&(o=!0);var de=Pt;if(Pt=0,Er=null,co(s,O,te,de),u&&ao){A=0;break e}break;default:de=Pt,Pt=0,Er=null,co(s,O,te,de)}}BS(),A=rn;break}catch(Ee){ev(s,Ee)}while(!0);return o&&s.shellSuspendCounter++,Pa=ti=null,Lt=p,re.H=v,re.A=_,gt===null&&(Yt=null,St=0,su()),A}function BS(){for(;gt!==null;)rv(gt)}function jS(s,o){var u=Lt;Lt|=2;var p=tv(),v=nv();Yt!==s||St!==o?(Lu=null,Ou=Re()+500,lo(s,o)):ao=cr(s,o);e:do try{if(Pt!==0&&gt!==null){o=gt;var _=Er;t:switch(Pt){case 1:Pt=0,Er=null,co(s,o,_,1);break;case 2:case 9:if(pg(_)){Pt=0,Er=null,av(o);break}o=function(){Pt!==2&&Pt!==9||Yt!==s||(Pt=7),wa(s)},_.then(o,o);break e;case 3:Pt=7;break e;case 4:Pt=5;break e;case 7:pg(_)?(Pt=0,Er=null,av(o)):(Pt=0,Er=null,co(s,o,_,7));break;case 5:var A=null;switch(gt.tag){case 26:A=gt.memoizedState;case 5:case 27:var O=gt;if(!A||Bv(A)){Pt=0,Er=null;var te=O.sibling;if(te!==null)gt=te;else{var de=O.return;de!==null?(gt=de,Uu(de)):gt=null}break t}}Pt=0,Er=null,co(s,o,_,5);break;case 6:Pt=0,Er=null,co(s,o,_,6);break;case 8:U0(),rn=6;break e;default:throw Error(r(462))}}VS();break}catch(Ee){ev(s,Ee)}while(!0);return Pa=ti=null,re.H=p,re.A=v,Lt=u,gt!==null?0:(Yt=null,St=0,su(),rn)}function VS(){for(;gt!==null&&!it();)rv(gt)}function rv(s){var o=Rx(s.alternate,s,za);s.memoizedProps=s.pendingProps,o===null?Uu(s):gt=o}function av(s){var o=s,u=o.alternate;switch(o.tag){case 15:case 0:o=Sx(u,o,o.pendingProps,o.type,void 0,St);break;case 11:o=Sx(u,o,o.pendingProps,o.type.render,o.ref,St);break;case 5:t0(o);default:Mx(u,o),o=gt=sg(o,za),o=Rx(u,o,za)}s.memoizedProps=s.pendingProps,o===null?Uu(s):gt=o}function co(s,o,u,p){Pa=ti=null,t0(o),eo=null,Rl=0;var v=o.return;try{if(RS(s,v,o,u,St)){rn=1,Nu(s,Pr(u,s.current)),gt=null;return}}catch(_){if(v!==null)throw gt=v,_;rn=1,Nu(s,Pr(u,s.current)),gt=null;return}o.flags&32768?(Mt||p===1?s=!0:ao||(St&536870912)!==0?s=!1:(gs=s=!0,(p===2||p===9||p===3||p===6)&&(p=Vr.current,p!==null&&p.tag===13&&(p.flags|=16384))),sv(o,s)):Uu(o)}function Uu(s){var o=s;do{if((o.flags&32768)!==0){sv(o,gs);return}s=o.return;var u=MS(o.alternate,o,za);if(u!==null){gt=u;return}if(o=o.sibling,o!==null){gt=o;return}gt=o=s}while(o!==null);rn===0&&(rn=5)}function sv(s,o){do{var u=IS(s.alternate,s);if(u!==null){u.flags&=32767,gt=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(s=s.sibling,s!==null)){gt=s;return}gt=s=u}while(s!==null);rn=6,gt=null}function iv(s,o,u,p,v,_,A,O,te){s.cancelPendingCommit=null;do Bu();while(Un!==0);if((Lt&6)!==0)throw Error(r(327));if(o!==null){if(o===s.current)throw Error(r(177));if(_=o.lanes|o.childLanes,_|=Rd,lt(s,u,_,A,O,te),s===Yt&&(gt=Yt=null,St=0),io=o,ys=s,oo=u,O0=_,L0=v,Kx=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,zS(en,function(){return fv(),null})):(s.callbackNode=null,s.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=re.T,re.T=null,v=ue.p,ue.p=2,A=Lt,Lt|=4;try{FS(s,o,u)}finally{Lt=A,ue.p=v,re.T=p}}Un=1,ov(),lv(),cv()}}function ov(){if(Un===1){Un=0;var s=ys,o=io,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=re.T,re.T=null;var p=ue.p;ue.p=2;var v=Lt;Lt|=4;try{Gx(o,s);var _=Z0,A=Wp(s.containerInfo),O=_.focusedElem,te=_.selectionRange;if(A!==O&&O&&O.ownerDocument&&Jp(O.ownerDocument.documentElement,O)){if(te!==null&&bd(O)){var de=te.start,Ee=te.end;if(Ee===void 0&&(Ee=de),"selectionStart"in O)O.selectionStart=de,O.selectionEnd=Math.min(Ee,O.value.length);else{var be=O.ownerDocument||document,pe=be&&be.defaultView||window;if(pe.getSelection){var ge=pe.getSelection(),Qe=O.textContent.length,Xe=Math.min(te.start,Qe),Ht=te.end===void 0?Xe:Math.min(te.end,Qe);!ge.extend&&Xe>Ht&&(A=Ht,Ht=Xe,Xe=A);var oe=Yp(O,Xe),ae=Yp(O,Ht);if(oe&&ae&&(ge.rangeCount!==1||ge.anchorNode!==oe.node||ge.anchorOffset!==oe.offset||ge.focusNode!==ae.node||ge.focusOffset!==ae.offset)){var fe=be.createRange();fe.setStart(oe.node,oe.offset),ge.removeAllRanges(),Xe>Ht?(ge.addRange(fe),ge.extend(ae.node,ae.offset)):(fe.setEnd(ae.node,ae.offset),ge.addRange(fe))}}}}for(be=[],ge=O;ge=ge.parentNode;)ge.nodeType===1&&be.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<be.length;O++){var Se=be[O];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}Xu=!!X0,Z0=X0=null}finally{Lt=v,ue.p=p,re.T=u}}s.current=o,Un=2}}function lv(){if(Un===2){Un=0;var s=ys,o=io,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=re.T,re.T=null;var p=ue.p;ue.p=2;var v=Lt;Lt|=4;try{Bx(s,o.alternate,o)}finally{Lt=v,ue.p=p,re.T=u}}Un=3}}function cv(){if(Un===4||Un===3){Un=0,rt();var s=ys,o=io,u=oo,p=Kx;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Un=5:(Un=0,io=ys=null,uv(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(vs=null),ea(u),o=o.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(ln,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=re.T,v=ue.p,ue.p=2,re.T=null;try{for(var _=s.onRecoverableError,A=0;A<p.length;A++){var O=p[A];_(O.value,{componentStack:O.stack})}}finally{re.T=o,ue.p=v}}(oo&3)!==0&&Bu(),wa(s),v=s.pendingLanes,(u&4194090)!==0&&(v&42)!==0?s===P0?Bl++:(Bl=0,P0=s):Bl=0,jl(0)}}function uv(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,yl(o)))}function Bu(s){return ov(),lv(),cv(),fv()}function fv(){if(Un!==5)return!1;var s=ys,o=O0;O0=0;var u=ea(oo),p=re.T,v=ue.p;try{ue.p=32>u?32:u,re.T=null,u=L0,L0=null;var _=ys,A=oo;if(Un=0,io=ys=null,oo=0,(Lt&6)!==0)throw Error(r(331));var O=Lt;if(Lt|=4,Jx(_.current),zx(_,_.current,A,u),Lt=O,jl(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(ln,_)}catch{}return!0}finally{ue.p=v,re.T=p,uv(s,o)}}function dv(s,o,u){o=Pr(u,o),o=p0(s.stateNode,o,2),s=cs(s,o,2),s!==null&&(Fe(s,2),wa(s))}function zt(s,o,u){if(s.tag===3)dv(s,s,u);else for(;o!==null;){if(o.tag===3){dv(o,s,u);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(vs===null||!vs.has(p))){s=Pr(u,s),u=gx(2),p=cs(o,u,2),p!==null&&(xx(u,p,o,s),Fe(p,2),wa(p));break}}o=o.return}}function V0(s,o,u){var p=s.pingCache;if(p===null){p=s.pingCache=new PS;var v=new Set;p.set(o,v)}else v=p.get(o),v===void 0&&(v=new Set,p.set(o,v));v.has(u)||(D0=!0,v.add(u),s=HS.bind(null,s,o,u),o.then(s,s))}function HS(s,o,u){var p=s.pingCache;p!==null&&p.delete(o),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Yt===s&&(St&u)===u&&(rn===4||rn===3&&(St&62914560)===St&&300>Re()-F0?(Lt&2)===0&&lo(s,0):M0|=u,so===St&&(so=0)),wa(s)}function hv(s,o){o===0&&(o=Ve()),s=$i(s,o),s!==null&&(Fe(s,o),wa(s))}function GS(s){var o=s.memoizedState,u=0;o!==null&&(u=o.retryLane),hv(s,u)}function $S(s,o){var u=0;switch(s.tag){case 13:var p=s.stateNode,v=s.memoizedState;v!==null&&(u=v.retryLane);break;case 19:p=s.stateNode;break;case 22:p=s.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(o),hv(s,u)}function zS(s,o){return yt(s,o)}var ju=null,uo=null,H0=!1,Vu=!1,G0=!1,li=0;function wa(s){s!==uo&&s.next===null&&(uo===null?ju=uo=s:uo=uo.next=s),Vu=!0,H0||(H0=!0,YS())}function jl(s,o){if(!G0&&Vu){G0=!0;do for(var u=!1,p=ju;p!==null;){if(s!==0){var v=p.pendingLanes;if(v===0)var _=0;else{var A=p.suspendedLanes,O=p.pingedLanes;_=(1<<31-Pe(42|s)+1)-1,_&=v&~(A&~O),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(u=!0,xv(p,_))}else _=St,_=vr(p,p===Yt?_:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(_&3)===0||cr(p,_)||(u=!0,xv(p,_));p=p.next}while(u);G0=!1}}function qS(){mv()}function mv(){Vu=H0=!1;var s=0;li!==0&&(tb()&&(s=li),li=0);for(var o=Re(),u=null,p=ju;p!==null;){var v=p.next,_=pv(p,o);_===0?(p.next=null,u===null?ju=v:u.next=v,v===null&&(uo=u)):(u=p,(s!==0||(_&3)!==0)&&(Vu=!0)),p=v}jl(s)}function pv(s,o){for(var u=s.suspendedLanes,p=s.pingedLanes,v=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var A=31-Pe(_),O=1<<A,te=v[A];te===-1?((O&u)===0||(O&p)!==0)&&(v[A]=Rr(O,o)):te<=o&&(s.expiredLanes|=O),_&=~O}if(o=Yt,u=St,u=vr(s,s===o?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p=s.callbackNode,u===0||s===o&&(Pt===2||Pt===9)||s.cancelPendingCommit!==null)return p!==null&&p!==null&&qe(p),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||cr(s,u)){if(o=u&-u,o===s.callbackPriority)return o;switch(p!==null&&qe(p),ea(u)){case 2:case 8:u=dn;break;case 32:u=en;break;case 268435456:u=Nn;break;default:u=en}return p=gv.bind(null,s),u=yt(u,p),s.callbackPriority=o,s.callbackNode=u,o}return p!==null&&p!==null&&qe(p),s.callbackPriority=2,s.callbackNode=null,2}function gv(s,o){if(Un!==0&&Un!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(Bu()&&s.callbackNode!==u)return null;var p=St;return p=vr(s,s===Yt?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p===0?null:(Zx(s,p,o),pv(s,Re()),s.callbackNode!=null&&s.callbackNode===u?gv.bind(null,s):null)}function xv(s,o){if(Bu())return null;Zx(s,o,!0)}function YS(){rb(function(){(Lt&6)!==0?yt($t,qS):mv()})}function $0(){return li===0&&(li=ve()),li}function vv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Zc(""+s)}function yv(s,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,s.id&&u.setAttribute("form",s.id),o.parentNode.insertBefore(u,o),s=new FormData(s),u.parentNode.removeChild(u),s}function JS(s,o,u,p,v){if(o==="submit"&&u&&u.stateNode===v){var _=vv((v[pn]||null).action),A=p.submitter;A&&(o=(o=A[pn]||null)?vv(o.formAction):A.getAttribute("formAction"),o!==null&&(_=o,A=null));var O=new nu("action","action",null,p,v);s.push({event:O,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(li!==0){var te=A?yv(v,A):new FormData(v);u0(u,{pending:!0,data:te,method:v.method,action:_},null,te)}}else typeof _=="function"&&(O.preventDefault(),te=A?yv(v,A):new FormData(v),u0(u,{pending:!0,data:te,method:v.method,action:_},_,te))},currentTarget:v}]})}}for(var z0=0;z0<Nd.length;z0++){var q0=Nd[z0],WS=q0.toLowerCase(),KS=q0[0].toUpperCase()+q0.slice(1);ra(WS,"on"+KS)}ra(Zp,"onAnimationEnd"),ra(Qp,"onAnimationIteration"),ra(eg,"onAnimationStart"),ra("dblclick","onDoubleClick"),ra("focusin","onFocus"),ra("focusout","onBlur"),ra(hS,"onTransitionRun"),ra(mS,"onTransitionStart"),ra(pS,"onTransitionCancel"),ra(tg,"onTransitionEnd"),Oe("onMouseEnter",["mouseout","mouseover"]),Oe("onMouseLeave",["mouseout","mouseover"]),Oe("onPointerEnter",["pointerout","pointerover"]),Oe("onPointerLeave",["pointerout","pointerover"]),Ae("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ae("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ae("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ae("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ae("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ae("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vl));function _v(s,o){o=(o&4)!==0;for(var u=0;u<s.length;u++){var p=s[u],v=p.event;p=p.listeners;e:{var _=void 0;if(o)for(var A=p.length-1;0<=A;A--){var O=p[A],te=O.instance,de=O.currentTarget;if(O=O.listener,te!==_&&v.isPropagationStopped())break e;_=O,v.currentTarget=de;try{_(v)}catch(Ee){ku(Ee)}v.currentTarget=null,_=te}else for(A=0;A<p.length;A++){if(O=p[A],te=O.instance,de=O.currentTarget,O=O.listener,te!==_&&v.isPropagationStopped())break e;_=O,v.currentTarget=de;try{_(v)}catch(Ee){ku(Ee)}v.currentTarget=null,_=te}}}}function xt(s,o){var u=o[zs];u===void 0&&(u=o[zs]=new Set);var p=s+"__bubble";u.has(p)||(Tv(o,s,2,!1),u.add(p))}function Y0(s,o,u){var p=0;o&&(p|=4),Tv(u,s,p,o)}var Hu="_reactListening"+Math.random().toString(36).slice(2);function J0(s){if(!s[Hu]){s[Hu]=!0,he.forEach(function(u){u!=="selectionchange"&&(XS.has(u)||Y0(u,!1,s),Y0(u,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Hu]||(o[Hu]=!0,Y0("selectionchange",!1,o))}}function Tv(s,o,u,p){switch(zv(o)){case 2:var v=Sb;break;case 8:v=bb;break;default:v=lh}u=v.bind(null,o,u,s),v=void 0,!gd||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(v=!0),p?v!==void 0?s.addEventListener(o,u,{capture:!0,passive:v}):s.addEventListener(o,u,!0):v!==void 0?s.addEventListener(o,u,{passive:v}):s.addEventListener(o,u,!1)}function W0(s,o,u,p,v){var _=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var A=p.tag;if(A===3||A===4){var O=p.stateNode.containerInfo;if(O===v)break;if(A===4)for(A=p.return;A!==null;){var te=A.tag;if((te===3||te===4)&&A.stateNode.containerInfo===v)return;A=A.return}for(;O!==null;){if(A=V(O),A===null)return;if(te=A.tag,te===5||te===6||te===26||te===27){p=_=A;continue e}O=O.parentNode}}p=p.return}kp(function(){var de=_,Ee=md(u),be=[];e:{var pe=ng.get(s);if(pe!==void 0){var ge=nu,Qe=s;switch(s){case"keypress":if(eu(u)===0)break e;case"keydown":case"keyup":ge=zE;break;case"focusin":Qe="focus",ge=_d;break;case"focusout":Qe="blur",ge=_d;break;case"beforeblur":case"afterblur":ge=_d;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=Dp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=IE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=JE;break;case Zp:case Qp:case eg:ge=LE;break;case tg:ge=KE;break;case"scroll":case"scrollend":ge=DE;break;case"wheel":ge=ZE;break;case"copy":case"cut":case"paste":ge=UE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=Ip;break;case"toggle":case"beforetoggle":ge=eS}var Xe=(o&4)!==0,Ht=!Xe&&(s==="scroll"||s==="scrollend"),oe=Xe?pe!==null?pe+"Capture":null:pe;Xe=[];for(var ae=de,fe;ae!==null;){var Se=ae;if(fe=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||fe===null||oe===null||(Se=il(ae,oe),Se!=null&&Xe.push(Hl(ae,Se,fe))),Ht)break;ae=ae.return}0<Xe.length&&(pe=new ge(pe,Qe,null,u,Ee),be.push({event:pe,listeners:Xe}))}}if((o&7)===0){e:{if(pe=s==="mouseover"||s==="pointerover",ge=s==="mouseout"||s==="pointerout",pe&&u!==hd&&(Qe=u.relatedTarget||u.fromElement)&&(V(Qe)||Qe[ga]))break e;if((ge||pe)&&(pe=Ee.window===Ee?Ee:(pe=Ee.ownerDocument)?pe.defaultView||pe.parentWindow:window,ge?(Qe=u.relatedTarget||u.toElement,ge=de,Qe=Qe?V(Qe):null,Qe!==null&&(Ht=i(Qe),Xe=Qe.tag,Qe!==Ht||Xe!==5&&Xe!==27&&Xe!==6)&&(Qe=null)):(ge=null,Qe=de),ge!==Qe)){if(Xe=Dp,Se="onMouseLeave",oe="onMouseEnter",ae="mouse",(s==="pointerout"||s==="pointerover")&&(Xe=Ip,Se="onPointerLeave",oe="onPointerEnter",ae="pointer"),Ht=ge==null?pe:ce(ge),fe=Qe==null?pe:ce(Qe),pe=new Xe(Se,ae+"leave",ge,u,Ee),pe.target=Ht,pe.relatedTarget=fe,Se=null,V(Ee)===de&&(Xe=new Xe(oe,ae+"enter",Qe,u,Ee),Xe.target=fe,Xe.relatedTarget=Ht,Se=Xe),Ht=Se,ge&&Qe)t:{for(Xe=ge,oe=Qe,ae=0,fe=Xe;fe;fe=fo(fe))ae++;for(fe=0,Se=oe;Se;Se=fo(Se))fe++;for(;0<ae-fe;)Xe=fo(Xe),ae--;for(;0<fe-ae;)oe=fo(oe),fe--;for(;ae--;){if(Xe===oe||oe!==null&&Xe===oe.alternate)break t;Xe=fo(Xe),oe=fo(oe)}Xe=null}else Xe=null;ge!==null&&wv(be,pe,ge,Xe,!1),Qe!==null&&Ht!==null&&wv(be,Ht,Qe,Xe,!0)}}e:{if(pe=de?ce(de):window,ge=pe.nodeName&&pe.nodeName.toLowerCase(),ge==="select"||ge==="input"&&pe.type==="file")var $e=Vp;else if(Bp(pe))if(Hp)$e=uS;else{$e=lS;var pt=oS}else ge=pe.nodeName,!ge||ge.toLowerCase()!=="input"||pe.type!=="checkbox"&&pe.type!=="radio"?de&&dd(de.elementType)&&($e=Vp):$e=cS;if($e&&($e=$e(s,de))){jp(be,$e,u,Ee);break e}pt&&pt(s,pe,de),s==="focusout"&&de&&pe.type==="number"&&de.memoizedProps.value!=null&&fd(pe,"number",pe.value)}switch(pt=de?ce(de):window,s){case"focusin":(Bp(pt)||pt.contentEditable==="true")&&(Vi=pt,Cd=de,ml=null);break;case"focusout":ml=Cd=Vi=null;break;case"mousedown":Ad=!0;break;case"contextmenu":case"mouseup":case"dragend":Ad=!1,Kp(be,u,Ee);break;case"selectionchange":if(dS)break;case"keydown":case"keyup":Kp(be,u,Ee)}var We;if(wd)e:{switch(s){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else ji?Pp(s,u)&&(Ze="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Ze="onCompositionStart");Ze&&(Fp&&u.locale!=="ko"&&(ji||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&ji&&(We=Np()):(ss=Ee,xd="value"in ss?ss.value:ss.textContent,ji=!0)),pt=Gu(de,Ze),0<pt.length&&(Ze=new Mp(Ze,s,null,u,Ee),be.push({event:Ze,listeners:pt}),We?Ze.data=We:(We=Up(u),We!==null&&(Ze.data=We)))),(We=nS?rS(s,u):aS(s,u))&&(Ze=Gu(de,"onBeforeInput"),0<Ze.length&&(pt=new Mp("onBeforeInput","beforeinput",null,u,Ee),be.push({event:pt,listeners:Ze}),pt.data=We)),JS(be,s,de,u,Ee)}_v(be,o)})}function Hl(s,o,u){return{instance:s,listener:o,currentTarget:u}}function Gu(s,o){for(var u=o+"Capture",p=[];s!==null;){var v=s,_=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||_===null||(v=il(s,u),v!=null&&p.unshift(Hl(s,v,_)),v=il(s,o),v!=null&&p.push(Hl(s,v,_))),s.tag===3)return p;s=s.return}return[]}function fo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function wv(s,o,u,p,v){for(var _=o._reactName,A=[];u!==null&&u!==p;){var O=u,te=O.alternate,de=O.stateNode;if(O=O.tag,te!==null&&te===p)break;O!==5&&O!==26&&O!==27||de===null||(te=de,v?(de=il(u,_),de!=null&&A.unshift(Hl(u,de,te))):v||(de=il(u,_),de!=null&&A.push(Hl(u,de,te)))),u=u.return}A.length!==0&&s.push({event:o,listeners:A})}var ZS=/\r\n?/g,QS=/\u0000|\uFFFD/g;function Ev(s){return(typeof s=="string"?s:""+s).replace(ZS,`
`).replace(QS,"")}function Sv(s,o){return o=Ev(o),Ev(s)===o}function $u(){}function Vt(s,o,u,p,v,_){switch(u){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||Pi(s,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&Pi(s,""+p);break;case"className":Ft(s,"class",p);break;case"tabIndex":Ft(s,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Ft(s,u,p);break;case"style":Cp(s,p,_);break;case"data":if(o!=="object"){Ft(s,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||u!=="href")){s.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=Zc(""+p),s.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(u==="formAction"?(o!=="input"&&Vt(s,o,"name",v.name,v,null),Vt(s,o,"formEncType",v.formEncType,v,null),Vt(s,o,"formMethod",v.formMethod,v,null),Vt(s,o,"formTarget",v.formTarget,v,null)):(Vt(s,o,"encType",v.encType,v,null),Vt(s,o,"method",v.method,v,null),Vt(s,o,"target",v.target,v,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=Zc(""+p),s.setAttribute(u,p);break;case"onClick":p!=null&&(s.onclick=$u);break;case"onScroll":p!=null&&xt("scroll",s);break;case"onScrollEnd":p!=null&&xt("scrollend",s);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(v.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"multiple":s.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":s.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){s.removeAttribute("xlink:href");break}u=Zc(""+p),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""+p):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":p===!0?s.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,p):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?s.setAttribute(u,p):s.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?s.removeAttribute(u):s.setAttribute(u,p);break;case"popover":xt("beforetoggle",s),xt("toggle",s),It(s,"popover",p);break;case"xlinkActuate":Ot(s,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Ot(s,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Ot(s,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Ot(s,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Ot(s,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Ot(s,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":It(s,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=NE.get(u)||u,It(s,u,p))}}function K0(s,o,u,p,v,_){switch(u){case"style":Cp(s,p,_);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(v.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"children":typeof p=="string"?Pi(s,p):(typeof p=="number"||typeof p=="bigint")&&Pi(s,""+p);break;case"onScroll":p!=null&&xt("scroll",s);break;case"onScrollEnd":p!=null&&xt("scrollend",s);break;case"onClick":p!=null&&(s.onclick=$u);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!me.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(v=u.endsWith("Capture"),o=u.slice(2,v?u.length-7:void 0),_=s[pn]||null,_=_!=null?_[u]:null,typeof _=="function"&&s.removeEventListener(o,_,v),typeof p=="function")){typeof _!="function"&&_!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(o,p,v);break e}u in s?s[u]=p:p===!0?s.setAttribute(u,""):It(s,u,p)}}}function Bn(s,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xt("error",s),xt("load",s);var p=!1,v=!1,_;for(_ in u)if(u.hasOwnProperty(_)){var A=u[_];if(A!=null)switch(_){case"src":p=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Vt(s,o,_,A,u,null)}}v&&Vt(s,o,"srcSet",u.srcSet,u,null),p&&Vt(s,o,"src",u.src,u,null);return;case"input":xt("invalid",s);var O=_=A=v=null,te=null,de=null;for(p in u)if(u.hasOwnProperty(p)){var Ee=u[p];if(Ee!=null)switch(p){case"name":v=Ee;break;case"type":A=Ee;break;case"checked":te=Ee;break;case"defaultChecked":de=Ee;break;case"value":_=Ee;break;case"defaultValue":O=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(r(137,o));break;default:Vt(s,o,p,Ee,u,null)}}wp(s,_,O,te,de,A,v,!1),Kc(s);return;case"select":xt("invalid",s),p=A=_=null;for(v in u)if(u.hasOwnProperty(v)&&(O=u[v],O!=null))switch(v){case"value":_=O;break;case"defaultValue":A=O;break;case"multiple":p=O;default:Vt(s,o,v,O,u,null)}o=_,u=A,s.multiple=!!p,o!=null?Li(s,!!p,o,!1):u!=null&&Li(s,!!p,u,!0);return;case"textarea":xt("invalid",s),_=v=p=null;for(A in u)if(u.hasOwnProperty(A)&&(O=u[A],O!=null))switch(A){case"value":p=O;break;case"defaultValue":v=O;break;case"children":_=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(r(91));break;default:Vt(s,o,A,O,u,null)}Sp(s,p,v,_),Kc(s);return;case"option":for(te in u)if(u.hasOwnProperty(te)&&(p=u[te],p!=null))switch(te){case"selected":s.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Vt(s,o,te,p,u,null)}return;case"dialog":xt("beforetoggle",s),xt("toggle",s),xt("cancel",s),xt("close",s);break;case"iframe":case"object":xt("load",s);break;case"video":case"audio":for(p=0;p<Vl.length;p++)xt(Vl[p],s);break;case"image":xt("error",s),xt("load",s);break;case"details":xt("toggle",s);break;case"embed":case"source":case"link":xt("error",s),xt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in u)if(u.hasOwnProperty(de)&&(p=u[de],p!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Vt(s,o,de,p,u,null)}return;default:if(dd(o)){for(Ee in u)u.hasOwnProperty(Ee)&&(p=u[Ee],p!==void 0&&K0(s,o,Ee,p,u,void 0));return}}for(O in u)u.hasOwnProperty(O)&&(p=u[O],p!=null&&Vt(s,o,O,p,u,null))}function eb(s,o,u,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,_=null,A=null,O=null,te=null,de=null,Ee=null;for(ge in u){var be=u[ge];if(u.hasOwnProperty(ge)&&be!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":te=be;default:p.hasOwnProperty(ge)||Vt(s,o,ge,null,p,be)}}for(var pe in p){var ge=p[pe];if(be=u[pe],p.hasOwnProperty(pe)&&(ge!=null||be!=null))switch(pe){case"type":_=ge;break;case"name":v=ge;break;case"checked":de=ge;break;case"defaultChecked":Ee=ge;break;case"value":A=ge;break;case"defaultValue":O=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,o));break;default:ge!==be&&Vt(s,o,pe,ge,p,be)}}ud(s,A,O,te,de,Ee,_,v);return;case"select":ge=A=O=pe=null;for(_ in u)if(te=u[_],u.hasOwnProperty(_)&&te!=null)switch(_){case"value":break;case"multiple":ge=te;default:p.hasOwnProperty(_)||Vt(s,o,_,null,p,te)}for(v in p)if(_=p[v],te=u[v],p.hasOwnProperty(v)&&(_!=null||te!=null))switch(v){case"value":pe=_;break;case"defaultValue":O=_;break;case"multiple":A=_;default:_!==te&&Vt(s,o,v,_,p,te)}o=O,u=A,p=ge,pe!=null?Li(s,!!u,pe,!1):!!p!=!!u&&(o!=null?Li(s,!!u,o,!0):Li(s,!!u,u?[]:"",!1));return;case"textarea":ge=pe=null;for(O in u)if(v=u[O],u.hasOwnProperty(O)&&v!=null&&!p.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:Vt(s,o,O,null,p,v)}for(A in p)if(v=p[A],_=u[A],p.hasOwnProperty(A)&&(v!=null||_!=null))switch(A){case"value":pe=v;break;case"defaultValue":ge=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(r(91));break;default:v!==_&&Vt(s,o,A,v,p,_)}Ep(s,pe,ge);return;case"option":for(var Qe in u)if(pe=u[Qe],u.hasOwnProperty(Qe)&&pe!=null&&!p.hasOwnProperty(Qe))switch(Qe){case"selected":s.selected=!1;break;default:Vt(s,o,Qe,null,p,pe)}for(te in p)if(pe=p[te],ge=u[te],p.hasOwnProperty(te)&&pe!==ge&&(pe!=null||ge!=null))switch(te){case"selected":s.selected=pe&&typeof pe!="function"&&typeof pe!="symbol";break;default:Vt(s,o,te,pe,p,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in u)pe=u[Xe],u.hasOwnProperty(Xe)&&pe!=null&&!p.hasOwnProperty(Xe)&&Vt(s,o,Xe,null,p,pe);for(de in p)if(pe=p[de],ge=u[de],p.hasOwnProperty(de)&&pe!==ge&&(pe!=null||ge!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(r(137,o));break;default:Vt(s,o,de,pe,p,ge)}return;default:if(dd(o)){for(var Ht in u)pe=u[Ht],u.hasOwnProperty(Ht)&&pe!==void 0&&!p.hasOwnProperty(Ht)&&K0(s,o,Ht,void 0,p,pe);for(Ee in p)pe=p[Ee],ge=u[Ee],!p.hasOwnProperty(Ee)||pe===ge||pe===void 0&&ge===void 0||K0(s,o,Ee,pe,p,ge);return}}for(var oe in u)pe=u[oe],u.hasOwnProperty(oe)&&pe!=null&&!p.hasOwnProperty(oe)&&Vt(s,o,oe,null,p,pe);for(be in p)pe=p[be],ge=u[be],!p.hasOwnProperty(be)||pe===ge||pe==null&&ge==null||Vt(s,o,be,pe,p,ge)}var X0=null,Z0=null;function zu(s){return s.nodeType===9?s:s.ownerDocument}function bv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Cv(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Q0(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var eh=null;function tb(){var s=window.event;return s&&s.type==="popstate"?s===eh?!1:(eh=s,!0):(eh=null,!1)}var Av=typeof setTimeout=="function"?setTimeout:void 0,nb=typeof clearTimeout=="function"?clearTimeout:void 0,kv=typeof Promise=="function"?Promise:void 0,rb=typeof queueMicrotask=="function"?queueMicrotask:typeof kv<"u"?function(s){return kv.resolve(null).then(s).catch(ab)}:Av;function ab(s){setTimeout(function(){throw s})}function Ts(s){return s==="head"}function Nv(s,o){var u=o,p=0,v=0;do{var _=u.nextSibling;if(s.removeChild(u),_&&_.nodeType===8)if(u=_.data,u==="/$"){if(0<p&&8>p){u=p;var A=s.ownerDocument;if(u&1&&Gl(A.documentElement),u&2&&Gl(A.body),u&4)for(u=A.head,Gl(u),A=u.firstChild;A;){var O=A.nextSibling,te=A.nodeName;A[I]||te==="SCRIPT"||te==="STYLE"||te==="LINK"&&A.rel.toLowerCase()==="stylesheet"||u.removeChild(A),A=O}}if(v===0){s.removeChild(_),Xl(o);return}v--}else u==="$"||u==="$?"||u==="$!"?v++:p=u.charCodeAt(0)-48;else p=0;u=_}while(u);Xl(o)}function th(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":th(u),B(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function sb(s,o,u,p){for(;s.nodeType===1;){var v=u;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(p){if(!s[I])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var _=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=sa(s.nextSibling),s===null)break}return null}function ib(s,o,u){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=sa(s.nextSibling),s===null))return null;return s}function nh(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function ob(s,o){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")o();else{var p=function(){o(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),s._reactRetry=p}}function sa(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var rh=null;function Rv(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return s;o--}else u==="/$"&&o++}s=s.previousSibling}return null}function Dv(s,o,u){switch(o=zu(u),s){case"html":if(s=o.documentElement,!s)throw Error(r(452));return s;case"head":if(s=o.head,!s)throw Error(r(453));return s;case"body":if(s=o.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Gl(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);B(s)}var Gr=new Map,Mv=new Set;function qu(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var qa=ue.d;ue.d={f:lb,r:cb,D:ub,C:fb,L:db,m:hb,X:pb,S:mb,M:gb};function lb(){var s=qa.f(),o=Pu();return s||o}function cb(s){var o=Y(s);o!==null&&o.tag===5&&o.type==="form"?Zg(o):qa.r(s)}var ho=typeof document>"u"?null:document;function Iv(s,o,u){var p=ho;if(p&&typeof o=="string"&&o){var v=Lr(o);v='link[rel="'+s+'"][href="'+v+'"]',typeof u=="string"&&(v+='[crossorigin="'+u+'"]'),Mv.has(v)||(Mv.add(v),s={rel:s,crossOrigin:u,href:o},p.querySelector(v)===null&&(o=p.createElement("link"),Bn(o,"link",s),le(o),p.head.appendChild(o)))}}function ub(s){qa.D(s),Iv("dns-prefetch",s,null)}function fb(s,o){qa.C(s,o),Iv("preconnect",s,o)}function db(s,o,u){qa.L(s,o,u);var p=ho;if(p&&s&&o){var v='link[rel="preload"][as="'+Lr(o)+'"]';o==="image"&&u&&u.imageSrcSet?(v+='[imagesrcset="'+Lr(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(v+='[imagesizes="'+Lr(u.imageSizes)+'"]')):v+='[href="'+Lr(s)+'"]';var _=v;switch(o){case"style":_=mo(s);break;case"script":_=po(s)}Gr.has(_)||(s=g({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:s,as:o},u),Gr.set(_,s),p.querySelector(v)!==null||o==="style"&&p.querySelector($l(_))||o==="script"&&p.querySelector(zl(_))||(o=p.createElement("link"),Bn(o,"link",s),le(o),p.head.appendChild(o)))}}function hb(s,o){qa.m(s,o);var u=ho;if(u&&s){var p=o&&typeof o.as=="string"?o.as:"script",v='link[rel="modulepreload"][as="'+Lr(p)+'"][href="'+Lr(s)+'"]',_=v;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=po(s)}if(!Gr.has(_)&&(s=g({rel:"modulepreload",href:s},o),Gr.set(_,s),u.querySelector(v)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(zl(_)))return}p=u.createElement("link"),Bn(p,"link",s),le(p),u.head.appendChild(p)}}}function mb(s,o,u){qa.S(s,o,u);var p=ho;if(p&&s){var v=xe(p).hoistableStyles,_=mo(s);o=o||"default";var A=v.get(_);if(!A){var O={loading:0,preload:null};if(A=p.querySelector($l(_)))O.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":o},u),(u=Gr.get(_))&&ah(s,u);var te=A=p.createElement("link");le(te),Bn(te,"link",s),te._p=new Promise(function(de,Ee){te.onload=de,te.onerror=Ee}),te.addEventListener("load",function(){O.loading|=1}),te.addEventListener("error",function(){O.loading|=2}),O.loading|=4,Yu(A,o,p)}A={type:"stylesheet",instance:A,count:1,state:O},v.set(_,A)}}}function pb(s,o){qa.X(s,o);var u=ho;if(u&&s){var p=xe(u).hoistableScripts,v=po(s),_=p.get(v);_||(_=u.querySelector(zl(v)),_||(s=g({src:s,async:!0},o),(o=Gr.get(v))&&sh(s,o),_=u.createElement("script"),le(_),Bn(_,"link",s),u.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},p.set(v,_))}}function gb(s,o){qa.M(s,o);var u=ho;if(u&&s){var p=xe(u).hoistableScripts,v=po(s),_=p.get(v);_||(_=u.querySelector(zl(v)),_||(s=g({src:s,async:!0,type:"module"},o),(o=Gr.get(v))&&sh(s,o),_=u.createElement("script"),le(_),Bn(_,"link",s),u.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},p.set(v,_))}}function Fv(s,o,u,p){var v=(v=ie.current)?qu(v):null;if(!v)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=mo(u.href),u=xe(v).hoistableStyles,p=u.get(o),p||(p={type:"style",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=mo(u.href);var _=xe(v).hoistableStyles,A=_.get(s);if(A||(v=v.ownerDocument||v,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,A),(_=v.querySelector($l(s)))&&!_._p&&(A.instance=_,A.state.loading=5),Gr.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Gr.set(s,u),_||xb(v,s,u,A.state))),o&&p===null)throw Error(r(528,""));return A}if(o&&p!==null)throw Error(r(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=po(u),u=xe(v).hoistableScripts,p=u.get(o),p||(p={type:"script",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function mo(s){return'href="'+Lr(s)+'"'}function $l(s){return'link[rel="stylesheet"]['+s+"]"}function Ov(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function xb(s,o,u,p){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=s.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),Bn(o,"link",u),le(o),s.head.appendChild(o))}function po(s){return'[src="'+Lr(s)+'"]'}function zl(s){return"script[async]"+s}function Lv(s,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var p=s.querySelector('style[data-href~="'+Lr(u.href)+'"]');if(p)return o.instance=p,le(p),p;var v=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(s.ownerDocument||s).createElement("style"),le(p),Bn(p,"style",v),Yu(p,u.precedence,s),o.instance=p;case"stylesheet":v=mo(u.href);var _=s.querySelector($l(v));if(_)return o.state.loading|=4,o.instance=_,le(_),_;p=Ov(u),(v=Gr.get(v))&&ah(p,v),_=(s.ownerDocument||s).createElement("link"),le(_);var A=_;return A._p=new Promise(function(O,te){A.onload=O,A.onerror=te}),Bn(_,"link",p),o.state.loading|=4,Yu(_,u.precedence,s),o.instance=_;case"script":return _=po(u.src),(v=s.querySelector(zl(_)))?(o.instance=v,le(v),v):(p=u,(v=Gr.get(_))&&(p=g({},u),sh(p,v)),s=s.ownerDocument||s,v=s.createElement("script"),le(v),Bn(v,"link",p),s.head.appendChild(v),o.instance=v);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,Yu(p,u.precedence,s));return o.instance}function Yu(s,o,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=p.length?p[p.length-1]:null,_=v,A=0;A<p.length;A++){var O=p[A];if(O.dataset.precedence===o)_=O;else if(_!==v)break}_?_.parentNode.insertBefore(s,_.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(s,o.firstChild))}function ah(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function sh(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Ju=null;function Pv(s,o,u){if(Ju===null){var p=new Map,v=Ju=new Map;v.set(u,p)}else v=Ju,p=v.get(u),p||(p=new Map,v.set(u,p));if(p.has(s))return p;for(p.set(s,null),u=u.getElementsByTagName(s),v=0;v<u.length;v++){var _=u[v];if(!(_[I]||_[mn]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var A=_.getAttribute(o)||"";A=s+A;var O=p.get(A);O?O.push(_):p.set(A,[_])}}return p}function Uv(s,o,u){s=s.ownerDocument||s,s.head.insertBefore(u,o==="title"?s.querySelector("head > title"):null)}function vb(s,o,u){if(u===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Bv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var ql=null;function yb(){}function _b(s,o,u){if(ql===null)throw Error(r(475));var p=ql;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var v=mo(u.href),_=s.querySelector($l(v));if(_){s=_._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(p.count++,p=Wu.bind(p),s.then(p,p)),o.state.loading|=4,o.instance=_,le(_);return}_=s.ownerDocument||s,u=Ov(u),(v=Gr.get(v))&&ah(u,v),_=_.createElement("link"),le(_);var A=_;A._p=new Promise(function(O,te){A.onload=O,A.onerror=te}),Bn(_,"link",u),o.instance=_}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(p.count++,o=Wu.bind(p),s.addEventListener("load",o),s.addEventListener("error",o))}}function Tb(){if(ql===null)throw Error(r(475));var s=ql;return s.stylesheets&&s.count===0&&ih(s,s.stylesheets),0<s.count?function(o){var u=setTimeout(function(){if(s.stylesheets&&ih(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u)}}:null}function Wu(){if(this.count--,this.count===0){if(this.stylesheets)ih(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Ku=null;function ih(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Ku=new Map,o.forEach(wb,s),Ku=null,Wu.call(s))}function wb(s,o){if(!(o.state.loading&4)){var u=Ku.get(s);if(u)var p=u.get(null);else{u=new Map,Ku.set(s,u);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<v.length;_++){var A=v[_];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(u.set(A.dataset.precedence,A),p=A)}p&&u.set(null,p)}v=o.instance,A=v.getAttribute("data-precedence"),_=u.get(A)||p,_===p&&u.set(null,v),u.set(A,v),this.count++,p=Wu.bind(this),v.addEventListener("load",p),v.addEventListener("error",p),_?_.parentNode.insertBefore(v,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),o.state.loading|=4}}var Yl={$$typeof:C,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function Eb(s,o,u,p,v,_,A,O){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ke(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ke(0),this.hiddenUpdates=Ke(null),this.identifierPrefix=p,this.onUncaughtError=v,this.onCaughtError=_,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function jv(s,o,u,p,v,_,A,O,te,de,Ee,be){return s=new Eb(s,o,u,A,O,te,de,be),o=1,_===!0&&(o|=24),_=_r(3,null,null,o),s.current=_,_.stateNode=s,o=Vd(),o.refCount++,s.pooledCache=o,o.refCount++,_.memoizedState={element:p,isDehydrated:u,cache:o},zd(_),s}function Vv(s){return s?(s=zi,s):zi}function Hv(s,o,u,p,v,_){v=Vv(v),p.context===null?p.context=v:p.pendingContext=v,p=ls(o),p.payload={element:u},_=_===void 0?null:_,_!==null&&(p.callback=_),u=cs(s,p,o),u!==null&&(br(u,s,o),El(u,s,o))}function Gv(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<o?u:o}}function oh(s,o){Gv(s,o),(s=s.alternate)&&Gv(s,o)}function $v(s){if(s.tag===13){var o=$i(s,67108864);o!==null&&br(o,s,67108864),oh(s,67108864)}}var Xu=!0;function Sb(s,o,u,p){var v=re.T;re.T=null;var _=ue.p;try{ue.p=2,lh(s,o,u,p)}finally{ue.p=_,re.T=v}}function bb(s,o,u,p){var v=re.T;re.T=null;var _=ue.p;try{ue.p=8,lh(s,o,u,p)}finally{ue.p=_,re.T=v}}function lh(s,o,u,p){if(Xu){var v=ch(p);if(v===null)W0(s,o,p,Zu,u),qv(s,p);else if(Ab(v,s,o,u,p))p.stopPropagation();else if(qv(s,p),o&4&&-1<Cb.indexOf(s)){for(;v!==null;){var _=Y(v);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var A=hn(_.pendingLanes);if(A!==0){var O=_;for(O.pendingLanes|=2,O.entangledLanes|=2;A;){var te=1<<31-Pe(A);O.entanglements[1]|=te,A&=~te}wa(_),(Lt&6)===0&&(Ou=Re()+500,jl(0))}}break;case 13:O=$i(_,2),O!==null&&br(O,_,2),Pu(),oh(_,2)}if(_=ch(p),_===null&&W0(s,o,p,Zu,u),_===v)break;v=_}v!==null&&p.stopPropagation()}else W0(s,o,p,null,u)}}function ch(s){return s=md(s),uh(s)}var Zu=null;function uh(s){if(Zu=null,s=V(s),s!==null){var o=i(s);if(o===null)s=null;else{var u=o.tag;if(u===13){if(s=l(o),s!==null)return s;s=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Zu=s,null}function zv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Dt()){case $t:return 2;case dn:return 8;case en:case Gn:return 32;case Nn:return 268435456;default:return 32}default:return 32}}var fh=!1,ws=null,Es=null,Ss=null,Jl=new Map,Wl=new Map,bs=[],Cb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function qv(s,o){switch(s){case"focusin":case"focusout":ws=null;break;case"dragenter":case"dragleave":Es=null;break;case"mouseover":case"mouseout":Ss=null;break;case"pointerover":case"pointerout":Jl.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wl.delete(o.pointerId)}}function Kl(s,o,u,p,v,_){return s===null||s.nativeEvent!==_?(s={blockedOn:o,domEventName:u,eventSystemFlags:p,nativeEvent:_,targetContainers:[v]},o!==null&&(o=Y(o),o!==null&&$v(o)),s):(s.eventSystemFlags|=p,o=s.targetContainers,v!==null&&o.indexOf(v)===-1&&o.push(v),s)}function Ab(s,o,u,p,v){switch(o){case"focusin":return ws=Kl(ws,s,o,u,p,v),!0;case"dragenter":return Es=Kl(Es,s,o,u,p,v),!0;case"mouseover":return Ss=Kl(Ss,s,o,u,p,v),!0;case"pointerover":var _=v.pointerId;return Jl.set(_,Kl(Jl.get(_)||null,s,o,u,p,v)),!0;case"gotpointercapture":return _=v.pointerId,Wl.set(_,Kl(Wl.get(_)||null,s,o,u,p,v)),!0}return!1}function Yv(s){var o=V(s.target);if(o!==null){var u=i(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){s.blockedOn=o,al(s.priority,function(){if(u.tag===13){var p=Sr();p=Dr(p);var v=$i(u,p);v!==null&&br(v,u,p),oh(u,p)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Qu(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var u=ch(s.nativeEvent);if(u===null){u=s.nativeEvent;var p=new u.constructor(u.type,u);hd=p,u.target.dispatchEvent(p),hd=null}else return o=Y(u),o!==null&&$v(o),s.blockedOn=u,!1;o.shift()}return!0}function Jv(s,o,u){Qu(s)&&u.delete(o)}function kb(){fh=!1,ws!==null&&Qu(ws)&&(ws=null),Es!==null&&Qu(Es)&&(Es=null),Ss!==null&&Qu(Ss)&&(Ss=null),Jl.forEach(Jv),Wl.forEach(Jv)}function ef(s,o){s.blockedOn===o&&(s.blockedOn=null,fh||(fh=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,kb)))}var tf=null;function Wv(s){tf!==s&&(tf=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){tf===s&&(tf=null);for(var o=0;o<s.length;o+=3){var u=s[o],p=s[o+1],v=s[o+2];if(typeof p!="function"){if(uh(p||u)===null)continue;break}var _=Y(u);_!==null&&(s.splice(o,3),o-=3,u0(_,{pending:!0,data:v,method:u.method,action:p},p,v))}}))}function Xl(s){function o(te){return ef(te,s)}ws!==null&&ef(ws,s),Es!==null&&ef(Es,s),Ss!==null&&ef(Ss,s),Jl.forEach(o),Wl.forEach(o);for(var u=0;u<bs.length;u++){var p=bs[u];p.blockedOn===s&&(p.blockedOn=null)}for(;0<bs.length&&(u=bs[0],u.blockedOn===null);)Yv(u),u.blockedOn===null&&bs.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var v=u[p],_=u[p+1],A=v[pn]||null;if(typeof _=="function")A||Wv(u);else if(A){var O=null;if(_&&_.hasAttribute("formAction")){if(v=_,A=_[pn]||null)O=A.formAction;else if(uh(v)!==null)continue}else O=A.action;typeof O=="function"?u[p+1]=O:(u.splice(p,3),p-=3),Wv(u)}}}function dh(s){this._internalRoot=s}nf.prototype.render=dh.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(r(409));var u=o.current,p=Sr();Hv(u,p,s,o,null,null)},nf.prototype.unmount=dh.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;Hv(s.current,2,null,s,null,null),Pu(),o[ga]=null}};function nf(s){this._internalRoot=s}nf.prototype.unstable_scheduleHydration=function(s){if(s){var o=Oi();s={blockedOn:null,target:s,priority:o};for(var u=0;u<bs.length&&o!==0&&o<bs[u].priority;u++);bs.splice(u,0,s),u===0&&Yv(s)}};var Kv=e.version;if(Kv!=="19.1.0")throw Error(r(527,Kv,"19.1.0"));ue.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(o),s=s!==null?f(s):null,s=s===null?null:s.stateNode,s};var Nb={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:re,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rf.isDisabled&&rf.supportsFiber)try{ln=rf.inject(Nb),qt=rf}catch{}}return Ql.createRoot=function(s,o){if(!a(s))throw Error(r(299));var u=!1,p="",v=dx,_=hx,A=mx,O=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(v=o.onUncaughtError),o.onCaughtError!==void 0&&(_=o.onCaughtError),o.onRecoverableError!==void 0&&(A=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(O=o.unstable_transitionCallbacks)),o=jv(s,1,!1,null,null,u,p,v,_,A,O,null),s[ga]=o.current,J0(s),new dh(o)},Ql.hydrateRoot=function(s,o,u){if(!a(s))throw Error(r(299));var p=!1,v="",_=dx,A=hx,O=mx,te=null,de=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onUncaughtError!==void 0&&(_=u.onUncaughtError),u.onCaughtError!==void 0&&(A=u.onCaughtError),u.onRecoverableError!==void 0&&(O=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(te=u.unstable_transitionCallbacks),u.formState!==void 0&&(de=u.formState)),o=jv(s,1,!0,o,u??null,p,v,_,A,O,te,de),o.context=Vv(null),u=o.current,p=Sr(),p=Dr(p),v=ls(p),v.callback=null,cs(u,v,p),u=p,o.current.lanes=u,Fe(o,u),wa(o),s[ga]=o.current,J0(s),new nf(o)},Ql.version="19.1.0",Ql}var i1;function jb(){if(i1)return ph.exports;i1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),ph.exports=Bb(),ph.exports}var Vb=jb();const Hb=bm(Vb);var ba=(t=>(t.NOT_STARTED="Not Started",t.IN_PROGRESS="In Progress",t.COMPLETED="Completed",t))(ba||{}),Bh=(t=>(t.PENDING="pending",t.ACHIEVED="achieved",t.MISSED="missed",t))(Bh||{}),_t=(t=>(t.NOT_STARTED="Not Started",t.IN_PROGRESS="In Progress",t.COMPLETED="Completed",t.BLOCKED="Blocked",t))(_t||{}),pr=(t=>(t[t.INPUT_FORM=0]="INPUT_FORM",t[t.PROJECT_FLOW=1]="PROJECT_FLOW",t[t.TASK_DETAIL=2]="TASK_DETAIL",t))(pr||{}),Rt;(function(t){t.assertEqual=a=>{};function e(a){}t.assertIs=e;function n(a){throw new Error}t.assertNever=n,t.arrayToEnum=a=>{const i={};for(const l of a)i[l]=l;return i},t.getValidEnumValues=a=>{const i=t.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),l={};for(const c of i)l[c]=a[c];return t.objectValues(l)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&i.push(l);return i},t.find=(a,i)=>{for(const l of a)if(i(l))return l},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,i=" | "){return a.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Rt||(Rt={}));var o1;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(o1||(o1={}));const ze=Rt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ns=t=>{switch(typeof t){case"undefined":return ze.undefined;case"string":return ze.string;case"number":return Number.isNaN(t)?ze.nan:ze.number;case"boolean":return ze.boolean;case"function":return ze.function;case"bigint":return ze.bigint;case"symbol":return ze.symbol;case"object":return Array.isArray(t)?ze.array:t===null?ze.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ze.promise:typeof Map<"u"&&t instanceof Map?ze.map:typeof Set<"u"&&t instanceof Set?ze.set:typeof Date<"u"&&t instanceof Date?ze.date:ze.object;default:return ze.unknown}},Le=Rt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Qa extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(i){return i.message},r={_errors:[]},a=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(a);else if(l.code==="invalid_return_type")a(l.returnTypeError);else if(l.code==="invalid_arguments")a(l.argumentsError);else if(l.path.length===0)r._errors.push(n(l));else{let c=r,d=0;for(;d<l.path.length;){const f=l.path[d];d===l.path.length-1?(c[f]=c[f]||{_errors:[]},c[f]._errors.push(n(l))):c[f]=c[f]||{_errors:[]},c=c[f],d++}}};return a(this),r}static assert(e){if(!(e instanceof Qa))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Rt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const a of this.issues)if(a.path.length>0){const i=a.path[0];n[i]=n[i]||[],n[i].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Qa.create=t=>new Qa(t);const jh=(t,e)=>{let n;switch(t.code){case Le.invalid_type:t.received===ze.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Le.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Rt.jsonStringifyReplacer)}`;break;case Le.unrecognized_keys:n=`Unrecognized key(s) in object: ${Rt.joinValues(t.keys,", ")}`;break;case Le.invalid_union:n="Invalid input";break;case Le.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Rt.joinValues(t.options)}`;break;case Le.invalid_enum_value:n=`Invalid enum value. Expected ${Rt.joinValues(t.options)}, received '${t.received}'`;break;case Le.invalid_arguments:n="Invalid function arguments";break;case Le.invalid_return_type:n="Invalid function return type";break;case Le.invalid_date:n="Invalid date";break;case Le.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Rt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Le.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Le.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Le.custom:n="Invalid input";break;case Le.invalid_intersection_types:n="Intersection results could not be merged";break;case Le.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Le.not_finite:n="Number must be finite";break;default:n=e.defaultError,Rt.assertNever(t)}return{message:n}};let Gb=jh;function $b(){return Gb}const zb=t=>{const{data:e,path:n,errorMaps:r,issueData:a}=t,i=[...n,...a.path||[]],l={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let c="";const d=r.filter(f=>!!f).slice().reverse();for(const f of d)c=f(l,{data:e,defaultError:c}).message;return{...a,path:i,message:c}};function Ge(t,e){const n=$b(),r=zb({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===jh?void 0:jh].filter(a=>!!a)});t.common.issues.push(r)}class or{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const a of n){if(a.status==="aborted")return at;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const a of n){const i=await a.key,l=await a.value;r.push({key:i,value:l})}return or.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const a of n){const{key:i,value:l}=a;if(i.status==="aborted"||l.status==="aborted")return at;i.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||a.alwaysSet)&&(r[i.value]=l.value)}return{status:e.value,value:r}}}const at=Object.freeze({status:"aborted"}),rc=t=>({status:"dirty",value:t}),Kr=t=>({status:"valid",value:t}),l1=t=>t.status==="aborted",c1=t=>t.status==="dirty",jo=t=>t.status==="valid",Cf=t=>typeof Promise<"u"&&t instanceof Promise;var Ye;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Ye||(Ye={}));class Na{constructor(e,n,r,a){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const u1=(t,e)=>{if(jo(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Qa(t.common.issues);return this._error=n,this._error}}};function dt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:a}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(l,c)=>{const{message:d}=t;return l.code==="invalid_enum_value"?{message:d??c.defaultError}:typeof c.data>"u"?{message:d??r??c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:d??n??c.defaultError}},description:a}}class Et{get description(){return this._def.description}_getType(e){return Ns(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Ns(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new or,ctx:{common:e.parent.common,data:e.data,parsedType:Ns(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Cf(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ns(e)},a=this._parseSync({data:e,path:r.path,parent:r});return u1(r,a)}"~validate"(e){var r,a;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ns(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:n});return jo(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(a=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(i=>jo(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ns(e)},a=this._parse({data:e,path:r.path,parent:r}),i=await(Cf(a)?a:Promise.resolve(a));return u1(r,i)}refine(e,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,i)=>{const l=e(a),c=()=>i.addIssue({code:Le.custom,...r(a)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,n){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(e){return new Go({schema:this,typeName:nt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Os.create(this,this._def)}nullable(){return $o.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ka.create(this)}promise(){return Df.create(this,this._def)}or(e){return kf.create([this,e],this._def)}and(e){return Nf.create(this,e,this._def)}transform(e){return new Go({...dt(this._def),schema:this,typeName:nt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new $h({...dt(this._def),innerType:this,defaultValue:n,typeName:nt.ZodDefault})}brand(){return new mC({typeName:nt.ZodBranded,type:this,...dt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new zh({...dt(this._def),innerType:this,catchValue:n,typeName:nt.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Am.create(this,e)}readonly(){return qh.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const qb=/^c[^\s-]{8,}$/i,Yb=/^[0-9a-z]+$/,Jb=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Wb=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Kb=/^[a-z0-9_-]{21}$/i,Xb=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Zb=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Qb=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,eC="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let yh;const tC=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,nC=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,rC=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,aC=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,sC=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,iC=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,RT="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",oC=new RegExp(`^${RT}$`);function DT(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function lC(t){return new RegExp(`^${DT(t)}$`)}function cC(t){let e=`${RT}T${DT(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function uC(t,e){return!!((e==="v4"||!e)&&tC.test(t)||(e==="v6"||!e)&&rC.test(t))}function fC(t,e){if(!Xb.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function dC(t,e){return!!((e==="v4"||!e)&&nC.test(t)||(e==="v6"||!e)&&aC.test(t))}class Ca extends Et{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ze.string){const i=this._getOrReturnCtx(e);return Ge(i,{code:Le.invalid_type,expected:ze.string,received:i.parsedType}),at}const r=new or;let a;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),Ge(a,{code:Le.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),Ge(a,{code:Le.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const l=e.data.length>i.value,c=e.data.length<i.value;(l||c)&&(a=this._getOrReturnCtx(e,a),l?Ge(a,{code:Le.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&Ge(a,{code:Le.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Qb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"email",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")yh||(yh=new RegExp(eC,"u")),yh.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"emoji",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Wb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"uuid",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")Kb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"nanoid",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")qb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"cuid",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")Yb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"cuid2",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")Jb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"ulid",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),Ge(a,{validation:"url",code:Le.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"regex",code:Le.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Le.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Le.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Le.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?cC(i).test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Le.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?oC.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Le.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?lC(i).test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Le.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Zb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"duration",code:Le.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?uC(e.data,i.version)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"ip",code:Le.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?fC(e.data,i.alg)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"jwt",code:Le.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?dC(e.data,i.version)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"cidr",code:Le.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?sC.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"base64",code:Le.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?iC.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"base64url",code:Le.invalid_string,message:i.message}),r.dirty()):Rt.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(a=>e.test(a),{validation:n,code:Le.invalid_string,...Ye.errToObj(r)})}_addCheck(e){return new Ca({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Ye.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Ye.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Ye.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Ye.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Ye.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Ye.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Ye.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Ye.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Ye.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Ye.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Ye.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Ye.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Ye.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...Ye.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Ye.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Ye.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Ye.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Ye.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Ye.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Ye.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Ye.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Ye.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Ye.errToObj(n)})}nonempty(e){return this.min(1,Ye.errToObj(e))}trim(){return new Ca({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ca({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ca({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ca.create=t=>new Ca({checks:[],typeName:nt.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...dt(t)});function hC(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=n>r?n:r,i=Number.parseInt(t.toFixed(a).replace(".","")),l=Number.parseInt(e.toFixed(a).replace(".",""));return i%l/10**a}class xi extends Et{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ze.number){const i=this._getOrReturnCtx(e);return Ge(i,{code:Le.invalid_type,expected:ze.number,received:i.parsedType}),at}let r;const a=new or;for(const i of this._def.checks)i.kind==="int"?Rt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{code:Le.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Le.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Le.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?hC(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Le.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{code:Le.not_finite,message:i.message}),a.dirty()):Rt.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Ye.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Ye.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Ye.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ye.toString(n))}setLimit(e,n,r,a){return new xi({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Ye.toString(a)}]})}_addCheck(e){return new xi({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Ye.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ye.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ye.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ye.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ye.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ye.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Ye.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ye.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ye.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Rt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}xi.create=t=>new xi({checks:[],typeName:nt.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...dt(t)});class vi extends Et{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ze.bigint)return this._getInvalidInput(e);let r;const a=new or;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Le.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Le.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Le.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Rt.assertNever(i);return{status:a.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return Ge(n,{code:Le.invalid_type,expected:ze.bigint,received:n.parsedType}),at}gte(e,n){return this.setLimit("min",e,!0,Ye.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Ye.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Ye.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ye.toString(n))}setLimit(e,n,r,a){return new vi({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Ye.toString(a)}]})}_addCheck(e){return new vi({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ye.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ye.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ye.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ye.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ye.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}vi.create=t=>new vi({checks:[],typeName:nt.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...dt(t)});class Af extends Et{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ze.boolean){const r=this._getOrReturnCtx(e);return Ge(r,{code:Le.invalid_type,expected:ze.boolean,received:r.parsedType}),at}return Kr(e.data)}}Af.create=t=>new Af({typeName:nt.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...dt(t)});class Vo extends Et{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ze.date){const i=this._getOrReturnCtx(e);return Ge(i,{code:Le.invalid_type,expected:ze.date,received:i.parsedType}),at}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Ge(i,{code:Le.invalid_date}),at}const r=new or;let a;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(a=this._getOrReturnCtx(e,a),Ge(a,{code:Le.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(a=this._getOrReturnCtx(e,a),Ge(a,{code:Le.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Rt.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Vo({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Ye.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Ye.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Vo.create=t=>new Vo({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:nt.ZodDate,...dt(t)});class f1 extends Et{_parse(e){if(this._getType(e)!==ze.symbol){const r=this._getOrReturnCtx(e);return Ge(r,{code:Le.invalid_type,expected:ze.symbol,received:r.parsedType}),at}return Kr(e.data)}}f1.create=t=>new f1({typeName:nt.ZodSymbol,...dt(t)});class d1 extends Et{_parse(e){if(this._getType(e)!==ze.undefined){const r=this._getOrReturnCtx(e);return Ge(r,{code:Le.invalid_type,expected:ze.undefined,received:r.parsedType}),at}return Kr(e.data)}}d1.create=t=>new d1({typeName:nt.ZodUndefined,...dt(t)});class h1 extends Et{_parse(e){if(this._getType(e)!==ze.null){const r=this._getOrReturnCtx(e);return Ge(r,{code:Le.invalid_type,expected:ze.null,received:r.parsedType}),at}return Kr(e.data)}}h1.create=t=>new h1({typeName:nt.ZodNull,...dt(t)});class m1 extends Et{constructor(){super(...arguments),this._any=!0}_parse(e){return Kr(e.data)}}m1.create=t=>new m1({typeName:nt.ZodAny,...dt(t)});class Vh extends Et{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Kr(e.data)}}Vh.create=t=>new Vh({typeName:nt.ZodUnknown,...dt(t)});class Us extends Et{_parse(e){const n=this._getOrReturnCtx(e);return Ge(n,{code:Le.invalid_type,expected:ze.never,received:n.parsedType}),at}}Us.create=t=>new Us({typeName:nt.ZodNever,...dt(t)});class p1 extends Et{_parse(e){if(this._getType(e)!==ze.undefined){const r=this._getOrReturnCtx(e);return Ge(r,{code:Le.invalid_type,expected:ze.void,received:r.parsedType}),at}return Kr(e.data)}}p1.create=t=>new p1({typeName:nt.ZodVoid,...dt(t)});class ka extends Et{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),a=this._def;if(n.parsedType!==ze.array)return Ge(n,{code:Le.invalid_type,expected:ze.array,received:n.parsedType}),at;if(a.exactLength!==null){const l=n.data.length>a.exactLength.value,c=n.data.length<a.exactLength.value;(l||c)&&(Ge(n,{code:l?Le.too_big:Le.too_small,minimum:c?a.exactLength.value:void 0,maximum:l?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Ge(n,{code:Le.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Ge(n,{code:Le.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((l,c)=>a.type._parseAsync(new Na(n,l,n.path,c)))).then(l=>or.mergeArray(r,l));const i=[...n.data].map((l,c)=>a.type._parseSync(new Na(n,l,n.path,c)));return or.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new ka({...this._def,minLength:{value:e,message:Ye.toString(n)}})}max(e,n){return new ka({...this._def,maxLength:{value:e,message:Ye.toString(n)}})}length(e,n){return new ka({...this._def,exactLength:{value:e,message:Ye.toString(n)}})}nonempty(e){return this.min(1,e)}}ka.create=(t,e)=>new ka({type:t,minLength:null,maxLength:null,exactLength:null,typeName:nt.ZodArray,...dt(e)});function No(t){if(t instanceof Tn){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Os.create(No(r))}return new Tn({...t._def,shape:()=>e})}else return t instanceof ka?new ka({...t._def,type:No(t.element)}):t instanceof Os?Os.create(No(t.unwrap())):t instanceof $o?$o.create(No(t.unwrap())):t instanceof yi?yi.create(t.items.map(e=>No(e))):t}class Tn extends Et{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Rt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==ze.object){const f=this._getOrReturnCtx(e);return Ge(f,{code:Le.invalid_type,expected:ze.object,received:f.parsedType}),at}const{status:r,ctx:a}=this._processInputParams(e),{shape:i,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof Us&&this._def.unknownKeys==="strip"))for(const f in a.data)l.includes(f)||c.push(f);const d=[];for(const f of l){const g=i[f],y=a.data[f];d.push({key:{status:"valid",value:f},value:g._parse(new Na(a,y,a.path,f)),alwaysSet:f in a.data})}if(this._def.catchall instanceof Us){const f=this._def.unknownKeys;if(f==="passthrough")for(const g of c)d.push({key:{status:"valid",value:g},value:{status:"valid",value:a.data[g]}});else if(f==="strict")c.length>0&&(Ge(a,{code:Le.unrecognized_keys,keys:c}),r.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const g of c){const y=a.data[g];d.push({key:{status:"valid",value:g},value:f._parse(new Na(a,y,a.path,g)),alwaysSet:g in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const f=[];for(const g of d){const y=await g.key,T=await g.value;f.push({key:y,value:T,alwaysSet:g.alwaysSet})}return f}).then(f=>or.mergeObjectSync(r,f)):or.mergeObjectSync(r,d)}get shape(){return this._def.shape()}strict(e){return Ye.errToObj,new Tn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var i,l;const a=((l=(i=this._def).errorMap)==null?void 0:l.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:Ye.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new Tn({...this._def,unknownKeys:"strip"})}passthrough(){return new Tn({...this._def,unknownKeys:"passthrough"})}extend(e){return new Tn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Tn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:nt.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Tn({...this._def,catchall:e})}pick(e){const n={};for(const r of Rt.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Tn({...this._def,shape:()=>n})}omit(e){const n={};for(const r of Rt.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new Tn({...this._def,shape:()=>n})}deepPartial(){return No(this)}partial(e){const n={};for(const r of Rt.objectKeys(this.shape)){const a=this.shape[r];e&&!e[r]?n[r]=a:n[r]=a.optional()}return new Tn({...this._def,shape:()=>n})}required(e){const n={};for(const r of Rt.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Os;)i=i._def.innerType;n[r]=i}return new Tn({...this._def,shape:()=>n})}keyof(){return MT(Rt.objectKeys(this.shape))}}Tn.create=(t,e)=>new Tn({shape:()=>t,unknownKeys:"strip",catchall:Us.create(),typeName:nt.ZodObject,...dt(e)});Tn.strictCreate=(t,e)=>new Tn({shape:()=>t,unknownKeys:"strict",catchall:Us.create(),typeName:nt.ZodObject,...dt(e)});Tn.lazycreate=(t,e)=>new Tn({shape:t,unknownKeys:"strip",catchall:Us.create(),typeName:nt.ZodObject,...dt(e)});class kf extends Et{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function a(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return n.common.issues.push(...c.ctx.common.issues),c.result;const l=i.map(c=>new Qa(c.ctx.common.issues));return Ge(n,{code:Le.invalid_union,unionErrors:l}),at}if(n.common.async)return Promise.all(r.map(async i=>{const l={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:l}),ctx:l}})).then(a);{let i;const l=[];for(const d of r){const f={...n,common:{...n.common,issues:[]},parent:null},g=d._parseSync({data:n.data,path:n.path,parent:f});if(g.status==="valid")return g;g.status==="dirty"&&!i&&(i={result:g,ctx:f}),f.common.issues.length&&l.push(f.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const c=l.map(d=>new Qa(d));return Ge(n,{code:Le.invalid_union,unionErrors:c}),at}}get options(){return this._def.options}}kf.create=(t,e)=>new kf({options:t,typeName:nt.ZodUnion,...dt(e)});function Hh(t,e){const n=Ns(t),r=Ns(e);if(t===e)return{valid:!0,data:t};if(n===ze.object&&r===ze.object){const a=Rt.objectKeys(e),i=Rt.objectKeys(t).filter(c=>a.indexOf(c)!==-1),l={...t,...e};for(const c of i){const d=Hh(t[c],e[c]);if(!d.valid)return{valid:!1};l[c]=d.data}return{valid:!0,data:l}}else if(n===ze.array&&r===ze.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let i=0;i<t.length;i++){const l=t[i],c=e[i],d=Hh(l,c);if(!d.valid)return{valid:!1};a.push(d.data)}return{valid:!0,data:a}}else return n===ze.date&&r===ze.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Nf extends Et{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=(i,l)=>{if(l1(i)||l1(l))return at;const c=Hh(i.value,l.value);return c.valid?((c1(i)||c1(l))&&n.dirty(),{status:n.value,value:c.data}):(Ge(r,{code:Le.invalid_intersection_types}),at)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,l])=>a(i,l)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Nf.create=(t,e,n)=>new Nf({left:t,right:e,typeName:nt.ZodIntersection,...dt(n)});class yi extends Et{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ze.array)return Ge(r,{code:Le.invalid_type,expected:ze.array,received:r.parsedType}),at;if(r.data.length<this._def.items.length)return Ge(r,{code:Le.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),at;!this._def.rest&&r.data.length>this._def.items.length&&(Ge(r,{code:Le.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((l,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new Na(r,l,r.path,c)):null}).filter(l=>!!l);return r.common.async?Promise.all(i).then(l=>or.mergeArray(n,l)):or.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new yi({...this._def,rest:e})}}yi.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new yi({items:t,typeName:nt.ZodTuple,rest:null,...dt(e)})};class Rf extends Et{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ze.object)return Ge(r,{code:Le.invalid_type,expected:ze.object,received:r.parsedType}),at;const a=[],i=this._def.keyType,l=this._def.valueType;for(const c in r.data)a.push({key:i._parse(new Na(r,c,r.path,c)),value:l._parse(new Na(r,r.data[c],r.path,c)),alwaysSet:c in r.data});return r.common.async?or.mergeObjectAsync(n,a):or.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof Et?new Rf({keyType:e,valueType:n,typeName:nt.ZodRecord,...dt(r)}):new Rf({keyType:Ca.create(),valueType:e,typeName:nt.ZodRecord,...dt(n)})}}class g1 extends Et{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ze.map)return Ge(r,{code:Le.invalid_type,expected:ze.map,received:r.parsedType}),at;const a=this._def.keyType,i=this._def.valueType,l=[...r.data.entries()].map(([c,d],f)=>({key:a._parse(new Na(r,c,r.path,[f,"key"])),value:i._parse(new Na(r,d,r.path,[f,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of l){const f=await d.key,g=await d.value;if(f.status==="aborted"||g.status==="aborted")return at;(f.status==="dirty"||g.status==="dirty")&&n.dirty(),c.set(f.value,g.value)}return{status:n.value,value:c}})}else{const c=new Map;for(const d of l){const f=d.key,g=d.value;if(f.status==="aborted"||g.status==="aborted")return at;(f.status==="dirty"||g.status==="dirty")&&n.dirty(),c.set(f.value,g.value)}return{status:n.value,value:c}}}}g1.create=(t,e,n)=>new g1({valueType:e,keyType:t,typeName:nt.ZodMap,...dt(n)});class Cc extends Et{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ze.set)return Ge(r,{code:Le.invalid_type,expected:ze.set,received:r.parsedType}),at;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(Ge(r,{code:Le.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(Ge(r,{code:Le.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const i=this._def.valueType;function l(d){const f=new Set;for(const g of d){if(g.status==="aborted")return at;g.status==="dirty"&&n.dirty(),f.add(g.value)}return{status:n.value,value:f}}const c=[...r.data.values()].map((d,f)=>i._parse(new Na(r,d,r.path,f)));return r.common.async?Promise.all(c).then(d=>l(d)):l(c)}min(e,n){return new Cc({...this._def,minSize:{value:e,message:Ye.toString(n)}})}max(e,n){return new Cc({...this._def,maxSize:{value:e,message:Ye.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Cc.create=(t,e)=>new Cc({valueType:t,minSize:null,maxSize:null,typeName:nt.ZodSet,...dt(e)});class Gh extends Et{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Gh.create=(t,e)=>new Gh({getter:t,typeName:nt.ZodLazy,...dt(e)});class x1 extends Et{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Ge(n,{received:n.data,code:Le.invalid_literal,expected:this._def.value}),at}return{status:"valid",value:e.data}}get value(){return this._def.value}}x1.create=(t,e)=>new x1({value:t,typeName:nt.ZodLiteral,...dt(e)});function MT(t,e){return new Ho({values:t,typeName:nt.ZodEnum,...dt(e)})}class Ho extends Et{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Ge(n,{expected:Rt.joinValues(r),received:n.parsedType,code:Le.invalid_type}),at}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return Ge(n,{received:n.data,code:Le.invalid_enum_value,options:r}),at}return Kr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Ho.create(e,{...this._def,...n})}exclude(e,n=this._def){return Ho.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}Ho.create=MT;class v1 extends Et{_parse(e){const n=Rt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ze.string&&r.parsedType!==ze.number){const a=Rt.objectValues(n);return Ge(r,{expected:Rt.joinValues(a),received:r.parsedType,code:Le.invalid_type}),at}if(this._cache||(this._cache=new Set(Rt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const a=Rt.objectValues(n);return Ge(r,{received:r.data,code:Le.invalid_enum_value,options:a}),at}return Kr(e.data)}get enum(){return this._def.values}}v1.create=(t,e)=>new v1({values:t,typeName:nt.ZodNativeEnum,...dt(e)});class Df extends Et{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ze.promise&&n.common.async===!1)return Ge(n,{code:Le.invalid_type,expected:ze.promise,received:n.parsedType}),at;const r=n.parsedType===ze.promise?n.data:Promise.resolve(n.data);return Kr(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Df.create=(t,e)=>new Df({type:t,typeName:nt.ZodPromise,...dt(e)});class Go extends Et{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===nt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:l=>{Ge(r,l),l.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const l=a.transform(r.data,i);if(r.common.async)return Promise.resolve(l).then(async c=>{if(n.value==="aborted")return at;const d=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return d.status==="aborted"?at:d.status==="dirty"||n.value==="dirty"?rc(d.value):d});{if(n.value==="aborted")return at;const c=this._def.schema._parseSync({data:l,path:r.path,parent:r});return c.status==="aborted"?at:c.status==="dirty"||n.value==="dirty"?rc(c.value):c}}if(a.type==="refinement"){const l=c=>{const d=a.refinement(c,i);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?at:(c.status==="dirty"&&n.dirty(),l(c.value),{status:n.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?at:(c.status==="dirty"&&n.dirty(),l(c.value).then(()=>({status:n.value,value:c.value}))))}if(a.type==="transform")if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!jo(l))return at;const c=a.transform(l.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>jo(l)?Promise.resolve(a.transform(l.value,i)).then(c=>({status:n.value,value:c})):at);Rt.assertNever(a)}}Go.create=(t,e,n)=>new Go({schema:t,typeName:nt.ZodEffects,effect:e,...dt(n)});Go.createWithPreprocess=(t,e,n)=>new Go({schema:e,effect:{type:"preprocess",transform:t},typeName:nt.ZodEffects,...dt(n)});class Os extends Et{_parse(e){return this._getType(e)===ze.undefined?Kr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Os.create=(t,e)=>new Os({innerType:t,typeName:nt.ZodOptional,...dt(e)});class $o extends Et{_parse(e){return this._getType(e)===ze.null?Kr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}$o.create=(t,e)=>new $o({innerType:t,typeName:nt.ZodNullable,...dt(e)});class $h extends Et{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===ze.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}$h.create=(t,e)=>new $h({innerType:t,typeName:nt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...dt(e)});class zh extends Et{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Cf(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Qa(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Qa(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}zh.create=(t,e)=>new zh({innerType:t,typeName:nt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...dt(e)});class y1 extends Et{_parse(e){if(this._getType(e)!==ze.nan){const r=this._getOrReturnCtx(e);return Ge(r,{code:Le.invalid_type,expected:ze.nan,received:r.parsedType}),at}return{status:"valid",value:e.data}}}y1.create=t=>new y1({typeName:nt.ZodNaN,...dt(t)});class mC extends Et{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Am extends Et{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?at:i.status==="dirty"?(n.dirty(),rc(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?at:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,n){return new Am({in:e,out:n,typeName:nt.ZodPipeline})}}class qh extends Et{_parse(e){const n=this._def.innerType._parse(e),r=a=>(jo(a)&&(a.value=Object.freeze(a.value)),a);return Cf(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}qh.create=(t,e)=>new qh({innerType:t,typeName:nt.ZodReadonly,...dt(e)});var nt;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(nt||(nt={}));const ci=Ca.create,_1=xi.create;vi.create;const pC=Af.create;Vo.create;const T1=Vh.create;Us.create;const ac=ka.create,gC=Tn.create,xC=kf.create;Nf.create;yi.create;const vC=Rf.create,yC=Gh.create,_C=Ho.create;Df.create;Os.create;$o.create;const go={string:t=>Ca.create({...t,coerce:!0}),number:t=>xi.create({...t,coerce:!0}),boolean:t=>Af.create({...t,coerce:!0}),bigint:t=>vi.create({...t,coerce:!0}),date:t=>Vo.create({...t,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let TC,wC;function EC(){return{geminiUrl:TC,vertexUrl:wC}}function SC(t,e,n){var r,a,i;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=EC();return t.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:e:(i=l.geminiUrl)!==null&&i!==void 0?i:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ai{}function Je(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,a)=>{if(Object.prototype.hasOwnProperty.call(e,a)){const i=e[a];return i!=null?String(i):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function m(t,e,n){for(let i=0;i<e.length-1;i++){const l=e[i];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in t))if(Array.isArray(n))t[c]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(t[c])){const d=t[c];if(Array.isArray(n))for(let f=0;f<d.length;f++){const g=d[f];m(g,e.slice(i+1),n[f])}else for(const f of d)m(f,e.slice(i+1),n)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in t||(t[c]=[{}]);const d=t[c];m(d[0],e.slice(i+1),n);return}(!t[l]||typeof t[l]!="object")&&(t[l]={}),t=t[l]}const r=e[e.length-1],a=t[r];if(a!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===a)return;if(typeof a=="object"&&typeof n=="object"&&a!==null&&n!==null)Object.assign(a,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function h(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in t){const i=t[a];return Array.isArray(i)?i.map(l=>h(l,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var w1;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(w1||(w1={}));var E1;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(E1||(E1={}));var Aa;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Aa||(Aa={}));var S1;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(S1||(S1={}));var b1;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(b1||(b1={}));var C1;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(C1||(C1={}));var A1;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(A1||(A1={}));var k1;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(k1||(k1={}));var N1;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(N1||(N1={}));var R1;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(R1||(R1={}));var D1;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(D1||(D1={}));var M1;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(M1||(M1={}));var I1;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(I1||(I1={}));var F1;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(F1||(F1={}));var O1;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(O1||(O1={}));var L1;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(L1||(L1={}));var Mf;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Mf||(Mf={}));var P1;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(P1||(P1={}));var Yh;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Yh||(Yh={}));var U1;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(U1||(U1={}));var B1;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(B1||(B1={}));var j1;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(j1||(j1={}));var V1;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(V1||(V1={}));var H1;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(H1||(H1={}));var G1;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(G1||(G1={}));var $1;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})($1||($1={}));var z1;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(z1||(z1={}));var q1;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(q1||(q1={}));var Y1;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Y1||(Y1={}));var J1;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(J1||(J1={}));var W1;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(W1||(W1={}));var K1;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(K1||(K1={}));var X1;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(X1||(X1={}));var Z1;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Z1||(Z1={}));var Q1;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Q1||(Q1={}));var ey;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(ey||(ey={}));var ty;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(ty||(ty={}));var ny;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(ny||(ny={}));var ry;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ry||(ry={}));var ay;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(ay||(ay={}));var sy;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(sy||(sy={}));var Mo;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Mo||(Mo={}));class Jh{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class ec{get text(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",g=!1;const y=[];for(const T of(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[w,E]of Object.entries(T))w!=="text"&&w!=="thought"&&(E!==null||E!==void 0)&&y.push(w);if(typeof T.text=="string"){if(typeof T.thought=="boolean"&&T.thought)continue;g=!0,f+=T.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?f:void 0}get data(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const g=[];for(const y of(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[T,w]of Object.entries(y))T!=="inlineData"&&(w!==null||w!==void 0)&&g.push(T);y.inlineData&&typeof y.inlineData.data=="string"&&(f+=atob(y.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var e,n,r,a,i,l,c,d,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,n,r,a,i,l,c,d,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.output}}class iy{}class oy{}class bC{}class CC{}class ly{}class cy{}class uy{}class AC{}class fy{}class dy{}class hy{}class kC{}class NC{}class RC{}class my{}class DC{get text(){var e,n,r;let a="",i=!1;const l=[];for(const c of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(c))d!=="text"&&d!=="thought"&&f!==null&&l.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;i=!0,a+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?a:void 0}get data(){var e,n,r;let a="";const i=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(l))c!=="inlineData"&&d!==null&&i.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class MC{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ut(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function IT(t,e){const n=Ut(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function FT(t){return Array.isArray(t)?t.map(e=>If(e)):[If(t)]}function If(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function OT(t){const e=If(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function LT(t){const e=If(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function py(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function PT(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>py(e)):[py(t)]}function Wh(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function gy(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function xy(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function Kn(t){if(t==null)throw new Error("ContentUnion is required");return Wh(t)?t:{role:"user",parts:PT(t)}}function UT(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=Kn(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=Kn(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>Kn(n)):[Kn(e)]}function Jr(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(gy(t)||xy(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Kn(t)]}const e=[],n=[],r=Wh(t[0]);for(const a of t){const i=Wh(a);if(i!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(i)e.push(a);else{if(gy(a)||xy(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||e.push({role:"user",parts:PT(n)}),e}const IC=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),vy=_C(["string","number","integer","object","array","boolean","null"]),FC=xC([vy,ac(vy)]);function OC(t=!0){const e=yC(()=>{const n=gC({type:FC.optional(),format:ci().optional(),title:ci().optional(),description:ci().optional(),default:T1().optional(),items:e.optional(),minItems:go.string().optional(),maxItems:go.string().optional(),enum:ac(T1()).optional(),properties:vC(ci(),e).optional(),required:ac(ci()).optional(),minProperties:go.string().optional(),maxProperties:go.string().optional(),propertyOrdering:ac(ci()).optional(),minimum:_1().optional(),maximum:_1().optional(),minLength:go.string().optional(),maxLength:go.string().optional(),pattern:ci().optional(),anyOf:ac(e).optional(),additionalProperties:pC().optional()});return t?n.strict():n});return e}function LC(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Aa).includes(n[0].toUpperCase())?n[0].toUpperCase():Aa.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Aa).includes(r.toUpperCase())?r.toUpperCase():Aa.TYPE_UNSPECIFIED})}}function Fo(t){const e={},n=["items"],r=["anyOf"],a=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const i=t.anyOf;i!=null&&i.length==2&&(i[0].type==="null"?(e.nullable=!0,t=i[1]):i[1].type==="null"&&(e.nullable=!0,t=i[0])),t.type instanceof Array&&LC(t.type,e);for(const[l,c]of Object.entries(t))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(Aa).includes(c.toUpperCase())?c.toUpperCase():Aa.TYPE_UNSPECIFIED}else if(n.includes(l))e[l]=Fo(c);else if(r.includes(l)){const d=[];for(const f of c){if(f.type=="null"){e.nullable=!0;continue}d.push(Fo(f))}e[l]=d}else if(a.includes(l)){const d={};for(const[f,g]of Object.entries(c))d[f]=Fo(g);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=c}return e}function Ac(t){if(Object.keys(t).includes("$schema")){delete t.$schema;const e=OC().parse(t);return Fo(e)}else return Fo(t)}function km(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Nm(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ko(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(e.parameters=Ac(e.parameters)),e.response&&(e.response=Ac(e.response));return t}function Xo(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function PC(t,e,n,r=1){const a=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:a?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:a?`${n}/${e}`:e}function ns(t,e){if(typeof e!="string")throw new Error("name must be a string");return PC(t,e,"cachedContents")}function BT(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function rs(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function UC(t){return t!=null&&typeof t=="object"&&"name"in t}function BC(t){return t!=null&&typeof t=="object"&&"video"in t}function jC(t){return t!=null&&typeof t=="object"&&"uri"in t}function jT(t){var e;let n;if(UC(t)&&(n=t.name),!(jC(t)&&(n=t.uri,n===void 0))&&!(BC(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function VT(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function HT(t){for(const e of["models","tunedModels","publisherModels"])if(VC(t,e))return t[e];return[]}function VC(t,e){return t!==null&&typeof t=="object"&&e in t}function HC(t,e={}){const n=t,r={name:n.name,description:n.description,parameters:Fo(Kf(n.inputSchema))};return e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function GC(t,e={}){const n=[],r=new Set;for(const a of t){const i=a.name;if(r.has(i))throw new Error(`Duplicate function name ${i} found in MCP tools. Please ensure function names are unique.`);r.add(i);const l=HC(a,e);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function $C(t){const e=[];for(const n of t)e.push(Kf(n));return e}function zC(t){const e={};for(const[n,r]of Object.entries(t)){const a=r;e[n]=Kf(a)}return e}function Kf(t){const e=new Set(["items"]),n=new Set(["anyOf"]),r=new Set(["properties"]),a={};for(const[i,l]of Object.entries(t))if(e.has(i))a[i]=Kf(l);else if(n.has(i))a[i]=$C(l);else if(r.has(i))a[i]=zC(l);else if(i==="type"){const c=l.toUpperCase();a[i]=Object.values(Aa).includes(c)?c:Aa.TYPE_UNSPECIFIED}else IC.has(i)&&(a[i]=l);return a}function GT(t,e){if(typeof e!="string"&&!Array.isArray(e)){if(t&&t.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function qC(t){const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Zo(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function $T(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YC(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function JC(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function WC(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function KC(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],YC(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],JC(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],WC(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function zT(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>KC(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function XC(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const y=h(t,["maxProperties"]);y!=null&&m(e,["maxProperties"],y);const T=h(t,["maximum"]);T!=null&&m(e,["maximum"],T);const w=h(t,["minItems"]);w!=null&&m(e,["minItems"],w);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const b=h(t,["minimum"]);b!=null&&m(e,["minimum"],b);const N=h(t,["nullable"]);N!=null&&m(e,["nullable"],N);const k=h(t,["pattern"]);k!=null&&m(e,["pattern"],k);const C=h(t,["properties"]);C!=null&&m(e,["properties"],C);const P=h(t,["propertyOrdering"]);P!=null&&m(e,["propertyOrdering"],P);const j=h(t,["required"]);j!=null&&m(e,["required"],j);const H=h(t,["title"]);H!=null&&m(e,["title"],H);const L=h(t,["type"]);return L!=null&&m(e,["type"],L),e}function ZC(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function QC(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function eA(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function tA(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],eA(n)),e}function nA(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function rA(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],nA(n)),e}function aA(){return{}}function sA(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>QC(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],tA(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],rA(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],aA());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function iA(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function oA(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function lA(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],oA(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function cA(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],iA(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],lA(r)),e}function uA(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function qT(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],uA(n)),e}function fA(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],qT(r)),e}function dA(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>fA(a))),m(e,["speakerVoiceConfigs"],r)}return e}function hA(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],qT(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],dA(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function mA(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function pA(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],zT(Kn(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const y=h(e,["responseLogprobs"]);y!=null&&m(r,["responseLogprobs"],y);const T=h(e,["logprobs"]);T!=null&&m(r,["logprobs"],T);const w=h(e,["presencePenalty"]);w!=null&&m(r,["presencePenalty"],w);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const b=h(e,["responseMimeType"]);b!=null&&m(r,["responseMimeType"],b);const N=h(e,["responseSchema"]);N!=null&&m(r,["responseSchema"],XC(Ac(N)));const k=h(e,["responseJsonSchema"]);if(k!=null&&m(r,["responseJsonSchema"],k),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=h(e,["safetySettings"]);if(n!==void 0&&C!=null){let X=C;Array.isArray(X)&&(X=X.map(ee=>ZC(ee))),m(n,["safetySettings"],X)}const P=h(e,["tools"]);if(n!==void 0&&P!=null){let X=Xo(P);Array.isArray(X)&&(X=X.map(ee=>sA(Ko(ee)))),m(n,["tools"],X)}const j=h(e,["toolConfig"]);if(n!==void 0&&j!=null&&m(n,["toolConfig"],cA(j)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=h(e,["cachedContent"]);n!==void 0&&H!=null&&m(n,["cachedContent"],ns(t,H));const L=h(e,["responseModalities"]);L!=null&&m(r,["responseModalities"],L);const K=h(e,["mediaResolution"]);K!=null&&m(r,["mediaResolution"],K);const M=h(e,["speechConfig"]);if(M!=null&&m(r,["speechConfig"],hA(km(M))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=h(e,["thinkingConfig"]);return Q!=null&&m(r,["thinkingConfig"],mA(Q)),r}function gA(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["request","model"],Ut(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>zT(c))),m(n,["request","contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["request","generationConfig"],pA(t,i,n)),n}function xA(t,e){const n={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=h(e,["fileName"]);r!=null&&m(n,["fileName"],r);const a=h(e,["inlinedRequests"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>gA(t,l))),m(n,["requests","requests"],i)}return n}function vA(t,e){const n={},r=h(t,["displayName"]);if(e!==void 0&&r!=null&&m(e,["batch","displayName"],r),h(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function yA(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["src"]);a!=null&&m(n,["batch","inputConfig"],xA(t,GT(t,a)));const i=h(e,["config"]);return i!=null&&m(n,["config"],vA(i,n)),n}function _A(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Zo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function TA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Zo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function wA(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);if(e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),h(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function EA(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],wA(n,e)),e}function SA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Zo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function bA(t){const e={},n=h(t,["format"]);n!=null&&m(e,["instancesFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsSource","uris"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigquerySource","inputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function CA(t){const e={},n=h(t,["format"]);n!=null&&m(e,["predictionsFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsDestination","outputUriPrefix"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigqueryDestination","outputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function AA(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["dest"]);return e!==void 0&&a!=null&&m(e,["outputConfig"],CA(qC(a))),n}function kA(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],Ut(t,r));const a=h(e,["src"]);a!=null&&m(n,["inputConfig"],bA(GT(t,a)));const i=h(e,["config"]);return i!=null&&m(n,["config"],AA(i,n)),n}function NA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Zo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function RA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Zo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function DA(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function MA(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],DA(n,e)),e}function IA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],Zo(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function YT(){return{}}function FA(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function OA(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function LA(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function PA(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],FA(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],OA(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],LA(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function UA(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>PA(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function BA(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function jA(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function VA(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>jA(a))),m(e,["urlMetadata"],r)}return e}function HA(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],UA(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],BA(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],VA(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const y=h(t,["safetyRatings"]);return y!=null&&m(e,["safetyRatings"],y),e}function GA(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>HA(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const i=h(t,["usageMetadata"]);return i!=null&&m(e,["usageMetadata"],i),e}function $A(t){const e={},n=h(t,["response"]);return n!=null&&m(e,["response"],GA(n)),h(t,["error"])!=null&&m(e,["error"],YT()),e}function zA(t){const e={},n=h(t,["responsesFile"]);n!=null&&m(e,["fileName"],n);const r=h(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>$A(i))),m(e,["inlinedResponses"],a)}return e}function Kh(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata","displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["metadata","state"]);a!=null&&m(e,["state"],$T(a));const i=h(t,["metadata","createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["metadata","endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["metadata","updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["metadata","model"]);d!=null&&m(e,["model"],d);const f=h(t,["metadata","output"]);return f!=null&&m(e,["dest"],zA(f)),e}function qA(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Kh(i))),m(e,["batchJobs"],a)}return e}function YA(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);return r!=null&&m(e,["done"],r),h(t,["error"])!=null&&m(e,["error"],YT()),e}function JT(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["code"]);r!=null&&m(e,["code"],r);const a=h(t,["message"]);return a!=null&&m(e,["message"],a),e}function JA(t){const e={},n=h(t,["instancesFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsSource","uris"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigquerySource","inputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function WA(t){const e={},n=h(t,["predictionsFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsDestination","outputUriPrefix"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigqueryDestination","outputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function Xh(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["state"]);a!=null&&m(e,["state"],$T(a));const i=h(t,["error"]);i!=null&&m(e,["error"],JT(i));const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["startTime"]);c!=null&&m(e,["startTime"],c);const d=h(t,["endTime"]);d!=null&&m(e,["endTime"],d);const f=h(t,["updateTime"]);f!=null&&m(e,["updateTime"],f);const g=h(t,["model"]);g!=null&&m(e,["model"],g);const y=h(t,["inputConfig"]);y!=null&&m(e,["src"],JA(y));const T=h(t,["outputConfig"]);return T!=null&&m(e,["dest"],WA(T)),e}function KA(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Xh(i))),m(e,["batchJobs"],a)}return e}function XA(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);r!=null&&m(e,["done"],r);const a=h(t,["error"]);return a!=null&&m(e,["error"],JT(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var _i;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(_i||(_i={}));class Vc{constructor(e,n,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,a)}init(e,n,r){var a,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(i=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZA extends Ai{constructor(e){super(),this.apiClient=e,this.create=async n=>{if(this.apiClient.isVertexAI()){const a=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${a}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new Vc(_i.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=kA(this.apiClient,e);return c=Je("batchPredictionJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Xh(g))}else{const f=yA(this.apiClient,e);return c=Je("{model}:batchGenerateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Kh(g))}}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=NA(this.apiClient,e);return c=Je("batchPredictionJobs/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Xh(g))}else{const f=_A(this.apiClient,e);return c=Je("batches/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Kh(g))}}async cancel(e){var n,r,a,i;let l="",c={};if(this.apiClient.isVertexAI()){const d=RA(this.apiClient,e);l=Je("batchPredictionJobs/{name}:cancel",d._url),c=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const d=TA(this.apiClient,e);l=Je("batches/{name}:cancel",d._url),c=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=MA(e);return c=Je("batchPredictionJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=KA(g),T=new my;return Object.assign(T,y),T})}else{const f=EA(e);return c=Je("batches",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=qA(g),T=new my;return Object.assign(T,y),T})}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=IA(this.apiClient,e);return c=Je("batchPredictionJobs/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>XA(g))}else{const f=SA(this.apiClient,e);return c=Je("batches/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>YA(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QA(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function ek(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function tk(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function nk(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],QA(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],ek(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],tk(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function yy(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>nk(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function rk(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function ak(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function sk(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],ak(n)),e}function ik(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function ok(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],ik(n)),e}function lk(){return{}}function ck(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>rk(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],sk(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],ok(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],lk());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function uk(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function fk(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function dk(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],fk(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function hk(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],uk(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],dk(r)),e}function mk(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const i=h(t,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let g=Jr(l);Array.isArray(g)&&(g=g.map(y=>yy(y))),m(e,["contents"],g)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],yy(Kn(c)));const d=h(t,["tools"]);if(e!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(y=>ck(y))),m(e,["tools"],g)}const f=h(t,["toolConfig"]);if(e!==void 0&&f!=null&&m(e,["toolConfig"],hk(f)),h(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function pk(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],IT(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],mk(a,n)),n}function gk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ns(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function xk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ns(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function vk(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function yk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ns(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],vk(a,n)),n}function _k(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function Tk(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],_k(n,e)),e}function wk(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function Ek(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function Sk(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function bk(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],wk(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],Ek(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],Sk(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function _y(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>bk(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function Ck(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function Ak(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function kk(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],Ak(n)),e}function Nk(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function Rk(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],Nk(n)),e}function Dk(){return{}}function Mk(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function Ik(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],Mk(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function Fk(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],Ik(n)),e}function Ok(){return{}}function Lk(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(T=>Ck(T))),m(e,["functionDeclarations"],y)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],kk(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],Rk(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],Dk());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],Fk(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],Ok());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function Pk(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function Uk(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function Bk(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],Uk(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function jk(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],Pk(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],Bk(r)),e}function Vk(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const i=h(t,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let y=Jr(l);Array.isArray(y)&&(y=y.map(T=>_y(T))),m(e,["contents"],y)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],_y(Kn(c)));const d=h(t,["tools"]);if(e!==void 0&&d!=null){let y=d;Array.isArray(y)&&(y=y.map(T=>Lk(T))),m(e,["tools"],y)}const f=h(t,["toolConfig"]);e!==void 0&&f!=null&&m(e,["toolConfig"],jk(f));const g=h(t,["kmsKeyName"]);return e!==void 0&&g!=null&&m(e,["encryption_spec","kmsKeyName"],g),n}function Hk(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],IT(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],Vk(a,n)),n}function Gk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ns(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function $k(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ns(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function zk(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function qk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ns(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],zk(a,n)),n}function Yk(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function Jk(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],Yk(n,e)),e}function Ef(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const i=h(t,["createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const d=h(t,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function Wk(){return{}}function Kk(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Ef(i))),m(e,["cachedContents"],a)}return e}function Sf(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const i=h(t,["createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const d=h(t,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function Xk(){return{}}function Zk(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Sf(i))),m(e,["cachedContents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qk extends Ai{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Vc(_i.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=Hk(this.apiClient,e);return c=Je("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Sf(g))}else{const f=pk(this.apiClient,e);return c=Je("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Ef(g))}}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=Gk(this.apiClient,e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Sf(g))}else{const f=gk(this.apiClient,e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Ef(g))}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=$k(this.apiClient,e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=Xk(),y=new dy;return Object.assign(y,g),y})}else{const f=xk(this.apiClient,e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=Wk(),y=new dy;return Object.assign(y,g),y})}}async update(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=qk(this.apiClient,e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Sf(g))}else{const f=yk(this.apiClient,e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Ef(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=Jk(e);return c=Je("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=Zk(g),T=new hy;return Object.assign(T,y),T})}else{const f=Tk(e);return c=Je("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=Kk(g),T=new hy;return Object.assign(T,y),T})}}}function Ty(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kt(t){return this instanceof Kt?(this.v=t,this):new Kt(t)}function Oo(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),a,i=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(w){return function(E){return Promise.resolve(E).then(w,y)}}function c(w,E){r[w]&&(a[w]=function(S){return new Promise(function(b,N){i.push([w,S,b,N])>1||d(w,S)})},E&&(a[w]=E(a[w])))}function d(w,E){try{f(r[w](E))}catch(S){T(i[0][3],S)}}function f(w){w.value instanceof Kt?Promise.resolve(w.value.v).then(g,y):T(i[0][2],w)}function g(w){d("next",w)}function y(w){d("throw",w)}function T(w,E){w(E),i.shift(),i.length&&d(i[0][0],i[0][1])}}function fc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Ty=="function"?Ty(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(l){return new Promise(function(c,d){l=t[i](l),a(c,d,l.done,l.value)})}}function a(i,l,c,d){Promise.resolve(d).then(function(f){i({value:f,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function e4(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:WT(n)}function WT(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function t4(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function wy(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const a=[];let i=!0;for(;r<n&&t[r].role==="model";)a.push(t[r]),i&&!WT(t[r])&&(i=!1),r++;i?e.push(...a):e.pop()}return e}class n4{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new r4(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class r4{constructor(e,n,r,a={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=a,this.history=i,this.sendPromise=Promise.resolve(),t4(i)}async sendMessage(e){var n;await this.sendPromise;const r=Kn(e.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,l,c;const d=await a,f=(l=(i=d.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content,g=d.automaticFunctionCallingHistory,y=this.getHistory(!0).length;let T=[];g!=null&&(T=(c=g.slice(y))!==null&&c!==void 0?c:[]);const w=f?[f]:[];this.recordHistory(r,w,T)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(e){var n;await this.sendPromise;const r=Kn(e.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const i=await a;return this.processStreamResponse(i,r)}getHistory(e=!1){const n=e?wy(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,a;return Oo(this,arguments,function*(){var l,c,d,f;const g=[];try{for(var y=!0,T=fc(e),w;w=yield Kt(T.next()),l=w.done,!l;y=!0){f=w.value,y=!1;const E=f;if(e4(E)){const S=(a=(r=E.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;S!==void 0&&g.push(S)}yield yield Kt(E)}}catch(E){c={error:E}}finally{try{!y&&!l&&(d=T.return)&&(yield Kt(d.call(T)))}finally{if(c)throw c.error}}this.recordHistory(n,g)})}recordHistory(e,n,r){let a=[];n.length>0&&n.every(i=>i.role!==void 0)?a=n:a.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...wy(r)):this.history.push(e),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xf extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Xf.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function a4(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function s4(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],a4(n,e)),e}function i4(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function o4(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const i=h(t,["sizeBytes"]);i!=null&&m(e,["sizeBytes"],i);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const d=h(t,["updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(t,["sha256Hash"]);f!=null&&m(e,["sha256Hash"],f);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const y=h(t,["downloadUri"]);y!=null&&m(e,["downloadUri"],y);const T=h(t,["state"]);T!=null&&m(e,["state"],T);const w=h(t,["source"]);w!=null&&m(e,["source"],w);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],i4(S)),e}function l4(t){const e={},n=h(t,["file"]);n!=null&&m(e,["file"],o4(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function c4(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],jT(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function u4(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],jT(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function f4(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function Zh(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const i=h(t,["sizeBytes"]);i!=null&&m(e,["sizeBytes"],i);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const d=h(t,["updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(t,["sha256Hash"]);f!=null&&m(e,["sha256Hash"],f);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const y=h(t,["downloadUri"]);y!=null&&m(e,["downloadUri"],y);const T=h(t,["state"]);T!=null&&m(e,["state"],T);const w=h(t,["source"]);w!=null&&m(e,["source"],w);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],f4(S)),e}function d4(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Zh(i))),m(e,["files"],a)}return e}function h4(){return{}}function m4(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class p4 extends Ai{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Vc(_i.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>Zh(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=s4(e);return i=Je("files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=d4(d),g=new kC;return Object.assign(g,f),g})}}async createInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=l4(e);return i=Je("upload/v1beta/files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=h4(),f=new NC;return Object.assign(f,d),f})}}async get(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=c4(e);return i=Je("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>Zh(d))}}async delete(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=u4(e);return i=Je("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=m4(),f=new RC;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function g4(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function x4(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function KT(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],g4(n)),e}function v4(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],x4(n)),e}function y4(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],KT(r)),e}function _4(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>y4(a))),m(e,["speakerVoiceConfigs"],r)}return e}function T4(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],KT(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],_4(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function w4(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],v4(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function E4(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function S4(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function b4(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function C4(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function A4(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function k4(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function N4(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],E4(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],b4(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],A4(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function R4(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],S4(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],C4(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],k4(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function D4(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>N4(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function M4(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>R4(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function I4(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function F4(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function O4(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function L4(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function P4(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],O4(n)),e}function U4(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],L4(n)),e}function B4(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function j4(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function V4(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],B4(n)),e}function H4(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],j4(n)),e}function G4(){return{}}function $4(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function z4(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],$4(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function q4(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],z4(n)),e}function Y4(){return{}}function J4(){return{}}function W4(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>I4(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],P4(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],V4(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],Y4());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function K4(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(T=>F4(T))),m(e,["functionDeclarations"],y)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],U4(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],H4(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],G4());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],q4(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],J4());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function X4(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Z4(t){const e={},n=h(t,["handle"]);n!=null&&m(e,["handle"],n);const r=h(t,["transparent"]);return r!=null&&m(e,["transparent"],r),e}function Ey(){return{}}function Sy(){return{}}function Q4(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function eN(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function tN(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],Q4(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function nN(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],eN(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function rN(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function aN(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function sN(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],rN(r)),e}function iN(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],aN(r)),e}function oN(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function lN(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function cN(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const y=h(t,["speechConfig"]);e!==void 0&&y!=null&&m(e,["setup","generationConfig","speechConfig"],T4(Nm(y)));const T=h(t,["enableAffectiveDialog"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],T);const w=h(t,["systemInstruction"]);e!==void 0&&w!=null&&m(e,["setup","systemInstruction"],D4(Kn(w)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let j=Xo(E);Array.isArray(j)&&(j=j.map(H=>W4(Ko(H)))),m(e,["setup","tools"],j)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],X4(S));const b=h(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],Ey());const N=h(t,["outputAudioTranscription"]);e!==void 0&&N!=null&&m(e,["setup","outputAudioTranscription"],Ey());const k=h(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&m(e,["setup","realtimeInputConfig"],tN(k));const C=h(t,["contextWindowCompression"]);e!==void 0&&C!=null&&m(e,["setup","contextWindowCompression"],sN(C));const P=h(t,["proactivity"]);return e!==void 0&&P!=null&&m(e,["setup","proactivity"],oN(P)),n}function uN(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const y=h(t,["speechConfig"]);e!==void 0&&y!=null&&m(e,["setup","generationConfig","speechConfig"],w4(Nm(y)));const T=h(t,["enableAffectiveDialog"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],T);const w=h(t,["systemInstruction"]);e!==void 0&&w!=null&&m(e,["setup","systemInstruction"],M4(Kn(w)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let j=Xo(E);Array.isArray(j)&&(j=j.map(H=>K4(Ko(H)))),m(e,["setup","tools"],j)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],Z4(S));const b=h(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],Sy());const N=h(t,["outputAudioTranscription"]);e!==void 0&&N!=null&&m(e,["setup","outputAudioTranscription"],Sy());const k=h(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&m(e,["setup","realtimeInputConfig"],nN(k));const C=h(t,["contextWindowCompression"]);e!==void 0&&C!=null&&m(e,["setup","contextWindowCompression"],iN(C));const P=h(t,["proactivity"]);return e!==void 0&&P!=null&&m(e,["setup","proactivity"],lN(P)),n}function fN(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],Ut(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],cN(a,n)),n}function dN(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],Ut(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],uN(a,n)),n}function hN(){return{}}function mN(){return{}}function pN(){return{}}function gN(){return{}}function xN(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],FT(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],LT(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const i=h(t,["video"]);i!=null&&m(e,["video"],OT(i));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],hN()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],pN()),e}function vN(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],FT(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],LT(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const i=h(t,["video"]);i!=null&&m(e,["video"],OT(i));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],mN()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],gN()),e}function XT(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function yN(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>XT(a))),m(e,["weightedPrompts"],r)}return e}function ZT(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const i=h(t,["guidance"]);i!=null&&m(e,["guidance"],i);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const d=h(t,["brightness"]);d!=null&&m(e,["brightness"],d);const f=h(t,["scale"]);f!=null&&m(e,["scale"],f);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const y=h(t,["muteDrums"]);y!=null&&m(e,["muteDrums"],y);const T=h(t,["onlyBassAndDrums"]);return T!=null&&m(e,["onlyBassAndDrums"],T),e}function _N(t){const e={},n=h(t,["musicGenerationConfig"]);return n!=null&&m(e,["musicGenerationConfig"],ZT(n)),e}function QT(t){const e={},n=h(t,["model"]);return n!=null&&m(e,["model"],n),e}function ew(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>XT(a))),m(e,["weightedPrompts"],r)}return e}function Qh(t){const e={},n=h(t,["setup"]);n!=null&&m(e,["setup"],QT(n));const r=h(t,["clientContent"]);r!=null&&m(e,["clientContent"],ew(r));const a=h(t,["musicGenerationConfig"]);a!=null&&m(e,["musicGenerationConfig"],ZT(a));const i=h(t,["playbackControl"]);return i!=null&&m(e,["playbackControl"],i),e}function TN(){return{}}function wN(t){const e={},n=h(t,["sessionId"]);return n!=null&&m(e,["sessionId"],n),e}function EN(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function SN(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function bN(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function CN(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function AN(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function kN(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function NN(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],EN(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],bN(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],AN(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function RN(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],SN(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],CN(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],kN(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function DN(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>NN(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function MN(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>RN(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function by(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function Cy(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function IN(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function FN(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>IN(a))),m(e,["urlMetadata"],r)}return e}function ON(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],DN(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const i=h(t,["groundingMetadata"]);i!=null&&m(e,["groundingMetadata"],i);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],by(c));const d=h(t,["outputTranscription"]);d!=null&&m(e,["outputTranscription"],by(d));const f=h(t,["urlContextMetadata"]);return f!=null&&m(e,["urlContextMetadata"],FN(f)),e}function LN(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],MN(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const i=h(t,["groundingMetadata"]);i!=null&&m(e,["groundingMetadata"],i);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],Cy(c));const d=h(t,["outputTranscription"]);return d!=null&&m(e,["outputTranscription"],Cy(d)),e}function PN(t){const e={},n=h(t,["id"]);n!=null&&m(e,["id"],n);const r=h(t,["args"]);r!=null&&m(e,["args"],r);const a=h(t,["name"]);return a!=null&&m(e,["name"],a),e}function UN(t){const e={},n=h(t,["args"]);n!=null&&m(e,["args"],n);const r=h(t,["name"]);return r!=null&&m(e,["name"],r),e}function BN(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>PN(a))),m(e,["functionCalls"],r)}return e}function jN(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>UN(a))),m(e,["functionCalls"],r)}return e}function VN(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function HN(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function af(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function sf(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function GN(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["responseTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const i=h(t,["toolUsePromptTokenCount"]);i!=null&&m(e,["toolUsePromptTokenCount"],i);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const d=h(t,["promptTokensDetails"]);if(d!=null){let T=d;Array.isArray(T)&&(T=T.map(w=>af(w))),m(e,["promptTokensDetails"],T)}const f=h(t,["cacheTokensDetails"]);if(f!=null){let T=f;Array.isArray(T)&&(T=T.map(w=>af(w))),m(e,["cacheTokensDetails"],T)}const g=h(t,["responseTokensDetails"]);if(g!=null){let T=g;Array.isArray(T)&&(T=T.map(w=>af(w))),m(e,["responseTokensDetails"],T)}const y=h(t,["toolUsePromptTokensDetails"]);if(y!=null){let T=y;Array.isArray(T)&&(T=T.map(w=>af(w))),m(e,["toolUsePromptTokensDetails"],T)}return e}function $N(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["candidatesTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const i=h(t,["toolUsePromptTokenCount"]);i!=null&&m(e,["toolUsePromptTokenCount"],i);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const d=h(t,["promptTokensDetails"]);if(d!=null){let w=d;Array.isArray(w)&&(w=w.map(E=>sf(E))),m(e,["promptTokensDetails"],w)}const f=h(t,["cacheTokensDetails"]);if(f!=null){let w=f;Array.isArray(w)&&(w=w.map(E=>sf(E))),m(e,["cacheTokensDetails"],w)}const g=h(t,["candidatesTokensDetails"]);if(g!=null){let w=g;Array.isArray(w)&&(w=w.map(E=>sf(E))),m(e,["responseTokensDetails"],w)}const y=h(t,["toolUsePromptTokensDetails"]);if(y!=null){let w=y;Array.isArray(w)&&(w=w.map(E=>sf(E))),m(e,["toolUsePromptTokensDetails"],w)}const T=h(t,["trafficType"]);return T!=null&&m(e,["trafficType"],T),e}function zN(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function qN(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function YN(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function JN(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function WN(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],TN());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],ON(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],BN(a));const i=h(t,["toolCallCancellation"]);i!=null&&m(e,["toolCallCancellation"],VN(i));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],GN(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],zN(c));const d=h(t,["sessionResumptionUpdate"]);return d!=null&&m(e,["sessionResumptionUpdate"],YN(d)),e}function KN(t){const e={},n=h(t,["setupComplete"]);n!=null&&m(e,["setupComplete"],wN(n));const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],LN(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],jN(a));const i=h(t,["toolCallCancellation"]);i!=null&&m(e,["toolCallCancellation"],HN(i));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],$N(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],qN(c));const d=h(t,["sessionResumptionUpdate"]);return d!=null&&m(e,["sessionResumptionUpdate"],JN(d)),e}function XN(){return{}}function ZN(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function QN(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>ZN(a))),m(e,["weightedPrompts"],r)}return e}function e3(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const i=h(t,["guidance"]);i!=null&&m(e,["guidance"],i);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const d=h(t,["brightness"]);d!=null&&m(e,["brightness"],d);const f=h(t,["scale"]);f!=null&&m(e,["scale"],f);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const y=h(t,["muteDrums"]);y!=null&&m(e,["muteDrums"],y);const T=h(t,["onlyBassAndDrums"]);return T!=null&&m(e,["onlyBassAndDrums"],T),e}function t3(t){const e={},n=h(t,["clientContent"]);n!=null&&m(e,["clientContent"],QN(n));const r=h(t,["musicGenerationConfig"]);return r!=null&&m(e,["musicGenerationConfig"],e3(r)),e}function n3(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);r!=null&&m(e,["mimeType"],r);const a=h(t,["sourceMetadata"]);return a!=null&&m(e,["sourceMetadata"],t3(a)),e}function r3(t){const e={},n=h(t,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>n3(a))),m(e,["audioChunks"],r)}return e}function a3(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["filteredReason"]);return r!=null&&m(e,["filteredReason"],r),e}function s3(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],XN());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],r3(r));const a=h(t,["filteredPrompt"]);return a!=null&&m(e,["filteredPrompt"],a3(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function i3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function o3(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function l3(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function c3(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],i3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],o3(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],l3(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function Zf(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>c3(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function u3(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const y=h(t,["maxProperties"]);y!=null&&m(e,["maxProperties"],y);const T=h(t,["maximum"]);T!=null&&m(e,["maximum"],T);const w=h(t,["minItems"]);w!=null&&m(e,["minItems"],w);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const b=h(t,["minimum"]);b!=null&&m(e,["minimum"],b);const N=h(t,["nullable"]);N!=null&&m(e,["nullable"],N);const k=h(t,["pattern"]);k!=null&&m(e,["pattern"],k);const C=h(t,["properties"]);C!=null&&m(e,["properties"],C);const P=h(t,["propertyOrdering"]);P!=null&&m(e,["propertyOrdering"],P);const j=h(t,["required"]);j!=null&&m(e,["required"],j);const H=h(t,["title"]);H!=null&&m(e,["title"],H);const L=h(t,["type"]);return L!=null&&m(e,["type"],L),e}function f3(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function d3(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function h3(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function m3(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],h3(n)),e}function p3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function g3(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],p3(n)),e}function x3(){return{}}function v3(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>d3(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],m3(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],g3(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],x3());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function y3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function _3(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function T3(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],_3(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function w3(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],y3(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],T3(r)),e}function E3(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function tw(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],E3(n)),e}function S3(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],tw(r)),e}function b3(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>S3(a))),m(e,["speakerVoiceConfigs"],r)}return e}function C3(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],tw(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],b3(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function A3(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function k3(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],Zf(Kn(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const y=h(e,["responseLogprobs"]);y!=null&&m(r,["responseLogprobs"],y);const T=h(e,["logprobs"]);T!=null&&m(r,["logprobs"],T);const w=h(e,["presencePenalty"]);w!=null&&m(r,["presencePenalty"],w);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const b=h(e,["responseMimeType"]);b!=null&&m(r,["responseMimeType"],b);const N=h(e,["responseSchema"]);N!=null&&m(r,["responseSchema"],u3(Ac(N)));const k=h(e,["responseJsonSchema"]);if(k!=null&&m(r,["responseJsonSchema"],k),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=h(e,["safetySettings"]);if(n!==void 0&&C!=null){let X=C;Array.isArray(X)&&(X=X.map(ee=>f3(ee))),m(n,["safetySettings"],X)}const P=h(e,["tools"]);if(n!==void 0&&P!=null){let X=Xo(P);Array.isArray(X)&&(X=X.map(ee=>v3(Ko(ee)))),m(n,["tools"],X)}const j=h(e,["toolConfig"]);if(n!==void 0&&j!=null&&m(n,["toolConfig"],w3(j)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=h(e,["cachedContent"]);n!==void 0&&H!=null&&m(n,["cachedContent"],ns(t,H));const L=h(e,["responseModalities"]);L!=null&&m(r,["responseModalities"],L);const K=h(e,["mediaResolution"]);K!=null&&m(r,["mediaResolution"],K);const M=h(e,["speechConfig"]);if(M!=null&&m(r,["speechConfig"],C3(km(M))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=h(e,["thinkingConfig"]);return Q!=null&&m(r,["thinkingConfig"],A3(Q)),r}function Ay(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>Zf(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["generationConfig"],k3(t,i,n)),n}function N3(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["requests[]","taskType"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["requests[]","title"],a);const i=h(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&m(e,["requests[]","outputDimensionality"],i),h(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function R3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["contents"]);a!=null&&m(n,["requests[]","content"],UT(t,a));const i=h(e,["config"]);i!=null&&m(n,["config"],N3(i,n));const l=h(e,["model"]);return l!==void 0&&m(n,["requests[]","model"],Ut(t,l)),n}function D3(t,e){const n={};if(h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=h(t,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const i=h(t,["guidanceScale"]);if(e!==void 0&&i!=null&&m(e,["parameters","guidanceScale"],i),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&m(e,["parameters","safetySetting"],l);const c=h(t,["personGeneration"]);e!==void 0&&c!=null&&m(e,["parameters","personGeneration"],c);const d=h(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&m(e,["parameters","includeSafetyAttributes"],d);const f=h(t,["includeRaiReason"]);e!==void 0&&f!=null&&m(e,["parameters","includeRaiReason"],f);const g=h(t,["language"]);e!==void 0&&g!=null&&m(e,["parameters","language"],g);const y=h(t,["outputMimeType"]);e!==void 0&&y!=null&&m(e,["parameters","outputOptions","mimeType"],y);const T=h(t,["outputCompressionQuality"]);if(e!==void 0&&T!=null&&m(e,["parameters","outputOptions","compressionQuality"],T),h(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function M3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["config"]);return i!=null&&m(n,["config"],D3(i,n)),n}function I3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Ut(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function F3(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const i=h(e,["pageToken"]);n!==void 0&&i!=null&&m(n,["_query","pageToken"],i);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],VT(t,c)),r}function O3(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],F3(t,r,n)),n}function L3(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const i=h(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&m(e,["defaultCheckpointId"],i),n}function P3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Ut(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],L3(a,n)),n}function U3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Ut(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function B3(t){const e={};if(h(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function j3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>Zf(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],B3(i)),n}function V3(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=h(t,["imageBytes"]);n!=null&&m(e,["bytesBase64Encoded"],rs(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function H3(t,e){const n={},r=h(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r),h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=h(t,["durationSeconds"]);if(e!==void 0&&a!=null&&m(e,["parameters","durationSeconds"],a),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=h(t,["aspectRatio"]);if(e!==void 0&&i!=null&&m(e,["parameters","aspectRatio"],i),h(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=h(t,["personGeneration"]);if(e!==void 0&&l!=null&&m(e,["parameters","personGeneration"],l),h(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=h(t,["negativePrompt"]);e!==void 0&&c!=null&&m(e,["parameters","negativePrompt"],c);const d=h(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&m(e,["parameters","enhancePrompt"],d),h(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(h(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(h(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function G3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["image"]);if(i!=null&&m(n,["instances[0]","image"],V3(i)),h(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const l=h(e,["config"]);return l!=null&&m(n,["config"],H3(l,n)),n}function $3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function z3(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function q3(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function Y3(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],$3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],z3(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],q3(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function Qo(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>Y3(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function J3(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const y=h(t,["maxProperties"]);y!=null&&m(e,["maxProperties"],y);const T=h(t,["maximum"]);T!=null&&m(e,["maximum"],T);const w=h(t,["minItems"]);w!=null&&m(e,["minItems"],w);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const b=h(t,["minimum"]);b!=null&&m(e,["minimum"],b);const N=h(t,["nullable"]);N!=null&&m(e,["nullable"],N);const k=h(t,["pattern"]);k!=null&&m(e,["pattern"],k);const C=h(t,["properties"]);C!=null&&m(e,["properties"],C);const P=h(t,["propertyOrdering"]);P!=null&&m(e,["propertyOrdering"],P);const j=h(t,["required"]);j!=null&&m(e,["required"],j);const H=h(t,["title"]);H!=null&&m(e,["title"],H);const L=h(t,["type"]);return L!=null&&m(e,["type"],L),e}function W3(t){const e={},n=h(t,["featureSelectionPreference"]);return n!=null&&m(e,["featureSelectionPreference"],n),e}function K3(t){const e={},n=h(t,["method"]);n!=null&&m(e,["method"],n);const r=h(t,["category"]);r!=null&&m(e,["category"],r);const a=h(t,["threshold"]);return a!=null&&m(e,["threshold"],a),e}function X3(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function Z3(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function Q3(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],Z3(n)),e}function eR(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function tR(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],eR(n)),e}function nR(){return{}}function rR(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function aR(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],rR(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function sR(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],aR(n)),e}function iR(){return{}}function nw(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(T=>X3(T))),m(e,["functionDeclarations"],y)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],Q3(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],tR(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],nR());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],sR(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],iR());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function oR(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function lR(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function cR(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],lR(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function uR(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],oR(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],cR(r)),e}function fR(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function dR(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],fR(n)),e}function hR(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],dR(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function mR(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function pR(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],Qo(Kn(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const y=h(e,["responseLogprobs"]);y!=null&&m(r,["responseLogprobs"],y);const T=h(e,["logprobs"]);T!=null&&m(r,["logprobs"],T);const w=h(e,["presencePenalty"]);w!=null&&m(r,["presencePenalty"],w);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const b=h(e,["responseMimeType"]);b!=null&&m(r,["responseMimeType"],b);const N=h(e,["responseSchema"]);N!=null&&m(r,["responseSchema"],J3(Ac(N)));const k=h(e,["responseJsonSchema"]);k!=null&&m(r,["responseJsonSchema"],k);const C=h(e,["routingConfig"]);C!=null&&m(r,["routingConfig"],C);const P=h(e,["modelSelectionConfig"]);P!=null&&m(r,["modelConfig"],W3(P));const j=h(e,["safetySettings"]);if(n!==void 0&&j!=null){let Te=j;Array.isArray(Te)&&(Te=Te.map(re=>K3(re))),m(n,["safetySettings"],Te)}const H=h(e,["tools"]);if(n!==void 0&&H!=null){let Te=Xo(H);Array.isArray(Te)&&(Te=Te.map(re=>nw(Ko(re)))),m(n,["tools"],Te)}const L=h(e,["toolConfig"]);n!==void 0&&L!=null&&m(n,["toolConfig"],uR(L));const K=h(e,["labels"]);n!==void 0&&K!=null&&m(n,["labels"],K);const M=h(e,["cachedContent"]);n!==void 0&&M!=null&&m(n,["cachedContent"],ns(t,M));const Q=h(e,["responseModalities"]);Q!=null&&m(r,["responseModalities"],Q);const X=h(e,["mediaResolution"]);X!=null&&m(r,["mediaResolution"],X);const ee=h(e,["speechConfig"]);ee!=null&&m(r,["speechConfig"],hR(km(ee)));const ye=h(e,["audioTimestamp"]);ye!=null&&m(r,["audioTimestamp"],ye);const Ie=h(e,["thinkingConfig"]);return Ie!=null&&m(r,["thinkingConfig"],mR(Ie)),r}function ky(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>Qo(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["generationConfig"],pR(t,i,n)),n}function gR(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["instances[]","task_type"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["instances[]","title"],a);const i=h(t,["outputDimensionality"]);e!==void 0&&i!=null&&m(e,["parameters","outputDimensionality"],i);const l=h(t,["mimeType"]);e!==void 0&&l!=null&&m(e,["instances[]","mimeType"],l);const c=h(t,["autoTruncate"]);return e!==void 0&&c!=null&&m(e,["parameters","autoTruncate"],c),n}function xR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["contents"]);a!=null&&m(n,["instances[]","content"],UT(t,a));const i=h(e,["config"]);return i!=null&&m(n,["config"],gR(i,n)),n}function vR(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const i=h(t,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const d=h(t,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&m(e,["parameters","safetySetting"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const y=h(t,["includeSafetyAttributes"]);e!==void 0&&y!=null&&m(e,["parameters","includeSafetyAttributes"],y);const T=h(t,["includeRaiReason"]);e!==void 0&&T!=null&&m(e,["parameters","includeRaiReason"],T);const w=h(t,["language"]);e!==void 0&&w!=null&&m(e,["parameters","language"],w);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const b=h(t,["addWatermark"]);e!==void 0&&b!=null&&m(e,["parameters","addWatermark"],b);const N=h(t,["enhancePrompt"]);return e!==void 0&&N!=null&&m(e,["parameters","enhancePrompt"],N),n}function yR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["config"]);return i!=null&&m(n,["config"],vR(i,n)),n}function Qf(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["imageBytes"]);r!=null&&m(e,["bytesBase64Encoded"],rs(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function _R(t){const e={},n=h(t,["maskMode"]);n!=null&&m(e,["maskMode"],n);const r=h(t,["segmentationClasses"]);r!=null&&m(e,["maskClasses"],r);const a=h(t,["maskDilation"]);return a!=null&&m(e,["dilation"],a),e}function TR(t){const e={},n=h(t,["controlType"]);n!=null&&m(e,["controlType"],n);const r=h(t,["enableControlImageComputation"]);return r!=null&&m(e,["computeControl"],r),e}function wR(t){const e={},n=h(t,["styleDescription"]);return n!=null&&m(e,["styleDescription"],n),e}function ER(t){const e={},n=h(t,["subjectType"]);n!=null&&m(e,["subjectType"],n);const r=h(t,["subjectDescription"]);return r!=null&&m(e,["subjectDescription"],r),e}function SR(t){const e={},n=h(t,["referenceImage"]);n!=null&&m(e,["referenceImage"],Qf(n));const r=h(t,["referenceId"]);r!=null&&m(e,["referenceId"],r);const a=h(t,["referenceType"]);a!=null&&m(e,["referenceType"],a);const i=h(t,["maskImageConfig"]);i!=null&&m(e,["maskImageConfig"],_R(i));const l=h(t,["controlImageConfig"]);l!=null&&m(e,["controlImageConfig"],TR(l));const c=h(t,["styleImageConfig"]);c!=null&&m(e,["styleImageConfig"],wR(c));const d=h(t,["subjectImageConfig"]);return d!=null&&m(e,["subjectImageConfig"],ER(d)),e}function bR(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const i=h(t,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const d=h(t,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&m(e,["parameters","safetySetting"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const y=h(t,["includeSafetyAttributes"]);e!==void 0&&y!=null&&m(e,["parameters","includeSafetyAttributes"],y);const T=h(t,["includeRaiReason"]);e!==void 0&&T!=null&&m(e,["parameters","includeRaiReason"],T);const w=h(t,["language"]);e!==void 0&&w!=null&&m(e,["parameters","language"],w);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const b=h(t,["editMode"]);e!==void 0&&b!=null&&m(e,["parameters","editMode"],b);const N=h(t,["baseSteps"]);return e!==void 0&&N!=null&&m(e,["parameters","editConfig","baseSteps"],N),n}function CR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["referenceImages"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>SR(d))),m(n,["instances[0]","referenceImages"],c)}const l=h(e,["config"]);return l!=null&&m(n,["config"],bR(l,n)),n}function AR(t,e){const n={},r=h(t,["includeRaiReason"]);e!==void 0&&r!=null&&m(e,["parameters","includeRaiReason"],r);const a=h(t,["outputMimeType"]);e!==void 0&&a!=null&&m(e,["parameters","outputOptions","mimeType"],a);const i=h(t,["outputCompressionQuality"]);e!==void 0&&i!=null&&m(e,["parameters","outputOptions","compressionQuality"],i);const l=h(t,["enhanceInputImage"]);e!==void 0&&l!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],l);const c=h(t,["imagePreservationFactor"]);e!==void 0&&c!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const d=h(t,["numberOfImages"]);e!==void 0&&d!=null&&m(e,["parameters","sampleCount"],d);const f=h(t,["mode"]);return e!==void 0&&f!=null&&m(e,["parameters","mode"],f),n}function kR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["image"]);a!=null&&m(n,["instances[0]","image"],Qf(a));const i=h(e,["upscaleFactor"]);i!=null&&m(n,["parameters","upscaleConfig","upscaleFactor"],i);const l=h(e,["config"]);return l!=null&&m(n,["config"],AR(l,n)),n}function NR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Ut(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function RR(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const i=h(e,["pageToken"]);n!==void 0&&i!=null&&m(n,["_query","pageToken"],i);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],VT(t,c)),r}function DR(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],RR(t,r,n)),n}function MR(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const i=h(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&m(e,["defaultCheckpointId"],i),n}function IR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],MR(a,n)),n}function FR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],Ut(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function OR(t,e){const n={},r=h(t,["systemInstruction"]);e!==void 0&&r!=null&&m(e,["systemInstruction"],Qo(Kn(r)));const a=h(t,["tools"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>nw(c))),m(e,["tools"],l)}const i=h(t,["generationConfig"]);return e!==void 0&&i!=null&&m(e,["generationConfig"],i),n}function LR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>Qo(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],OR(i,n)),n}function PR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["contents"]);if(a!=null){let l=Jr(a);Array.isArray(l)&&(l=l.map(c=>Qo(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],i),n}function UR(t){const e={},n=h(t,["uri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["videoBytes"]);r!=null&&m(e,["bytesBase64Encoded"],rs(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function BR(t,e){const n={},r=h(t,["numberOfVideos"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["outputGcsUri"]);e!==void 0&&a!=null&&m(e,["parameters","storageUri"],a);const i=h(t,["fps"]);e!==void 0&&i!=null&&m(e,["parameters","fps"],i);const l=h(t,["durationSeconds"]);e!==void 0&&l!=null&&m(e,["parameters","durationSeconds"],l);const c=h(t,["seed"]);e!==void 0&&c!=null&&m(e,["parameters","seed"],c);const d=h(t,["aspectRatio"]);e!==void 0&&d!=null&&m(e,["parameters","aspectRatio"],d);const f=h(t,["resolution"]);e!==void 0&&f!=null&&m(e,["parameters","resolution"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const y=h(t,["pubsubTopic"]);e!==void 0&&y!=null&&m(e,["parameters","pubsubTopic"],y);const T=h(t,["negativePrompt"]);e!==void 0&&T!=null&&m(e,["parameters","negativePrompt"],T);const w=h(t,["enhancePrompt"]);e!==void 0&&w!=null&&m(e,["parameters","enhancePrompt"],w);const E=h(t,["generateAudio"]);e!==void 0&&E!=null&&m(e,["parameters","generateAudio"],E);const S=h(t,["lastFrame"]);e!==void 0&&S!=null&&m(e,["instances[0]","lastFrame"],Qf(S));const b=h(t,["compressionQuality"]);return e!==void 0&&b!=null&&m(e,["parameters","compressionQuality"],b),n}function jR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],Ut(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["image"]);i!=null&&m(n,["instances[0]","image"],Qf(i));const l=h(e,["video"]);l!=null&&m(n,["instances[0]","video"],UR(l));const c=h(e,["config"]);return c!=null&&m(n,["config"],BR(c,n)),n}function VR(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function HR(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function GR(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function $R(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],VR(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],HR(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],GR(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function zR(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>$R(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function qR(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function YR(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function JR(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>YR(a))),m(e,["urlMetadata"],r)}return e}function WR(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],zR(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],qR(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],JR(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const y=h(t,["safetyRatings"]);return y!=null&&m(e,["safetyRatings"],y),e}function Ny(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>WR(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const i=h(t,["usageMetadata"]);return i!=null&&m(e,["usageMetadata"],i),e}function KR(t){const e={},n=h(t,["values"]);return n!=null&&m(e,["values"],n),e}function XR(){return{}}function ZR(t){const e={},n=h(t,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>KR(i))),m(e,["embeddings"],a)}return h(t,["metadata"])!=null&&m(e,["metadata"],XR()),e}function QR(t){const e={},n=h(t,["bytesBase64Encoded"]);n!=null&&m(e,["imageBytes"],rs(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function rw(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function e5(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],QR(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);return a!=null&&m(e,["safetyAttributes"],rw(a)),e}function t5(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>e5(i))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],rw(r)),e}function n5(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function em(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["version"]);i!=null&&m(e,["version"],i);const l=h(t,["_self"]);l!=null&&m(e,["tunedModelInfo"],n5(l));const c=h(t,["inputTokenLimit"]);c!=null&&m(e,["inputTokenLimit"],c);const d=h(t,["outputTokenLimit"]);d!=null&&m(e,["outputTokenLimit"],d);const f=h(t,["supportedGenerationMethods"]);return f!=null&&m(e,["supportedActions"],f),e}function r5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=HT(r);Array.isArray(a)&&(a=a.map(i=>em(i))),m(e,["models"],a)}return e}function a5(){return{}}function s5(t){const e={},n=h(t,["totalTokens"]);n!=null&&m(e,["totalTokens"],n);const r=h(t,["cachedContentTokenCount"]);return r!=null&&m(e,["cachedContentTokenCount"],r),e}function i5(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],rs(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function o5(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],i5(n)),e}function l5(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>o5(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function c5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],l5(l)),e}function u5(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function f5(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function d5(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function h5(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],u5(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],f5(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],d5(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function m5(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>h5(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function p5(t){const e={},n=h(t,["citations"]);return n!=null&&m(e,["citations"],n),e}function g5(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function x5(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>g5(a))),m(e,["urlMetadata"],r)}return e}function v5(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],m5(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],p5(r));const a=h(t,["finishMessage"]);a!=null&&m(e,["finishMessage"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],x5(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const y=h(t,["safetyRatings"]);return y!=null&&m(e,["safetyRatings"],y),e}function Ry(t){const e={},n=h(t,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>v5(f))),m(e,["candidates"],d)}const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["responseId"]);a!=null&&m(e,["responseId"],a);const i=h(t,["modelVersion"]);i!=null&&m(e,["modelVersion"],i);const l=h(t,["promptFeedback"]);l!=null&&m(e,["promptFeedback"],l);const c=h(t,["usageMetadata"]);return c!=null&&m(e,["usageMetadata"],c),e}function y5(t){const e={},n=h(t,["truncated"]);n!=null&&m(e,["truncated"],n);const r=h(t,["token_count"]);return r!=null&&m(e,["tokenCount"],r),e}function _5(t){const e={},n=h(t,["values"]);n!=null&&m(e,["values"],n);const r=h(t,["statistics"]);return r!=null&&m(e,["statistics"],y5(r)),e}function T5(t){const e={},n=h(t,["billableCharacterCount"]);return n!=null&&m(e,["billableCharacterCount"],n),e}function w5(t){const e={},n=h(t,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>_5(i))),m(e,["embeddings"],a)}const r=h(t,["metadata"]);return r!=null&&m(e,["metadata"],T5(r)),e}function E5(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["imageBytes"],rs(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function aw(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function Rm(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],E5(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);a!=null&&m(e,["safetyAttributes"],aw(a));const i=h(t,["prompt"]);return i!=null&&m(e,["enhancedPrompt"],i),e}function S5(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>Rm(i))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],aw(r)),e}function b5(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Rm(a))),m(e,["generatedImages"],r)}return e}function C5(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>Rm(a))),m(e,["generatedImages"],r)}return e}function A5(t){const e={},n=h(t,["endpoint"]);n!=null&&m(e,["name"],n);const r=h(t,["deployedModelId"]);return r!=null&&m(e,["deployedModelId"],r),e}function k5(t){const e={},n=h(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function N5(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);return a!=null&&m(e,["step"],a),e}function tm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["versionId"]);i!=null&&m(e,["version"],i);const l=h(t,["deployedModels"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(T=>A5(T))),m(e,["endpoints"],y)}const c=h(t,["labels"]);c!=null&&m(e,["labels"],c);const d=h(t,["_self"]);d!=null&&m(e,["tunedModelInfo"],k5(d));const f=h(t,["defaultCheckpointId"]);f!=null&&m(e,["defaultCheckpointId"],f);const g=h(t,["checkpoints"]);if(g!=null){let y=g;Array.isArray(y)&&(y=y.map(T=>N5(T))),m(e,["checkpoints"],y)}return e}function R5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=HT(r);Array.isArray(a)&&(a=a.map(i=>tm(i))),m(e,["models"],a)}return e}function D5(){return{}}function M5(t){const e={},n=h(t,["totalTokens"]);return n!=null&&m(e,["totalTokens"],n),e}function I5(t){const e={},n=h(t,["tokensInfo"]);return n!=null&&m(e,["tokensInfo"],n),e}function F5(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],rs(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function O5(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],F5(n)),e}function L5(t){const e={},n=h(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>O5(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function P5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response"]);return l!=null&&m(e,["response"],L5(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const U5="Content-Type",B5="X-Server-Timeout",j5="User-Agent",nm="x-goog-api-client",V5="1.8.0",H5=`google-genai-sdk/${V5}`,G5="v1beta1",$5="v1beta",Dy=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class z5{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:G5,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:$5,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const a=[this.getRequestUrlInternal(n)];return r&&a.push(this.getBaseResourcePath()),e!==""&&a.push(e),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))a.searchParams.append(l,String(c));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.unaryApiCall(a,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[a,i]of Object.entries(n))typeof i=="object"?r[a]=Object.assign(Object.assign({},r[a]),i):i!==void 0&&(r[a]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.streamApiCall(a,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const a=new AbortController,i=a.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>a.abort(),n.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),e.signal=i}return n&&n.extraBody!==null&&q5(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await My(a),new Jh(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await My(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(e){var n;return Oo(this,arguments,function*(){const a=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:c,value:d}=yield Kt(a.read());if(c){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const f=i.decode(d);try{const y=JSON.parse(f);if("error"in y){const T=JSON.parse(JSON.stringify(y.error)),w=T.status,E=T.code,S=`got status: ${w}. ${JSON.stringify(y)}`;if(E>=400&&E<600)throw new Xf({message:S,status:E})}}catch(y){if(y.name==="ApiError")throw y}l+=f;let g=l.match(Dy);for(;g;){const y=g[1];try{const T=new Response(y,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Kt(new Jh(T)),l=l.slice(g[0].length),g=l.match(Dy)}catch(T){throw new Error(`exception parsing stream chunk ${y}. ${T}`)}}}}finally{a.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=H5+" "+this.clientOptions.userAgentExtra;return e[j5]=n,e[nm]=n,e[U5]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,a]of Object.entries(e.headers))n.append(r,a);e.timeout&&e.timeout>0&&n.append(B5,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const a={};n!=null&&(a.mimeType=n.mimeType,a.name=n.name,a.displayName=n.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const i=this.clientOptions.uploader,l=await i.stat(e);a.sizeBytes=String(l.size);const c=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=c;const d=await this.fetchUploadUrl(a,n);return i.upload(e,d,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let a={};n!=null&&n.httpOptions?a=n.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},l=await this.request({path:Je("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function My(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const a=JSON.stringify(r);throw n>=400&&n<600?new Xf({message:a,status:n}):new Error(a)}}function q5(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const i=JSON.parse(t.body);if(typeof i=="object"&&i!==null&&!Array.isArray(i))n=i;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(i,l){const c=Object.assign({},i);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const f=l[d],g=c[d];f&&typeof f=="object"&&!Array.isArray(f)&&g&&typeof g=="object"&&!Array.isArray(g)?c[d]=r(g,f):(g&&f&&typeof g!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof g}, New type: ${typeof f}. Overwriting.`),c[d]=f)}return c}const a=r(n,e);t.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Y5="mcp_used/unknown";function sw(t){for(const e of t)if(Dm(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function iw(t){var e;const n=(e=t[nm])!==null&&e!==void 0?e:"";t[nm]=(n+` ${Y5}`).trimStart()}function J5(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>Dm(a)))!==null&&r!==void 0?r:!1}function W5(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>!Dm(a)))!==null&&r!==void 0?r:!1}function Dm(t){return t!==null&&typeof t=="object"&&t instanceof Mm}function K5(t,e=100){return Oo(this,arguments,function*(){let r,a=0;for(;a<e;){const i=yield Kt(t.listTools({cursor:r}));for(const l of i.tools)yield yield Kt(l),a++;if(!i.nextCursor)break;r=i.nextCursor}})}class Mm{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Mm(e,n)}async initialize(){var e,n,r,a;if(this.mcpTools.length>0)return;const i={},l=[];for(const g of this.mcpClients)try{for(var c=!0,d=(n=void 0,fc(K5(g))),f;f=await d.next(),e=f.done,!e;c=!0){a=f.value,c=!1;const y=a;l.push(y);const T=y.name;if(i[T])throw new Error(`Duplicate function name ${T} found in MCP tools. Please ensure function names are unique.`);i[T]=g}}catch(y){n={error:y}}finally{try{!c&&!e&&(r=d.return)&&await r.call(d)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),GC(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[r.name];let i;this.config.timeout&&(i={timeout:this.config.timeout});const l=await a.callTool({name:r.name,arguments:r.args},void 0,i);n.push({functionResponse:{name:r.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function X5(t,e,n){const r=new MC;let a;n.data instanceof Blob?a=JSON.parse(await n.data.text()):a=JSON.parse(n.data);const i=s3(a);Object.assign(r,i),e(r)}class Z5{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),l=tD(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),d=`${a}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${c}`;let f=()=>{};const g=new Promise(C=>{f=C}),y=e.callbacks,T=function(){f({})},w=this.apiClient,E={onopen:T,onmessage:C=>{X5(w,y.onmessage,C)},onerror:(n=y==null?void 0:y.onerror)!==null&&n!==void 0?n:function(C){},onclose:(r=y==null?void 0:y.onclose)!==null&&r!==void 0?r:function(C){}},S=this.webSocketFactory.create(d,eD(l),E);S.connect(),await g;const b=Ut(this.apiClient,e.model),N=QT({model:b}),k=Qh({setup:N});return S.send(JSON.stringify(k)),new Q5(S,this.apiClient)}}class Q5{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=yN(e),r=ew(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=_N(e),r=Qh(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const n=Qh({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Mo.PLAY)}pause(){this.sendPlaybackControl(Mo.PAUSE)}stop(){this.sendPlaybackControl(Mo.STOP)}resetContext(){this.sendPlaybackControl(Mo.RESET_CONTEXT)}close(){this.conn.close()}}function eD(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function tD(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nD="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function rD(t,e,n){const r=new DC;let a;n.data instanceof Blob?a=await n.data.text():n.data instanceof ArrayBuffer?a=new TextDecoder().decode(n.data):a=n.data;const i=JSON.parse(a);if(t.isVertexAI()){const l=KN(i);Object.assign(r,l)}else{const l=WN(i);Object.assign(r,l)}e(r)}class aD{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new Z5(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,a,i,l,c;const d=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let g;const y=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&sw(e.config.tools)&&iw(y);const T=lD(y);if(this.apiClient.isVertexAI())g=`${d}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(T);else{const M=this.apiClient.getApiKey();let Q="BidiGenerateContent",X="key";M!=null&&M.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),Q="BidiGenerateContentConstrained",X="access_token"),g=`${d}/ws/google.ai.generativelanguage.${f}.GenerativeService.${Q}?${X}=${M}`}let w=()=>{};const E=new Promise(M=>{w=M}),S=e.callbacks,b=function(){var M;(M=S==null?void 0:S.onopen)===null||M===void 0||M.call(S),w({})},N=this.apiClient,k={onopen:b,onmessage:M=>{rD(N,S.onmessage,M)},onerror:(n=S==null?void 0:S.onerror)!==null&&n!==void 0?n:function(M){},onclose:(r=S==null?void 0:S.onclose)!==null&&r!==void 0?r:function(M){}},C=this.webSocketFactory.create(g,oD(T),k);C.connect(),await E;let P=Ut(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const M=this.apiClient.getProject(),Q=this.apiClient.getLocation();P=`projects/${M}/locations/${Q}/`+P}let j={};this.apiClient.isVertexAI()&&((a=e.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Mf.AUDIO]}:e.config.responseModalities=[Mf.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const H=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],L=[];for(const M of H)if(this.isCallableTool(M)){const Q=M;L.push(await Q.tool())}else L.push(M);L.length>0&&(e.config.tools=L);const K={model:P,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?j=dN(this.apiClient,K):j=fN(this.apiClient,K),delete j.config,C.send(JSON.stringify(j)),new iD(C,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const sD={turnComplete:!0};class iD{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Jr(n.turns),e.isVertexAI()?r=r.map(a=>Qo(a)):r=r.map(a=>Zf(a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(nD)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},sD),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:vN(e)}:n={realtimeInput:xN(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function oD(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function lD(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Iy=10;function Fy(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let a=!1;for(const l of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(bf(l)){a=!0;break}if(!a)return!0;const i=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return i&&(i<0||!Number.isInteger(i))||i==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",i),!0):!1}function bf(t){return"callTool"in t&&typeof t.callTool=="function"}function Oy(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cD extends Ai{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,a,i,l,c;const d=await this.processParamsForMcpUsage(n);if(!J5(n)||Fy(n.config))return await this.generateContentInternal(d);if(W5(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let f,g;const y=Jr(d.contents),T=(i=(a=(r=d.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&i!==void 0?i:Iy;let w=0;for(;w<T&&(f=await this.generateContentInternal(d),!(!f.functionCalls||f.functionCalls.length===0));){const E=f.candidates[0].content,S=[];for(const b of(c=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(bf(b)){const k=await b.callTool(f.functionCalls);S.push(...k)}w++,g={role:"user",parts:S},d.contents=Jr(d.contents),d.contents.push(E),d.contents.push(g),Oy(d.config)&&(y.push(E),y.push(g))}return Oy(d.config)&&(f.automaticFunctionCallingHistory=y),f},this.generateContentStream=async n=>{if(Fy(n.config)){const r=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var a;let i;const l=[];if(r!=null&&r.generatedImages)for(const d of r.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((a=d==null?void 0:d.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?i=d==null?void 0:d.safetyAttributes:l.push(d);let c;return i?c={generatedImages:l,positivePromptSafetyAttributes:i}:c={generatedImages:l},c}),this.list=async n=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Vc(_i.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const a={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async processParamsForMcpUsage(e){var n,r,a;const i=(n=e.config)===null||n===void 0?void 0:n.tools;if(!i)return e;const l=await Promise.all(i.map(async d=>bf(d)?await d.tool():d)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&sw(e.config.tools)){const d=(a=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&a!==void 0?a:{};let f=Object.assign({},d);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),iw(f),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return c}async initAfcToolsMap(e){var n,r,a;const i=new Map;for(const l of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(bf(l)){const c=l,d=await c.tool();for(const f of(a=d.functionDeclarations)!==null&&a!==void 0?a:[]){if(!f.name)throw new Error("Function declaration name is required.");if(i.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);i.set(f.name,c)}}return i}async processAfcStream(e){var n,r,a;const i=(a=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:Iy;let l=!1,c=0;const d=await this.initAfcToolsMap(e);return function(f,g,y){var T,w;return Oo(this,arguments,function*(){for(var E,S,b,N;c<i;){l&&(c++,l=!1);const j=yield Kt(f.processParamsForMcpUsage(y)),H=yield Kt(f.generateContentStreamInternal(j)),L=[],K=[];try{for(var k=!0,C=(S=void 0,fc(H)),P;P=yield Kt(C.next()),E=P.done,!E;k=!0){N=P.value,k=!1;const M=N;if(yield yield Kt(M),M.candidates&&(!((T=M.candidates[0])===null||T===void 0)&&T.content)){K.push(M.candidates[0].content);for(const Q of(w=M.candidates[0].content.parts)!==null&&w!==void 0?w:[])if(c<i&&Q.functionCall){if(!Q.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(Q.functionCall.name)){const X=yield Kt(g.get(Q.functionCall.name).callTool([Q.functionCall]));L.push(...X)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${Q.functionCall.name}`)}}}}catch(M){S={error:M}}finally{try{!k&&!E&&(b=C.return)&&(yield Kt(b.call(C)))}finally{if(S)throw S.error}}if(L.length>0){l=!0;const M=new ec;M.candidates=[{content:{role:"user",parts:L}}],yield yield Kt(M);const Q=[];Q.push(...K),Q.push({role:"user",parts:L});const X=Jr(y.contents).concat(Q);y.contents=X}else break}})}(this,d,e)}async generateContentInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=ky(this.apiClient,e);return c=Je("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=Ry(g),T=new ec;return Object.assign(T,y),T})}else{const f=Ay(this.apiClient,e);return c=Je("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=Ny(g),T=new ec;return Object.assign(T,y),T})}}async generateContentStreamInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=ky(this.apiClient,e);return c=Je("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(y){return Oo(this,arguments,function*(){var T,w,E,S;try{for(var b=!0,N=fc(y),k;k=yield Kt(N.next()),T=k.done,!T;b=!0){S=k.value,b=!1;const P=Ry(yield Kt(S.json())),j=new ec;Object.assign(j,P),yield yield Kt(j)}}catch(C){w={error:C}}finally{try{!b&&!T&&(E=N.return)&&(yield Kt(E.call(N)))}finally{if(w)throw w.error}}})})}else{const f=Ay(this.apiClient,e);return c=Je("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(y){return Oo(this,arguments,function*(){var T,w,E,S;try{for(var b=!0,N=fc(y),k;k=yield Kt(N.next()),T=k.done,!T;b=!0){S=k.value,b=!1;const P=Ny(yield Kt(S.json())),j=new ec;Object.assign(j,P),yield yield Kt(j)}}catch(C){w={error:C}}finally{try{!b&&!T&&(E=N.return)&&(yield Kt(E.call(N)))}finally{if(w)throw w.error}}})})}}async embedContent(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=xR(this.apiClient,e);return c=Je("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=w5(g),T=new iy;return Object.assign(T,y),T})}else{const f=R3(this.apiClient,e);return c=Je("{model}:batchEmbedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=ZR(g),T=new iy;return Object.assign(T,y),T})}}async generateImagesInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=yR(this.apiClient,e);return c=Je("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=S5(g),T=new oy;return Object.assign(T,y),T})}else{const f=M3(this.apiClient,e);return c=Je("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=t5(g),T=new oy;return Object.assign(T,y),T})}}async editImageInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=CR(this.apiClient,e);return i=Je("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=b5(d),g=new bC;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=kR(this.apiClient,e);return i=Je("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=C5(d),g=new CC;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=NR(this.apiClient,e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>tm(g))}else{const f=I3(this.apiClient,e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>em(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=DR(this.apiClient,e);return c=Je("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=R5(g),T=new ly;return Object.assign(T,y),T})}else{const f=O3(this.apiClient,e);return c=Je("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=r5(g),T=new ly;return Object.assign(T,y),T})}}async update(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=IR(this.apiClient,e);return c=Je("{model}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>tm(g))}else{const f=P3(this.apiClient,e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>em(g))}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=FR(this.apiClient,e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=D5(),y=new cy;return Object.assign(y,g),y})}else{const f=U3(this.apiClient,e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=a5(),y=new cy;return Object.assign(y,g),y})}}async countTokens(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=LR(this.apiClient,e);return c=Je("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=M5(g),T=new uy;return Object.assign(T,y),T})}else{const f=j3(this.apiClient,e);return c=Je("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=s5(g),T=new uy;return Object.assign(T,y),T})}}async computeTokens(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=PR(this.apiClient,e);return i=Je("{model}:computeTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=I5(d),g=new AC;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=jR(this.apiClient,e);return c=Je("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>P5(g))}else{const f=G3(this.apiClient,e);return c=Je("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>c5(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uD(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function fD(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function dD(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["operationName"],n);const r=h(t,["resourceName"]);r!=null&&m(e,["_url","resourceName"],r);const a=h(t,["config"]);return a!=null&&m(e,["config"],a),e}function hD(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],rs(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function mD(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],hD(n)),e}function pD(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>mD(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function gD(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],pD(l)),e}function xD(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],rs(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function vD(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],xD(n)),e}function yD(t){const e={},n=h(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>vD(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function Ly(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response"]);return l!=null&&m(e,["response"],yD(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _D extends Ai{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let i;return r&&"httpOptions"in r&&(i=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=fD(e);return c=Je("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Ly(g))}else{const f=uD(e);return c=Je("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>gD(g))}}async fetchPredictVideosOperationInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=dD(e);return i=Je("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>Ly(d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TD(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function ow(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],TD(n)),e}function wD(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],ow(r)),e}function ED(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>wD(a))),m(e,["speakerVoiceConfigs"],r)}return e}function SD(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],ow(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],ED(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function bD(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function CD(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function AD(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function kD(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],bD(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],CD(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],AD(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function ND(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>kD(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function RD(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function DD(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function MD(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],DD(n)),e}function ID(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function FD(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],ID(n)),e}function OD(){return{}}function LD(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>RD(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],MD(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],FD(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],OD());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function PD(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Py(){return{}}function UD(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function BD(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],UD(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function jD(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function VD(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],jD(r)),e}function HD(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function GD(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const y=h(t,["speechConfig"]);e!==void 0&&y!=null&&m(e,["setup","generationConfig","speechConfig"],SD(Nm(y)));const T=h(t,["enableAffectiveDialog"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],T);const w=h(t,["systemInstruction"]);e!==void 0&&w!=null&&m(e,["setup","systemInstruction"],ND(Kn(w)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let j=Xo(E);Array.isArray(j)&&(j=j.map(H=>LD(Ko(H)))),m(e,["setup","tools"],j)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],PD(S));const b=h(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],Py());const N=h(t,["outputAudioTranscription"]);e!==void 0&&N!=null&&m(e,["setup","outputAudioTranscription"],Py());const k=h(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&m(e,["setup","realtimeInputConfig"],BD(k));const C=h(t,["contextWindowCompression"]);e!==void 0&&C!=null&&m(e,["setup","contextWindowCompression"],VD(C));const P=h(t,["proactivity"]);return e!==void 0&&P!=null&&m(e,["setup","proactivity"],HD(P)),n}function $D(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],Ut(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],GD(a,n)),n}function zD(t,e,n){const r={},a=h(e,["expireTime"]);n!==void 0&&a!=null&&m(n,["expireTime"],a);const i=h(e,["newSessionExpireTime"]);n!==void 0&&i!=null&&m(n,["newSessionExpireTime"],i);const l=h(e,["uses"]);n!==void 0&&l!=null&&m(n,["uses"],l);const c=h(e,["liveConnectConstraints"]);n!==void 0&&c!=null&&m(n,["bidiGenerateContentSetup"],$D(t,c));const d=h(e,["lockAdditionalFields"]);return n!==void 0&&d!=null&&m(n,["fieldMask"],d),r}function qD(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],zD(t,r,n)),n}function YD(t){const e={},n=h(t,["name"]);return n!=null&&m(e,["name"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JD(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const a=Object.keys(r).map(i=>`${n}.${i}`);e.push(...a)}else e.push(n)}return e.join(",")}function WD(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const i=r.setup;typeof i=="object"&&i!==null?(t.bidiGenerateContentSetup=i,n=i):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const a=t.fieldMask;if(n){const i=JD(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)i?t.fieldMask=i:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];a.length>0&&(c=a.map(f=>l.includes(f)?`generationConfig.${f}`:f));const d=[];i&&d.push(i),c.length>0&&d.push(...c),d.length>0?t.fieldMask=d.join(","):delete t.fieldMask}else delete t.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?t.fieldMask=a.join(","):delete t.fieldMask;return t}class KD extends Ai{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=qD(this.apiClient,e);i=Je("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const d=WD(c,e.config);return a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>YD(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XD(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function ZD(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function QD(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],ZD(n,e)),e}function eM(t){const e={},n=h(t,["textInput"]);n!=null&&m(e,["textInput"],n);const r=h(t,["output"]);return r!=null&&m(e,["output"],r),e}function tM(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=h(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>eM(a))),m(e,["examples","examples"],r)}return e}function nM(t,e){const n={};if(h(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=h(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&m(e,["displayName"],r),h(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=h(t,["epochCount"]);e!==void 0&&a!=null&&m(e,["tuningTask","hyperparameters","epochCount"],a);const i=h(t,["learningRateMultiplier"]);if(i!=null&&m(n,["tuningTask","hyperparameters","learningRateMultiplier"],i),h(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=h(t,["batchSize"]);e!==void 0&&l!=null&&m(e,["tuningTask","hyperparameters","batchSize"],l);const c=h(t,["learningRate"]);return e!==void 0&&c!=null&&m(e,["tuningTask","hyperparameters","learningRate"],c),n}function rM(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["tuningTask","trainingData"],tM(r));const a=h(t,["config"]);return a!=null&&m(e,["config"],nM(a,e)),e}function aM(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function sM(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function iM(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],sM(n,e)),e}function oM(t,e){const n={},r=h(t,["gcsUri"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);if(e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),h(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function lM(t,e){const n={},r=h(t,["gcsUri"]);r!=null&&m(n,["validationDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);return e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),n}function cM(t,e){const n={},r=h(t,["validationDataset"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec"],lM(r,n));const a=h(t,["tunedModelDisplayName"]);e!==void 0&&a!=null&&m(e,["tunedModelDisplayName"],a);const i=h(t,["description"]);e!==void 0&&i!=null&&m(e,["description"],i);const l=h(t,["epochCount"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=h(t,["learningRateMultiplier"]);e!==void 0&&c!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=h(t,["exportLastCheckpointOnly"]);e!==void 0&&d!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const f=h(t,["adapterSize"]);if(e!==void 0&&f!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],f),h(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function uM(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],oM(r,e));const a=h(t,["config"]);return a!=null&&m(e,["config"],cM(a,e)),e}function fM(t){const e={},n=h(t,["name"]);n!=null&&m(e,["model"],n);const r=h(t,["name"]);return r!=null&&m(e,["endpoint"],r),e}function lw(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],BT(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const i=h(t,["tuningTask","startTime"]);i!=null&&m(e,["startTime"],i);const l=h(t,["tuningTask","completeTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["description"]);d!=null&&m(e,["description"],d);const f=h(t,["baseModel"]);f!=null&&m(e,["baseModel"],f);const g=h(t,["_self"]);g!=null&&m(e,["tunedModel"],fM(g));const y=h(t,["distillationSpec"]);y!=null&&m(e,["distillationSpec"],y);const T=h(t,["experiment"]);T!=null&&m(e,["experiment"],T);const w=h(t,["labels"]);w!=null&&m(e,["labels"],w);const E=h(t,["pipelineJob"]);E!=null&&m(e,["pipelineJob"],E);const S=h(t,["satisfiesPzi"]);S!=null&&m(e,["satisfiesPzi"],S);const b=h(t,["satisfiesPzs"]);b!=null&&m(e,["satisfiesPzs"],b);const N=h(t,["serviceAccount"]);N!=null&&m(e,["serviceAccount"],N);const k=h(t,["tunedModelDisplayName"]);return k!=null&&m(e,["tunedModelDisplayName"],k),e}function dM(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>lw(i))),m(e,["tuningJobs"],a)}return e}function hM(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);return i!=null&&m(e,["error"],i),e}function mM(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);a!=null&&m(e,["step"],a);const i=h(t,["endpoint"]);return i!=null&&m(e,["endpoint"],i),e}function pM(t){const e={},n=h(t,["model"]);n!=null&&m(e,["model"],n);const r=h(t,["endpoint"]);r!=null&&m(e,["endpoint"],r);const a=h(t,["checkpoints"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>mM(l))),m(e,["checkpoints"],i)}return e}function rm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],BT(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const i=h(t,["startTime"]);i!=null&&m(e,["startTime"],i);const l=h(t,["endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["error"]);d!=null&&m(e,["error"],d);const f=h(t,["description"]);f!=null&&m(e,["description"],f);const g=h(t,["baseModel"]);g!=null&&m(e,["baseModel"],g);const y=h(t,["tunedModel"]);y!=null&&m(e,["tunedModel"],pM(y));const T=h(t,["supervisedTuningSpec"]);T!=null&&m(e,["supervisedTuningSpec"],T);const w=h(t,["tuningDataStats"]);w!=null&&m(e,["tuningDataStats"],w);const E=h(t,["encryptionSpec"]);E!=null&&m(e,["encryptionSpec"],E);const S=h(t,["partnerModelTuningSpec"]);S!=null&&m(e,["partnerModelTuningSpec"],S);const b=h(t,["distillationSpec"]);b!=null&&m(e,["distillationSpec"],b);const N=h(t,["experiment"]);N!=null&&m(e,["experiment"],N);const k=h(t,["labels"]);k!=null&&m(e,["labels"],k);const C=h(t,["pipelineJob"]);C!=null&&m(e,["pipelineJob"],C);const P=h(t,["satisfiesPzi"]);P!=null&&m(e,["satisfiesPzi"],P);const j=h(t,["satisfiesPzs"]);j!=null&&m(e,["satisfiesPzs"],j);const H=h(t,["serviceAccount"]);H!=null&&m(e,["serviceAccount"],H);const L=h(t,["tunedModelDisplayName"]);return L!=null&&m(e,["tunedModelDisplayName"],L),e}function gM(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>rm(i))),m(e,["tuningJobs"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xM extends Ai{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Vc(_i.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:Yh.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=aM(e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>rm(g))}else{const f=XD(e);return c=Je("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>lw(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=iM(e);return c=Je("tuningJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=gM(g),T=new fy;return Object.assign(T,y),T})}else{const f=QD(e);return c=Je("tunedModels",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=dM(g),T=new fy;return Object.assign(T,y),T})}}async tuneInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=uM(e);return i=Je("tuningJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>rm(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=rM(e);return i=Je("tunedModels",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>hM(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vM{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const yM=1024*1024*8,_M=3,TM=1e3,wM=2,_h="x-goog-upload-status";async function EM(t,e,n){var r,a,i;let l=0,c=0,d=new Jh(new Response),f="upload";for(l=t.size;c<l;){const y=Math.min(yM,l-c),T=t.slice(c,c+y);c+y>=l&&(f+=", finalize");let w=0,E=TM;for(;w<_M&&(d=await n.request({path:"",body:T,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(c),"Content-Length":String(y)}}}),!(!((r=d==null?void 0:d.headers)===null||r===void 0)&&r[_h]));)w++,await bM(E),E=E*wM;if(c+=y,((a=d==null?void 0:d.headers)===null||a===void 0?void 0:a[_h])!=="active")break;if(l<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const g=await(d==null?void 0:d.json());if(((i=d==null?void 0:d.headers)===null||i===void 0?void 0:i[_h])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return g.file}async function SM(t){return{size:t.size,type:t.type}}function bM(t){return new Promise(e=>setTimeout(e,t))}class CM{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await EM(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await SM(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AM{create(e,n,r){return new kM(e,n,r)}}class kM{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Uy="x-goog-api-key";class NM{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(Uy)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Uy,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const RM="gl-node/";class DM{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=SC(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const a=new NM(this.apiKey);this.apiClient=new z5({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:RM+"web",uploader:new CM,downloader:new vM}),this.models=new cD(this.apiClient),this.live=new aD(this.apiClient,a,new AM),this.batches=new ZA(this.apiClient),this.chats=new n4(this.models,this.apiClient),this.caches=new Qk(this.apiClient),this.files=new p4(this.apiClient),this.operations=new _D(this.apiClient),this.authTokens=new KD(this.apiClient),this.tunings=new xM(this.apiClient)}}const Xr="gemini-2.5-flash-preview-04-17";let Gt=null;const By=t=>{if(!t){Gt=null;return}try{Gt=new DM({apiKey:t})}catch(e){console.error("Failed to initialize Gemini AI:",e),Gt=null}},Hs=t=>{const e=n=>{const{position:r,extendedDetails:a,...i}=n,l={...i};if(a){const{reportDeck:c,attachments:d,subSteps:f,decisions:g,...y}=a,T={...y};c&&c.slides.length>0&&(T.reportDeckExists=!0,T.reportDeckSlideCount=c.slides.length),d&&d.length>0&&(T.attachments=d.map(w=>({id:w.id,name:w.name,type:w.type}))),f&&f.length>0&&(T.subSteps=f.map(w=>{const{position:E,attachments:S,actionItems:b,...N}=w,k={...N};return S&&S.length>0&&(k.attachments=S.map(C=>({id:C.id,name:C.name,type:C.type}))),b&&b.length>0&&(k.actionItems=b.map(C=>{const{report:P,...j}=C,H={...j};if(P){const{attachments:L,...K}=P,M={...K};L&&L.length>0&&(M.attachments=L.map(Q=>({id:Q.id,name:Q.name,type:Q.type}))),H.report=M}return H})),k})),l.extendedDetails=T}return l};return Array.isArray(t)?t.map(e):e(t)},ed=t=>({...t,slides:t.slides.map(e=>{if(e.isLocked)return{id:e.id,isLocked:!0,summary:`Locked Slide: Contains ${e.elements.length} elements. Content is preserved and must not be changed.`,elements:[]};const{elements:n,...r}=e;return{...r,elements:n.map(a=>{var i;if(a.type==="flowchart"&&((i=a.data)!=null&&i.subSteps)){const l=a;return{...l,data:{subStepCount:l.data.subSteps.length,subSteps:`[Sub-step data omitted for brevity, count: ${l.data.subSteps.length}]`}}}return a})}})}),MM=t=>{const e=/"dependencies"\s*:\s*\[([\s\S]*?)\]/g;return t.replace(e,(n,r)=>{const a=r.match(/"[^"]*"/g);return`"dependencies": [${a?a.join(", "):""}]`})},pa=t=>{let e=t.trim();const n=/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s,r=e.match(n);if(r&&r[1]&&(e=r[1].trim()),e=MM(e),e=e.replace(/"((?:\\.|[^"\\])*)"/g,(a,i)=>`"${i.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}"`),!r){const a=e.indexOf("{"),i=e.indexOf("[");if(a===-1&&i===-1)throw console.error("No JSON object or array found in the response string.",t),new Error(`AI response did not contain a valid JSON structure. Raw response: ${t.substring(0,500)}...`);const l=a===-1?i:i===-1?a:Math.min(a,i),c=e.lastIndexOf("}"),d=e.lastIndexOf("]"),f=Math.max(c,d);l>-1&&f>l&&(e=e.substring(l,f+1))}try{return JSON.parse(e)}catch(a){throw console.error("Failed to parse JSON response:",a,`
Original text:`,t,`
Processed string:`,e),new Error(`Failed to parse AI response as JSON. Raw response: ${t.substring(0,500)}...`)}},Zr=(t,e)=>{console.error(`Error in Gemini API call during ${e}:`,t);let n=`AIとの通信中に不明なエラーが発生しました (${e})。`;if(t instanceof Error){const r=t.message.toLowerCase();r.includes("api key not valid")||r.includes("api key is invalid")?n="APIキーが無効です。キーを確認して再度設定してください。(API key not valid. Please pass a valid API key.)":r.includes("quota")?n="API利用上限に達しました。Google AI Platformのプランと請求情報を確認してください。(You have exceeded your API quota.)":n=`AIとの通信に失敗しました (${e}): ${t.message}`}throw new Error(n)},IM=async(t,e)=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
    You are an expert project planner. Your task is to break down a high-level project goal into a sequence of actionable tasks.
    CONTEXT:
    - Project Goal: "${t}"
    - Target Completion Date: "${e}"
    INSTRUCTIONS:
    1.  Generate a sequence of 3 to 7 high-level, actionable tasks.
    2.  Provide a concise title (max 10 words) and a brief description (1-2 sentences) for each.
    3.  Your response MUST be a single, valid JSON array of objects. Do NOT include any explanations or markdown fences.
    4.  The language of the output should match the language of the input goal.
    5.  Each object MUST have this structure: { "id": "unique_string_id", "title": "Task Title", "description": "Task Description" }
  `;try{const r=await Gt.models.generateContent({model:Xr,contents:n,config:{responseMimeType:"application/json"}}),a=pa(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.id||!i.title||!i.description))throw new Error("AI returned an unexpected format for project tasks.");return a}catch(r){Zr(r,"project plan generation")}},FM=async t=>{var n;if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const e=`
    You are a project management expert. Analyze the given task and propose a list of concrete next steps to accomplish it.
    CONTEXT:
    - Task Title: "${t.title}"
    - Task Description: "${t.description}"
    - Required Resources: "${((n=t.extendedDetails)==null?void 0:n.resources)||"Not specified"}"
    INSTRUCTIONS:
    1.  Generate a list of 3 to 6 actionable proposals (sub-steps).
    2.  Each proposal must have a concise 'title' and a 'description'.
    3.  Focus on breaking down the main task into logical phases or components.
    4.  Your response MUST be a single, valid JSON array of objects. Do not include any explanations.
    5.  The language must match the input task language.
    6.  The JSON structure for each item must be: { "title": "...", "description": "..." }
  `;try{const r=await Gt.models.generateContent({model:Xr,contents:e,config:{responseMimeType:"application/json"}}),a=pa(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.title||!i.description))throw new Error("AI returned an unexpected format for step proposals.");if(a.length===0)throw new Error("AI did not generate any proposals. The task might be too abstract.");return a}catch(r){Zr(r,"step proposal generation")}},OM=async(t,e)=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
        You are a senior project analyst AI. Your task is to intelligently update a list of critical project decisions based on the latest task data. You will merge new findings with an existing list.

        CONTEXT:
        - Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Hs(t))}
        - Existing Decisions List: ${JSON.stringify(e)}
        - Today's Date: ${new Date().toISOString().split("T")[0]}

        INSTRUCTIONS:
        1.  **Analyze Task Data**: Holistically review the 'Full Task Data' to understand the current state, including sub-steps, action items, and notes.
        2.  **Review Existing Decisions**: Go through each item in the 'Existing Decisions List'.
        3.  **Merge and Update**:
            *   **For each existing decision**: Check if the latest task data provides new information.
                *   If an 'undecided' item now has a clear answer in the task data, update its 'status' to 'decided', fill in the 'decision' and 'reasoning', and set the 'date'.
                *   You may also refine the 'question' or 'reasoning' of existing items if the new data provides more clarity.
                *   Keep the original 'id' for all existing items.
            *   **Identify New Decisions**: Look for any *new* critical questions or decision points in the task data that are NOT present in the existing list.
            *   For each new decision you find, create a new decision object.
        4.  **Construct Final List**: Your output MUST be a single JSON array containing the complete, merged list of decisions. This list must include:
            *   All the original decisions, updated as necessary.
            *   All the newly identified decisions.
        5.  **JSON Structure**: Every object in the output array MUST strictly follow this structure. For new items, you MUST set the 'id' field to 'NEW'. For existing items, you MUST preserve their original 'id'.
            {
              "id": "string (original ID or 'NEW' for new items)",
              "question": "The question that needs a decision.",
              "decision": "The final outcome (string, or empty string for 'undecided').",
              "reasoning": "Justification for the decision, or explanation of importance for 'undecided'.",
              "date": "YYYY-MM-DD (string, or empty string for 'undecided').",
              "status": "'decided' or 'undecided'."
            }
        6.  **Language and Format**: The output language must match the input task language. The response must be only the JSON array, without any markdown or explanations.
    `;try{const r=await Gt.models.generateContent({model:Xr,contents:n,config:{responseMimeType:"application/json"}}),a=pa(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.question||!i.status||!i.id))throw new Error("AI returned an unexpected format for decisions. Expected fields: id, question, status.");return a}catch(r){Zr(r,"decision generation")}},LM=async(t,e)=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
        You are a professional presentation designer and project analyst. Your task is to create a project status report slide deck based on ALL the provided data.
        CONTEXT:
        - Overall Project Goal: "${e}"
        - Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Hs(t))}
        INSTRUCTIONS:
        1.  Generate a comprehensive slide deck (5-8 slides).
        2.  The response MUST be a single, valid JSON object. Do NOT use markdown.
        3.  The JSON must follow this structure: { "slides": [ { "id": "...", "layout": "...", "isLocked": false, "elements": [ ... ] } ] }.
        4.  Available element types: 'textbox', 'image', 'table', 'chart', 'flowchart'.
        5.  For 'textbox' elements, you MUST use a "content" field for the text.
        6.  **CRITICAL SYNTHESIS**:
            - Create a title slide and an overview slide.
            - **Flowchart Slide**: If the task has sub-steps, create one slide dedicated to visualizing the workflow. This slide should have a 'textbox' title (e.g., "サブステップのワークフロー") and a 'flowchart' element. The 'flowchart' element must have this structure: \`{"id": "...", "type": "flowchart", "position": {"x": 5, "y": 15, "width": 90, "height": 75}, "data": {"subSteps": [...]}}\`. You MUST copy the entire 'subSteps' array from the input JSON into the \`data.subSteps\` field.
            - **Decision Log Slide**: If the task's 'extendedDetails.decisions' array is present and not empty, create a dedicated slide titled "決定事項ログ". Use textboxes to create a clear summary. For each 'decided' item, show the question and decision. For 'undecided' items, list the question and why it's important.
            - **ACTION ITEM FOCUS**: For significant Sub-Steps, create additional summary slides. Analyze 'actionItems' and report on completion status.
            - Create slides for key challenges and a final summary.
        7.  Write concise, professional text in the same language as the input task.
        8.  Position elements logically. Do not let them overlap.
    `;try{const r=await Gt.models.generateContent({model:Xr,contents:n,config:{responseMimeType:"application/json"}}),a=pa(r.text);if(!a||!Array.isArray(a.slides))throw new Error("AI returned an invalid format for the slide deck.");return a.slides.forEach(i=>{i.elements.forEach(l=>{l.type==="textbox"&&typeof l.text<"u"&&(l.content=l.text,delete l.text)})}),a}catch(r){Zr(r,"initial slide deck generation")}},PM=async(t,e,n)=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a presentation designer and project analyst. Your task is to update a project status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Updated Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Hs(e))}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(ed(t))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked), REGENERATE their content from scratch based on the 'updatedTaskData'.
      3.  This includes regenerating 'flowchart' slides to reflect the latest sub-step data.
      4.  **ACTION ITEM FOCUS**: When regenerating, pay close attention to the progress and reports within each sub-step's 'actionItems'.
      5.  The final output MUST be a single, valid JSON object representing the complete slide deck, with all slides (locked and regenerated) in their original order.
      6.  Follow the same JSON structure and rules as the initial generation.
    `;try{const a=await Gt.models.generateContent({model:Xr,contents:r,config:{responseMimeType:"application/json"}}),i=pa(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the regenerated slide deck.");return i}catch(a){Zr(a,"slide deck regeneration")}},UM=async t=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const e=`
        You are an expert presentation designer. The following JSON represents a slide deck.
        Analyze its content and structure. Your task is to improve the layout, wording, and visual hierarchy for maximum clarity and impact.
        You can rephrase text for conciseness, change element positions and sizes, and adjust font properties. Do not change element types or IDs.
        Return the updated slide deck as a valid JSON object with the exact same structure as the input. Do not use markdown.
        CRITICAL: Textbox elements use a "content" field, NOT a "text" field.
        
        Input Deck (pruned for brevity):
        ${JSON.stringify(ed(t))}
    `;try{const n=await Gt.models.generateContent({model:Xr,contents:e,config:{responseMimeType:"application/json"}}),r=pa(n.text);if(!r||!Array.isArray(r.slides))throw new Error("AI returned an invalid format for the optimized slide deck.");return r}catch(n){Zr(n,"slide layout optimization")}},BM=async(t,e,n)=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a senior project manager AI. Your task is to conduct a holistic health check of the entire project.
      CONTEXT:
      - Overall Project Goal: "${e}"
      - Final Target Date: "${n}"
      - Current Date: "${new Date().toISOString().split("T")[0]}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Hs(t),null,2)}

      INSTRUCTIONS:
      1.  **Holistic Analysis**: Review ALL provided data. Compare task/sub-step due dates with the current date. Analyze dependencies, blockers, and the completion rate of action items.
      2.  **Determine Overall Status**: Categorize the project's health as 'On Track', 'At Risk', or 'Off Track'.
      3.  **Identify Positives**: List 2-3 key accomplishments or areas that are progressing well.
      4.  **Identify Concerns**: List the most critical risks or issues. For each, explain WHY it's a concern (e.g., "Task 'X' is 2 weeks overdue and blocking 3 other tasks"). Note the related task IDs.
      5.  **Propose Solutions**: For each major concern, provide concrete, actionable suggestions for improvement. (e.g., "Re-allocate resources from Task Y to Task X", "Hold a risk mitigation meeting for Z").
      6.  **Summarize**: Write a concise, executive-level summary of the project's current state.
      7.  **JSON Output**: Your response MUST be a single, valid JSON object following the ProjectHealthReport structure. Do not include markdown or explanations.
      8.  **The output language MUST be Japanese.**

      JSON Structure to follow:
      {
        "overallStatus": "'On Track' | 'At Risk' | 'Off Track'",
        "summary": "string",
        "positivePoints": ["string"],
        "areasOfConcern": [{ "description": "string", "relatedTaskIds": ["string"] }],
        "suggestions": ["string"]
      }
    `;try{const a=await Gt.models.generateContent({model:Xr,contents:r,config:{responseMimeType:"application/json"}}),i=pa(a.text);if(!i||!i.overallStatus||!i.summary)throw new Error("AI returned an invalid format for the project health report.");return i}catch(a){Zr(a,"project health report generation")}},jM=async(t,e,n)=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
        You are a senior project analyst AI. Your task is to create a comprehensive slide deck summarizing the ENTIRE project status.
        CONTEXT:
        - Overall Project Goal: "${e}"
        - Final Target Date: "${n}"
        - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Hs(t),null,2)}
        INSTRUCTIONS:
        1.  Synthesize a comprehensive slide deck (6-10 slides) summarizing the entire project.
        2.  The response MUST be a single, valid JSON object following the SlideDeck structure. Do NOT use markdown.
        3.  The output language MUST be Japanese.
        4.  **CRITICAL SYNTHESIS**:
            - **Title & Overview**: Create a title slide and a project overview slide.
            - **Task Summary & Flowchart**: For each major task in the 'tasks' array, create one or two summary slides. One slide should show a \`flowchart\` of its sub-steps if they exist, following the structure \`{"type": "flowchart", "data": {"subSteps": [...]}}\`. You MUST copy the task's specific \`subSteps\` array from the input JSON into the \`data.subSteps\` field. Another slide can summarize the task's status and outcomes.
            - **Key Project Decisions**: Analyze the 'decisions' data from all tasks. Create a dedicated slide titled "主要なプロジェクト決定事項". List the top 3-5 most important 'decided' items and their outcomes. Separately, list any critical 'undecided' questions that pose a risk to the project timeline or goals.
            - **Key Achievements & Risks**: Create dedicated slides for significant achievements and project-level risks.
            - **Conclusion**: A final slide summarizing the project's outlook and next steps.
        5.  Use the standard JSON format for slides and elements. Remember "content" for textboxes.
    `;try{const a=await Gt.models.generateContent({model:Xr,contents:r,config:{responseMimeType:"application/json"}}),i=pa(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the project slide deck.");return i}catch(a){Zr(a,"project report deck generation")}},VM=async(t,e,n,r)=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const a=`
      You are a senior project analyst AI. Your task is to update a project-wide status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Final Target Date: "${r}"
      - Updated Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Hs(e),null,2)}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(ed(t))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked slides), REGENERATE their content from scratch based on the updated project data.
      3.  This includes regenerating any 'flowchart' elements on unlocked slides to show the latest sub-step data.
      4.  Synthesize information across all tasks to provide a holistic project view in the regenerated slides.
      5.  The final output MUST be a single, valid JSON object for the complete slide deck, in the original slide order.
      6.  The output language MUST be Japanese.
    `;try{const i=await Gt.models.generateContent({model:Xr,contents:a,config:{responseMimeType:"application/json"}}),l=pa(i.text);if(!l||!Array.isArray(l.slides))throw new Error("AI returned an invalid format for the regenerated project slide deck.");return l}catch(i){Zr(i,"project report deck regeneration")}},HM=t=>{const e=t.match(/^data:(.+);base64,(.*)$/);return e?{mimeType:e[1],data:e[2]}:null},cw=t=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const e=[];for(const n of t){if(e.push({text:`
--- START OF SOURCE: ${n.name} ---
`}),n.type==="image"&&typeof n.content=="string"){const r=HM(n.content);r?e.push({inlineData:{mimeType:r.mimeType,data:r.data}}):e.push({text:"[Image data was invalid or in wrong format]"})}else if(n.type==="json"){const r=n.content.slides?ed(n.content):Hs(n.content);e.push({text:`Type: JSON Data
Content: ${JSON.stringify(r,null,2)}`})}else e.push({text:`Type: Text
Content: ${n.content}`});e.push({text:`
--- END OF SOURCE: ${n.name} ---
`})}return e},uw=async(t,e)=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are a professional presentation designer AI. Your task is to create a slide deck based on a user's objective and provided source materials.

        **USER OBJECTIVE**: "${e}"

        **CRITICAL INSTRUCTIONS**:
        1.  **Strict JSON Output**: Your entire response MUST be a single, valid JSON object. Do NOT include any text, explanations, or markdown fences (like \`\`\`json\`) outside of the JSON object. Your response should start with \`{\` and end with \`}\`.
        2.  **Schema Adherence**: The JSON object MUST strictly conform to the following TypeScript interfaces for \`SlideDeck\`, \`Slide\`, and \`SlideElement\`.
            \`\`\`typescript
            // The main container for the presentation
            interface SlideDeck {
              slides: Slide[];
              theme?: 'light' | 'dark' | 'business';
            }

            // Represents a single slide in the deck
            interface Slide {
              id: string; // A unique identifier for the slide
              layout: 'title_slide' | 'title_and_content' | 'section_header' | 'two_column' | 'blank';
              elements: SlideElement[];
              isLocked?: boolean; // Must be false for all generated slides
              notes?: string; // Optional speaker notes
            }

            // Union type for all possible elements on a slide
            type SlideElement = TextboxElement | ImageElement | TableElement | ChartElement | FlowchartElement;

            // Base interface for all elements
            interface BaseSlideElement {
              id: string; // A unique identifier for the element
              type: 'textbox' | 'image' | 'table' | 'chart' | 'flowchart';
              position: { x: number; y: number; width: number; height: number; }; // Position in percentages
            }

            // For displaying text
            interface TextboxElement extends BaseSlideElement {
              type: 'textbox';
              content: string; // IMPORTANT: The text content field MUST be named "content".
            }
            
            // For displaying an image from the source materials
            interface ImageElement extends BaseSlideElement {
              type: 'image';
              // You MUST find a relevant image from the source materials and reference its properties here.
              // These IDs must correspond to actual data in the sources provided.
              subStepId: string;
              actionItemId: string; 
              attachmentId: string;
            }

            // For displaying a flowchart of sub-steps
            interface FlowchartElement extends BaseSlideElement {
                type: 'flowchart';
                // You MUST copy the entire 'subSteps' array from the source task data into this field.
                data: {
                    subSteps: any[]; 
                };
            }
            \`\`\`
        3.  **Content Synthesis**:
            *   Analyze ALL provided source materials to create a coherent 4-7 slide presentation that directly addresses the user's objective.
            *   If image sources are provided, you MUST incorporate them into the slides using the 'image' element type.
            *   Do not just copy-paste. Interpret, summarize, and visualize the information effectively.
        4.  **Language**: The output language MUST be Japanese.
        5.  **IDs**: Generate unique string IDs for all 'id' fields in slides and elements.

        **SOURCE MATERIALS FOLLOW**:
    `},...cw(t)];r.push({text:`
Reminder: Create the slide deck now based on the objective and all the sources provided above. The response must be only the JSON object.`});try{const a=await Gt.models.generateContent({model:Xr,contents:{parts:r},config:{responseMimeType:"application/json"}}),i=pa(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the custom slide deck.");return i}catch(a){Zr(a,"custom slide deck generation")}},GM=async(t,e)=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are an expert project analyst. Your task is to write a text-based report based on a specific user objective and a collection of source materials.
        USER OBJECTIVE:
        "${e}"
        INSTRUCTIONS:
        1.  Synthesize the information from ALL provided source materials to create a coherent and insightful report that directly addresses the user's objective.
        2.  Do not simply copy-paste data. Interpret and summarize the information in a clear, professional manner.
        3.  Format the output using Markdown for readability (e.g., use headings, bullet points, bold text).
        4.  If image sources are provided, reference them by name in your report (e.g., "(see image: 'chart.png')"). Do not try to embed them.
        5.  The language of the output should be Japanese.
        6.  Your response MUST be only the text report. Do not include any other explanations.
        SOURCE MATERIALS FOLLOW:
    `},...cw(t)];r.push({text:`
Reminder: Write the report now based on the objective and all the sources provided above. The response must be only the text report.`});try{return(await Gt.models.generateContent({model:Xr,contents:{parts:r}})).text}catch(a){Zr(a,"custom text report generation")}},jy=async(t,e,n)=>{if(!Gt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a project management assistant AI. Your task is to convert a project structure into data for a Gantt chart.
      CONTEXT:
      - Project Goal: "${e}"
      - Project Start Date: "${new Date().toISOString().split("T")[0]}"
      - Project Target End Date: "${n}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Hs(t),null,2)}

      INSTRUCTIONS:
      1.  Create a flat list of items for the Gantt chart. Include every ProjectTask, every SubStep, and every ActionItem from all tasks.
      2.  For each item, generate a JSON object with this exact structure:
          { "id": "string", "name": "string", "start": "YYYY-MM-DD", "end": "YYYY-MM-DD", "progress": number, "dependencies": ["string"], "type": "'task' | 'substep' | 'actionitem'", "parentId": "string | null" }
      3.  **Date Estimation**:
          - The project must fit between the start and target dates.
          - Use an item's \`dueDate\` as its 'end' date if available for tasks and sub-steps.
          - Estimate 'start' and 'end' dates logically. An item must start after its dependencies end.
          - For 'actionitem', estimate a short duration (e.g., 1-2 days) within the parent sub-step's timeframe.
      4.  **Progress Calculation**:
          - For a 'task': 'Completed' is 100, 'Not Started' is 0. For 'In Progress' or 'Blocked', average the progress of its sub-steps. If no sub-steps, 'In Progress' is 50.
          - For a 'substep': Calculate progress from its \`actionItems\` (% of completed items). If no action items, use its \`status\`: 'Completed' is 100, 'In Progress' is 50, 'Not Started' is 0.
          - For an 'actionitem': 'completed: true' is 100, 'completed: false' is 0.
      5.  **Dependencies & Parent ID**:
          - **Rule**: The 'dependencies' array models the sequential workflow. A dependency can ONLY exist between items of the SAME \`type\` AND with the SAME \`parentId\`.
          - **Tasks**: A task's 'parentId' is ALWAYS null. Use \`nextTaskIds\` to establish dependencies between tasks.
          - **Sub-steps**: A sub-step's 'parentId' MUST BE the ID of its parent ProjectTask. Use \`nextSubStepIds\` to establish dependencies ONLY between sub-steps within the same task.
          - **Action Items**: An action item's 'parentId' MUST BE the ID of its parent SubStep. Create sequential dependencies ONLY between action items within the same sub-step (item 2 depends on item 1, etc.).
          - **CRITICAL**: Do NOT create dependencies across different parents (e.g., from a sub-step in Task A to one in Task B) or across different types (e.g., from a task to a sub-step).
      6.  Your response MUST be a single, valid JSON array of GanttItem objects. Do not use markdown.
    `;try{const a=await Gt.models.generateContent({model:Xr,contents:r,config:{responseMimeType:"application/json"}}),i=pa(a.text);if(!i||!Array.isArray(i))throw new Error("AI returned an invalid format for the Gantt chart data.");return i}catch(a){Zr(a,"Gantt chart data generation")}},$M="modulepreload",zM=function(t){return"/"+t},Vy={},Hc=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){let l=function(f){return Promise.all(f.map(g=>Promise.resolve(g).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=l(n.map(f=>{if(f=zM(f),f in Vy)return;Vy[f]=!0;const g=f.endsWith(".css"),y=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${y}`))return;const T=document.createElement("link");if(T.rel=g?"stylesheet":$M,g||(T.as="script"),T.crossOrigin="",T.href=f,d&&T.setAttribute("nonce",d),document.head.appendChild(T),g)return new Promise((w,E)=>{T.addEventListener("load",w),T.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},qM=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Hc(async()=>{const{default:r}=await Promise.resolve().then(()=>el);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Im extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class YM extends Im{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Hy extends Im{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Gy extends Im{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var am;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(am||(am={}));var JM=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class WM{constructor(e,{headers:n={},customFetch:r,region:a=am.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=qM(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return JM(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:l}=n;let c={},{region:d}=n;d||(d=this.region);const f=new URL(`${this.url}/${e}`);d&&d!=="any"&&(c["x-region"]=d,f.searchParams.set("forceFunctionRegion",d));let g;l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",g=l):typeof l=="string"?(c["Content-Type"]="text/plain",g=l):typeof FormData<"u"&&l instanceof FormData?g=l:(c["Content-Type"]="application/json",g=JSON.stringify(l)));const y=yield this.fetch(f.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:g}).catch(S=>{throw new YM(S)}),T=y.headers.get("x-relay-error");if(T&&T==="true")throw new Hy(y);if(!y.ok)throw new Gy(y);let w=((r=y.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),E;return w==="application/json"?E=yield y.json():w==="application/octet-stream"?E=yield y.blob():w==="text/event-stream"?E=y:w==="multipart/form-data"?E=yield y.formData():E=yield y.text(),{data:E,error:null,response:y}}catch(a){return{data:null,error:a,response:a instanceof Gy||a instanceof Hy?a.context:void 0}}})}}var In={},xo={},vo={},yo={},_o={},To={},KM=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},zo=KM();const XM=zo.fetch,fw=zo.fetch.bind(zo),dw=zo.Headers,ZM=zo.Request,QM=zo.Response,el=Object.freeze(Object.defineProperty({__proto__:null,Headers:dw,Request:ZM,Response:QM,default:fw,fetch:XM},Symbol.toStringTag,{value:"Module"})),eI=Db(el);var of={},$y;function hw(){if($y)return of;$y=1,Object.defineProperty(of,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return of.default=t,of}var zy;function mw(){if(zy)return To;zy=1;var t=To&&To.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(To,"__esModule",{value:!0});const e=t(eI),n=t(hw());class r{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,l){return this.headers=Object.assign({},this.headers),this.headers[i]=l,this}then(i,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var g,y,T;let w=null,E=null,S=null,b=f.status,N=f.statusText;if(f.ok){if(this.method!=="HEAD"){const j=await f.text();j===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?E=j:E=JSON.parse(j))}const C=(g=this.headers.Prefer)===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),P=(y=f.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");C&&P&&P.length>1&&(S=parseInt(P[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(w={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,S=null,b=406,N="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const C=await f.text();try{w=JSON.parse(C),Array.isArray(w)&&f.status===404&&(E=[],w=null,b=200,N="OK")}catch{f.status===404&&C===""?(b=204,N="No Content"):w={message:C}}if(w&&this.isMaybeSingle&&(!((T=w==null?void 0:w.details)===null||T===void 0)&&T.includes("0 rows"))&&(w=null,b=200,N="OK"),w&&this.shouldThrowOnError)throw new n.default(w)}return{error:w,data:E,count:S,status:b,statusText:N}});return this.shouldThrowOnError||(d=d.catch(f=>{var g,y,T;return{error:{message:`${(g=f==null?void 0:f.name)!==null&&g!==void 0?g:"FetchError"}: ${f==null?void 0:f.message}`,details:`${(y=f==null?void 0:f.stack)!==null&&y!==void 0?y:""}`,hint:"",code:`${(T=f==null?void 0:f.code)!==null&&T!==void 0?T:""}`},data:null,count:null,status:0,statusText:""}})),d.then(i,l)}returns(){return this}overrideTypes(){return this}}return To.default=r,To}var qy;function pw(){if(qy)return _o;qy=1;var t=_o&&_o.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(_o,"__esModule",{value:!0});const e=t(mw());class n extends e.default{select(a){let i=!1;const l=(a??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",l),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(a,{ascending:i=!0,nullsFirst:l,foreignTable:c,referencedTable:d=c}={}){const f=d?`${d}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${a}.${i?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:i,referencedTable:l=i}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${a}`),this}range(a,i,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"offset":`${c}.offset`,f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this.url.searchParams.set(f,`${i-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:a=!1,verbose:i=!1,settings:l=!1,buffers:c=!1,wal:d=!1,format:f="text"}={}){var g;const y=[a?"analyze":null,i?"verbose":null,l?"settings":null,c?"buffers":null,d?"wal":null].filter(Boolean).join("|"),T=(g=this.headers.Accept)!==null&&g!==void 0?g:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${f}; for="${T}"; options=${y};`,f==="json"?this:this}rollback(){var a;return((a=this.headers.Prefer)!==null&&a!==void 0?a:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return _o.default=n,_o}var Yy;function Fm(){if(Yy)return yo;Yy=1;var t=yo&&yo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(yo,"__esModule",{value:!0});const e=t(pw());class n extends e.default{eq(a,i){return this.url.searchParams.append(a,`eq.${i}`),this}neq(a,i){return this.url.searchParams.append(a,`neq.${i}`),this}gt(a,i){return this.url.searchParams.append(a,`gt.${i}`),this}gte(a,i){return this.url.searchParams.append(a,`gte.${i}`),this}lt(a,i){return this.url.searchParams.append(a,`lt.${i}`),this}lte(a,i){return this.url.searchParams.append(a,`lte.${i}`),this}like(a,i){return this.url.searchParams.append(a,`like.${i}`),this}likeAllOf(a,i){return this.url.searchParams.append(a,`like(all).{${i.join(",")}}`),this}likeAnyOf(a,i){return this.url.searchParams.append(a,`like(any).{${i.join(",")}}`),this}ilike(a,i){return this.url.searchParams.append(a,`ilike.${i}`),this}ilikeAllOf(a,i){return this.url.searchParams.append(a,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(a,i){return this.url.searchParams.append(a,`ilike(any).{${i.join(",")}}`),this}is(a,i){return this.url.searchParams.append(a,`is.${i}`),this}in(a,i){const l=Array.from(new Set(i)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cs.{${i.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(i)}`),this}containedBy(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cd.{${i.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(i)}`),this}rangeGt(a,i){return this.url.searchParams.append(a,`sr.${i}`),this}rangeGte(a,i){return this.url.searchParams.append(a,`nxl.${i}`),this}rangeLt(a,i){return this.url.searchParams.append(a,`sl.${i}`),this}rangeLte(a,i){return this.url.searchParams.append(a,`nxr.${i}`),this}rangeAdjacent(a,i){return this.url.searchParams.append(a,`adj.${i}`),this}overlaps(a,i){return typeof i=="string"?this.url.searchParams.append(a,`ov.${i}`):this.url.searchParams.append(a,`ov.{${i.join(",")}}`),this}textSearch(a,i,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const f=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${d}fts${f}.${i}`),this}match(a){return Object.entries(a).forEach(([i,l])=>{this.url.searchParams.append(i,`eq.${l}`)}),this}not(a,i,l){return this.url.searchParams.append(a,`not.${i}.${l}`),this}or(a,{foreignTable:i,referencedTable:l=i}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,i,l){return this.url.searchParams.append(a,`${i}.${l}`),this}}return yo.default=n,yo}var Jy;function gw(){if(Jy)return vo;Jy=1;var t=vo&&vo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(vo,"__esModule",{value:!0});const e=t(Fm());class n{constructor(a,{headers:i={},schema:l,fetch:c}){this.url=a,this.headers=i,this.schema=l,this.fetch=c}select(a,{head:i=!1,count:l}={}){const c=i?"HEAD":"GET";let d=!1;const f=(a??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",f),l&&(this.headers.Prefer=`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(a,{count:i,defaultToNull:l=!0}={}){const c="POST",d=[];if(this.headers.Prefer&&d.push(this.headers.Prefer),i&&d.push(`count=${i}`),l||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(a)){const f=a.reduce((g,y)=>g.concat(Object.keys(y)),[]);if(f.length>0){const g=[...new Set(f)].map(y=>`"${y}"`);this.url.searchParams.set("columns",g.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}upsert(a,{onConflict:i,ignoreDuplicates:l=!1,count:c,defaultToNull:d=!0}={}){const f="POST",g=[`resolution=${l?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&g.push(this.headers.Prefer),c&&g.push(`count=${c}`),d||g.push("missing=default"),this.headers.Prefer=g.join(","),Array.isArray(a)){const y=a.reduce((T,w)=>T.concat(Object.keys(w)),[]);if(y.length>0){const T=[...new Set(y)].map(w=>`"${w}"`);this.url.searchParams.set("columns",T.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}update(a,{count:i}={}){const l="PATCH",c=[];return this.headers.Prefer&&c.push(this.headers.Prefer),i&&c.push(`count=${i}`),this.headers.Prefer=c.join(","),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}delete({count:a}={}){const i="DELETE",l=[];return a&&l.push(`count=${a}`),this.headers.Prefer&&l.unshift(this.headers.Prefer),this.headers.Prefer=l.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return vo.default=n,vo}var tc={},nc={},Wy;function tI(){return Wy||(Wy=1,Object.defineProperty(nc,"__esModule",{value:!0}),nc.version=void 0,nc.version="0.0.0-automated"),nc}var Ky;function nI(){if(Ky)return tc;Ky=1,Object.defineProperty(tc,"__esModule",{value:!0}),tc.DEFAULT_HEADERS=void 0;const t=tI();return tc.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},tc}var Xy;function rI(){if(Xy)return xo;Xy=1;var t=xo&&xo.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(xo,"__esModule",{value:!0});const e=t(gw()),n=t(Fm()),r=nI();class a{constructor(l,{headers:c={},schema:d,fetch:f}={}){this.url=l,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),c),this.schemaName=d,this.fetch=f}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new a(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:f=!1,count:g}={}){let y;const T=new URL(`${this.url}/rpc/${l}`);let w;d||f?(y=d?"HEAD":"GET",Object.entries(c).filter(([S,b])=>b!==void 0).map(([S,b])=>[S,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([S,b])=>{T.searchParams.append(S,b)})):(y="POST",w=c);const E=Object.assign({},this.headers);return g&&(E.Prefer=`count=${g}`),new n.default({method:y,url:T,headers:E,schema:this.schemaName,body:w,fetch:this.fetch,allowEmpty:!1})}}return xo.default=a,xo}var Zy;function aI(){if(Zy)return In;Zy=1;var t=In&&In.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(In,"__esModule",{value:!0}),In.PostgrestError=In.PostgrestBuilder=In.PostgrestTransformBuilder=In.PostgrestFilterBuilder=In.PostgrestQueryBuilder=In.PostgrestClient=void 0;const e=t(rI());In.PostgrestClient=e.default;const n=t(gw());In.PostgrestQueryBuilder=n.default;const r=t(Fm());In.PostgrestFilterBuilder=r.default;const a=t(pw());In.PostgrestTransformBuilder=a.default;const i=t(mw());In.PostgrestBuilder=i.default;const l=t(hw());return In.PostgrestError=l.default,In.default={PostgrestClient:e.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:i.default,PostgrestError:l.default},In}var sI=aI();const iI=bm(sI),{PostgrestClient:oI,PostgrestQueryBuilder:YV,PostgrestFilterBuilder:JV,PostgrestTransformBuilder:WV,PostgrestBuilder:KV,PostgrestError:XV}=iI;function lI(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const cI=lI(),uI="2.11.15",fI=`realtime-js/${uI}`,dI="1.0.0",xw=1e4,hI=1e3;var dc;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(dc||(dc={}));var Yn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Yn||(Yn={}));var ca;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ca||(ca={}));var sm;(function(t){t.websocket="websocket"})(sm||(sm={}));var di;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(di||(di={}));class mI{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const a=n.getUint8(1),i=n.getUint8(2);let l=this.HEADER_LENGTH+2;const c=r.decode(e.slice(l,l+a));l=l+a;const d=r.decode(e.slice(l,l+i));l=l+i;const f=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{ref:null,topic:c,event:d,payload:f}}}class vw{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Jt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Jt||(Jt={}));const Qy=(t,e,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,l)=>(i[l]=pI(l,t,e,a),i),{})},pI=(t,e,n,r)=>{const a=e.find(c=>c.name===t),i=a==null?void 0:a.type,l=n[t];return i&&!r.includes(i)?yw(i,l):im(l)},yw=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return yI(e,n)}switch(t){case Jt.bool:return gI(e);case Jt.float4:case Jt.float8:case Jt.int2:case Jt.int4:case Jt.int8:case Jt.numeric:case Jt.oid:return xI(e);case Jt.json:case Jt.jsonb:return vI(e);case Jt.timestamp:return _I(e);case Jt.abstime:case Jt.date:case Jt.daterange:case Jt.int4range:case Jt.int8range:case Jt.money:case Jt.reltime:case Jt.text:case Jt.time:case Jt.timestamptz:case Jt.timetz:case Jt.tsrange:case Jt.tstzrange:return im(e);default:return im(e)}},im=t=>t,gI=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},xI=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},vI=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},yI=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const l=t.slice(1,n);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(c=>yw(e,c))}return t},_I=t=>typeof t=="string"?t.replace(" ","T"):t,_w=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Th{constructor(e,n,r={},a=xw){this.channel=e,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var e_;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(e_||(e_={}));class hc{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=hc.syncState(this.state,a,i,l),this.pendingDiffs.forEach(d=>{this.state=hc.syncDiff(this.state,d,i,l)}),this.pendingDiffs=[],c()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=hc.syncDiff(this.state,a,i,l),c())}),this.onJoin((a,i,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:l})}),this.onLeave((a,i,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,a){const i=this.cloneDeep(e),l=this.transformState(n),c={},d={};return this.map(i,(f,g)=>{l[f]||(d[f]=g)}),this.map(l,(f,g)=>{const y=i[f];if(y){const T=g.map(b=>b.presence_ref),w=y.map(b=>b.presence_ref),E=g.filter(b=>w.indexOf(b.presence_ref)<0),S=y.filter(b=>T.indexOf(b.presence_ref)<0);E.length>0&&(c[f]=E),S.length>0&&(d[f]=S)}else c[f]=g}),this.syncDiff(i,{joins:c,leaves:d},r,a)}static syncDiff(e,n,r,a){const{joins:i,leaves:l}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(c,d)=>{var f;const g=(f=e[c])!==null&&f!==void 0?f:[];if(e[c]=this.cloneDeep(d),g.length>0){const y=e[c].map(w=>w.presence_ref),T=g.filter(w=>y.indexOf(w.presence_ref)<0);e[c].unshift(...T)}r(c,g,d)}),this.map(l,(c,d)=>{let f=e[c];if(!f)return;const g=d.map(y=>y.presence_ref);f=f.filter(y=>g.indexOf(y.presence_ref)<0),e[c]=f,a(c,f,d),f.length===0&&delete e[c]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const a=e[r];return"metas"in a?n[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var t_;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(t_||(t_={}));var n_;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(n_||(n_={}));var Ja;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Ja||(Ja={}));class Om{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Yn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Th(this,ca.join,this.params,this.timeout),this.rejoinTimer=new vw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Yn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Yn.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Yn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Yn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ca.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new hc(this),this.broadcastEndpointURL=_w(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Yn.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params;this._onError(g=>e==null?void 0:e(Ja.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(Ja.CLOSED));const d={},f={broadcast:i,presence:l,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&a!==void 0?a:[],private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var y;if(this.socket.setAuth(),g===void 0){e==null||e(Ja.SUBSCRIBED);return}else{const T=this.bindings.postgres_changes,w=(y=T==null?void 0:T.length)!==null&&y!==void 0?y:0,E=[];for(let S=0;S<w;S++){const b=T[S],{filter:{event:N,schema:k,table:C,filter:P}}=b,j=g&&g[S];if(j&&j.event===N&&j.schema===k&&j.table===C&&j.filter===P)E.push(Object.assign(Object.assign({},b),{id:j.id}));else{this.unsubscribe(),this.state=Yn.errored,e==null||e(Ja.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,e&&e(Ja.SUBSCRIBED);return}}).receive("error",g=>{this.state=Yn.errored,e==null||e(Ja.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ja.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:l}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,c,d;const f=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),f.receive("ok",()=>i("ok")),f.receive("error",()=>i("error")),f.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Yn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ca.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new Th(this,ca.leave,{},e),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),l=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(i),l}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Th(this,e,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var a,i;const l=e.toLocaleLowerCase(),{close:c,error:d,leave:f,join:g}=ca;if(r&&[c,d,f,g].indexOf(l)>=0&&r!==this._joinRef())return;let T=this._onMessage(l,n,r);if(n&&!T)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(w=>{var E,S,b;return((E=w.filter)===null||E===void 0?void 0:E.event)==="*"||((b=(S=w.filter)===null||S===void 0?void 0:S.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===l}).map(w=>w.callback(T,r)):(i=this.bindings[l])===null||i===void 0||i.filter(w=>{var E,S,b,N,k,C;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in w){const P=w.id,j=(E=w.filter)===null||E===void 0?void 0:E.event;return P&&((S=n.ids)===null||S===void 0?void 0:S.includes(P))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((b=n.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const P=(k=(N=w==null?void 0:w.filter)===null||N===void 0?void 0:N.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return P==="*"||P===((C=n==null?void 0:n.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return w.type.toLocaleLowerCase()===l}).map(w=>{if(typeof T=="object"&&"ids"in T){const E=T.data,{schema:S,table:b,commit_timestamp:N,type:k,errors:C}=E;T=Object.assign(Object.assign({},{schema:S,table:b,commit_timestamp:N,eventType:k,new:{},old:{},errors:C}),this._getPayloadRecords(E))}w.callback(T,r)})}_isClosed(){return this.state===Yn.closed}_isJoined(){return this.state===Yn.joined}_isJoining(){return this.state===Yn.joining}_isLeaving(){return this.state===Yn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const a=e.toLocaleLowerCase(),i={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Om.isEqual(a.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ca.close,{},e)}_onError(e){this._on(ca.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Yn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Qy(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Qy(e.columns,e.old_record)),n}}const r_=()=>{},TI=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class wI{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xw,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=r_,this.ref=0,this.logger=r_,this.conn=null,this.sendBuffer=[],this.serializer=new mI,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let l;return i?l=i:typeof fetch>"u"?l=(...c)=>Hc(async()=>{const{default:d}=await Promise.resolve().then(()=>el);return{default:d}},void 0).then(({default:d})=>d(...c)):l=fetch,(...c)=>l(...c)},this.endPoint=`${e}/${sm.websocket}`,this.httpEndpoint=_w(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(i,l)=>l(JSON.stringify(i)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new vw(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=cI),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:dI}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case dc.connecting:return di.Connecting;case dc.open:return di.Open;case dc.closing:return di.Closing;default:return di.Closed}}isConnected(){return this.connectionState()===di.Open}channel(e,n={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new Om(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:a,ref:i}=e,l=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${n} ${r} (${i})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:fI};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(ca.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(hI,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:a,payload:i,ref:l}=n;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${a} ${l&&"("+l+")"||""}`,i),Array.from(this.channels).filter(c=>c._isMember(r)).forEach(c=>c._trigger(a,i,l)),this.stateChangeCallbacks.message.forEach(c=>c(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(ca.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${r}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([TI],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class Lm extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Fn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class EI extends Lm{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class om extends Lm{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var SI=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const Tw=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Hc(async()=>{const{default:r}=await Promise.resolve().then(()=>el);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},bI=()=>SI(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Hc(()=>Promise.resolve().then(()=>el),void 0)).Response:Response}),lm=t=>{if(Array.isArray(t))return t.map(n=>lm(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=lm(r)}),e};var ki=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const wh=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),CI=(t,e,n)=>ki(void 0,void 0,void 0,function*(){const r=yield bI();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{e(new EI(wh(a),t.status||500))}).catch(a=>{e(new om(wh(a),a))}):e(new om(wh(t),t))}),AI=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function Gc(t,e,n,r,a,i){return ki(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(n,AI(e,r,a,i)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>CI(d,c,r))})})}function Ff(t,e,n,r){return ki(this,void 0,void 0,function*(){return Gc(t,"GET",e,n,r)})}function Rs(t,e,n,r,a){return ki(this,void 0,void 0,function*(){return Gc(t,"POST",e,r,a,n)})}function kI(t,e,n,r,a){return ki(this,void 0,void 0,function*(){return Gc(t,"PUT",e,r,a,n)})}function NI(t,e,n,r){return ki(this,void 0,void 0,function*(){return Gc(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function ww(t,e,n,r,a){return ki(this,void 0,void 0,function*(){return Gc(t,"DELETE",e,r,a,n)})}var mr=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const RI={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},a_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class DI{constructor(e,n={},r,a){this.url=e,this.headers=n,this.bucketId=r,this.fetch=Tw(a)}uploadOrUpdate(e,n,r,a){return mr(this,void 0,void 0,function*(){try{let i;const l=Object.assign(Object.assign({},a_),a);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),d&&i.append("metadata",this.encodeMetadata(d)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",l.cacheControl),d&&i.append("metadata",this.encodeMetadata(d))):(i=r,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const f=this._removeEmptyFolders(n),g=this._getFinalPath(f),y=yield this.fetch(`${this.url}/object/${g}`,Object.assign({method:e,body:i,headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{})),T=yield y.json();return y.ok?{data:{path:f,id:T.Id,fullPath:T.Key},error:null}:{data:null,error:T}}catch(i){if(Fn(i))return{data:null,error:i};throw i}})}upload(e,n,r){return mr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,a){return mr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),l=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",n);try{let d;const f=Object.assign({upsert:a_.upsert},a),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",f.cacheControl)):(d=r,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType);const y=yield this.fetch(c.toString(),{method:"PUT",body:d,headers:g}),T=yield y.json();return y.ok?{data:{path:i,fullPath:T.Key},error:null}:{data:null,error:T}}catch(d){if(Fn(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,n){return mr(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const i=yield Rs(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),l=new URL(this.url+i.url),c=l.searchParams.get("token");if(!c)throw new Lm("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(r){if(Fn(r))return{data:null,error:r};throw r}})}update(e,n,r){return mr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return mr(this,void 0,void 0,function*(){try{return{data:yield Rs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Fn(a))return{data:null,error:a};throw a}})}copy(e,n,r){return mr(this,void 0,void 0,function*(){try{return{data:{path:(yield Rs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Fn(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,r){return mr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield Rs(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(a){if(Fn(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,r){return mr(this,void 0,void 0,function*(){try{const a=yield Rs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${i}`):null})),error:null}}catch(a){if(Fn(a))return{data:null,error:a};throw a}})}download(e,n){return mr(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),l=i?`?${i}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield Ff(this.fetch,`${this.url}/${a}/${c}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(Fn(c))return{data:null,error:c};throw c}})}info(e){return mr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Ff(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:lm(r),error:null}}catch(r){if(Fn(r))return{data:null,error:r};throw r}})}exists(e){return mr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield NI(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Fn(r)&&r instanceof om){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),a=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&a.push(i);const c=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});d!==""&&a.push(d);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${f}`)}}}remove(e){return mr(this,void 0,void 0,function*(){try{return{data:yield ww(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(Fn(n))return{data:null,error:n};throw n}})}list(e,n,r){return mr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},RI),n),{prefix:e||""});return{data:yield Rs(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(Fn(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const MI="2.7.1",II={"X-Client-Info":`storage-js/${MI}`};var wo=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class FI{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},II),n),this.fetch=Tw(r)}listBuckets(){return wo(this,void 0,void 0,function*(){try{return{data:yield Ff(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Fn(e))return{data:null,error:e};throw e}})}getBucket(e){return wo(this,void 0,void 0,function*(){try{return{data:yield Ff(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(Fn(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return wo(this,void 0,void 0,function*(){try{return{data:yield Rs(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Fn(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return wo(this,void 0,void 0,function*(){try{return{data:yield kI(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Fn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return wo(this,void 0,void 0,function*(){try{return{data:yield Rs(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Fn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return wo(this,void 0,void 0,function*(){try{return{data:yield ww(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(Fn(n))return{data:null,error:n};throw n}})}}class OI extends FI{constructor(e,n={},r){super(e,n,r)}from(e){return new DI(this.url,this.headers,e,this.fetch)}}const LI="2.50.3";let sc="";typeof Deno<"u"?sc="deno":typeof document<"u"?sc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?sc="react-native":sc="node";const PI={"X-Client-Info":`supabase-js-${sc}/${LI}`},UI={headers:PI},BI={schema:"public"},jI={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},VI={};var HI=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const GI=t=>{let e;return t?e=t:typeof fetch>"u"?e=fw:e=fetch,(...n)=>e(...n)},$I=()=>typeof Headers>"u"?dw:Headers,zI=(t,e,n)=>{const r=GI(n),a=$I();return(i,l)=>HI(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:t;let f=new a(l==null?void 0:l.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),r(i,Object.assign(Object.assign({},l),{headers:f}))})};var qI=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};function YI(t){return t.endsWith("/")?t:t+"/"}function JI(t,e){var n,r;const{db:a,auth:i,realtime:l,global:c}=t,{db:d,auth:f,realtime:g,global:y}=e,T={db:Object.assign(Object.assign({},d),a),auth:Object.assign(Object.assign({},f),i),realtime:Object.assign(Object.assign({},g),l),global:Object.assign(Object.assign(Object.assign({},y),c),{headers:Object.assign(Object.assign({},(n=y==null?void 0:y.headers)!==null&&n!==void 0?n:{}),(r=c==null?void 0:c.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>qI(this,void 0,void 0,function*(){return""})};return t.accessToken?T.accessToken=t.accessToken:delete T.accessToken,T}const Ew="2.70.0",Ro=30*1e3,cm=3,Eh=cm*Ro,WI="http://localhost:9999",KI="supabase.auth.token",XI={"X-Client-Info":`gotrue-js/${Ew}`},um="X-Supabase-Api-Version",Sw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ZI=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,QI=6e5;class Pm extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function ct(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class e6 extends Pm{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function t6(t){return ct(t)&&t.name==="AuthApiError"}class bw extends Pm{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Gs extends Pm{constructor(e,n,r,a){super(e,r,a),this.name=n,this.status=r}}class ks extends Gs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function n6(t){return ct(t)&&t.name==="AuthSessionMissingError"}class lf extends Gs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cf extends Gs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class uf extends Gs{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function r6(t){return ct(t)&&t.name==="AuthImplicitGrantRedirectError"}class s_ extends Gs{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class fm extends Gs{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Sh(t){return ct(t)&&t.name==="AuthRetryableFetchError"}class i_ extends Gs{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class mc extends Gs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Of="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),o_=` 	
\r=`.split(""),a6=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<o_.length;e+=1)t[o_[e].charCodeAt(0)]=-2;for(let e=0;e<Of.length;e+=1)t[Of[e].charCodeAt(0)]=e;return t})();function l_(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Of[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Of[r]),e.queuedBits-=6}}function Cw(t,e,n){const r=a6[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function c_(t){const e=[],n=l=>{e.push(String.fromCodePoint(l))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=l=>{o6(l,r,n)};for(let l=0;l<t.length;l+=1)Cw(t.charCodeAt(l),a,i);return e.join("")}function s6(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function i6(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}s6(r,e)}}function o6(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if((t>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function l6(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)Cw(t.charCodeAt(a),n,r);return new Uint8Array(e)}function c6(t){const e=[];return i6(t,n=>e.push(n)),new Uint8Array(e)}function u6(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};return t.forEach(a=>l_(a,n,r)),l_(null,n,r),e.join("")}function f6(t){return Math.round(Date.now()/1e3)+t}function d6(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const la=()=>typeof window<"u"&&typeof document<"u",ui={tested:!1,writable:!1},pc=()=>{if(!la())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ui.tested)return ui.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ui.tested=!0,ui.writable=!0}catch{ui.tested=!0,ui.writable=!1}return ui.writable};function h6(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return n.searchParams.forEach((r,a)=>{e[a]=r}),e}const Aw=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Hc(async()=>{const{default:r}=await Promise.resolve().then(()=>el);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},m6=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",kw=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},ff=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},df=async(t,e)=>{await t.removeItem(e)};class td{constructor(){this.promise=new td.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}td.promiseConstructor=Promise;function bh(t){const e=t.split(".");if(e.length!==3)throw new mc("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!ZI.test(e[r]))throw new mc("JWT not in base64url format");return{header:JSON.parse(c_(e[0])),payload:JSON.parse(c_(e[1])),signature:l6(e[2]),raw:{header:e[0],payload:e[1]}}}async function p6(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function g6(t,e){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await t(i);if(!e(i,null,l)){r(l);return}}catch(l){if(!e(i,l)){a(l);return}}})()})}function x6(t){return("0"+t.toString(16)).substr(-2)}function v6(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let i=0;i<56;i++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,x6).join("")}async function y6(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function _6(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await y6(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Eo(t,e,n=!1){const r=v6();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await kw(t,`${e}-code-verifier`,a);const i=await _6(r);return[i,r===i?"plain":"s256"]}const T6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function w6(t){const e=t.headers.get(um);if(!e||!e.match(T6))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function E6(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function S6(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const b6=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function So(t){if(!b6.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var C6=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const fi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),A6=[502,503,504];async function u_(t){var e;if(!m6(t))throw new fm(fi(t),0);if(A6.includes(t.status))throw new fm(fi(t),t.status);let n;try{n=await t.json()}catch(i){throw new bw(fi(i),i)}let r;const a=w6(t);if(a&&a.getTime()>=Sw["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new i_(fi(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ks}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new i_(fi(n),t.status,n.weak_password.reasons);throw new e6(fi(n),t.status||500,r)}const k6=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function vt(t,e,n,r){var a;const i=Object.assign({},r==null?void 0:r.headers);i[um]||(i[um]=Sw["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const l=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(l.redirect_to=r.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await N6(t,e,n+c,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(d):{data:Object.assign({},d),error:null}}async function N6(t,e,n,r,a,i){const l=k6(e,r,a,i);let c;try{c=await t(n,Object.assign({},l))}catch(d){throw console.error(d),new fm(fi(d),0)}if(c.ok||await u_(c),r!=null&&r.noResolveJson)return c;try{return await c.json()}catch(d){await u_(d)}}function Ya(t){var e;let n=null;I6(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=f6(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function f_(t){const e=Ya(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ds(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function R6(t){return{data:t,error:null}}function D6(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i}=t,l=C6(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function M6(t){return t}function I6(t){return t.access_token&&t.refresh_token&&t.expires_in}const Ch=["global","local","others"];var F6=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};class O6{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=Aw(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=Ch[0]){if(Ch.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ch.join(", ")}`);try{return await vt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ct(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await vt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ds})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=F6(e,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await vt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:D6,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ct(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await vt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ds})}catch(n){if(ct(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,a,i,l,c,d;try{const f={nextPage:null,lastPage:0,total:0},g=await vt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:M6});if(g.error)throw g.error;const y=await g.json(),T=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,w=(d=(c=g.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return w.length>0&&(w.forEach(E=>{const S=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(E.split(";")[1].split("=")[1]);f[`${b}Page`]=S}),f.total=parseInt(T)),{data:Object.assign(Object.assign({},y),f),error:null}}catch(f){if(ct(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){So(e);try{return await vt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ds})}catch(n){if(ct(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){So(e);try{return await vt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ds})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){So(e);try{return await vt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ds})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){So(e.userId);try{const{data:n,error:r}=await vt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _deleteFactor(e){So(e.userId),So(e.id);try{return{data:await vt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ct(n))return{data:null,error:n};throw n}}}const L6={getItem:t=>pc()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{pc()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{pc()&&globalThis.localStorage.removeItem(t)}};function d_(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function P6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const bo={debug:!!(globalThis&&pc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Nw extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class U6 extends Nw{}async function B6(t,e,n){bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),bo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new U6(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(bo.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}P6();const j6={url:WI,storageKey:KI,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:XI,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function h_(t,e,n){return await n()}class kc{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=kc.nextInstanceID,kc.nextInstanceID+=1,this.instanceID>0&&la()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},j6),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new O6({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Aw(a.fetch),this.lock=a.lock||h_,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:la()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=B6:this.lock=h_,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:pc()?this.storage=L6:(this.memoryStorage={},this.storage=d_(this.memoryStorage)):(this.memoryStorage={},this.storage=d_(this.memoryStorage)),la()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ew}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=h6(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),la()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),r6(i)){const d=(e=i.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ct(n)?{error:n}:{error:new bw("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,a;try{const i=await vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:Ya}),{data:l,error:c}=i;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(i){if(ct(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,r,a;try{let i;if("email"in e){const{email:g,password:y,options:T}=e;let w=null,E=null;this.flowType==="pkce"&&([w,E]=await Eo(this.storage,this.storageKey)),i=await vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:T==null?void 0:T.emailRedirectTo,body:{email:g,password:y,data:(n=T==null?void 0:T.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:T==null?void 0:T.captchaToken},code_challenge:w,code_challenge_method:E},xform:Ya})}else if("phone"in e){const{phone:g,password:y,options:T}=e;i=await vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:y,data:(r=T==null?void 0:T.data)!==null&&r!==void 0?r:{},channel:(a=T==null?void 0:T.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:T==null?void 0:T.captchaToken}},xform:Ya})}else throw new cf("You must provide either an email or phone number and a password");const{data:l,error:c}=i;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(i){if(ct(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:l,options:c}=e;n=await vt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:f_})}else if("phone"in e){const{phone:i,password:l,options:c}=e;n=await vt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:f_})}else throw new cf("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new lf}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,a,i,l,c,d,f,g,y,T,w;let E,S;if("message"in e)E=e.message,S=e.signature;else{const{chain:b,wallet:N,statement:k,options:C}=e;let P;if(la())if(typeof N=="object")P=N;else{const H=window;if("solana"in H&&typeof H.solana=="object"&&("signIn"in H.solana&&typeof H.solana.signIn=="function"||"signMessage"in H.solana&&typeof H.solana.signMessage=="function"))P=H.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(C!=null&&C.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=N}const j=new URL((n=C==null?void 0:C.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in P&&P.signIn){const H=await P.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C==null?void 0:C.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),k?{statement:k}:null));let L;if(Array.isArray(H)&&H[0]&&typeof H[0]=="object")L=H[0];else if(H&&typeof H=="object"&&"signedMessage"in H&&"signature"in H)L=H;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in L&&"signature"in L&&(typeof L.signedMessage=="string"||L.signedMessage instanceof Uint8Array)&&L.signature instanceof Uint8Array)E=typeof L.signedMessage=="string"?L.signedMessage:new TextDecoder().decode(L.signedMessage),S=L.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in P)||typeof P.signMessage!="function"||!("publicKey"in P)||typeof P!="object"||!P.publicKey||!("toBase58"in P.publicKey)||typeof P.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");E=[`${j.host} wants you to sign in with your Solana account:`,P.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(a=(r=C==null?void 0:C.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=C==null?void 0:C.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((l=C==null?void 0:C.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((c=C==null?void 0:C.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((d=C==null?void 0:C.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((f=C==null?void 0:C.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((y=(g=C==null?void 0:C.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||y===void 0)&&y.length?["Resources",...C.signInWithSolana.resources.map(L=>`- ${L}`)]:[]].join(`
`);const H=await P.signMessage(new TextEncoder().encode(E),"utf8");if(!H||!(H instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=H}}try{const{data:b,error:N}=await vt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:E,signature:u6(S)},!((T=e.options)===null||T===void 0)&&T.captchaToken?{gotrue_meta_security:{captcha_token:(w=e.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:Ya});if(N)throw N;return!b||!b.session||!b.user?{data:{user:null,session:null},error:new lf}:(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign({},b),error:N})}catch(b){if(ct(b))return{data:{user:null,session:null},error:b};throw b}}async _exchangeCodeForSession(e){const n=await ff(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:i,error:l}=await vt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Ya});if(await df(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new lf}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:l})}catch(i){if(ct(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:a,access_token:i,nonce:l}=e,c=await vt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ya}),{data:d,error:f}=c;return f?{data:{user:null,session:null},error:f}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new lf}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:f})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,a,i,l;try{if("email"in e){const{email:c,options:d}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await Eo(this.storage,this.storageKey));const{error:y}=await vt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(r=d==null?void 0:d.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:y}}if("phone"in e){const{phone:c,options:d}=e,{data:f,error:g}=await vt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:g}}throw new cf("You must provide either an email or phone number.")}catch(c){if(ct(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var n,r;try{let a,i;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:l,error:c}=await vt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Ya});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,f=l.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(ct(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,r,a;try{let i=null,l=null;return this.flowType==="pkce"&&([i,l]=await Eo(this.storage,this.storageKey)),await vt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:R6})}catch(i){if(ct(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new ks;const{error:a}=await vt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(ct(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:i}=e,{error:l}=await vt(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in e){const{phone:r,type:a,options:i}=e,{data:l,error:c}=await vt(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c}}throw new cf("You must provide either an email or phone number and a type")}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await ff(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Eh:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let l=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,f,g)=>(!l&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,f,g))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await vt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ds}):await this._useSession(async n=>{var r,a,i;const{data:l,error:c}=n;if(c)throw c;return!(!((r=l.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ks}:await vt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Ds})})}catch(n){if(ct(n))return n6(n)&&(await this._removeSession(),await df(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new ks;const l=a.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await Eo(this.storage,this.storageKey));const{data:f,error:g}=await vt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:Ds});if(g)throw g;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ks;const n=Date.now()/1e3;let r=n,a=!0,i=null;const{payload:l}=bh(e.access_token);if(l.exp&&(r=l.exp,a=r<=n),a){const{session:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;i={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(ct(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:l,error:c}=n;if(c)throw c;e=(r=l.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new ks;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!la())throw new uf("No browser detected.");if(e.error||e.error_description||e.error_code)throw new uf(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new s_("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new uf("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new s_("No code detected.");const{data:k,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:l,expires_in:c,expires_at:d,token_type:f}=e;if(!i||!c||!l||!f)throw new uf("No session defined in URL");const g=Math.round(Date.now()/1e3),y=parseInt(c);let T=g+y;d&&(T=parseInt(d));const w=T-g;w*1e3<=Ro&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${w}s, should have been closer to ${y}s`);const E=T-y;g-E>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",E,T,g):g-E<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",E,T,g);const{data:S,error:b}=await this._getUser(i);if(b)throw b;const N={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:y,expires_at:T,refresh_token:l,token_type:f,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:N,redirectType:e.type},error:null}}catch(r){if(ct(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await ff(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{error:i};const l=(r=a.session)===null||r===void 0?void 0:r.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(t6(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await df(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=d6(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,a;try{const{data:{session:i},error:l}=n;if(l)throw l;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await Eo(this.storage,this.storageKey,!0));try{return await vt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(ct(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(ct(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:a}=await this._useSession(async i=>{var l,c,d,f,g;const{data:y,error:T}=i;if(T)throw T;const w=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await vt(this.fetch,"GET",w,{headers:this.headers,jwt:(g=(f=y.session)===null||f===void 0?void 0:f.access_token)!==null&&g!==void 0?g:void 0})});if(a)throw a;return la()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ct(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:l}=n;if(l)throw l;return await vt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await g6(async a=>(a>0&&await p6(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await vt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ya})),(a,i)=>{const l=200*Math.pow(2,a);return i&&Sh(i)&&Date.now()+l-r<Ro})}catch(r){if(this._debug(n,"error",r),ct(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),la()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await ff(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const a=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Eh;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${Eh}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),Sh(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new ks;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new td;const{data:i,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!i.session)throw new ks;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={session:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(a,"error",i),ct(i)){const l={session:null,error:i};return Sh(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(l),l}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,n)}catch(d){i.push(d)}});if(await Promise.all(l),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await kw(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await df(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&la()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ro);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/Ro);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ro}ms, refresh threshold is ${cm} ticks`),a<=cm&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Nw)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!la()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,l]=await Eo(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(c.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await vt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:l}=n;if(l)return{data:null,error:l};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:f}=await vt(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(e.factorType==="totp"&&(!((a=d==null?void 0:d.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{data:null,error:i};const{data:l,error:c}=await vt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(n){if(ct(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await vt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ct(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],a=r.filter(l=>l.factor_type==="totp"&&l.status==="verified"),i=r.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:r,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=bh(a.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(y=>y.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const g=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:g},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r||(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+QI>Date.now()))return r;const{data:a,error:i}=await vt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new mc("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),r=a.keys.find(l=>l.kid===e),!r)throw new mc("No matching signing key found in JWKS");return r}async getClaims(e,n={keys:[]}){try{let r=e;if(!r){const{data:w,error:E}=await this.getSession();if(E||!w.session)return{data:null,error:E};r=w.session.access_token}const{header:a,payload:i,signature:l,raw:{header:c,payload:d}}=bh(r);if(E6(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:w}=await this.getUser(r);if(w)throw w;return{data:{claims:i,header:a,signature:l},error:null}}const f=S6(a.alg),g=await this.fetchJwk(a.kid,n),y=await crypto.subtle.importKey("jwk",g,f,!0,["verify"]);if(!await crypto.subtle.verify(f,y,l,c6(`${c}.${d}`)))throw new mc("Invalid JWT signature");return{data:{claims:i,header:a,signature:l},error:null}}catch(r){if(ct(r))return{data:null,error:r};throw r}}}kc.nextInstanceID=0;const V6=kc;class H6 extends V6{constructor(e){super(e)}}var G6=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class $6{constructor(e,n,r){var a,i,l;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const c=YI(e),d=new URL(c);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const f=`sb-${d.hostname.split(".")[0]}-auth-token`,g={db:BI,realtime:VI,auth:Object.assign(Object.assign({},jI),{storageKey:f}),global:UI},y=JI(r??{},g);this.storageKey=(a=y.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=y.global.headers)!==null&&i!==void 0?i:{},y.accessToken?(this.accessToken=y.accessToken,this.auth=new Proxy({},{get:(T,w)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(w)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=y.auth)!==null&&l!==void 0?l:{},this.headers,y.global.fetch),this.fetch=zI(n,this._getAccessToken.bind(this),y.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},y.realtime)),this.rest=new oI(new URL("rest/v1",d).href,{headers:this.headers,schema:y.db.schema,fetch:this.fetch}),y.accessToken||this._listenForAuthEvents()}get functions(){return new WM(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new OI(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return G6(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:i,flowType:l,lock:c,debug:d},f,g){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new H6({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),f),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,flowType:l,lock:c,debug:d,fetch:g,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new wI(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const z6=(t,e,n)=>new $6(t,e,n),q6="https://utpfewlxcgagbrtlpdmy.supabase.co",Y6="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV0cGZld2x4Y2dhZ2JydGxwZG15Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE5MTc3MDMsImV4cCI6MjA2NzQ5MzcwM30.2Nt7hxmBrwm8Hz78bQ5XVG4HQGCmvYQ3nTazTjKloV8",bt=z6(q6,Y6);class Nc{static async getProjects(){const{data:e,error:n}=await bt.from("projects").select("*").order("updated_at",{ascending:!1});if(n)throw new Error(`プロジェクトの取得に失敗しました: ${n.message}`);return e.map(r=>({id:r.id,title:r.title,goal:r.goal,targetDate:r.target_date,tasks:r.tasks_data||[],ganttData:r.gantt_data,createdAt:r.created_at,updatedAt:r.updated_at}))}static async createProject(e,n,r,a=[],i){const{data:{user:l}}=await bt.auth.getUser();if(!l)throw new Error("ログインが必要です");const{data:c,error:d}=await bt.from("projects").insert({user_id:l.id,title:e,goal:n,target_date:r,tasks_data:a,gantt_data:i}).select().single();if(d)throw new Error(`プロジェクトの作成に失敗しました: ${d.message}`);return{id:c.id,title:c.title,goal:c.goal,targetDate:c.target_date,tasks:c.tasks_data||[],ganttData:c.gantt_data,createdAt:c.created_at,updatedAt:c.updated_at}}static async updateProject(e,n){const r={};n.title!==void 0&&(r.title=n.title),n.goal!==void 0&&(r.goal=n.goal),n.targetDate!==void 0&&(r.target_date=n.targetDate),n.tasks!==void 0&&(r.tasks_data=n.tasks),n.ganttData!==void 0&&(r.gantt_data=n.ganttData);const{data:a,error:i}=await bt.from("projects").update(r).eq("id",e).select().single();if(i)throw new Error(`プロジェクトの更新に失敗しました: ${i.message}`);return{id:a.id,title:a.title,goal:a.goal,targetDate:a.target_date,tasks:a.tasks_data||[],ganttData:a.gantt_data,createdAt:a.created_at,updatedAt:a.updated_at}}static async deleteProject(e){const{error:n}=await bt.from("projects").delete().eq("id",e);if(n)throw new Error(`プロジェクトの削除に失敗しました: ${n.message}`)}static async getProject(e){const{data:n,error:r}=await bt.from("projects").select("*").eq("id",e).single();if(r)throw new Error(`プロジェクトの取得に失敗しました: ${r.message}`);return{id:n.id,title:n.title,goal:n.goal,targetDate:n.target_date,tasks:n.tasks_data||[],ganttData:n.gantt_data,createdAt:n.created_at,updatedAt:n.updated_at}}}const Cn=({size:t="md",color:e="border-blue-500",text:n})=>{const r={sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"};return x.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[x.jsx("div",{className:`animate-spin rounded-full border-4 ${e} border-t-transparent ${r[t]}`}),n&&x.jsx("p",{className:"text-slate-600 text-sm",children:n})]})},Um=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-3.75h.008v.008H12v-.008ZM12 15h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5v-.008ZM9.75 18.75h.008v.008H9.75v-.008ZM7.5 18.75h.008v.008H7.5v-.008ZM14.25 15h.008v.008H14.25v-.008ZM16.5 15h.008v.008H16.5v-.008ZM14.25 18.75h.008v.008H14.25v-.008ZM16.5 18.75h.008v.008H16.5v-.008Z"})}),Bm=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m12 12 4.243 4.243"})]}),J6=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),er=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),Rw=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),Dw=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),qo=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),Mw=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),ha=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),jm=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),gc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),Iw=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.354a15.055 15.055 0 0 1-3 0M12.75 4.5v-.75a.75.75 0 0 0-.75-.75h-.75a.75.75 0 0 0-.75.75v.75m0 0A2.25 2.25 0 0 0 9.75 6.75h4.5A2.25 2.25 0 0 0 12.75 4.5M12 18.75h.008v.008H12v-.008Z"})}),Bs=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),W6=({title:t,...e})=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[t&&x.jsx("title",{children:t}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75V12m0 0H9.75M12 12h2.25m-2.25 0V9.75M12 12v2.25m0 0H9.75M12 14.25h2.25M12 6.75a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Zm0 0V3m0 3.75h.008v.008H12V6.75Zm-5.25 0H3.75m0 0V3m0 3.75h.008v.008H3.75V6.75Zm10.5 0h2.25m0 0V3m0 3.75h.008v.008H16.5V6.75Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),nd=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75h16.5v16.5H3.75V3.75Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3 6-6"})]}),rd=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25-2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"})}),Vm=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),K6=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),X6=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Z6=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113A.375.375 0 0 1 9.75 15.113V8.887c0-.286.307-.466.557-.332l5.603 3.118Z"})]}),Q6=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),eF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),tF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125A3.375 3.375 0 005.625 4.5h12.75c1.72 0 3.125 1.119 3.375 2.625M9.75 10.5h4.5m-4.5 3h4.5M11.25 3v1.5m0 15V21m0-16.5a1.5 1.5 0 00-3 0V21a1.5 1.5 0 003 0V3.062A3.375 3.375 0 0112 2.25c.465 0 .91.095 1.312.281M14.25 9a3 3 0 10-6 0 3 3 0 006 0z"})}),nF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.623 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"})}),rF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),Hm=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3M3.75 21h16.5M16.5 3.75h.008v.008H16.5V3.75zm-3.75 0h.008v.008H12.75V3.75zm-3.75 0h.008v.008H9V3.75zm-3.75 0h.008v.008H5.25V3.75z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.5h18M9.75 16.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-3a.75.75 0 01-.75-.75v-4.5z"})]}),aF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),sF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"})}),iF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 15 6-6m0 0-6-6m6 6H3a6 6 0 0 0 0 12h3"})}),Yo=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.122 2.122l7.81-7.81"})}),ad=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m0 0H3.375c-.621 0-1.125-.504-1.125-1.125v-12.75c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v12.75c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m17.25 0v-12.75a1.125 1.125 0 0 0-1.125-1.125H3.375A1.125 1.125 0 0 0 2.25 4.5v12.75c0 .621.504 1.125 1.125 1.125M12 4.5v15m0 0H9m3 0h3"})}),oF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...t,children:x.jsx("path",{fillRule:"evenodd",d:"M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z",clipRule:"evenodd"})}),lF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...t,children:x.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-1V7a5 5 0 00-5-5zm0 2.5a2.5 2.5 0 00-2.5 2.5V9h5V7a2.5 2.5 0 00-2.5-2.5z"})}),Ti=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.5 17.25l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 13.5l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 17.25l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),Fw=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75c0-.231-.035-.454-.1-.664M6.75 7.5H18v2.25H6.75V7.5zM3 12h3v6.75a2.25 2.25 0 002.25 2.25h9.75a2.25 2.25 0 002.25-2.25V12h3m-3.498 6.75H15"})}),cF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75v4.5m0-4.5h-4.5m4.5 0L15 9m5.25 11.25v-4.5m0 4.5h-4.5m4.5 0L15 15"})}),uF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9V4.5M15 9h4.5M15 9l5.25-5.25M15 15v4.5M15 15h4.5M15 15l5.25 5.25"})}),Ow=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"})}),wi=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})}),Rc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...t,children:x.jsx("path",{d:"M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"})}),Ei=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...t,children:x.jsx("path",{d:"M7.247 11.14l-4.796-5.481c-.566-.647-.106-1.659.753-1.659h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})}),Dc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25z"})}),fF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"})}),dF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"})}),Lf=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75a17.933 17.933 0 0 1-7.499-1.632Z"})}),hF=({onSubmit:t,isLoading:e,onImportProject:n,onLoadTemplate:r,initialGoal:a="",initialDate:i="",onOpenProjectList:l,onLogout:c,user:d})=>{const[f,g]=se.useState(a),[y,T]=se.useState(i),w=se.useRef(null);Bo.useEffect(()=>{g(a)},[a]),Bo.useEffect(()=>{T(i)},[i]);const E=new Date().toISOString().split("T")[0],S=P=>{if(P.preventDefault(),!f.trim()||!y){alert("事業目的と目標日付を入力してください。");return}t(f,y)},b=()=>{var P;(P=w.current)==null||P.click()},N=P=>{var H;const j=(H=P.target.files)==null?void 0:H[0];j&&(n(j),P.target.value="")},k=P=>{if(!f.trim()||!y){alert("テンプレートから開始するには、まずプロジェクトの目的と目標の日付を入力してください。");return}r(P,f,y)},C=({template:P,title:j,description:H,disabled:L})=>x.jsxs("button",{type:"button",onClick:()=>k(P),disabled:L,className:"text-left p-4 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400 text-white rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105",children:[x.jsx("div",{className:"font-semibold text-md",children:j}),x.jsx("div",{className:"text-xs text-purple-200 mt-1",children:H})]});return x.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[x.jsxs("div",{className:"w-full max-w-2xl mb-4 flex justify-between items-center",children:[x.jsxs("div",{className:"text-white text-sm",children:["ログイン中: ",d==null?void 0:d.email]}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",children:[x.jsx(wi,{className:"w-5 h-5"}),"保存済みプロジェクト"]}),x.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:[x.jsx(Dc,{className:"w-5 h-5"}),"ログアウト"]})]})]}),x.jsxs("div",{className:"w-full max-w-2xl bg-white shadow-2xl rounded-xl p-8 md:p-12",children:[x.jsxs("div",{className:"text-center mb-10",children:[x.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-3",children:"AIプロジェクトプランナー"}),x.jsx("p",{className:"text-slate-600 text-lg",children:"あなたの目標達成をAIがお手伝いします。"})]}),x.jsxs("form",{onSubmit:S,className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"projectGoal",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(Bm,{className:"w-5 h-5 mr-2 text-blue-600"}),"プロジェクトの目的 (最終形)"]}),x.jsx("textarea",{id:"projectGoal",value:f,onChange:P=>g(P.target.value),placeholder:"例: 新しいEコマースサイトを立ち上げ、初年度売上1000万円を目指す",rows:3,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100 placeholder-slate-400"})]}),x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"targetDate",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(Um,{className:"w-5 h-5 mr-2 text-blue-600"}),"目標の日付"]}),x.jsx("input",{type:"date",id:"targetDate",value:y,onChange:P=>T(P.target.value),min:E,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100",style:{colorScheme:"dark"}})]}),x.jsx("p",{className:"text-sm text-slate-500 text-center",children:"目的と日付を入力して計画を作成するか、テンプレートまたは既存の計画から開始します。"}),x.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[x.jsx("button",{type:"submit",disabled:e,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:e?x.jsx(Cn,{size:"sm",color:"border-white"}):"AIで計画を作成"}),x.jsxs("button",{type:"button",onClick:b,disabled:e,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:[x.jsx(Dw,{className:"w-5 h-5 mr-2"}),"計画をインポート (.json)"]}),x.jsx("input",{type:"file",ref:w,onChange:N,accept:".json",className:"hidden","aria-hidden":"true"})]}),x.jsxs("div",{className:"sm:col-span-2 pt-4",children:[x.jsx("p",{className:"text-center text-sm font-semibold text-slate-600 mb-3",children:"または、テンプレートから開始:"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[x.jsx(C,{template:"process-design",disabled:e,title:"工程設計 (APQP)",description:"新製品の工程をAPQPに基づき計画から量産まで設計します。"}),x.jsx(C,{template:"process-change",disabled:e,title:"工程変更 (ISO/IATF)",description:"既存工程の変更を影響分析、承認、検証を含めて管理します。"}),x.jsx(C,{template:"new-product-eval",disabled:e,title:"新製品の設備評価",description:"顧客要求に基づき、既存設備での実現可能性を評価・報告します。"}),x.jsx(C,{template:"improvement-project",disabled:e,title:"生産性・コスト改善",description:"DMAICフレームワークに基づき、既存プロセスの問題を解決し、改善します。"}),x.jsx(C,{template:"equipment-modification",disabled:e,title:"社内設備改造",description:"社内設備・治具の改造・改善を計画・実行・評価します。"})]})]})]})]}),x.jsx("footer",{className:"mt-12 text-center",children:x.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API & Supabase"})})]})},hf=t=>{switch(t){case _t.IN_PROGRESS:return{icon:x.jsx(Z6,{className:"w-3.5 h-3.5"}),color:"text-blue-700",text:"進行中",bgColor:"bg-blue-100"};case _t.COMPLETED:return{icon:x.jsx(jm,{className:"w-3.5 h-3.5"}),color:"text-green-700",text:"完了",bgColor:"bg-green-100"};case _t.BLOCKED:return{icon:x.jsx(Q6,{className:"w-3.5 h-3.5"}),color:"text-red-700",text:"停滞中",bgColor:"bg-red-100"};case _t.NOT_STARTED:default:return{icon:x.jsx(X6,{className:"w-3.5 h-3.5"}),color:"text-slate-600",text:"未着手",bgColor:"bg-slate-100"}}},mF=({task:t,onSelectTask:e,onRemoveTask:n,onUpdateStatus:r,onDragCardStart:a,index:i,cardRef:l,onStartConnection:c,onEndConnection:d})=>{var H,L,K,M;const[f,g]=se.useState(!1),y=se.useRef(null);se.useEffect(()=>{const Q=X=>{y.current&&!y.current.contains(X.target)&&g(!1)};return document.addEventListener("mousedown",Q),()=>{document.removeEventListener("mousedown",Q)}},[y]);const T=Q=>{r(t.id,Q),g(!1)},w=(H=t.extendedDetails)==null?void 0:H.numericalTarget;let E="text-slate-500";w&&(w.status===Bh.ACHIEVED?E="text-green-600":w.status===Bh.MISSED?E="text-red-600":E="text-yellow-600");const S=hf(t.status),b=(L=t.extendedDetails)==null?void 0:L.dueDate,N=b?new Date(b+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"short",day:"numeric"}):null,k=t.status===_t.IN_PROGRESS,C="task-card-in-flow bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 ease-in-out overflow-hidden flex-shrink-0 w-80 md:w-96 m-1 cursor-grab active:cursor-grabbing",P=k?"border-4 border-blue-500 ring-2 ring-blue-500 ring-offset-1":"border border-transparent",j=Q=>{Q.stopPropagation(),c(t.id,Q)};return x.jsxs("div",{ref:l,id:`taskcard-${t.id}`,draggable:"true",onDragStart:Q=>a(Q,t.id),onMouseUp:()=>d(t.id),className:`${C} ${P}`,style:{position:"absolute",left:((K=t.position)==null?void 0:K.x)||0,top:((M=t.position)==null?void 0:M.y)||0,touchAction:"none"},children:[x.jsxs("div",{className:"p-5 relative",children:[x.jsx("div",{onMouseDown:j,className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-4 h-4 bg-blue-500 border-2 border-white rounded-full cursor-crosshair hover:scale-125 transition-transform z-10",title:"ドラッグして接続"}),x.jsxs("div",{className:"flex items-start justify-between mb-2",children:[x.jsxs("div",{className:"flex items-center flex-grow min-w-0 mr-2",children:[x.jsx("span",{className:"bg-blue-600 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-xs mr-3 flex-shrink-0",children:i+1}),x.jsx("div",{className:"flex-grow min-w-0",children:x.jsx("div",{className:"text-lg font-bold text-slate-900 break-words","aria-label":`task title for ${t.title}`,children:t.title})})]}),x.jsxs("div",{className:"flex space-x-1 flex-shrink-0 items-center",children:[w&&x.jsx(W6,{className:`w-5 h-5 ${E}`,title:`数値目標: ${w.description} (${w.status})`}),x.jsx("button",{onClick:Q=>{Q.stopPropagation(),e(t)},className:"text-blue-600 hover:text-blue-800 transition-colors p-1 rounded-full hover:bg-blue-100",title:"詳細・計画編集","aria-label":`詳細・計画編集: ${t.title}`,children:x.jsx(J6,{className:"w-5 h-5"})}),x.jsx("button",{onClick:Q=>{Q.stopPropagation(),n(t.id)},className:"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-100",title:"タスクを削除","aria-label":`タスクを削除: ${t.title}`,children:x.jsx(ha,{className:"w-5 h-5"})})]})]}),x.jsx("div",{className:"h-20 mb-3",children:x.jsx("p",{className:"text-slate-800 text-sm leading-relaxed line-clamp-4 overflow-hidden h-full",children:t.description})}),x.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2",children:[x.jsxs("div",{className:"relative",ref:y,children:[x.jsxs("button",{onClick:()=>g(Q=>!Q),className:`inline-flex items-center px-2 py-0.5 rounded-full cursor-pointer ${S.bgColor} ${S.color} hover:ring-2 hover:ring-offset-1 hover:ring-blue-400 transition-all`,title:"ステータスを変更",children:[Bo.cloneElement(S.icon,{className:`w-3 h-3 mr-1 ${S.color}`}),S.text]}),f&&x.jsx("div",{className:"absolute bottom-full mb-1 w-36 bg-white border border-slate-200 rounded-md shadow-lg z-20 py-1",children:Object.values(_t).map(Q=>x.jsxs("button",{onClick:()=>T(Q),className:"w-full text-left px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-100 flex items-center",children:[Bo.cloneElement(hf(Q).icon,{className:`w-3.5 h-3.5 mr-2 ${hf(Q).color}`}),hf(Q).text]},Q))})]}),N&&x.jsxs("div",{className:"flex items-center text-orange-600",children:[x.jsx(K6,{className:"w-3.5 h-3.5 mr-1"}),"期日: ",N]})]})]}),x.jsx("button",{onClick:Q=>{Q.stopPropagation(),e(t)},className:"block w-full text-left bg-slate-100 hover:bg-slate-200 text-blue-700 font-medium py-3 px-5 transition-colors text-xs border-t border-slate-200",children:"詳細な計画・レポート・接続 →"})]})},pF=se.memo(mF),dm=({from:t,to:e,id:n,onDelete:r})=>{const l=t.x,c=e.x,d=(l+c)/2,f=(t.y+e.y)/2,g=`M${l},${t.y} C${l+50},${t.y} ${c-50},${e.y} ${c},${e.y}`;return x.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"},"aria-hidden":"true",children:[x.jsx("defs",{children:x.jsx("marker",{id:`arrowhead-${n}`,markerWidth:8,markerHeight:8*.7,refX:8,refY:8*.35,orient:"auto",markerUnits:"strokeWidth",children:x.jsx("path",{d:`M0,0 L8,${8*.35} L0,${8*.7} Z`,fill:"#64748b"})})}),x.jsxs("g",{style:{pointerEvents:r?"auto":"none"},children:[x.jsx("path",{d:g,stroke:"#64748b",strokeWidth:2,markerEnd:`url(#arrowhead-${n})`,fill:"none"}),x.jsx("path",{d:g,stroke:"transparent",strokeWidth:"16",fill:"none",className:r?"cursor-pointer group":"",onClick:r}),r&&x.jsxs("g",{transform:`translate(${d}, ${f})`,className:"opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:r,children:[x.jsx("circle",{cx:"0",cy:"0",r:"8",fill:"white",stroke:"#ef4444",strokeWidth:"1"}),x.jsx("path",{d:"M -3.5 -3.5 L 3.5 3.5 M -3.5 3.5 L 3.5 -3.5",stroke:"#ef4444",strokeWidth:"1.5",strokeLinecap:"round"})]})]})]})},gF=({tasks:t,onClose:e})=>{const[n,r]=se.useState("all"),[a,i]=se.useState(""),[l,c]=se.useState(null),d=se.useMemo(()=>{const E=[];return t.forEach(S=>{var b,N;(N=(b=S.extendedDetails)==null?void 0:b.subSteps)==null||N.forEach(k=>{var C;(C=k.actionItems)==null||C.forEach(P=>{E.push({actionItem:P,subStep:k,task:S})})})}),E},[t]),f=se.useMemo(()=>d.filter(E=>n==="completed"?E.actionItem.completed:n==="pending"?!E.actionItem.completed:!0).filter(E=>{const S=a.toLowerCase();return E.actionItem.text.toLowerCase().includes(S)||E.subStep.text.toLowerCase().includes(S)||(E.subStep.responsible||"").toLowerCase().includes(S)||E.task.title.toLowerCase().includes(S)}),[d,n,a]),g=se.useMemo(()=>{let E=[...f];return l!==null&&E.sort((S,b)=>{let N="",k="";switch(l.key){case"status":N=S.actionItem.completed,k=b.actionItem.completed;break;case"actionItem":N=S.actionItem.text.toLowerCase(),k=b.actionItem.text.toLowerCase();break;case"responsible":N=(S.subStep.responsible||"").toLowerCase(),k=(b.subStep.responsible||"").toLowerCase();break;case"subStep":N=S.subStep.text.toLowerCase(),k=b.subStep.text.toLowerCase();break;case"task":N=S.task.title.toLowerCase(),k=b.task.title.toLowerCase();break;case"dueDate":N=S.actionItem.dueDate||S.subStep.dueDate||"9999-12-31",k=b.actionItem.dueDate||b.subStep.dueDate||"9999-12-31";break}return N<k?l.direction==="ascending"?-1:1:N>k?l.direction==="ascending"?1:-1:0}),E},[f,l]),y=E=>{let S="ascending";l&&l.key===E&&l.direction==="ascending"&&(S="descending"),c({key:E,direction:S})},T=E=>!l||l.key!==E?x.jsx(Rc,{className:"w-3 h-3 ml-1 opacity-20"}):l.direction==="ascending"?x.jsx(Rc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Ei,{className:"w-3 h-3 ml-1 text-blue-600"}),w=({sortKey:E,label:S,className:b})=>x.jsx("th",{scope:"col",className:`px-6 py-3 ${b||""}`,children:x.jsxs("button",{onClick:()=>y(E),className:"flex items-center gap-1 hover:text-blue-600 transition-colors",children:[S,T(E)]})});return x.jsxs("div",{className:"fixed inset-0 bg-slate-100 z-[60] flex flex-col",children:[x.jsx("header",{className:"flex-shrink-0 bg-white shadow-md",children:x.jsxs("div",{className:"flex items-center justify-between p-4 border-b w-full max-w-7xl mx-auto",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"全アクションアイテム一覧"}),x.jsxs("button",{onClick:e,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",children:[x.jsx(Rw,{className:"w-5 h-5"}),"フローに戻る"]})]})}),x.jsxs("main",{className:"flex-grow flex flex-col overflow-hidden p-4 w-full max-w-7xl mx-auto",children:[x.jsx("div",{className:"p-4 flex-shrink-0 bg-white rounded-t-lg border-x border-t",children:x.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[x.jsx("input",{type:"text",placeholder:"検索...",value:a,onChange:E=>i(E.target.value),className:"px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm w-full sm:w-auto flex-grow"}),x.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-slate-100 p-1",children:[x.jsx("button",{onClick:()=>r("all"),className:`px-3 py-1 text-sm rounded-md ${n==="all"?"bg-white shadow":"hover:bg-slate-200"}`,children:"全て"}),x.jsx("button",{onClick:()=>r("pending"),className:`px-3 py-1 text-sm rounded-md ${n==="pending"?"bg-white shadow":"hover:bg-slate-200"}`,children:"未完了"}),x.jsx("button",{onClick:()=>r("completed"),className:`px-3 py-1 text-sm rounded-md ${n==="completed"?"bg-white shadow":"hover:bg-slate-200"}`,children:"完了"})]})]})}),x.jsx("div",{className:"flex-grow overflow-y-auto bg-white rounded-b-lg border",children:x.jsxs("table",{className:"w-full text-sm text-left text-slate-600",children:[x.jsx("thead",{className:"text-xs text-slate-700 uppercase bg-slate-100 sticky top-0 z-10",children:x.jsxs("tr",{children:[x.jsx(w,{sortKey:"status",label:"状態",className:"w-24"}),x.jsx(w,{sortKey:"actionItem",label:"アクションアイテム"}),x.jsx(w,{sortKey:"responsible",label:"担当者"}),x.jsx(w,{sortKey:"subStep",label:"所属サブステップ"}),x.jsx(w,{sortKey:"task",label:"所属タスク"}),x.jsx(w,{sortKey:"dueDate",label:"期日"})]})}),x.jsxs("tbody",{className:"divide-y divide-slate-200",children:[g.map(({actionItem:E,subStep:S,task:b},N)=>x.jsxs("tr",{className:"hover:bg-slate-50",children:[x.jsx("td",{className:"px-6 py-3",children:E.completed?x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[x.jsx(nd,{className:"w-4 h-4 mr-1"}),"完了"]}):x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[x.jsx(rd,{className:"w-4 h-4 mr-1"}),"未完了"]})}),x.jsx("td",{className:"px-6 py-3 font-medium text-slate-900",children:E.text}),x.jsx("td",{className:"px-6 py-3",children:S.responsible||"未設定"}),x.jsx("td",{className:"px-6 py-3",children:S.text}),x.jsx("td",{className:"px-6 py-3",children:b.title}),x.jsx("td",{className:"px-6 py-3",children:E.dueDate||S.dueDate?new Date((E.dueDate||S.dueDate)+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"未設定"})]},E.id+N)),g.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-500",children:"条件に一致するアイテムはありません。"})})]})]})})]})]})},m_={"On Track":{bgColor:"bg-green-100",textColor:"text-green-800",icon:x.jsx(jm,{className:"w-12 h-12 text-green-500"})},"At Risk":{bgColor:"bg-yellow-100",textColor:"text-yellow-800",icon:x.jsx(gc,{className:"w-12 h-12 text-yellow-500"})},"Off Track":{bgColor:"bg-red-100",textColor:"text-red-800",icon:x.jsx(gc,{className:"w-12 h-12 text-red-500"})},Unknown:{bgColor:"bg-slate-100",textColor:"text-slate-800",icon:x.jsx(gc,{className:"w-12 h-12 text-slate-500"})}},xF=({report:t,onClose:e})=>{if(!t)return null;const n=m_[t.overallStatus]||m_.Unknown;return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200 flex-shrink-0",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AIプロジェクト診断レポート"}),x.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(er,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[x.jsxs("section",{className:`p-6 rounded-lg flex items-center gap-6 ${n.bgColor}`,children:[x.jsx("div",{className:"flex-shrink-0",children:n.icon}),x.jsxs("div",{children:[x.jsx("h4",{className:`text-2xl font-bold ${n.textColor}`,children:t.overallStatus}),x.jsx("p",{className:`mt-1 text-base ${n.textColor}`,children:t.summary})]})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(jm,{className:"w-5 h-5 mr-2 text-green-500"}),"うまくいっている点"]}),x.jsx("ul",{className:"list-disc list-inside space-y-2 text-slate-600 pl-2",children:t.positivePoints.map((r,a)=>x.jsx("li",{children:r},a))})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(gc,{className:"w-5 h-5 mr-2 text-yellow-500"}),"懸念事項"]}),x.jsx("div",{className:"space-y-3",children:t.areasOfConcern.map((r,a)=>x.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg",children:[x.jsx("p",{className:"font-semibold text-yellow-800",children:r.description}),r.relatedTaskIds.length>0&&x.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["関連タスクID: ",r.relatedTaskIds.join(", ")]})]},a))})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(Iw,{className:"w-5 h-5 mr-2 text-blue-500"}),"AIからの提案"]}),x.jsx("div",{className:"space-y-3",children:t.suggestions.map((r,a)=>x.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:x.jsx("p",{className:"text-blue-800",children:r})},a))})]})]}),x.jsx("footer",{className:"p-4 bg-slate-50 border-t flex justify-end",children:x.jsx("button",{onClick:e,className:"px-5 py-2 text-sm font-medium text-white bg-slate-600 rounded-md hover:bg-slate-700",children:"閉じる"})})]})})};class Yr{static async getProjectMembers(e){const{data:n,error:r}=await bt.from("project_members").select(`
        *,
        users!user_id(email)
      `).eq("project_id",e).eq("status","active").order("created_at",{ascending:!0});if(r)throw new Error(`メンバー情報の取得に失敗しました: ${r.message}`);return n.map(a=>{var i,l,c;return{id:a.id,projectId:a.project_id,userId:a.user_id,role:a.role,invitedBy:a.invited_by,invitedAt:a.invited_at,joinedAt:a.joined_at,status:a.status,userEmail:(i=a.users)==null?void 0:i.email,userName:((c=(l=a.users)==null?void 0:l.email)==null?void 0:c.split("@")[0])||"Unknown"}})}static async getProjectInvitations(e){const{data:n,error:r}=await bt.from("project_invitations").select(`
        *,
        inviter:users!invited_by(email)
      `).eq("project_id",e).eq("status","pending").gt("expires_at",new Date().toISOString()).order("invited_at",{ascending:!1});if(r)throw new Error(`招待一覧の取得に失敗しました: ${r.message}`);return n.map(a=>{var i,l;return{id:a.id,projectId:a.project_id,email:a.email,role:a.role,invitedBy:a.invited_by,invitedAt:a.invited_at,expiresAt:a.expires_at,status:a.status,inviterName:((l=(i=a.inviter)==null?void 0:i.email)==null?void 0:l.split("@")[0])||"Unknown"}})}static async inviteToProject(e,n,r){const{data:{user:a}}=await bt.auth.getUser();if(!a)throw new Error("ログインが必要です");const{data:i}=await bt.from("project_invitations").select("*").eq("project_id",e).eq("email",n).eq("status","pending").single();if(i)throw new Error("このメールアドレスには既に招待が送信されています");const{data:l}=await bt.from("project_members").select(`
        user_id,
        users!user_id(email)
      `).eq("project_id",e).eq("status","active");if(((l==null?void 0:l.map(g=>{var y;return(y=g.users)==null?void 0:y.email}))||[]).includes(n))throw new Error("このユーザーは既にプロジェクトのメンバーです");const{data:d,error:f}=await bt.from("project_invitations").insert({project_id:e,email:n,role:r,invited_by:a.id}).select().single();if(f)throw new Error(`招待の送信に失敗しました: ${f.message}`);return{id:d.id,projectId:d.project_id,email:d.email,role:d.role,invitedBy:d.invited_by,invitedAt:d.invited_at,expiresAt:d.expires_at,status:d.status}}static async acceptInvitation(e){const{data:{user:n}}=await bt.auth.getUser();if(!n)throw new Error("ログインが必要です");const{data:r,error:a}=await bt.from("project_invitations").select("*").eq("id",e).eq("email",n.email).eq("status","pending").single();if(a||!r)throw new Error("有効な招待が見つかりません");if(new Date(r.expires_at)<new Date)throw new Error("招待の有効期限が切れています");const{error:i}=await bt.from("project_members").insert({project_id:r.project_id,user_id:n.id,role:r.role,invited_by:r.invited_by,status:"active",joined_at:new Date().toISOString()});if(i)throw new Error(`メンバー追加に失敗しました: ${i.message}`);const{error:l}=await bt.from("project_invitations").update({status:"accepted",updated_at:new Date().toISOString()}).eq("id",e);if(l)throw new Error(`招待ステータスの更新に失敗しました: ${l.message}`)}static async getUserInvitations(){const{data:{user:e}}=await bt.auth.getUser();if(!e)throw new Error("ログインが必要です");const{data:n,error:r}=await bt.from("project_invitations").select(`
        *,
        inviter:users!invited_by(email),
        project:projects(title)
      `).eq("email",e.email).eq("status","pending").gt("expires_at",new Date().toISOString()).order("invited_at",{ascending:!1});if(r)throw new Error(`招待一覧の取得に失敗しました: ${r.message}`);return n.map(a=>{var i,l,c;return{id:a.id,projectId:a.project_id,email:a.email,role:a.role,invitedBy:a.invited_by,invitedAt:a.invited_at,expiresAt:a.expires_at,status:a.status,inviterName:((l=(i=a.inviter)==null?void 0:i.email)==null?void 0:l.split("@")[0])||"Unknown",projectTitle:((c=a.project)==null?void 0:c.title)||"Unknown Project"}})}static async updateMemberRole(e,n,r){const{error:a}=await bt.from("project_members").update({role:r}).eq("project_id",e).eq("user_id",n);if(a)throw new Error(`メンバーの役割更新に失敗しました: ${a.message}`)}static async removeMember(e,n){const{error:r}=await bt.from("project_members").delete().eq("project_id",e).eq("user_id",n);if(r)throw new Error(`メンバーの削除に失敗しました: ${r.message}`)}static async logActivity(e,n,r={}){const{data:{user:a}}=await bt.auth.getUser();a&&await bt.from("project_activity_log").insert({project_id:e,user_id:a.id,action:n,details:r})}static async getActivityLog(e,n=50){const{data:r,error:a}=await bt.from("project_activity_log").select(`
        *,
        user:users!user_id(email)
      `).eq("project_id",e).order("created_at",{ascending:!1}).limit(n);if(a)throw new Error(`アクティビティログの取得に失敗しました: ${a.message}`);return r.map(i=>{var l,c;return{id:i.id,projectId:i.project_id,userId:i.user_id,action:i.action,details:i.details,createdAt:i.created_at,userName:((c=(l=i.user)==null?void 0:l.email)==null?void 0:c.split("@")[0])||"Unknown"}})}static subscribeToProjectUpdates(e,n){return bt.channel(`project-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"projects",filter:`id=eq.${e}`},n).on("postgres_changes",{event:"*",schema:"public",table:"project_members",filter:`project_id=eq.${e}`},n).on("postgres_changes",{event:"INSERT",schema:"public",table:"project_activity_log",filter:`project_id=eq.${e}`},n).subscribe()}static async getUserProjectRole(e){const{data:{user:n}}=await bt.auth.getUser();if(!n)return null;const{data:r,error:a}=await bt.from("project_members").select("role").eq("project_id",e).eq("user_id",n.id).eq("status","active").single();return a?null:r.role}static async isAdmin(){const{data:{user:e}}=await bt.auth.getUser();return e?e.email==="administrator@example.com":!1}static async getAllProjects(){const{data:e,error:n}=await bt.from("projects").select(`
        *,
        user:users!user_id(email),
        member_count:project_members(count)
      `).order("created_at",{ascending:!1});if(n)throw new Error(`プロジェクト一覧の取得に失敗しました: ${n.message}`);return e}static async getAllUsers(){const{data:e,error:n}=await bt.from("users").select("*").order("created_at",{ascending:!1});if(n)throw new Error(`ユーザー一覧の取得に失敗しました: ${n.message}`);return e}}const p_=t=>{const e=Math.cos(2*Math.PI*t),n=Math.sin(2*Math.PI*t);return[e,n]},vF=({data:t,title:e})=>{const n=t.reduce((l,c)=>l+c.value,0);if(n===0)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data to display"});let r=0;const a=["#4a90e2","#50e3c2","#f5a623","#f8e71c","#7ed321","#9013fe"],i=t.map((l,c)=>{const d=l.value/n,[f,g]=p_(r);r+=d;const[y,T]=p_(r),w=d>.5?1:0;return{path:[`M ${f} ${g}`,`A 1 1 0 ${w} 1 ${y} ${T}`,"L 0 0"].join(" "),color:a[c%a.length],label:l.label}});return x.jsxs("div",{className:"w-full h-full flex flex-col bg-white p-2",children:[x.jsx("text",{x:"50%",y:"10",textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",className:"block text-center",children:e}),x.jsxs("div",{className:"flex-grow flex items-center",children:[x.jsx("svg",{viewBox:"-1 -1 2 2",className:"w-2/3 h-full",children:i.map((l,c)=>x.jsx("path",{d:l.path,fill:l.color},c))}),x.jsx("div",{className:"w-1/3 text-[8px] space-y-1",children:i.map((l,c)=>x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:l.color}}),x.jsx("span",{className:"truncate",children:l.label})]},c))})]})]})},yF=({data:t,title:e})=>{const n=Math.max(...t.map(f=>f.value),0),r=300,a=150,i={top:20,right:10,bottom:30,left:30},l=r-i.left-i.right,c=a-i.top-i.bottom,d=t.map((f,g)=>{const y=g/(t.length-1)*l,T=c-f.value/n*c;return`${y},${T}`}).join(" ");return x.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[x.jsx("text",{x:r/2,y:i.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:e}),x.jsxs("g",{transform:`translate(${i.left}, ${i.top})`,children:[x.jsx("line",{x1:"0",y1:"0",x2:"0",y2:c,stroke:"#ddd",strokeWidth:"0.5"}),x.jsx("line",{x1:"0",y1:c,x2:l,y2:c,stroke:"#ddd",strokeWidth:"0.5"}),x.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1.5",points:d}),t.map((f,g)=>{const y=g/(t.length-1)*l,T=c-f.value/n*c;return x.jsx("circle",{cx:y,cy:T,r:"2",fill:"#4a90e2"},g)})]})]})},_F=({data:t,title:e})=>{const n=Math.max(...t.map(f=>f.value),0),r=300,a=150,i={top:20,right:10,bottom:30,left:30},l=r-i.left-i.right,c=a-i.top-i.bottom,d=t.length>0?l/t.length*.8:0;return x.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[x.jsx("text",{x:r/2,y:i.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:e}),x.jsxs("g",{transform:`translate(${i.left}, ${i.top})`,children:[x.jsx("line",{x1:"0",y1:"0",x2:"0",y2:c,stroke:"#999",strokeWidth:"0.5"}),[0,n/2,n].map(f=>x.jsxs("g",{transform:`translate(0, ${c-f/n*c})`,children:[x.jsx("line",{x1:"-3",y1:"0",x2:"0",y2:"0",stroke:"#999",strokeWidth:"0.5"}),x.jsx("text",{x:"-5",y:"3",textAnchor:"end",fontSize:"6",fill:"#666",children:f.toFixed(0)})]},f)),t.map((f,g)=>x.jsxs("g",{transform:`translate(${g*l/t.length+l/t.length*.1}, 0)`,children:[x.jsx("rect",{x:"0",y:c-f.value/n*c,width:d,height:f.value/n*c,fill:"#4a90e2"}),x.jsx("text",{x:d/2,y:c+8,textAnchor:"middle",fontSize:"6",fill:"#666",transform:`rotate(-45, ${d/2}, ${c+8})`,children:f.label})]},f.label))]})]})},TF=({subStep:t,statusColor:e})=>{var n,r;return x.jsx("div",{style:{position:"absolute",left:((n=t.position)==null?void 0:n.x)||0,top:((r=t.position)==null?void 0:r.y)||0,width:192,minHeight:76,padding:"8px",borderRadius:"8px",backgroundColor:"white",borderLeft:`4px solid ${e}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",fontSize:"12px",fontFamily:"sans-serif",color:"#333",display:"flex",flexDirection:"column",justifyContent:"center"},children:x.jsx("p",{className:`font-bold break-words ${t.status===ba.COMPLETED?"line-through text-slate-500":""}`,children:t.text})})},wF=({subSteps:t})=>{if(!t||t.length===0)return x.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 text-slate-500 text-sm",children:"No sub-steps to display."});const e=l=>{switch(l){case ba.COMPLETED:return"#22c55e";case ba.IN_PROGRESS:return"#3b82f6";default:return"#94a3b8"}},n=192,r=76,a=se.useMemo(()=>{const l=[];return(t||[]).forEach(c=>{var d;if((d=c==null?void 0:c.nextSubStepIds)!=null&&d.length&&c.position){const f={x:c.position.x+n,y:c.position.y+r/2};c.nextSubStepIds.forEach(g=>{const y=t.find(T=>T.id===g);if(y&&y.position){const T={x:y.position.x,y:y.position.y+r/2};l.push({id:`fc-render-${c.id}-${g}`,from:f,to:T,sourceId:c.id,targetId:g})}})}}),l},[t,n,r]),i=se.useMemo(()=>{if(!t||t.length===0)return{minX:0,minY:0,width:400,height:300};let l=0,c=0;return t.forEach(d=>{d.position&&(l=Math.max(l,d.position.x+n),c=Math.max(c,d.position.y+r))}),{minX:0,minY:0,width:l+20,height:c+20}},[t,n,r]);return x.jsx("div",{className:"w-full h-full bg-slate-50 overflow-hidden",style:{fontFamily:"Inter, sans-serif"},children:x.jsxs("svg",{width:"100%",height:"100%",viewBox:`${i.minX} ${i.minY} ${i.width} ${i.height}`,children:[x.jsx("style",{children:`
                    .flowchart-card-container {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        font-family: Inter, sans-serif;
                    }
                    `}),x.jsx("foreignObject",{x:"0",y:"0",width:i.width,height:i.height,children:x.jsx("div",{className:"flowchart-card-container",children:(t||[]).map(l=>x.jsx(TF,{subStep:l,statusColor:e(l.status)},l.id))})}),a.map(l=>x.jsx(dm,{from:l.from,to:l.to,id:l.id},l.id))]})})},EF=({el:t,onUpdate:e,children:n,isSelected:r,onClick:a})=>x.jsx("div",{onClick:i=>{i.stopPropagation(),a()},style:{position:"absolute",left:`${t.position.x}%`,top:`${t.position.y}%`,width:`${t.position.width}%`,height:`${t.position.height}%`,outline:r?"2px solid #3b82f6":"1px dashed transparent",cursor:"move"},className:"transition-all duration-150 hover:outline-dashed hover:outline-slate-400",children:n}),Gm=({tasks:t,initialDeck:e,onSave:n,onClose:r,generateUniqueId:a,projectGoal:i,targetDate:l,reportScope:c})=>{const[d,f]=se.useState(e),[g,y]=se.useState(0),[T,w]=se.useState(null),[E,S]=se.useState(!1),[b,N]=se.useState(null),[k,C]=se.useState(!1),P=se.useRef(null),j=(ne,W)=>{f(U=>({...U,slides:U.slides.map(G=>G.id===ne?{...G,...typeof W=="function"?W(G):G}:G)}))},H=ne=>{const W=d.slides[ne];j(W.id,{isLocked:!W.isLocked})},L=(ne,W,U)=>{j(ne,G=>({elements:G.elements.map(R=>R.id===W?{...R,...U}:R)}))},K=async()=>{S(!0),N(null);try{const ne={...d,slides:d.slides.map(G=>G.isLocked?G:{...G,isLocked:void 0})},W=await UM(ne),U={...W,slides:W.slides.map((G,R)=>({...G,isLocked:d.slides[R].isLocked}))};f(U)}catch(ne){N(ne instanceof Error?ne.message:"最適化に失敗しました。")}finally{S(!1)}},M=async()=>{S(!0),N(null);try{let ne;c==="project"?ne=await VM(d,t,i,l):ne=await PM(d,t[0],i),f(ne)}catch(ne){N(ne instanceof Error?ne.message:"レポートの再生成に失敗しました。")}finally{S(!1)}},Q=(ne,W)=>{var U,G,R;for(const z of t){const J=(G=(U=z.extendedDetails)==null?void 0:U.subSteps)==null?void 0:G.find(q=>q.id===ne);if(J){const q=(R=J==null?void 0:J.actionItems)==null?void 0:R.find(ie=>ie.id===W);if(q)return q}}},X=ne=>{var W,U,G,R,z;switch(ne.type){case"textbox":const J=ne;return x.jsx("textarea",{value:J.content,onChange:q=>L(d.slides[g].id,ne.id,{content:q.target.value}),className:"w-full h-full bg-transparent resize-none border-none outline-none p-2",style:{fontSize:J.fontSize,fontWeight:J.fontWeight,textAlign:J.textAlign,color:"#333"}});case"image":{const q=ne,ie=Q(q.subStepId,q.actionItemId),we=(U=(W=ie==null?void 0:ie.report)==null?void 0:W.attachments)==null?void 0:U.find(_e=>_e.id===q.attachmentId);return we?x.jsx("img",{src:we.dataUrl,className:"w-full h-full object-contain",alt:we.name}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"画像が見つかりません"})}case"table":{const q=ne,ie=Q(q.subStepId,q.actionItemId),we=(G=ie==null?void 0:ie.report)==null?void 0:G.matrixData;return we?x.jsx("div",{className:"p-2 overflow-auto h-full",children:x.jsxs("table",{className:"w-full text-[8px] border-collapse bg-white",children:[x.jsx("thead",{children:x.jsx("tr",{className:"bg-slate-200",children:we.headers.map((_e,ke)=>x.jsx("th",{className:"border border-slate-300 p-1 font-semibold",children:_e},ke))})}),x.jsx("tbody",{children:we.rows.map((_e,ke)=>x.jsx("tr",{children:_e.map((Ce,He)=>x.jsx("td",{className:"border border-slate-300 p-1",children:Ce},`${ke}-${He}`))},ke))})]})}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"データなし"})}case"chart":{const q=ne,ie=Q(q.subStepId,q.actionItemId),we=(((z=(R=ie==null?void 0:ie.report)==null?void 0:R.matrixData)==null?void 0:z.rows)||[]).map(_e=>({label:_e[0],value:parseFloat(_e[1])||0})).filter(_e=>_e.label&&!isNaN(_e.value));if(we.length===0)return x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"チャートデータなし"});switch(q.chartType){case"line":return x.jsx(yF,{data:we,title:q.title});case"pie":return x.jsx(vF,{data:we,title:q.title});case"bar":default:return x.jsx(_F,{data:we,title:q.title})}}case"flowchart":{const q=ne;return q.data&&q.data.subSteps?x.jsx(wF,{subSteps:q.data.subSteps}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"フローチャートのデータが見つかりません。"})}default:return null}},ee=()=>window.print(),ye=(ne,W)=>{const U=JSON.stringify(ne,null,2),G=new Blob([U],{type:"application/json"}),R=URL.createObjectURL(G),z=document.createElement("a");z.href=R,z.download=W,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(R)},Ie=ne=>{ne==="pdf"?ee():ye(d,"report-deck.json"),C(!1)},Te=()=>{n(d),r()},re=d.slides[g],ue=c==="project"?`プロジェクト全体レポート: ${i}`:`タスクレポート: ${t[0].title}`;return x.jsxs(x.Fragment,{children:[x.jsx("style",{children:"@media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } .no-print { display: none !important; } .slide-print-page { page-break-after: always; width: 100vw; height: 56.25vw; /* 16:9 aspect ratio */ box-shadow: none !important; border: none; } }"}),x.jsxs("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-80 z-[100] flex flex-col p-4 no-print",onClick:()=>w(null),children:[x.jsxs("header",{className:"flex items-center justify-between pb-4 flex-shrink-0",children:[x.jsx("h2",{className:"text-xl font-bold text-white truncate pr-4",children:ue}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsxs("button",{onClick:M,disabled:E,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[x.jsx(Vm,{className:"w-4 h-4"})," ",E?"処理中...":"レポート再生成"]}),x.jsxs("button",{onClick:K,disabled:E,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:bg-slate-400",children:[x.jsx(Iw,{className:"w-4 h-4"})," ",E?"処理中...":"AIでレイアウト最適化"]}),x.jsxs("div",{className:"relative",ref:P,children:[x.jsx("button",{onClick:()=>C(ne=>!ne),className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"ダウンロード",children:x.jsx(qo,{className:"w-5 h-5"})}),k&&x.jsxs("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg z-10",children:[x.jsx("button",{onClick:()=>Ie("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"PDFとして保存"}),x.jsx("button",{onClick:()=>Ie("json"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"JSONとして保存"})]})]}),x.jsxs("button",{onClick:r,className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"閉じる",children:[" ",x.jsx(er,{className:"w-5 h-5"})]}),x.jsx("button",{onClick:Te,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold text-sm",children:"保存して閉じる"})]})]}),b&&x.jsx("div",{className:"text-red-400 text-sm mb-2 bg-red-100 border border-red-400 p-2 rounded-md",children:b}),x.jsxs("div",{className:"flex-grow flex gap-4 min-h-0",children:[x.jsx("aside",{className:"w-40 bg-slate-800 rounded-lg p-2 flex flex-col gap-2 overflow-y-auto",children:d.slides.map((ne,W)=>x.jsxs("div",{onClick:()=>y(W),className:`relative group aspect-video bg-white rounded cursor-pointer transition-all p-1 ${g===W?"ring-4 ring-blue-500":"hover:ring-2 ring-blue-400"}`,children:[x.jsx("div",{className:"absolute top-1 right-1 z-10 opacity-50 group-hover:opacity-100 transition-opacity",children:x.jsx("button",{onClick:U=>{U.stopPropagation(),H(W)},title:ne.isLocked?"スライドのロック解除":"スライドをロック",className:`p-1 rounded-full ${ne.isLocked?"bg-blue-600 text-white":"bg-slate-500 text-white"}`,children:ne.isLocked?x.jsx(oF,{className:"w-3 h-3"}):x.jsx(lF,{className:"w-3 h-3"})})}),x.jsx("div",{className:"w-full h-full transform scale-[0.1] origin-top-left overflow-hidden relative",children:ne.elements.map(U=>x.jsx("div",{style:{position:"absolute",left:`${U.position.x}%`,top:`${U.position.y}%`,width:`${U.position.width}%`,height:`${U.position.height}%`,backgroundColor:"#ccc"}},U.id))}),x.jsx("span",{className:"text-white text-xs block text-center -mt-2",children:W+1})]},ne.id))}),x.jsx("main",{className:"flex-grow flex items-center justify-center",children:re&&x.jsx("div",{className:"aspect-video w-full max-w-[100vh] bg-white shadow-2xl rounded-lg relative overflow-hidden",children:re.elements.map(ne=>x.jsx(EF,{el:ne,onUpdate:()=>{},isSelected:T===ne.id,onClick:()=>w(ne.id),children:X(ne)},ne.id))})}),x.jsxs("aside",{className:"w-64 bg-slate-800 rounded-lg p-3 text-white overflow-y-auto",children:[x.jsx("h3",{className:"font-bold border-b border-slate-600 pb-2 mb-3",children:"プロパティ"}),x.jsx("p",{className:"text-xs text-slate-400",children:"要素を選択してプロパティを編集します。"})]})]})]}),x.jsx("div",{className:"hidden print:block",children:d.slides.map((ne,W)=>x.jsx("div",{className:"slide-print-page bg-white relative",children:x.jsx("div",{className:"w-full h-full relative",children:ne.elements.map(U=>x.jsx("div",{style:{position:"absolute",left:`${U.position.x}%`,top:`${U.position.y}%`,width:`${U.position.width}%`,height:`${U.position.height}%`},children:X(U)},U.id))})},ne.id))})]})},SF=({onClose:t,onDownloadAndStartNew:e,onStartNewWithoutSaving:n})=>x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center",children:[x.jsx(gc,{className:"w-6 h-6 mr-2 text-yellow-500"}),"確認"]}),x.jsx("button",{onClick:t,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"閉じる","aria-label":"確認モーダルを閉じる",children:x.jsx(er,{className:"w-5 h-5"})})]}),x.jsxs("div",{className:"p-6",children:[x.jsx("p",{className:"text-slate-700",children:"新しいプロジェクトを開始します。現在の作業内容は保存されませんが、よろしいですか？"}),x.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"現在のプロジェクトを保存したい場合は、JSON形式でダウンロードできます。"})]}),x.jsxs("footer",{className:"p-4 bg-slate-50 border-t border-slate-200 flex flex-col sm:flex-row justify-end gap-3 rounded-b-xl",children:[x.jsx("button",{type:"button",onClick:t,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"キャンセル"}),x.jsx("button",{type:"button",onClick:n,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-red-700 bg-red-100 border border-transparent rounded-md shadow-sm hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"保存せずに新規作成"}),x.jsxs("button",{type:"submit",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[x.jsx(qo,{className:"w-4 h-4"}),"ダウンロードして新規作成"]})]})]})});function bF(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),a=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(a),e&&(r.href=e),a.href=t,a.href}const CF=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function Ls(t){const e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n]);return e}let Co=null;function Lw(t={}){return Co||(t.includeStyleProperties?(Co=t.includeStyleProperties,Co):(Co=Ls(window.getComputedStyle(document.documentElement)),Co))}function Pf(t,e){const r=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return r?parseFloat(r.replace("px","")):0}function AF(t){const e=Pf(t,"border-left-width"),n=Pf(t,"border-right-width");return t.clientWidth+e+n}function kF(t){const e=Pf(t,"border-top-width"),n=Pf(t,"border-bottom-width");return t.clientHeight+e+n}function Pw(t,e={}){const n=e.width||AF(t),r=e.height||kF(t);return{width:n,height:r}}function NF(){let t,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(t=parseInt(n,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const Cr=16384;function RF(t){(t.width>Cr||t.height>Cr)&&(t.width>Cr&&t.height>Cr?t.width>t.height?(t.height*=Cr/t.width,t.width=Cr):(t.width*=Cr/t.height,t.height=Cr):t.width>Cr?(t.height*=Cr/t.width,t.width=Cr):(t.width*=Cr/t.height,t.height=Cr))}function Uf(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>e(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=t})}async function DF(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function MF(t,e,n){const r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),i=document.createElementNS(r,"foreignObject");return a.setAttribute("width",`${e}`),a.setAttribute("height",`${n}`),a.setAttribute("viewBox",`0 0 ${e} ${n}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),a.appendChild(i),i.appendChild(t),DF(a)}const xr=(t,e)=>{if(t instanceof e)return!0;const n=Object.getPrototypeOf(t);return n===null?!1:n.constructor.name===e.name||xr(n,e)};function IF(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function FF(t,e){return Lw(e).map(n=>{const r=t.getPropertyValue(n),a=t.getPropertyPriority(n);return`${n}: ${r}${a?" !important":""};`}).join(" ")}function OF(t,e,n,r){const a=`.${t}:${e}`,i=n.cssText?IF(n):FF(n,r);return document.createTextNode(`${a}{${i}}`)}function g_(t,e,n,r){const a=window.getComputedStyle(t,n),i=a.getPropertyValue("content");if(i===""||i==="none")return;const l=CF();try{e.className=`${e.className} ${l}`}catch{return}const c=document.createElement("style");c.appendChild(OF(l,n,a,r)),e.appendChild(c)}function LF(t,e,n){g_(t,e,":before",n),g_(t,e,":after",n)}const x_="application/font-woff",v_="image/jpeg",PF={woff:x_,woff2:x_,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:v_,jpeg:v_,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function UF(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function $m(t){const e=UF(t).toLowerCase();return PF[e]||""}function BF(t){return t.split(/,/)[1]}function hm(t){return t.search(/^(data:)/)!==-1}function jF(t,e){return`data:${e};base64,${t}`}async function Uw(t,e,n){const r=await fetch(t,e);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const a=await r.blob();return new Promise((i,l)=>{const c=new FileReader;c.onerror=l,c.onloadend=()=>{try{i(n({res:r,result:c.result}))}catch(d){l(d)}},c.readAsDataURL(a)})}const Ah={};function VF(t,e,n){let r=t.replace(/\?.*/,"");return n&&(r=t),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),e?`[${e}]${r}`:r}async function zm(t,e,n){const r=VF(t,e,n.includeQueryParams);if(Ah[r]!=null)return Ah[r];n.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let a;try{const i=await Uw(t,n.fetchRequestInit,({res:l,result:c})=>(e||(e=l.headers.get("Content-Type")||""),BF(c)));a=jF(i,e)}catch(i){a=n.imagePlaceholder||"";let l=`Failed to fetch resource: ${t}`;i&&(l=typeof i=="string"?i:i.message),l&&console.warn(l)}return Ah[r]=a,a}async function HF(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):Uf(e)}async function GF(t,e){if(t.currentSrc){const i=document.createElement("canvas"),l=i.getContext("2d");i.width=t.clientWidth,i.height=t.clientHeight,l==null||l.drawImage(t,0,0,i.width,i.height);const c=i.toDataURL();return Uf(c)}const n=t.poster,r=$m(n),a=await zm(n,r,e);return Uf(a)}async function $F(t,e){var n;try{if(!((n=t==null?void 0:t.contentDocument)===null||n===void 0)&&n.body)return await sd(t.contentDocument.body,e,!0)}catch{}return t.cloneNode(!1)}async function zF(t,e){return xr(t,HTMLCanvasElement)?HF(t):xr(t,HTMLVideoElement)?GF(t,e):xr(t,HTMLIFrameElement)?$F(t,e):t.cloneNode(Bw(t))}const qF=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",Bw=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function YF(t,e,n){var r,a;if(Bw(e))return e;let i=[];return qF(t)&&t.assignedNodes?i=Ls(t.assignedNodes()):xr(t,HTMLIFrameElement)&&(!((r=t.contentDocument)===null||r===void 0)&&r.body)?i=Ls(t.contentDocument.body.childNodes):i=Ls(((a=t.shadowRoot)!==null&&a!==void 0?a:t).childNodes),i.length===0||xr(t,HTMLVideoElement)||await i.reduce((l,c)=>l.then(()=>sd(c,n)).then(d=>{d&&e.appendChild(d)}),Promise.resolve()),e}function JF(t,e,n){const r=e.style;if(!r)return;const a=window.getComputedStyle(t);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):Lw(n).forEach(i=>{let l=a.getPropertyValue(i);i==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),xr(t,HTMLIFrameElement)&&i==="display"&&l==="inline"&&(l="block"),i==="d"&&e.getAttribute("d")&&(l=`path(${e.getAttribute("d")})`),r.setProperty(i,l,a.getPropertyPriority(i))})}function WF(t,e){xr(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),xr(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function KF(t,e){if(xr(t,HTMLSelectElement)){const n=e,r=Array.from(n.children).find(a=>t.value===a.getAttribute("value"));r&&r.setAttribute("selected","")}}function XF(t,e,n){return xr(e,Element)&&(JF(t,e,n),LF(t,e,n),WF(t,e),KF(t,e)),e}async function ZF(t,e){const n=t.querySelectorAll?t.querySelectorAll("use"):[];if(n.length===0)return t;const r={};for(let i=0;i<n.length;i++){const c=n[i].getAttribute("xlink:href");if(c){const d=t.querySelector(c),f=document.querySelector(c);!d&&f&&!r[c]&&(r[c]=await sd(f,e,!0))}}const a=Object.values(r);if(a.length){const i="http://www.w3.org/1999/xhtml",l=document.createElementNS(i,"svg");l.setAttribute("xmlns",i),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const c=document.createElementNS(i,"defs");l.appendChild(c);for(let d=0;d<a.length;d++)c.appendChild(a[d]);t.appendChild(l)}return t}async function sd(t,e,n){return!n&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(r=>zF(r,e)).then(r=>YF(t,r,e)).then(r=>XF(t,r,e)).then(r=>ZF(r,e))}const jw=/url\((['"]?)([^'"]+?)\1\)/g,QF=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,e8=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function t8(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function n8(t){const e=[];return t.replace(jw,(n,r,a)=>(e.push(a),n)),e.filter(n=>!hm(n))}async function r8(t,e,n,r,a){try{const i=n?bF(e,n):e,l=$m(e);let c;return a||(c=await zm(i,l,r)),t.replace(t8(e),`$1${c}$3`)}catch{}return t}function a8(t,{preferredFontFormat:e}){return e?t.replace(e8,n=>{for(;;){const[r,,a]=QF.exec(n)||[];if(!a)return"";if(a===e)return`src: ${r};`}}):t}function Vw(t){return t.search(jw)!==-1}async function Hw(t,e,n){if(!Vw(t))return t;const r=a8(t,n);return n8(r).reduce((i,l)=>i.then(c=>r8(c,l,e,n)),Promise.resolve(r))}async function Ao(t,e,n){var r;const a=(r=e.style)===null||r===void 0?void 0:r.getPropertyValue(t);if(a){const i=await Hw(a,null,n);return e.style.setProperty(t,i,e.style.getPropertyPriority(t)),!0}return!1}async function s8(t,e){await Ao("background",t,e)||await Ao("background-image",t,e),await Ao("mask",t,e)||await Ao("-webkit-mask",t,e)||await Ao("mask-image",t,e)||await Ao("-webkit-mask-image",t,e)}async function i8(t,e){const n=xr(t,HTMLImageElement);if(!(n&&!hm(t.src))&&!(xr(t,SVGImageElement)&&!hm(t.href.baseVal)))return;const r=n?t.src:t.href.baseVal,a=await zm(r,$m(r),e);await new Promise((i,l)=>{t.onload=i,t.onerror=e.onImageErrorHandler?(...d)=>{try{i(e.onImageErrorHandler(...d))}catch(f){l(f)}}:l;const c=t;c.decode&&(c.decode=i),c.loading==="lazy"&&(c.loading="eager"),n?(t.srcset="",t.src=a):t.href.baseVal=a})}async function o8(t,e){const r=Ls(t.childNodes).map(a=>Gw(a,e));await Promise.all(r).then(()=>t)}async function Gw(t,e){xr(t,Element)&&(await s8(t,e),await i8(t,e),await o8(t,e))}function l8(t,e){const{style:n}=t;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const r=e.style;return r!=null&&Object.keys(r).forEach(a=>{n[a]=r[a]}),t}const y_={};async function __(t){let e=y_[t];if(e!=null)return e;const r=await(await fetch(t)).text();return e={url:t,cssText:r},y_[t]=e,e}async function T_(t,e){let n=t.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,i=(n.match(/url\([^)]+\)/g)||[]).map(async l=>{let c=l.replace(r,"$1");return c.startsWith("https://")||(c=new URL(c,t.url).href),Uw(c,e.fetchRequestInit,({result:d})=>(n=n.replace(l,`url(${d})`),[l,d]))});return Promise.all(i).then(()=>n)}function w_(t){if(t==null)return[];const e=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=t.replace(n,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=a.exec(r);if(d===null)break;e.push(d[0])}r=r.replace(a,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",c=new RegExp(l,"gi");for(;;){let d=i.exec(r);if(d===null){if(d=c.exec(r),d===null)break;i.lastIndex=c.lastIndex}else c.lastIndex=i.lastIndex;e.push(d[0])}return e}async function c8(t,e){const n=[],r=[];return t.forEach(a=>{if("cssRules"in a)try{Ls(a.cssRules||[]).forEach((i,l)=>{if(i.type===CSSRule.IMPORT_RULE){let c=l+1;const d=i.href,f=__(d).then(g=>T_(g,e)).then(g=>w_(g).forEach(y=>{try{a.insertRule(y,y.startsWith("@import")?c+=1:a.cssRules.length)}catch(T){console.error("Error inserting rule from remote css",{rule:y,error:T})}})).catch(g=>{console.error("Error loading remote css",g.toString())});r.push(f)}})}catch(i){const l=t.find(c=>c.href==null)||document.styleSheets[0];a.href!=null&&r.push(__(a.href).then(c=>T_(c,e)).then(c=>w_(c).forEach(d=>{l.insertRule(d,l.cssRules.length)})).catch(c=>{console.error("Error loading remote stylesheet",c)})),console.error("Error inlining remote css file",i)}}),Promise.all(r).then(()=>(t.forEach(a=>{if("cssRules"in a)try{Ls(a.cssRules||[]).forEach(i=>{n.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${a.href}`,i)}}),n))}function u8(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>Vw(e.style.getPropertyValue("src")))}async function f8(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=Ls(t.ownerDocument.styleSheets),r=await c8(n,e);return u8(r)}function $w(t){return t.trim().replace(/["']/g,"")}function d8(t){const e=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(i=>{e.add($w(i))}),Array.from(r.children).forEach(i=>{i instanceof HTMLElement&&n(i)})}return n(t),e}async function h8(t,e){const n=await f8(t,e),r=d8(t);return(await Promise.all(n.filter(i=>r.has($w(i.style.fontFamily))).map(i=>{const l=i.parentStyleSheet?i.parentStyleSheet.href:null;return Hw(i.cssText,l,e)}))).join(`
`)}async function m8(t,e){const n=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await h8(t,e);if(n){const r=document.createElement("style"),a=document.createTextNode(n);r.appendChild(a),t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)}}async function p8(t,e={}){const{width:n,height:r}=Pw(t,e),a=await sd(t,e,!0);return await m8(a,e),await Gw(a,e),l8(a,e),await MF(a,n,r)}async function g8(t,e={}){const{width:n,height:r}=Pw(t,e),a=await p8(t,e),i=await Uf(a),l=document.createElement("canvas"),c=l.getContext("2d"),d=e.pixelRatio||NF(),f=e.canvasWidth||n,g=e.canvasHeight||r;return l.width=f*d,l.height=g*d,e.skipAutoScale||RF(l),l.style.width=`${f}`,l.style.height=`${g}`,e.backgroundColor&&(c.fillStyle=e.backgroundColor,c.fillRect(0,0,l.width,l.height)),c.drawImage(i,0,0,l.width,l.height),l}async function x8(t,e={}){return(await g8(t,e)).toDataURL()}const ic=40,E_=64,S_=320,b_=["#3B82F6","#F59E0B","#10B981","#EF4444","#6B7280","#6366F1","#EC4899","#8B5CF6"],v8=({data:t,onClose:e,onItemClick:n,onRegenerate:r,isRegenerating:a})=>{const[i,l]=se.useState(!0),[c,d]=se.useState(new Set),[f,g]=se.useState("all"),y=se.useRef(null),[T,w]=se.useState(!1),[E,S]=se.useState("day"),[b,N]=se.useState({start:"",end:""}),C={day:40,week:15,month:5}[E],P=se.useMemo(()=>{const ne=new Map;return t.filter(W=>W.type==="task").forEach((W,U)=>{ne.set(W.id,b_[U%b_.length])}),ne},[t]),j=se.useCallback((ne,W)=>{if(ne.type==="task")return ne.id;let U=ne;for(;U.parentId;){const G=W.get(U.parentId);if(!G)return null;if(G.type==="task")return G.id;U=G}return null},[]),H=se.useMemo(()=>new Map(t.map(ne=>[ne.id,ne])),[t]),L=se.useCallback(ne=>{const W=j(ne,H);return W&&P.get(W)||"#9CA3AF"},[H,P,j]);se.useEffect(()=>{const ne=new Set(t.filter(W=>W.type==="task").map(W=>W.id));d(ne)},[t]);const K=ne=>{d(W=>{const U=new Set(W);return U.has(ne)?U.delete(ne):U.add(ne),U})},M=se.useMemo(()=>{const ne=[];return t.filter(U=>U.type==="task").forEach(U=>{ne.push(U),c.has(U.id)&&t.filter(R=>R.type==="substep"&&R.parentId===U.id).forEach(R=>{if(ne.push(R),c.has(R.id)){const z=t.filter(J=>{if(J.type!=="actionitem"||J.parentId!==R.id)return!1;if(f==="all")return!0;const q=J.progress===100;return f==="completed"?q:f==="pending"?!q:!0});ne.push(...z)}})}),ne},[t,c,f]),{timelineStart:Q,totalDays:X}=se.useMemo(()=>{if(t.length===0)return{timelineStart:new Date,totalDays:30};const ne=t.map(q=>new Date(q.start)).filter(q=>!isNaN(q.getTime())),W=t.map(q=>new Date(q.end)).filter(q=>!isNaN(q.getTime()));let U,G;ne.length===0||W.length===0?(U=new Date,G=new Date,G.setMonth(G.getMonth()+1)):(U=new Date(Math.min(...ne.map(q=>q.getTime()))),G=new Date(Math.max(...W.map(q=>q.getTime()))));let R=b.start?new Date(b.start):U,z=b.end?new Date(b.end):G;isNaN(R.getTime())&&(R=U),isNaN(z.getTime())&&(z=G),z<R&&(z=R),R.setDate(R.getDate()-2),z.setDate(z.getDate()+5);const J=(z.getTime()-R.getTime())/(1e3*3600*24);return{timelineStart:R,totalDays:Math.ceil(J)}},[t,b]),ee=se.useMemo(()=>{const ne=G=>{G=new Date(Date.UTC(G.getFullYear(),G.getMonth(),G.getDate())),G.setUTCDate(G.getUTCDate()+4-(G.getUTCDay()||7));const R=new Date(Date.UTC(G.getUTCFullYear(),0,1));return Math.ceil(((G.getTime()-R.getTime())/864e5+1)/7)},W=[];let U=new Date(Q);if(E==="day")for(let G=0;G<X;G++)W.push({secondaryLabel:U.toLocaleDateString("ja-JP",{weekday:"short"}),label:String(U.getDate()),width:C}),U.setDate(U.getDate()+1);else if(E==="week")for(let G=0;G<X;G++)(U.getDay()===1||W.length===0)&&W.push({label:`W${ne(U)}`,secondaryLabel:U.toLocaleDateString("ja-JP",{month:"short"}),width:0}),W[W.length-1].width+=C,U.setDate(U.getDate()+1);else if(E==="month"){let G=-1;for(let R=0;R<X;R++){const z=U.getMonth();z!==G&&(G=z,W.push({label:U.toLocaleDateString("ja-JP",{month:"long",year:"numeric"}),width:0})),W[W.length-1].width+=C,U.setDate(U.getDate()+1)}}return W},[Q,X,E,C]),ye=ne=>{const W=new Date(ne);return isNaN(W.getTime())?-1:(W.getTime()-Q.getTime())/(1e3*3600*24)},Ie=ne=>{switch(ne){case"substep":return"pl-5";case"actionitem":return"pl-9";default:return"pl-1"}},Te=ne=>t.some(W=>W.parentId===ne),re=se.useCallback(()=>{if(y.current===null){alert("チャート要素が見つかりません。");return}w(!0),x8(y.current,{cacheBust:!0,backgroundColor:"#ffffff",width:y.current.scrollWidth,height:y.current.scrollHeight}).then(ne=>{const W=document.createElement("a");W.download="gantt-chart.png",W.href=ne,W.click()}).catch(ne=>{console.error("ガントチャートのダウンロードに失敗しました。",ne),alert("画像のダウンロードに失敗しました。コンソールログを確認してください。")}).finally(()=>{w(!1)})},[]),ue=se.useMemo(()=>ee.reduce((ne,W)=>ne+W.width,0),[ee]);return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 z-[80]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex flex-wrap items-center justify-between p-4 border-b gap-4",children:[x.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"ガントチャート"}),x.jsxs("div",{className:"flex items-center flex-wrap gap-x-6 gap-y-2",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm font-medium text-slate-600",children:"表示単位:"}),x.jsx("div",{className:"flex items-center rounded-md bg-slate-100 p-1",children:["day","week","month"].map(ne=>x.jsx("button",{onClick:()=>S(ne),className:`px-3 py-1 text-xs capitalize rounded-md ${E===ne?"bg-white shadow-sm font-semibold text-blue-600":""}`,children:ne},ne))})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm font-medium text-slate-600",children:"表示範囲:"}),x.jsx("input",{type:"date",value:b.start,onChange:ne=>N(W=>({...W,start:ne.target.value})),className:"p-1 border rounded-md text-sm"}),x.jsx("span",{children:"-"}),x.jsx("input",{type:"date",value:b.end,onChange:ne=>N(W=>({...W,end:ne.target.value})),className:"p-1 border rounded-md text-sm"}),x.jsx("button",{onClick:()=>N({start:"",end:""}),className:"text-xs px-2 py-1 bg-slate-200 rounded-md hover:bg-slate-300",children:"リセット"})]}),x.jsxs("button",{onClick:re,disabled:T,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[T?x.jsx(Cn,{size:"sm",color:"border-white"}):x.jsx(qo,{className:"w-4 h-4"}),"PNG"]}),x.jsxs("button",{onClick:e,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-100 rounded-md hover:bg-slate-200",children:[x.jsx(er,{className:"w-5 h-5"}),"閉じる"]})]})]}),x.jsxs("div",{className:"flex-shrink-0 p-4 border-b flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-100 p-1",children:[x.jsx("button",{onClick:()=>g("all"),className:`px-3 py-1 text-xs rounded-full ${f==="all"?"bg-white shadow-sm":""}`,children:"すべて"}),x.jsx("button",{onClick:()=>g("pending"),className:`px-3 py-1 text-xs rounded-full ${f==="pending"?"bg-white shadow-sm":""}`,children:"未完了"}),x.jsx("button",{onClick:()=>g("completed"),className:`px-3 py-1 text-xs rounded-full ${f==="completed"?"bg-white shadow-sm":""}`,children:"完了"})]}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("button",{onClick:r,disabled:a,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[a?x.jsx(Cn,{size:"sm",color:"border-white"}):x.jsx(Vm,{className:"w-4 h-4"}),"AIで再生成"]}),x.jsxs("label",{className:"flex items-center text-sm text-slate-600 cursor-pointer",children:[x.jsx("input",{type:"checkbox",checked:i,onChange:()=>l(ne=>!ne),className:"w-4 h-4 mr-2 accent-blue-600"}),"依存関係"]})]})]}),x.jsx("div",{className:"flex-grow overflow-auto relative",children:x.jsxs("div",{ref:y,className:"grid",style:{gridTemplateColumns:`${S_}px 1fr`,width:`${S_+ue}px`},children:[x.jsx("div",{className:"sticky top-0 left-0 z-30 flex items-center p-2 font-semibold text-sm border-b border-r bg-slate-100 text-slate-800",style:{gridColumn:1,gridRow:1,height:E_},children:"タスク / サブステップ"}),x.jsx("div",{className:"sticky top-0 z-20 border-b bg-slate-50",style:{gridColumn:2,gridRow:1,height:E_},children:x.jsx("div",{className:"flex h-full",children:ee.map((ne,W)=>x.jsxs("div",{className:"border-r text-center text-[10px] flex flex-col items-center justify-center",style:{width:ne.width},children:[ne.secondaryLabel&&x.jsx("span",{className:"font-semibold text-slate-600",children:ne.secondaryLabel}),x.jsx("div",{className:`font-bold text-slate-800 ${E==="day"?"text-lg":"text-sm"}`,children:ne.label})]},W))})}),x.jsx("div",{className:"pointer-events-none flex",style:{gridColumn:2,gridRow:`2 / span ${M.length}`},children:ee.map((ne,W)=>x.jsx("div",{className:"h-full border-r border-slate-200",style:{width:ne.width}},W))}),M.map((ne,W)=>{const U=L(ne),G=(()=>{const we=M[W+1];return we?j(ne,H)!==j(we,H):!0})(),R=ye(ne.start),z=Math.max(.2,ye(ne.end)-R+1),J=R*C,q=z*C,ie={task:{height:"24px"},substep:{height:"20px"},actionitem:{height:"8px"}};return x.jsxs(Bo.Fragment,{children:[x.jsxs("div",{className:"sticky left-0 z-10 flex items-center border-r bg-slate-50",style:{gridColumn:1,gridRow:W+2,height:ic,borderBottom:G?`2px solid ${U}`:"1px solid #e5e7eb"},children:[x.jsx("div",{className:"w-1 h-full flex-shrink-0",style:{backgroundColor:U}}),x.jsxs("div",{className:`flex items-center w-full ${Ie(ne.type)}`,children:[(ne.type==="task"||ne.type==="substep")&&(Te(ne.id)?x.jsx(aF,{onClick:()=>K(ne.id),className:`w-4 h-4 mr-1 text-slate-500 cursor-pointer transition-transform ${c.has(ne.id)?"rotate-0":"-rotate-90"}`}):x.jsx("div",{className:"w-4 h-4 mr-1"})),ne.type==="actionitem"&&(ne.progress===100?x.jsx(nd,{className:"w-3.5 h-3.5 text-green-600 mr-2 flex-shrink-0"}):x.jsx(rd,{className:"w-3.5 h-3.5 text-slate-400 mr-2 flex-shrink-0"})),x.jsx("span",{onClick:()=>n==null?void 0:n(ne),className:`truncate text-xs ${ne.type==="task"?"font-semibold text-slate-800":"text-slate-600"} ${n?"cursor-pointer hover:text-blue-600":""}`,title:ne.name,children:ne.name})]})]}),x.jsx("div",{className:"relative",style:{gridColumn:2,gridRow:W+2,borderBottom:G?`2px solid ${U}`:"1px solid #e5e7eb"},children:R>=0&&x.jsx("div",{title:`${ne.name} (${ne.progress}%)`,onClick:()=>n==null?void 0:n(ne),className:"absolute h-full flex items-center group",style:{left:J,width:q,cursor:n?"pointer":"default"},children:x.jsx("div",{className:"w-full rounded",style:{...ie[ne.type],backgroundColor:U},children:x.jsx("div",{className:"bg-black bg-opacity-30 h-full rounded",style:{width:`${ne.progress}%`}})})})})]},ne.id)}),x.jsx("div",{style:{gridColumn:2,gridRow:`2 / span ${M.length}`,position:"relative",pointerEvents:"none"},children:i&&x.jsx(y8,{items:M,getDaysFromStart:ye,dayWidth:C})})]})})]})})},y8=({items:t,getDaysFromStart:e,dayWidth:n})=>{const r=se.useMemo(()=>{const a=[],i=new Map(t.map((l,c)=>[l.id,c]));return t.forEach((l,c)=>{(l.dependencies||[]).forEach(d=>{const f=i.get(d),g=f!==void 0?t[f]:void 0;if(g&&f!==void 0){const y=e(g.end),T=e(l.start);if(y<0||T<0)return;const w=(y+1)*n,E=f*ic+ic/2,S=T*n,b=c*ic+ic/2,N=w+20,k=S-20,C=`M ${w} ${E} C ${N} ${E}, ${k} ${b}, ${S} ${b}`;a.push({key:`${d}-${l.id}`,d:C})}})}),a},[t,e,n]);return x.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",overflow:"visible",children:[x.jsx("defs",{children:x.jsx("marker",{id:"gantt_arrowhead",markerWidth:"5",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:x.jsx("polygon",{points:"0 0, 5 2, 0 4",fill:"#4b5563"})})}),r.map(a=>x.jsx("path",{d:a.d,stroke:"#4b5563",strokeWidth:"1",fill:"none",markerEnd:"url(#gantt_arrowhead)"},a.key))]})},es=({message:t})=>t?x.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md relative",role:"alert",children:[x.jsx("strong",{className:"font-bold",children:"Error: "}),x.jsx("span",{className:"block sm:inline",children:t})]}):null,_8=({tasks:t,projectGoal:e,targetDate:n,ganttData:r,projectReportDeck:a,onClose:i,onReportGenerated:l,generateUniqueId:c})=>{const[d,f]=se.useState("list"),[g,y]=se.useState(new Set),[T,w]=se.useState(""),[E,S]=se.useState(!1),[b,N]=se.useState(null),[k,C]=se.useState({key:"taskName",direction:"ascending"}),[P,j]=se.useState("slides"),[H,L]=se.useState(null),K=se.useMemo(()=>{const G=[];return r&&G.push({id:"gantt-chart-main",name:"プロジェクト ガントチャート",type:"Gantt Chart",taskName:"プロジェクト全体",subStepName:"",actionItemName:"",source:{name:"プロジェクト ガントチャート",type:"json",content:r}}),a&&G.push({id:"project-report-main",name:"プロジェクトレポート",type:"Project Report",taskName:"プロジェクト全体",subStepName:"",actionItemName:"",source:{name:"プロジェクトレポート",type:"json",content:a}}),t.forEach(R=>{var z,J,q,ie,we;(z=R.extendedDetails)!=null&&z.reportDeck&&G.push({id:`task-report-${R.id}`,name:`タスクレポート: ${R.title}`,type:"Task Report",taskName:R.title,subStepName:"",actionItemName:"",source:{name:`タスクレポート: ${R.title}`,type:"json",content:R.extendedDetails.reportDeck}}),(q=(J=R.extendedDetails)==null?void 0:J.attachments)==null||q.forEach(_e=>{G.push({id:_e.id,name:_e.name,type:"Attachment",taskName:R.title,subStepName:"",actionItemName:"",source:{name:_e.name,type:_e.type.startsWith("image/")?"image":"text",content:_e.dataUrl,dataUrl:_e.dataUrl}})}),(we=(ie=R.extendedDetails)==null?void 0:ie.subSteps)==null||we.forEach(_e=>{var ke,Ce;(ke=_e.attachments)==null||ke.forEach(He=>{G.push({id:He.id,name:He.name,type:"Attachment",taskName:R.title,subStepName:_e.text,actionItemName:"",source:{name:He.name,type:He.type.startsWith("image/")?"image":"text",content:He.dataUrl,dataUrl:He.dataUrl}})}),(Ce=_e.actionItems)==null||Ce.forEach(He=>{var Z,yt,qe;(yt=(Z=He.report)==null?void 0:Z.attachments)==null||yt.forEach(it=>{G.push({id:it.id,name:it.name,type:"Attachment",taskName:R.title,subStepName:_e.text,actionItemName:He.text,source:{name:it.name,type:it.type.startsWith("image/")?"image":"text",content:it.dataUrl,dataUrl:it.dataUrl}})}),(qe=He.report)!=null&&qe.matrixData&&G.push({id:`matrix-${He.id}`,name:`データマトリクス: ${He.text}`,type:"Data Matrix",taskName:R.title,subStepName:_e.text,actionItemName:He.text,source:{name:`データマトリクス: ${He.text}`,type:"json",content:He.report.matrixData}})})})}),G},[t,r,a]),M=se.useMemo(()=>{let G=[...K];return k!==null&&G.sort((R,z)=>{const J=(R[k.key]||"").toLowerCase(),q=(z[k.key]||"").toLowerCase();return J<q?k.direction==="ascending"?-1:1:J>q?k.direction==="ascending"?1:-1:0}),G},[K,k]),Q=G=>{let R="ascending";k&&k.key===G&&k.direction==="ascending"&&(R="descending"),C({key:G,direction:R})},X=G=>!k||k.key!==G?x.jsx(Ei,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):k.direction==="ascending"?x.jsx(Rc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Ei,{className:"w-3 h-3 ml-1 text-blue-600"}),ee=G=>{y(R=>{const z=new Set(R);return z.has(G)?z.delete(G):z.add(G),z})},ye=()=>{g.size===K.length?y(new Set):y(new Set(K.map(G=>G.id)))},Ie=async()=>{if(g.size===0){N("レポート生成には、少なくとも1つの資料を選択してください。");return}if(!T.trim()){N("レポートの目的をプロンプトに入力してください。");return}S(!0),N(null),L(null);const G=K.filter(R=>g.has(R.id)).map(R=>R.source);try{if(P==="slides"){const R=await uw(G,T);l(R)}else{const R=await GM(G,T);L(R)}}catch(R){N(R instanceof Error?R.message:"カスタムレポートの生成に失敗しました。")}finally{S(!1)}},Te=G=>{switch(G){case"Gantt Chart":return x.jsx(Ow,{className:"w-5 h-5 text-amber-600"});case"Project Report":case"Task Report":return x.jsx(Hm,{className:"w-5 h-5 text-teal-600"});case"Attachment":return x.jsx(Yo,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return x.jsx(ad,{className:"w-5 h-5 text-purple-600"});default:return x.jsx(wi,{className:"w-5 h-5 text-slate-500"})}},re=G=>{if(G.dataUrl)return G.dataUrl;if(G.type==="json")try{const R=JSON.stringify(G.content,null,2),z=new Blob([R],{type:"application/json"});return URL.createObjectURL(z)}catch{return}},ue=(G,R)=>{const z=re(G);if(z){const J=document.createElement("a");J.href=z,J.download=R||G.name||"download",document.body.appendChild(J),J.click(),document.body.removeChild(J),G.type==="json"&&URL.revokeObjectURL(z)}},ne=se.useMemo(()=>K.filter(G=>g.has(G.id)),[g,K]),W=()=>x.jsxs(x.Fragment,{children:[x.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:x.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx("th",{className:"p-2 border border-slate-300 w-10 text-center",children:x.jsx("input",{type:"checkbox",checked:g.size===K.length&&K.length>0,onChange:ye,className:"w-4 h-4 accent-blue-600"})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>Q("name"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"資料名"}),X("name")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-40",children:x.jsxs("button",{onClick:()=>Q("type"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"種類"}),X("type")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>Q("taskName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"タスク"}),X("taskName")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>Q("subStepName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"サブステップ"}),X("subStepName")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>Q("actionItemName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"アクション"}),X("actionItemName")]})})]})}),x.jsx("tbody",{children:M.map(G=>{const R=re(G.source);return x.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"border border-slate-300 align-middle text-center p-2",children:x.jsx("input",{type:"checkbox",checked:g.has(G.id),onChange:()=>ee(G.id),className:"w-4 h-4 accent-blue-600"})}),x.jsx("td",{className:"border border-slate-300 p-2 font-medium text-slate-800",children:R?x.jsx("button",{onClick:()=>ue(G.source,G.name),className:"hover:underline text-blue-600 text-left",children:G.name}):x.jsx("span",{children:G.name})}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600",children:x.jsxs("div",{className:"flex items-center gap-2",children:[Te(G.type),x.jsx("span",{children:G.type})]})}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:G.taskName}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:G.subStepName}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:G.actionItemName})]},G.id)})})]})}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[x.jsxs("span",{className:"text-sm text-slate-600",children:[g.size," / ",K.length," 件の資料を選択中"]}),x.jsx("button",{onClick:()=>f("generate"),disabled:g.size===0,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed",children:"レポート生成へ"})]})]}),U=()=>x.jsxs(x.Fragment,{children:[x.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.jsxs("div",{children:[x.jsxs("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:["選択した資料 (",ne.length,"件)"]}),x.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-96 overflow-y-auto space-y-2",children:ne.map(G=>x.jsxs("div",{className:"text-sm text-slate-700 flex items-center gap-2",children:[Te(G.type),x.jsx("span",{className:"truncate",title:G.name,children:G.name})]},G.id))}),x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mt-6 mb-2",children:"レポート形式"}),x.jsxs("div",{className:"flex gap-4",children:[x.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[x.jsx("input",{type:"radio",name:"reportFormat",value:"slides",checked:P==="slides",onChange:()=>j("slides"),className:"w-4 h-4 accent-blue-600"}),"スライド形式"]}),x.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[x.jsx("input",{type:"radio",name:"reportFormat",value:"text",checked:P==="text",onChange:()=>j("text"),className:"w-4 h-4 accent-blue-600"}),"テキスト形式"]})]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:"レポート作成の目的"}),x.jsx("textarea",{value:T,onChange:G=>w(G.target.value),placeholder:"例：これらの資料からプロジェクトの進捗状況をまとめ、経営層向けの報告スライドを作成してください。",rows:6,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),b&&x.jsx("div",{className:"mt-2",children:x.jsx(es,{message:b})}),H&&x.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-slate-50",children:[x.jsx("h5",{className:"font-semibold text-md text-slate-800 mb-2",children:"生成されたテキストレポート"}),x.jsx("pre",{className:"text-sm text-slate-700 bg-white p-3 rounded whitespace-pre-wrap max-h-60 overflow-y-auto",children:H}),x.jsx("button",{onClick:()=>navigator.clipboard.writeText(H),className:"text-xs mt-2 px-2 py-1 bg-slate-200 rounded",children:"クリップボードにコピー"})]})]})]}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[x.jsxs("button",{onClick:()=>{f("list"),L(null)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:[x.jsx(Rw,{className:"w-4 h-4"}),"資料選択に戻る"]}),x.jsxs("button",{onClick:Ie,disabled:E,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[E?x.jsx(Cn,{size:"sm",color:"border-white"}):x.jsx(Ti,{className:"w-5 h-5"}),x.jsx("span",{children:E?"生成中...":"レポートを生成"})]})]})]});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[70]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-3",children:[x.jsx(wi,{className:"w-7 h-7 text-blue-600"}),x.jsx("span",{children:"資料センター"})]}),x.jsx("button",{onClick:i,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(er,{className:"w-6 h-6 text-slate-500"})})]}),d==="list"?W():U()]})})},T8=({isOpen:t,onClose:e,projectId:n,userRole:r})=>{const[a,i]=se.useState([]),[l,c]=se.useState([]),[d,f]=se.useState(!1),[g,y]=se.useState(null),[T,w]=se.useState(""),[E,S]=se.useState("member"),[b,N]=se.useState(!1),k=r==="owner"||r==="admin";se.useEffect(()=>{t&&C()},[t,n]);const C=async()=>{f(!0),y(null);try{const[M,Q]=await Promise.all([Yr.getProjectMembers(n),k?Yr.getProjectInvitations(n):Promise.resolve([])]);i(M),c(Q)}catch(M){y(M instanceof Error?M.message:"データの読み込みに失敗しました")}finally{f(!1)}},P=async()=>{if(!T.trim()){y("メールアドレスを入力してください");return}N(!0),y(null);try{await Yr.inviteToProject(n,T,E),w(""),S("member"),await C()}catch(M){y(M instanceof Error?M.message:"招待の送信に失敗しました")}finally{N(!1)}},j=async(M,Q)=>{try{await Yr.updateMemberRole(n,M,Q),await C()}catch(X){y(X instanceof Error?X.message:"役割の更新に失敗しました")}},H=async(M,Q)=>{if(confirm(`${Q}をプロジェクトから削除しますか？`))try{await Yr.removeMember(n,M),await C()}catch(X){y(X instanceof Error?X.message:"メンバーの削除に失敗しました")}},L=M=>{switch(M){case"owner":return x.jsx(dF,{className:"w-4 h-4 text-yellow-600"});case"admin":return x.jsx(nF,{className:"w-4 h-4 text-blue-600"});default:return x.jsx(Lf,{className:"w-4 h-4 text-slate-600"})}},K=M=>{switch(M){case"owner":return"所有者";case"admin":return"管理者";default:return"メンバー"}};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"プロジェクトメンバー"}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(er,{className:"w-6 h-6"})})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[g&&x.jsx(es,{message:g}),k&&x.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[x.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"新しいメンバーを招待"}),x.jsxs("div",{className:"flex gap-3",children:[x.jsx("input",{type:"email",value:T,onChange:M=>w(M.target.value),placeholder:"メールアドレス",className:"flex-grow px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500"}),x.jsxs("select",{value:E,onChange:M=>S(M.target.value),className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[x.jsx("option",{value:"member",children:"メンバー"}),x.jsx("option",{value:"admin",children:"管理者"})]}),x.jsxs("button",{onClick:P,disabled:b,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[b?x.jsx(Cn,{size:"sm",color:"border-white"}):x.jsx(Bs,{className:"w-4 h-4"}),"招待"]})]})]}),l.length>0&&x.jsxs("div",{className:"mb-6",children:[x.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"送信済み招待"}),x.jsx("div",{className:"space-y-2",children:l.map(M=>x.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-slate-800",children:M.email}),x.jsxs("p",{className:"text-sm text-slate-500",children:[K(M.role)," として招待中 | 期限: ",new Date(M.expiresAt).toLocaleDateString("ja-JP")]})]}),x.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded",children:"招待中"})]},M.id))})]}),d?x.jsx("div",{className:"flex items-center justify-center py-12",children:x.jsx(Cn,{size:"lg",text:"メンバー情報を読み込み中..."})}):x.jsxs("div",{className:"space-y-3",children:[x.jsxs("h4",{className:"font-semibold text-slate-800",children:["現在のメンバー (",a.length,"人)"]}),a.map(M=>x.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[x.jsxs("div",{className:"flex items-center gap-3",children:[L(M.role),x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-slate-800",children:M.userName||M.userEmail}),x.jsx("p",{className:"text-sm text-slate-500",children:M.userEmail})]})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm text-slate-600 bg-slate-200 px-2 py-1 rounded",children:K(M.role)}),k&&M.role!=="owner"&&x.jsxs("div",{className:"flex items-center gap-1",children:[M.role!=="admin"&&x.jsx("button",{onClick:()=>j(M.userId,"admin"),className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200",title:"管理者に昇格",children:"管理者に"}),M.role==="admin"&&x.jsx("button",{onClick:()=>j(M.userId,"member"),className:"text-xs px-2 py-1 bg-slate-100 text-slate-700 rounded hover:bg-slate-200",title:"メンバーに降格",children:"メンバーに"}),x.jsx("button",{onClick:()=>H(M.userId,M.userName||M.userEmail||""),className:"p-1 text-red-500 hover:text-red-700 rounded hover:bg-red-100",title:"削除",children:x.jsx(ha,{className:"w-4 h-4"})})]})]})]},M.id))]})]}),x.jsx("footer",{className:"p-6 bg-slate-50 border-t flex justify-end",children:x.jsx("button",{onClick:e,className:"px-6 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-700",children:"閉じる"})})]})}):null},w8=({isOpen:t,onClose:e,onInvitationAccepted:n})=>{const[r,a]=se.useState([]),[i,l]=se.useState(!1),[c,d]=se.useState(null),[f,g]=se.useState(new Set);se.useEffect(()=>{t&&y()},[t]);const y=async()=>{l(!0),d(null);try{const E=await Yr.getUserInvitations();a(E)}catch(E){d(E instanceof Error?E.message:"招待一覧の取得に失敗しました")}finally{l(!1)}},T=async E=>{g(S=>new Set(S).add(E)),d(null);try{await Yr.acceptInvitation(E),await y(),n()}catch(S){d(S instanceof Error?S.message:"招待の受諾に失敗しました")}finally{g(S=>{const b=new Set(S);return b.delete(E),b})}},w=E=>{switch(E){case"admin":return"管理者";case"member":return"メンバー";default:return E}};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"プロジェクト招待"}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(er,{className:"w-6 h-6"})})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[c&&x.jsx(es,{message:c}),i?x.jsx("div",{className:"flex items-center justify-center py-12",children:x.jsx(Cn,{size:"lg",text:"招待を確認中..."})}):r.length===0?x.jsxs("div",{className:"text-center py-12",children:[x.jsx(Lf,{className:"w-16 h-16 mx-auto text-slate-300 mb-4"}),x.jsx("p",{className:"text-slate-500 text-lg",children:"新しい招待はありません"})]}):x.jsxs("div",{className:"space-y-4",children:[x.jsx("p",{className:"text-slate-600 mb-4",children:"以下のプロジェクトに招待されています："}),r.map(E=>x.jsxs("div",{className:"p-4 border border-slate-200 rounded-lg bg-slate-50",children:[x.jsxs("div",{className:"mb-3",children:[x.jsx("h4",{className:"font-semibold text-slate-800 mb-1",children:E.projectTitle}),x.jsxs("p",{className:"text-sm text-slate-600",children:[E.inviterName,"さんから",w(E.role),"として招待されました"]}),x.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["招待日: ",new Date(E.invitedAt).toLocaleDateString("ja-JP")," | 有効期限: ",new Date(E.expiresAt).toLocaleDateString("ja-JP")]})]}),x.jsx("div",{className:"flex gap-2",children:x.jsxs("button",{onClick:()=>T(E.id),disabled:f.has(E.id),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-slate-400 text-sm",children:[f.has(E.id)?x.jsx(Cn,{size:"sm",color:"border-white"}):x.jsx(fF,{className:"w-4 h-4"}),"参加する"]})})]},E.id))]})]}),x.jsx("footer",{className:"p-6 bg-slate-50 border-t flex justify-end",children:x.jsx("button",{onClick:e,className:"px-6 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-700",children:"閉じる"})})]})}):null},E8=({tasks:t,projectGoal:e,targetDate:n,onSelectTask:r,onUpdateTaskExtendedDetails:a,onUpdateTaskPosition:i,onUpdateTaskStatus:l,onStartNewProject:c,onExportProject:d,onAddTask:f,onRemoveTask:g,onImportSingleTask:y,onAutoLayout:T,onUndo:w,canUndo:E,onRedo:S,canRedo:b,generateUniqueId:N,onUpdateTaskConnections:k,ganttData:C,setGanttData:P,onCustomReportGenerated:j,onClearApiKey:H,onOpenProjectList:L,onLogout:K,currentProjectId:M,onSaveProject:Q})=>{se.useRef(null);const X=se.useRef(null),[ee,ye]=se.useState(new Map),[Ie,Te]=se.useState([]),re=se.useRef(null),ue=se.useRef({x:0,y:0}),[ne,W]=se.useState(!1),[U,G]=se.useState(!1),[R,z]=se.useState(null),[J,q]=se.useState(!1),[ie,we]=se.useState(null),[_e,ke]=se.useState(!1),[Ce,He]=se.useState(null),[Z,yt]=se.useState(!1),[qe,it]=se.useState(null),[rt,Re]=se.useState(!1),[Dt,$t]=se.useState(!1),[dn,en]=se.useState(null),[Gn,Nn]=se.useState(!1),[on,wn]=se.useState(!1),[ln,qt]=se.useState(!1),[Ne,Pe]=se.useState(!1),[De,Be]=se.useState(null),[Tt,ot]=se.useState(!1),[Bt,hn]=se.useState(null),[vr,cr]=se.useState({x:0,y:0}),[Rr,ve]=se.useState(!1);se.useEffect(()=>{M&&Yr.getUserProjectRole(M).then(Be)},[M]),se.useEffect(()=>{(async()=>{try{const I=await Yr.getUserInvitations();ot(I.length>0)}catch(I){console.error("招待確認エラー:",I)}})()},[]),se.useEffect(()=>{if(!M)return;const F=Yr.subscribeToProjectUpdates(M,I=>{console.log("Project updated:",I)});return()=>{F.unsubscribe()}},[M]),se.useEffect(()=>{const F=new Map;t.forEach(I=>{F.set(I.id,ee.get(I.id)||se.createRef())}),ye(F)},[t]);const Ve=se.useCallback(()=>{if(!X.current||ee.size===0){Te([]);return}const F=[];t.forEach(I=>{var B,V;if(I.nextTaskIds&&I.nextTaskIds.length>0){const Y=ee.get(I.id),ce=Y==null?void 0:Y.current;if(!ce)return;const xe=((B=I.position)==null?void 0:B.x)||0,le=((V=I.position)==null?void 0:V.y)||0,he=ce.getBoundingClientRect(),me={x:xe+he.width,y:le+he.height/2};I.nextTaskIds.forEach(Ae=>{var Ot,Ir;const Oe=t.find(xa=>xa.id===Ae);if(!Oe)return;const je=ee.get(Ae),Me=je==null?void 0:je.current;if(!Me)return;const Ue=((Ot=Oe.position)==null?void 0:Ot.x)||0,tt=((Ir=Oe.position)==null?void 0:Ir.y)||0,It=Me.getBoundingClientRect(),Ft={x:Ue,y:tt+It.height/2};F.push({id:`conn-${I.id}-${Ae}`,from:me,to:Ft,sourceId:I.id,targetId:Ae})})}}),Te(F)},[t,ee]);se.useEffect(()=>{const F=setTimeout(Ve,50);return()=>clearTimeout(F)},[Ve,t]),se.useEffect(()=>{window.addEventListener("resize",Ve);const F=new MutationObserver(Ve);return X.current&&F.observe(X.current,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.removeEventListener("resize",Ve),F.disconnect()}},[Ve]);const Ke=(F,I)=>{var V,Y;re.current=I;const B=t.find(ce=>ce.id===I);if(X.current){const ce=X.current.getBoundingClientRect();ue.current.x=F.clientX-ce.left-(((V=B==null?void 0:B.position)==null?void 0:V.x)||0),ue.current.y=F.clientY-ce.top-(((Y=B==null?void 0:B.position)==null?void 0:Y.y)||0)}F.dataTransfer.effectAllowed="move"},Fe=F=>{F.preventDefault(),F.dataTransfer.dropEffect="move"},lt=F=>{var me;if(F.preventDefault(),!re.current||!X.current)return;const I=X.current.getBoundingClientRect(),B=(me=ee.get(re.current))==null?void 0:me.current,V=(B==null?void 0:B.offsetWidth)||380,Y=(B==null?void 0:B.offsetHeight)||280;let ce=F.clientX-I.left-ue.current.x,xe=F.clientY-I.top-ue.current.y;const le=X.current.scrollWidth,he=X.current.scrollHeight;ce=Math.max(0,Math.min(ce,le-V)),xe=Math.max(0,Math.min(xe,he-Y)),i(re.current,{x:ce,y:xe}),re.current=null,setTimeout(Ve,0)},mt=async()=>{q(!0),we(null);try{const F=await BM(t,e,n);z(F),G(!0)}catch(F){we(F instanceof Error?F.message:"プロジェクト診断レポートの生成に失敗しました。")}finally{q(!1)}},Xt=async()=>{if(Ce){ke(!0);return}yt(!0),it(null);try{const F=await jM(t,e,n);He(F),ke(!0)}catch(F){it(F instanceof Error?F.message:"プロジェクトレポートの生成に失敗しました。")}finally{yt(!1)}},Dr=async()=>{if(C){Re(!0);return}$t(!0),en(null);try{const F=await jy(t,e,n);P(F),Re(!0)}catch(F){en(F instanceof Error?F.message:"ガントチャートのデータ生成に失敗しました。")}finally{$t(!1)}},ea=async()=>{$t(!0),en(null);try{const F=await jy(t,e,n);P(F)}catch(F){en(F instanceof Error?F.message:"ガントチャートのデータ再生成に失敗しました。")}finally{$t(!1)}},Oi=async()=>{if(M){ve(!0);try{await Q(),await Yr.logActivity(M,"project_updated",{}),alert("プロジェクトが保存されました！")}catch(F){alert("プロジェクトの保存に失敗しました: "+(F instanceof Error?F.message:"不明なエラー"))}finally{ve(!1)}}else{const F=prompt("プロジェクト名を入力してください:",`${e.substring(0,50)}...`);if(!F)return;ve(!0);try{const I=await Nc.createProject(F,e,n,t,C);await Yr.logActivity(I.id,"project_created",{title:F}),alert("プロジェクトが保存されました！")}catch(I){alert("プロジェクトの保存に失敗しました: "+(I instanceof Error?I.message:"不明なエラー"))}finally{ve(!1)}}},al=(F,I)=>{if(!X.current)return;const B=X.current.getBoundingClientRect(),V={x:I.clientX-B.left+X.current.scrollLeft,y:I.clientY-B.top+X.current.scrollTop};hn({fromId:F,fromPos:V})},Mr=F=>{if(!Bt||Bt.fromId===F){hn(null);return}const I=t.find(B=>B.id===Bt.fromId);if(I){const B=Array.from(new Set([...I.nextTaskIds||[],F]));k(I.id,B)}hn(null)},mn=(F,I)=>{const B=t.find(V=>V.id===F);if(B){const V=(B.nextTaskIds||[]).filter(Y=>Y!==I);k(B.id,V)}},pn=F=>{if(!Bt||!X.current)return;const I=X.current.getBoundingClientRect();cr({x:F.clientX-I.left+X.current.scrollLeft,y:F.clientY-I.top+X.current.scrollTop})},ga=()=>{Bt&&hn(null)},zs=F=>{const I=F.type==="task"?F.id:F.parentId;if(!I)return;const B=t.find(V=>V.id===I);B&&(Re(!1),r(B))},sl=F=>{j(F),wn(!1)},D=n?new Date(n+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"未設定";return _e&&Ce?x.jsx(Gm,{tasks:t,initialDeck:Ce,onSave:F=>He(F),onClose:()=>ke(!1),projectGoal:e,targetDate:n,reportScope:"project",generateUniqueId:N}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"min-h-screen bg-slate-100 p-4 md:p-6 flex flex-col overflow-hidden",children:[x.jsxs("div",{className:"max-w-full mx-auto w-full",children:[x.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[x.jsxs("button",{onClick:()=>Nn(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-slate-600 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-transform hover:scale-105",children:[x.jsx(Bs,{className:"w-5 h-5 mr-2"}),"新規プロジェクト"]}),x.jsxs("div",{className:"flex flex-wrap gap-2",children:[Tt&&x.jsx("button",{onClick:()=>Pe(!0),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-orange-600 hover:bg-orange-700 animate-pulse",title:"新しい招待があります",children:x.jsx(Lf,{className:"w-5 h-5"})}),x.jsx("button",{onClick:L,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"保存済みプロジェクト",children:x.jsx(wi,{className:"w-5 h-5"})}),M&&x.jsx("button",{onClick:()=>qt(!0),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50",title:"プロジェクトメンバー",children:x.jsx(Lf,{className:"w-5 h-5"})}),x.jsx("button",{onClick:Oi,disabled:Rr,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 disabled:bg-slate-400",title:"プロジェクトを保存",children:Rr?x.jsx(Cn,{size:"sm",color:"border-white"}):x.jsx(qo,{className:"w-5 h-5"})}),x.jsx("button",{onClick:w,disabled:!E,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"元に戻す",children:x.jsx(sF,{className:"w-5 h-5"})}),x.jsx("button",{onClick:S,disabled:!b,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"やり直し",children:x.jsx(iF,{className:"w-5 h-5"})}),x.jsx("button",{onClick:H,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"APIキーを変更",children:x.jsx(Dc,{className:"w-5 h-5 text-yellow-600"})}),x.jsx("button",{onClick:K,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700",title:"ログアウト",children:x.jsx(Dc,{className:"w-5 h-5"})}),x.jsxs("button",{onClick:f,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700",children:[x.jsx(Mw,{className:"w-5 h-5 mr-2"}),"タスク追加"]}),x.jsxs("button",{onClick:d,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[x.jsx(qo,{className:"w-5 h-5 mr-2"}),"JSONエクスポート"]}),x.jsxs("button",{onClick:T,className:"inline-flex items-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",title:"自動整列",children:[x.jsx(Vm,{className:"w-5 h-5 mr-2"}),"整列"]})]})]}),x.jsxs("header",{className:"mb-6 p-6 bg-white rounded-xl shadow-lg",children:[x.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-3",children:"プロジェクトフロー"}),x.jsxs("div",{className:"space-y-2 text-slate-700",children:[x.jsxs("p",{className:"flex items-start",children:[x.jsx(Bm,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0 mt-1"}),x.jsx("strong",{children:"目的:"})," ",x.jsx("span",{className:"break-all",children:e})]}),x.jsxs("p",{className:"flex items-center",children:[x.jsx(Um,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0"}),x.jsx("strong",{children:"目標日:"})," ",D]}),M&&x.jsx("p",{className:"text-sm text-green-600",children:"✓ Supabaseに保存済み"})]})]}),x.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[x.jsxs("button",{onClick:()=>W(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx(Fw,{className:"w-5 h-5 mr-2"}),"アクションアイテム一覧"]}),x.jsxs("button",{onClick:()=>wn(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx(wi,{className:"w-5 h-5 mr-2"}),"資料センター"]}),x.jsxs("button",{onClick:Dr,disabled:Dt,className:"inline-flex items-center justify-center px-4 py-2 border border-amber-300 text-sm font-medium rounded-md shadow-sm text-amber-800 bg-amber-100 hover:bg-amber-200 disabled:bg-slate-400",children:[Dt?x.jsx(Cn,{size:"sm"}):x.jsx(Ow,{className:"w-5 h-5 mr-2"}),"ガントチャート"]}),x.jsxs("button",{onClick:mt,disabled:J,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400",children:[J?x.jsx(Cn,{size:"sm"}):x.jsx(Ti,{className:"w-5 h-5 mr-2"}),"AIプロジェクト診断"]}),x.jsxs("button",{onClick:Xt,disabled:Z,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-teal-600 hover:bg-teal-700 disabled:bg-slate-400",children:[Z?x.jsx(Cn,{size:"sm"}):x.jsx(Hm,{className:"w-5 h-5 mr-2"}),"プロジェクトレポート作成"]})]})]}),ie&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:ie})}),qe&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:qe})}),dn&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:dn})})]})]}),x.jsxs("div",{ref:X,className:"flex-grow overflow-auto pb-8 relative min-h-[600px] border border-slate-300 rounded-lg bg-slate-50 p-4 shadow-inner",onDragOver:Fe,onDrop:lt,onMouseMove:pn,onMouseUp:ga,children:[x.jsxs("div",{className:"relative w-full h-full min-w-[1200px] min-h-[800px]",children:[t.map((F,I)=>x.jsx(pF,{cardRef:ee.get(F.id),task:F,onSelectTask:r,onRemoveTask:g,onUpdateStatus:l,onDragCardStart:Ke,onStartConnection:al,onEndConnection:Mr,index:I},F.id)),Ie.map(F=>x.jsx(dm,{from:F.from,to:F.to,id:F.id,onDelete:()=>mn(F.sourceId,F.targetId)},F.id)),Bt&&x.jsx(dm,{from:Bt.fromPos,to:vr,id:"preview-connector"})]}),t.length===0&&x.jsx("div",{className:"text-center py-10 flex-grow flex items-center justify-center",children:x.jsx("p",{className:"text-slate-500 text-lg",children:"タスクがありません。「タスク追加」ボタンで最初のタスクを作成しましょう。"})})]})]}),rt&&C&&x.jsx(v8,{data:C,onClose:()=>Re(!1),onItemClick:zs,onRegenerate:ea,isRegenerating:Dt}),on&&x.jsx(_8,{tasks:t,projectGoal:e,targetDate:n,ganttData:C,projectReportDeck:Ce,onClose:()=>wn(!1),onReportGenerated:sl,generateUniqueId:N}),ln&&M&&x.jsx(T8,{isOpen:ln,onClose:()=>qt(!1),projectId:M,userRole:De}),Ne&&x.jsx(w8,{isOpen:Ne,onClose:()=>Pe(!1),onInvitationAccepted:()=>{ot(!1),window.location.reload()}}),ne&&x.jsx(gF,{tasks:t,onClose:()=>W(!1)}),U&&x.jsx(xF,{report:R,onClose:()=>G(!1)}),Gn&&x.jsx(SF,{onClose:()=>Nn(!1),onDownloadAndStartNew:()=>{d(),c()},onStartNewWithoutSaving:c})]})},S8=({proposals:t,existingSubSteps:e,onConfirm:n,onClose:r})=>{const[a,i]=se.useState(()=>{const d={};return t.forEach((f,g)=>{d[g]={decision:"NEW",targetSubStepId:void 0}}),d}),l=(d,f,g)=>{i(y=>({...y,[d]:{...y[d],[f]:g}}))},c=()=>{const d=[],f=[];Object.entries(a).forEach(([g,y])=>{const T=parseInt(g,10),w=t[T];y.decision==="NEW"?d.push(w):y.decision==="ADD"&&y.targetSubStepId&&f.push({targetSubStepId:y.targetSubStepId,title:w.title})}),n({newSubSteps:d,newActionItems:f})};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AIによる計画提案のレビュー"}),x.jsx("button",{onClick:r,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(er,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-5 overflow-y-auto space-y-4",children:[x.jsx("p",{className:"text-sm text-slate-600",children:"AIが以下のステップを提案しました。計画に追加する項目と方法を選択してください。"}),x.jsx("div",{className:"space-y-3",children:t.map((d,f)=>x.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[x.jsx("p",{className:"font-semibold text-slate-800",children:d.title}),x.jsx("p",{className:"text-sm text-slate-600 mb-3",children:d.description}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("select",{value:a[f].decision,onChange:g=>l(f,"decision",g.target.value),className:"p-2 border border-slate-300 rounded-md text-sm",children:[x.jsx("option",{value:"NEW",children:"新しいサブステップとして追加"}),e.length>0&&x.jsx("option",{value:"ADD",children:"既存のサブステップに追加"}),x.jsx("option",{value:"IGNORE",children:"無視する"})]}),a[f].decision==="ADD"&&x.jsxs("select",{value:a[f].targetSubStepId||"",onChange:g=>l(f,"targetSubStepId",g.target.value),className:"flex-grow p-2 border border-slate-300 rounded-md text-sm",children:[x.jsx("option",{value:"",disabled:!0,children:"追加先のサブステップを選択..."}),e.map(g=>x.jsx("option",{value:g.id,children:g.text},g.id))]})]})]},f))})]}),x.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[x.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:"キャンセル"}),x.jsx("button",{onClick:c,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"選択を計画に反映"})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var zw=1252,b8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],qm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ym=function(t){b8.indexOf(t)!=-1&&(zw=qm[0]=t)};function C8(){Ym(1252)}var fa=function(t){Ym(t)};function qw(){fa(1200),C8()}function C_(t){for(var e=[],n=0,r=t.length;n<r;++n)e[n]=t.charCodeAt(n);return e}function A8(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n)+(t.charCodeAt(2*n+1)<<8));return e.join("")}function Yw(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n+1)+(t.charCodeAt(2*n)<<8));return e.join("")}var oc=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1);return e==255&&n==254?A8(t.slice(2)):e==254&&n==255?Yw(t.slice(2)):e==65279?t.slice(1):t},mf=function(e){return String.fromCharCode(e)},A_=function(e){return String.fromCharCode(e)},Mc,Is="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function k_(t){for(var e="",n=0,r=0,a=0,i=0,l=0,c=0,d=0,f=0;f<t.length;)n=t.charCodeAt(f++),i=n>>2,r=t.charCodeAt(f++),l=(n&3)<<4|r>>4,a=t.charCodeAt(f++),c=(r&15)<<2|a>>6,d=a&63,isNaN(r)?c=d=64:isNaN(a)&&(d=64),e+=Is.charAt(i)+Is.charAt(l)+Is.charAt(c)+Is.charAt(d);return e}function Nr(t){var e="",n=0,r=0,a=0,i=0,l=0,c=0,d=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<t.length;)i=Is.indexOf(t.charAt(f++)),l=Is.indexOf(t.charAt(f++)),n=i<<2|l>>4,e+=String.fromCharCode(n),c=Is.indexOf(t.charAt(f++)),r=(l&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(r)),d=Is.indexOf(t.charAt(f++)),a=(c&3)<<6|d,d!==64&&(e+=String.fromCharCode(a));return e}var wt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ni=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function js(t){return wt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function N_(t){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ua=function(e){return wt?Ni(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function Ri(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function Jm(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Jm(new Uint8Array(t));for(var e=new Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e}var Ms=wt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ni(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),a=0;for(e=0,n=0;e<t.length;n+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function k8(t){for(var e=[],n=0,r=t.length+250,a=js(t.length+255),i=0;i<t.length;++i){var l=t.charCodeAt(i);if(l<128)a[n++]=l;else if(l<2048)a[n++]=192|l>>6&31,a[n++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=t.charCodeAt(++i)&1023;a[n++]=240|l>>8&7,a[n++]=128|l>>2&63,a[n++]=128|c>>6&15|(l&3)<<4,a[n++]=128|c&63}else a[n++]=224|l>>12&15,a[n++]=128|l>>6&63,a[n++]=128|l&63;n>r&&(e.push(a.slice(0,n)),n=0,a=js(65535),r=65530)}return e.push(a.slice(0,n)),Ms(e)}var ir=/\u0000/g,lc=/[\u0001-\u0006]/g;function Lo(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function da(t,e){var n=""+t;return n.length>=e?n:an("0",e-n.length)+n}function Wm(t,e){var n=""+t;return n.length>=e?n:an(" ",e-n.length)+n}function Bf(t,e){var n=""+t;return n.length>=e?n:n+an(" ",e-n.length)}function N8(t,e){var n=""+Math.round(t);return n.length>=e?n:an("0",e-n.length)+n}function R8(t,e){var n=""+t;return n.length>=e?n:an("0",e-n.length)+n}var R_=Math.pow(2,32);function ko(t,e){if(t>R_||t<-R_)return N8(t,e);var n=Math.round(t);return R8(n,e)}function jf(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var D_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],kh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function D8(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},M_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},M8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Vf(t,e,n){for(var r=t<0?-1:1,a=t*r,i=0,l=1,c=0,d=1,f=0,g=0,y=Math.floor(a);f<e&&(y=Math.floor(a),c=y*l+i,g=y*f+d,!(a-y<5e-8));)a=1/(a-y),i=l,l=c,d=f,f=g;if(g>e&&(f>e?(g=d,c=i):(g=f,c=l)),!n)return[0,r*c,g];var T=Math.floor(r*c/g);return[T,r*c-T*g,g]}function mi(t,e,n){if(t>2958465||t<0)return null;var r=t|0,a=Math.floor(86400*(t-r)),i=0,l=[],c={D:r,T:a,u:86400*(t-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=n?[1317,10,29]:[1900,2,29],i=3;else if(r===0)l=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var d=new Date(1900,0,1);d.setDate(d.getDate()+r-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],i=d.getDay(),r<60&&(i=(i+6)%7),n&&(i=U8(d,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var Jw=new Date(1899,11,31,0,0,0),I8=Jw.getTime(),F8=new Date(1900,2,1,0,0,0);function Ww(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=F8&&(n+=24*60*60*1e3),(n-(I8+(t.getTimezoneOffset()-Jw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Km(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function O8(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function L8(t){var e=t<0?12:11,n=Km(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function P8(t){var e=Km(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Ic(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=L8(t):e===10?n=t.toFixed(10).substr(0,12):n=P8(t),Km(O8(n.toUpperCase()))}function Si(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Ic(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Wr(14,Ww(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function U8(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function B8(t,e,n,r){var a="",i=0,l=0,c=n.y,d,f=0;switch(t){case 98:c=n.y+543;case 121:switch(e.length){case 1:case 2:d=c%100,f=2;break;default:d=c%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:d=n.m,f=e.length;break;case 3:return kh[n.m-1][1];case 5:return kh[n.m-1][0];default:return kh[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:d=n.d,f=e.length;break;case 3:return D_[n.q][0];default:return D_[n.q][1]}break;case 104:switch(e.length){case 1:case 2:d=1+(n.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:d=n.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:d=n.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?da(n.S,e.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,i=Math.round(l*(n.S+n.u)),i>=60*l&&(i=0),e==="s"?i===0?"0":""+i/l:(a=da(i,2+r),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":d=n.D*24+n.H;break;case"[m]":case"[mm]":d=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":d=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:d=c,f=1;break}var g=f>0?da(d,f):"";return g}function Fs(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var Kw=/%/g;function j8(t,e,n){var r=e.replace(Kw,""),a=e.length-r.length;return Xa(t,r,n*Math.pow(10,2*a))+an("%",a)}function V8(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Xa(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function Xw(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Xw(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),n=(e/Math.pow(10,i)).toPrecision(r+1+(a+i)%a),n.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+i):n+="E+"+(l-i);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,g){return d+f+g.substr(0,(a+i)%a)+"."+g.substr(i)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Zw=/# (\?+)( ?)\/( ?)(\d+)/;function H8(t,e,n){var r=parseInt(t[4],10),a=Math.round(e*r),i=Math.floor(a/r),l=a-i*r,c=r;return n+(i===0?"":""+i)+" "+(l===0?an(" ",t[1].length+1+t[4].length):Wm(l,t[1].length)+t[2]+"/"+t[3]+da(c,t[4].length))}function G8(t,e,n){return n+(e===0?"":""+e)+an(" ",t[1].length+2+t[4].length)}var Qw=/^#*0*\.([0#]+)/,e2=/\).*[0#]/,t2=/\(###\) ###\\?-####/;function rr(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function I_(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function F_(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function $8(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function z8(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function zr(t,e,n){if(t.charCodeAt(0)===40&&!e.match(e2)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?zr("n",r,n):"("+zr("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return V8(t,e,n);if(e.indexOf("%")!==-1)return j8(t,e,n);if(e.indexOf("E")!==-1)return Xw(e,n);if(e.charCodeAt(0)===36)return"$"+zr(t,e.substr(e.charAt(1)==" "?2:1),n);var a,i,l,c,d=Math.abs(n),f=n<0?"-":"";if(e.match(/^00+$/))return f+ko(d,e.length);if(e.match(/^[#?]+$/))return a=ko(n,0),a==="0"&&(a=""),a.length>e.length?a:rr(e.substr(0,e.length-a.length))+a;if(i=e.match(Zw))return H8(i,d,f);if(e.match(/^#+0+$/))return f+ko(d,e.length-e.indexOf("0"));if(i=e.match(Qw))return a=I_(n,i[1].length).replace(/^([^\.]+)$/,"$1."+rr(i[1])).replace(/\.$/,"."+rr(i[1])).replace(/\.(\d*)$/,function(E,S){return"."+S+an("0",rr(i[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return f+I_(d,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return f+Fs(ko(d,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+zr(t,e,-n):Fs(""+(Math.floor(n)+$8(n,i[1].length)))+"."+da(F_(n,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return zr(t,e.replace(/^#,#*,/,""),n);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Lo(zr(t,e.replace(/[\\-]/g,""),n)),l=0,Lo(Lo(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(t2))return a=zr(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=Vf(d,Math.pow(10,l)-1,!1),a=""+f,g=Xa("n",i[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+i[2]+"/"+i[3],g=Bf(c[2],l),g.length<i[4].length&&(g=rr(i[4].substr(i[4].length-g.length))+g),a+=g,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=Vf(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Wm(c[1],l)+i[2]+"/"+i[3]+Bf(c[2],l):an(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=ko(n,0),e.length<=a.length?a:rr(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=e.indexOf(".")-l,T=e.length-a.length-y;return rr(e.substr(0,y)+a+e.substr(e.length-T))}if(i=e.match(/^00,000\.([#0]*0)$/))return l=F_(n,i[1].length),n<0?"-"+zr(t,e,-n):Fs(z8(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?da(0,3-E.length):"")+E})+"."+da(l,i[1].length);switch(e){case"###,##0.00":return zr(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var w=Fs(ko(d,0));return w!=="0"?f+w:"";case"###,###.00":return zr(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return zr(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function q8(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Xa(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function Y8(t,e,n){var r=e.replace(Kw,""),a=e.length-r.length;return Xa(t,r,n*Math.pow(10,2*a))+an("%",a)}function n2(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+n2(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),n=(e/Math.pow(10,i)).toPrecision(r+1+(a+i)%a),!n.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+i):n+="E+"+(l-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,g){return d+f+g.substr(0,(a+i)%a)+"."+g.substr(i)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Sa(t,e,n){if(t.charCodeAt(0)===40&&!e.match(e2)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Sa("n",r,n):"("+Sa("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return q8(t,e,n);if(e.indexOf("%")!==-1)return Y8(t,e,n);if(e.indexOf("E")!==-1)return n2(e,n);if(e.charCodeAt(0)===36)return"$"+Sa(t,e.substr(e.charAt(1)==" "?2:1),n);var a,i,l,c,d=Math.abs(n),f=n<0?"-":"";if(e.match(/^00+$/))return f+da(d,e.length);if(e.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>e.length?a:rr(e.substr(0,e.length-a.length))+a;if(i=e.match(Zw))return G8(i,d,f);if(e.match(/^#+0+$/))return f+da(d,e.length-e.indexOf("0"));if(i=e.match(Qw))return a=(""+n).replace(/^([^\.]+)$/,"$1."+rr(i[1])).replace(/\.$/,"."+rr(i[1])),a=a.replace(/\.(\d*)$/,function(E,S){return"."+S+an("0",rr(i[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return f+Fs(""+d);if(i=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Sa(t,e,-n):Fs(""+n)+"."+an("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Sa(t,e.replace(/^#,#*,/,""),n);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Lo(Sa(t,e.replace(/[\\-]/g,""),n)),l=0,Lo(Lo(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(t2))return a=Sa(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=Vf(d,Math.pow(10,l)-1,!1),a=""+f,g=Xa("n",i[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+i[2]+"/"+i[3],g=Bf(c[2],l),g.length<i[4].length&&(g=rr(i[4].substr(i[4].length-g.length))+g),a+=g,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=Vf(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Wm(c[1],l)+i[2]+"/"+i[3]+Bf(c[2],l):an(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=""+n,e.length<=a.length?a:rr(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=e.indexOf(".")-l,T=e.length-a.length-y;return rr(e.substr(0,y)+a+e.substr(e.length-T))}if(i=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Sa(t,e,-n):Fs(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?da(0,3-E.length):"")+E})+"."+da(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var w=Fs(""+d);return w!=="0"?f+w:"";default:if(e.match(/\.[0#?]*$/))return Sa(t,e.slice(0,e.lastIndexOf(".")),n)+rr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Xa(t,e,n){return(n|0)===n?Sa(t,e,n):zr(t,e,n)}function J8(t){for(var e=[],n=!1,r=0,a=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(a,r-a),a=r+1}if(e[e.length]=t.substr(a),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var r2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function tl(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":jf(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match(r2))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function W8(t,e,n,r){for(var a=[],i="",l=0,c="",d="t",f,g,y,T="H";l<t.length;)switch(c=t.charAt(l)){case"G":if(!jf(t,l))throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(y=t.charCodeAt(++l))!==34&&l<t.length;)i+=String.fromCharCode(y);a[a.length]={t:"t",v:i},++l;break;case"\\":var w=t.charAt(++l),E=w==="("||w===")"?w:"t";a[a.length]={t:E,v:w},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(f==null&&(f=mi(e,n,t.charAt(l+1)==="2"),f==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},d=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=mi(e,n),f==null))return"";for(i=c;++l<t.length&&t.charAt(l).toLowerCase()===c;)i+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=T),a[a.length]={t:c,v:i},d=c;break;case"A":case"a":case"上":var S={t:c,v:c};if(f==null&&(f=mi(e,n)),t.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(S.v=f.H>=12?"P":"A"),S.t="T",T="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(S.v=f.H>=12?"PM":"AM"),S.t="T",l+=5,T="h"):t.substr(l,5).toUpperCase()==="上午/下午"?(f!=null&&(S.v=f.H>=12?"下午":"上午"),S.t="T",l+=5,T="h"):(S.t="t",++l),f==null&&S.t==="T")return"";a[a.length]=S,d=c;break;case"[":for(i=c;t.charAt(l++)!=="]"&&l<t.length;)i+=t.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(r2)){if(f==null&&(f=mi(e,n),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},d=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",tl(t)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=c;++l<t.length&&(c=t.charAt(l))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++l<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(l))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;t.charAt(++l)===c;)i+=c;a[a.length]={t:c,v:i},d=c;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)i+=t.charAt(l);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"t",v:c},++l;break}var b=0,N=0,k;for(l=a.length-1,d="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=T,d="h",b<1&&(b=1);break;case"s":(k=a[l].v.match(/\.0+$/))&&(N=Math.max(N,k[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":d=a[l].t;break;case"m":d==="s"&&(a[l].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[l].v.match(/[Hh]/)&&(b=1),b<2&&a[l].v.match(/[Mm]/)&&(b=2),b<3&&a[l].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var C="",P;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=B8(a[l].t.charCodeAt(0),a[l].v,f,N),a[l].t="t";break;case"n":case"?":for(P=l+1;a[P]!=null&&((c=a[P].t)==="?"||c==="D"||(c===" "||c==="t")&&a[P+1]!=null&&(a[P+1].t==="?"||a[P+1].t==="t"&&a[P+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[P].v==="/"||a[P].v===" "&&a[P+1]!=null&&a[P+1].t=="?"));)a[l].v+=a[P].v,a[P]={v:"",t:";"},++P;C+=a[l].v,l=P-1;break;case"G":a[l].t="t",a[l].v=Si(e,n);break}var j="",H,L;if(C.length>0){C.charCodeAt(0)==40?(H=e<0&&C.charCodeAt(0)===45?-e:e,L=Xa("n",C,H)):(H=e<0&&r>1?-e:e,L=Xa("n",C,H),H<0&&a[0]&&a[0].t=="t"&&(L=L.substr(1),a[0].v="-"+a[0].v)),P=L.length-1;var K=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){K=l;break}var M=a.length;if(K===a.length&&L.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(P>=a[l].v.length-1?(P-=a[l].v.length,a[l].v=L.substr(P+1,a[l].v.length)):P<0?a[l].v="":(a[l].v=L.substr(0,P+1),P=-1),a[l].t="t",M=l);P>=0&&M<a.length&&(a[M].v=L.substr(0,P+1)+a[M].v)}else if(K!==a.length&&L.indexOf("E")===-1){for(P=L.indexOf(".")-1,l=K;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(g=a[l].v.indexOf(".")>-1&&l===K?a[l].v.indexOf(".")-1:a[l].v.length-1,j=a[l].v.substr(g+1);g>=0;--g)P>=0&&(a[l].v.charAt(g)==="0"||a[l].v.charAt(g)==="#")&&(j=L.charAt(P--)+j);a[l].v=j,a[l].t="t",M=l}for(P>=0&&M<a.length&&(a[M].v=L.substr(0,P+1)+a[M].v),P=L.indexOf(".")+1,l=K;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==K)){for(g=a[l].v.indexOf(".")>-1&&l===K?a[l].v.indexOf(".")+1:0,j=a[l].v.substr(0,g);g<a[l].v.length;++g)P<L.length&&(j+=L.charAt(P++));a[l].v=j,a[l].t="t",M=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(H=r>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=Xa(a[l].t,a[l].v,H),a[l].t="t");var Q="";for(l=0;l!==a.length;++l)a[l]!=null&&(Q+=a[l].v);return Q}var O_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function L_(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function K8(t,e){var n=J8(t),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var i=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,i];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var l=n[0].match(O_),c=n[1].match(O_);return L_(e,l)?[r,n[0]]:L_(e,c)?[r,n[1]]:[r,n[l!=null&&c!=null?2:1]]}return[r,i]}function Wr(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:ut)[t],r==null&&(r=n.table&&n.table[M_[t]]||ut[M_[t]]),r==null&&(r=M8[t]||"General");break}if(jf(r,0))return Si(e,n);e instanceof Date&&(e=Ww(e,n.date1904));var a=K8(r,e);if(jf(a[1]))return Si(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return W8(a[1],e,n,a[0])}function pi(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(ut[n]==null){e<0&&(e=n);continue}if(ut[n]==t){e=n;break}}e<0&&(e=391)}return ut[e]=t,e}function a2(){ut=D8()}var X8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},s2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Z8(t){var e=typeof t=="number"?ut[t]:t;return e=e.replace(s2,"(\\d+)"),new RegExp("^"+e+"$")}function Q8(t,e,n){var r=-1,a=-1,i=-1,l=-1,c=-1,d=-1;(e.match(s2)||[]).forEach(function(y,T){var w=parseInt(n[T+1],10);switch(y.toLowerCase().charAt(0)){case"y":r=w;break;case"d":i=w;break;case"h":l=w;break;case"s":d=w;break;case"m":l>=0?c=w:a=w;break}}),d>=0&&c==-1&&a>=0&&(c=a,a=-1);var f=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var g=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&c==-1&&d==-1?f:r==-1&&a==-1&&i==-1?g:f+"T"+g}var eO=function(){var t={};t.version="1.2.0";function e(){for(var L=0,K=new Array(256),M=0;M!=256;++M)L=M,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,K[M]=L;return typeof Int32Array<"u"?new Int32Array(K):K}var n=e();function r(L){var K=0,M=0,Q=0,X=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Q=0;Q!=256;++Q)X[Q]=L[Q];for(Q=0;Q!=256;++Q)for(M=L[Q],K=256+Q;K<4096;K+=256)M=X[K]=M>>>8^L[M&255];var ee=[];for(Q=1;Q!=16;++Q)ee[Q-1]=typeof Int32Array<"u"?X.subarray(Q*256,Q*256+256):X.slice(Q*256,Q*256+256);return ee}var a=r(n),i=a[0],l=a[1],c=a[2],d=a[3],f=a[4],g=a[5],y=a[6],T=a[7],w=a[8],E=a[9],S=a[10],b=a[11],N=a[12],k=a[13],C=a[14];function P(L,K){for(var M=K^-1,Q=0,X=L.length;Q<X;)M=M>>>8^n[(M^L.charCodeAt(Q++))&255];return~M}function j(L,K){for(var M=K^-1,Q=L.length-15,X=0;X<Q;)M=C[L[X++]^M&255]^k[L[X++]^M>>8&255]^N[L[X++]^M>>16&255]^b[L[X++]^M>>>24]^S[L[X++]]^E[L[X++]]^w[L[X++]]^T[L[X++]]^y[L[X++]]^g[L[X++]]^f[L[X++]]^d[L[X++]]^c[L[X++]]^l[L[X++]]^i[L[X++]]^n[L[X++]];for(Q+=15;X<Q;)M=M>>>8^n[(M^L[X++])&255];return~M}function H(L,K){for(var M=K^-1,Q=0,X=L.length,ee=0,ye=0;Q<X;)ee=L.charCodeAt(Q++),ee<128?M=M>>>8^n[(M^ee)&255]:ee<2048?(M=M>>>8^n[(M^(192|ee>>6&31))&255],M=M>>>8^n[(M^(128|ee&63))&255]):ee>=55296&&ee<57344?(ee=(ee&1023)+64,ye=L.charCodeAt(Q++)&1023,M=M>>>8^n[(M^(240|ee>>8&7))&255],M=M>>>8^n[(M^(128|ee>>2&63))&255],M=M>>>8^n[(M^(128|ye>>6&15|(ee&3)<<4))&255],M=M>>>8^n[(M^(128|ye&63))&255]):(M=M>>>8^n[(M^(224|ee>>12&15))&255],M=M>>>8^n[(M^(128|ee>>6&63))&255],M=M>>>8^n[(M^(128|ee&63))&255]);return~M}return t.table=n,t.bstr=P,t.buf=j,t.str=H,t}(),Ct=function(){var e={};e.version="1.2.1";function n(D,F){for(var I=D.split("/"),B=F.split("/"),V=0,Y=0,ce=Math.min(I.length,B.length);V<ce;++V){if(Y=I[V].length-B[V].length)return Y;if(I[V]!=B[V])return I[V]<B[V]?-1:1}return I.length-B.length}function r(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:r(D.slice(0,-1));var F=D.lastIndexOf("/");return F===-1?D:D.slice(0,F+1)}function a(D){if(D.charAt(D.length-1)=="/")return a(D.slice(0,-1));var F=D.lastIndexOf("/");return F===-1?D:D.slice(F+1)}function i(D,F){typeof F=="string"&&(F=new Date(F));var I=F.getHours();I=I<<6|F.getMinutes(),I=I<<5|F.getSeconds()>>>1,D.write_shift(2,I);var B=F.getFullYear()-1980;B=B<<4|F.getMonth()+1,B=B<<5|F.getDate(),D.write_shift(2,B)}function l(D){var F=D.read_shift(2)&65535,I=D.read_shift(2)&65535,B=new Date,V=I&31;I>>>=5;var Y=I&15;I>>>=4,B.setMilliseconds(0),B.setFullYear(I+1980),B.setMonth(Y-1),B.setDate(V);var ce=F&31;F>>>=5;var xe=F&63;return F>>>=6,B.setHours(F),B.setMinutes(xe),B.setSeconds(ce<<1),B}function c(D){jn(D,0);for(var F={},I=0;D.l<=D.length-4;){var B=D.read_shift(2),V=D.read_shift(2),Y=D.l+V,ce={};switch(B){case 21589:I=D.read_shift(1),I&1&&(ce.mtime=D.read_shift(4)),V>5&&(I&2&&(ce.atime=D.read_shift(4)),I&4&&(ce.ctime=D.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}D.l=Y,F[B]=ce}return F}var d;function f(){return d||(d={})}function g(D,F){if(D[0]==80&&D[1]==75)return Ve(D,F);if((D[0]|32)==109&&(D[1]|32)==105)return al(D,F);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var I=3,B=512,V=0,Y=0,ce=0,xe=0,le=0,he=[],me=D.slice(0,512);jn(me,0);var Ae=y(me);switch(I=Ae[0],I){case 3:B=512;break;case 4:B=4096;break;case 0:if(Ae[1]==0)return Ve(D,F);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}B!==512&&(me=D.slice(0,B),jn(me,28));var Oe=D.slice(0,B);T(me,I);var je=me.read_shift(4,"i");if(I===3&&je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+je);me.l+=4,ce=me.read_shift(4,"i"),me.l+=4,me.chk("00100000","Mini Stream Cutoff Size: "),xe=me.read_shift(4,"i"),V=me.read_shift(4,"i"),le=me.read_shift(4,"i"),Y=me.read_shift(4,"i");for(var Me=-1,Ue=0;Ue<109&&(Me=me.read_shift(4,"i"),!(Me<0));++Ue)he[Ue]=Me;var tt=w(D,B);b(le,Y,tt,B,he);var It=k(tt,ce,he,B);It[ce].name="!Directory",V>0&&xe!==ye&&(It[xe].name="!MiniFAT"),It[he[0]].name="!FAT",It.fat_addrs=he,It.ssz=B;var Ft={},Ot=[],Ir=[],xa=[];C(ce,It,tt,Ot,V,Ft,Ir,xe),E(Ir,xa,Ot),Ot.shift();var Fr={FileIndex:Ir,FullPaths:xa};return F&&F.raw&&(Fr.raw={header:Oe,sectors:tt}),Fr}function y(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(Ie,"Header Signature: "),D.l+=16;var F=D.read_shift(2,"u");return[D.read_shift(2,"u"),F]}function T(D,F){var I=9;switch(D.l+=2,I=D.read_shift(2)){case 9:if(F!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(F!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function w(D,F){for(var I=Math.ceil(D.length/F)-1,B=[],V=1;V<I;++V)B[V-1]=D.slice(V*F,(V+1)*F);return B[I-1]=D.slice(I*F),B}function E(D,F,I){for(var B=0,V=0,Y=0,ce=0,xe=0,le=I.length,he=[],me=[];B<le;++B)he[B]=me[B]=B,F[B]=I[B];for(;xe<me.length;++xe)B=me[xe],V=D[B].L,Y=D[B].R,ce=D[B].C,he[B]===B&&(V!==-1&&he[V]!==V&&(he[B]=he[V]),Y!==-1&&he[Y]!==Y&&(he[B]=he[Y])),ce!==-1&&(he[ce]=B),V!==-1&&B!=he[B]&&(he[V]=he[B],me.lastIndexOf(V)<xe&&me.push(V)),Y!==-1&&B!=he[B]&&(he[Y]=he[B],me.lastIndexOf(Y)<xe&&me.push(Y));for(B=1;B<le;++B)he[B]===B&&(Y!==-1&&he[Y]!==Y?he[B]=he[Y]:V!==-1&&he[V]!==V&&(he[B]=he[V]));for(B=1;B<le;++B)if(D[B].type!==0){if(xe=B,xe!=he[xe])do xe=he[xe],F[B]=F[xe]+"/"+F[B];while(xe!==0&&he[xe]!==-1&&xe!=he[xe]);he[B]=-1}for(F[0]+="/",B=1;B<le;++B)D[B].type!==2&&(F[B]+="/")}function S(D,F,I){for(var B=D.start,V=D.size,Y=[],ce=B;I&&V>0&&ce>=0;)Y.push(F.slice(ce*ee,ce*ee+ee)),V-=ee,ce=hi(I,ce*4);return Y.length===0?bn(0):Ms(Y).slice(0,D.size)}function b(D,F,I,B,V){var Y=ye;if(D===ye){if(F!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var ce=I[D],xe=(B>>>2)-1;if(!ce)return;for(var le=0;le<xe&&(Y=hi(ce,le*4))!==ye;++le)V.push(Y);b(hi(ce,B-4),F-1,I,B,V)}}function N(D,F,I,B,V){var Y=[],ce=[];V||(V=[]);var xe=B-1,le=0,he=0;for(le=F;le>=0;){V[le]=!0,Y[Y.length]=le,ce.push(D[le]);var me=I[Math.floor(le*4/B)];if(he=le*4&xe,B<4+he)throw new Error("FAT boundary crossed: "+le+" 4 "+B);if(!D[me])break;le=hi(D[me],he)}return{nodes:Y,data:q_([ce])}}function k(D,F,I,B){var V=D.length,Y=[],ce=[],xe=[],le=[],he=B-1,me=0,Ae=0,Oe=0,je=0;for(me=0;me<V;++me)if(xe=[],Oe=me+F,Oe>=V&&(Oe-=V),!ce[Oe]){le=[];var Me=[];for(Ae=Oe;Ae>=0;){Me[Ae]=!0,ce[Ae]=!0,xe[xe.length]=Ae,le.push(D[Ae]);var Ue=I[Math.floor(Ae*4/B)];if(je=Ae*4&he,B<4+je)throw new Error("FAT boundary crossed: "+Ae+" 4 "+B);if(!D[Ue]||(Ae=hi(D[Ue],je),Me[Ae]))break}Y[Oe]={nodes:xe,data:q_([le])}}return Y}function C(D,F,I,B,V,Y,ce,xe){for(var le=0,he=B.length?2:0,me=F[D].data,Ae=0,Oe=0,je;Ae<me.length;Ae+=128){var Me=me.slice(Ae,Ae+128);jn(Me,64),Oe=Me.read_shift(2),je=tp(Me,0,Oe-he),B.push(je);var Ue={name:je,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},tt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);tt!==0&&(Ue.ct=P(Me,Me.l-8));var It=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);It!==0&&(Ue.mt=P(Me,Me.l-8)),Ue.start=Me.read_shift(4,"i"),Ue.size=Me.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=ye,Ue.name=""),Ue.type===5?(le=Ue.start,V>0&&le!==ye&&(F[le].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",F[Ue.start]===void 0&&(F[Ue.start]=N(I,Ue.start,F.fat_addrs,F.ssz)),F[Ue.start].name=Ue.name,Ue.content=F[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:le!==ye&&Ue.start!==ye&&F[le]&&(Ue.content=S(Ue,F[le].data,(F[xe]||{}).data))),Ue.content&&jn(Ue.content,0),Y[je]=Ue,ce.push(Ue)}}function P(D,F){return new Date((Ar(D,F+4)/1e7*Math.pow(2,32)+Ar(D,F)/1e7-11644473600)*1e3)}function j(D,F){return f(),g(d.readFileSync(D),F)}function H(D,F){var I=F&&F.type;switch(I||wt&&Buffer.isBuffer(D)&&(I="buffer"),I||"base64"){case"file":return j(D,F);case"base64":return g(ua(Nr(D)),F);case"binary":return g(ua(D),F)}return g(D,F)}function L(D,F){var I=F||{},B=I.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=B+"/",D.FileIndex[0]={name:B,type:5}),I.CLSID&&(D.FileIndex[0].clsid=I.CLSID),K(D)}function K(D){var F="Sh33tJ5";if(!Ct.find(D,"/"+F)){var I=bn(4);I[0]=55,I[1]=I[3]=50,I[2]=54,D.FileIndex.push({name:F,type:2,content:I,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+F),M(D)}}function M(D,F){L(D);for(var I=!1,B=!1,V=D.FullPaths.length-1;V>=0;--V){var Y=D.FileIndex[V];switch(Y.type){case 0:B?I=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(Y.R*Y.L*Y.C)&&(I=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!F)){var ce=new Date(1987,1,19),xe=0,le=Object.create?Object.create(null):{},he=[];for(V=0;V<D.FullPaths.length;++V)le[D.FullPaths[V]]=!0,D.FileIndex[V].type!==0&&he.push([D.FullPaths[V],D.FileIndex[V]]);for(V=0;V<he.length;++V){var me=r(he[V][0]);B=le[me],B||(he.push([me,{name:a(me).replace("/",""),type:1,clsid:re,ct:ce,mt:ce,content:null}]),le[me]=!0)}for(he.sort(function(je,Me){return n(je[0],Me[0])}),D.FullPaths=[],D.FileIndex=[],V=0;V<he.length;++V)D.FullPaths[V]=he[V][0],D.FileIndex[V]=he[V][1];for(V=0;V<he.length;++V){var Ae=D.FileIndex[V],Oe=D.FullPaths[V];if(Ae.name=a(Oe).replace("/",""),Ae.L=Ae.R=Ae.C=-(Ae.color=1),Ae.size=Ae.content?Ae.content.length:0,Ae.start=0,Ae.clsid=Ae.clsid||re,V===0)Ae.C=he.length>1?1:-1,Ae.size=0,Ae.type=5;else if(Oe.slice(-1)=="/"){for(xe=V+1;xe<he.length&&r(D.FullPaths[xe])!=Oe;++xe);for(Ae.C=xe>=he.length?-1:xe,xe=V+1;xe<he.length&&r(D.FullPaths[xe])!=r(Oe);++xe);Ae.R=xe>=he.length?-1:xe,Ae.type=1}else r(D.FullPaths[V+1]||"")==r(Oe)&&(Ae.R=V+1),Ae.type=2}}}function Q(D,F){var I=F||{};if(I.fileType=="mad")return Mr(D,I);switch(M(D),I.fileType){case"zip":return Fe(D,I)}var B=function(je){for(var Me=0,Ue=0,tt=0;tt<je.FileIndex.length;++tt){var It=je.FileIndex[tt];if(It.content){var Ft=It.content.length;Ft>0&&(Ft<4096?Me+=Ft+63>>6:Ue+=Ft+511>>9)}}for(var Ot=je.FullPaths.length+3>>2,Ir=Me+7>>3,xa=Me+127>>7,Fr=Ir+Ue+Ot+xa,ta=Fr+127>>7,qs=ta<=109?0:Math.ceil((ta-109)/127);Fr+ta+qs+127>>7>ta;)qs=++ta<=109?0:Math.ceil((ta-109)/127);var na=[1,qs,ta,xa,Ot,Ue,Me,0];return je.FileIndex[0].size=Me<<6,na[7]=(je.FileIndex[0].start=na[0]+na[1]+na[2]+na[3]+na[4]+na[5])+(na[6]+7>>3),na}(D),V=bn(B[7]<<9),Y=0,ce=0;{for(Y=0;Y<8;++Y)V.write_shift(1,Te[Y]);for(Y=0;Y<8;++Y)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),Y=0;Y<3;++Y)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,B[2]),V.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:ye),V.write_shift(4,B[3]),V.write_shift(-4,B[1]?B[0]-1:ye),V.write_shift(4,B[1]),Y=0;Y<109;++Y)V.write_shift(-4,Y<B[2]?B[1]+Y:-1)}if(B[1])for(ce=0;ce<B[1];++ce){for(;Y<236+ce*127;++Y)V.write_shift(-4,Y<B[2]?B[1]+Y:-1);V.write_shift(-4,ce===B[1]-1?ye:ce+1)}var xe=function(je){for(ce+=je;Y<ce-1;++Y)V.write_shift(-4,Y+1);je&&(++Y,V.write_shift(-4,ye))};for(ce=Y=0,ce+=B[1];Y<ce;++Y)V.write_shift(-4,ue.DIFSECT);for(ce+=B[2];Y<ce;++Y)V.write_shift(-4,ue.FATSECT);xe(B[3]),xe(B[4]);for(var le=0,he=0,me=D.FileIndex[0];le<D.FileIndex.length;++le)me=D.FileIndex[le],me.content&&(he=me.content.length,!(he<4096)&&(me.start=ce,xe(he+511>>9)));for(xe(B[6]+7>>3);V.l&511;)V.write_shift(-4,ue.ENDOFCHAIN);for(ce=Y=0,le=0;le<D.FileIndex.length;++le)me=D.FileIndex[le],me.content&&(he=me.content.length,!(!he||he>=4096)&&(me.start=ce,xe(he+63>>6)));for(;V.l&511;)V.write_shift(-4,ue.ENDOFCHAIN);for(Y=0;Y<B[4]<<2;++Y){var Ae=D.FullPaths[Y];if(!Ae||Ae.length===0){for(le=0;le<17;++le)V.write_shift(4,0);for(le=0;le<3;++le)V.write_shift(4,-1);for(le=0;le<12;++le)V.write_shift(4,0);continue}me=D.FileIndex[Y],Y===0&&(me.start=me.size?me.start-1:ye);var Oe=Y===0&&I.root||me.name;if(he=2*(Oe.length+1),V.write_shift(64,Oe,"utf16le"),V.write_shift(2,he),V.write_shift(1,me.type),V.write_shift(1,me.color),V.write_shift(-4,me.L),V.write_shift(-4,me.R),V.write_shift(-4,me.C),me.clsid)V.write_shift(16,me.clsid,"hex");else for(le=0;le<4;++le)V.write_shift(4,0);V.write_shift(4,me.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,me.start),V.write_shift(4,me.size),V.write_shift(4,0)}for(Y=1;Y<D.FileIndex.length;++Y)if(me=D.FileIndex[Y],me.size>=4096)if(V.l=me.start+1<<9,wt&&Buffer.isBuffer(me.content))me.content.copy(V,V.l,0,me.size),V.l+=me.size+511&-512;else{for(le=0;le<me.size;++le)V.write_shift(1,me.content[le]);for(;le&511;++le)V.write_shift(1,0)}for(Y=1;Y<D.FileIndex.length;++Y)if(me=D.FileIndex[Y],me.size>0&&me.size<4096)if(wt&&Buffer.isBuffer(me.content))me.content.copy(V,V.l,0,me.size),V.l+=me.size+63&-64;else{for(le=0;le<me.size;++le)V.write_shift(1,me.content[le]);for(;le&63;++le)V.write_shift(1,0)}if(wt)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function X(D,F){var I=D.FullPaths.map(function(le){return le.toUpperCase()}),B=I.map(function(le){var he=le.split("/");return he[he.length-(le.slice(-1)=="/"?2:1)]}),V=!1;F.charCodeAt(0)===47?(V=!0,F=I[0].slice(0,-1)+F):V=F.indexOf("/")!==-1;var Y=F.toUpperCase(),ce=V===!0?I.indexOf(Y):B.indexOf(Y);if(ce!==-1)return D.FileIndex[ce];var xe=!Y.match(lc);for(Y=Y.replace(ir,""),xe&&(Y=Y.replace(lc,"!")),ce=0;ce<I.length;++ce)if((xe?I[ce].replace(lc,"!"):I[ce]).replace(ir,"")==Y||(xe?B[ce].replace(lc,"!"):B[ce]).replace(ir,"")==Y)return D.FileIndex[ce];return null}var ee=64,ye=-2,Ie="d0cf11e0a1b11ae1",Te=[208,207,17,224,161,177,26,225],re="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ye,FREESECT:-1,HEADER_SIGNATURE:Ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ne(D,F,I){f();var B=Q(D,I);d.writeFileSync(F,B)}function W(D){for(var F=new Array(D.length),I=0;I<D.length;++I)F[I]=String.fromCharCode(D[I]);return F.join("")}function U(D,F){var I=Q(D,F);switch(F&&F.type||"buffer"){case"file":return f(),d.writeFileSync(F.filename,I),I;case"binary":return typeof I=="string"?I:W(I);case"base64":return k_(typeof I=="string"?I:W(I));case"buffer":if(wt)return Buffer.isBuffer(I)?I:Ni(I);case"array":return typeof I=="string"?ua(I):I}return I}var G;function R(D){try{var F=D.InflateRaw,I=new F;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)G=D;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function z(D,F){if(!G)return Rr(D,F);var I=G.InflateRaw,B=new I,V=B._processChunk(D.slice(D.l),B._finishFlushFlag);return D.l+=B.bytesRead,V}function J(D){return G?G.deflateRawSync(D):De(D)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function _e(D){var F=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(F>>16|F>>8|F)&255}for(var ke=typeof Uint8Array<"u",Ce=ke?new Uint8Array(256):[],He=0;He<256;++He)Ce[He]=_e(He);function Z(D,F){var I=Ce[D&255];return F<=8?I>>>8-F:(I=I<<8|Ce[D>>8&255],F<=16?I>>>16-F:(I=I<<8|Ce[D>>16&255],I>>>24-F))}function yt(D,F){var I=F&7,B=F>>>3;return(D[B]|(I<=6?0:D[B+1]<<8))>>>I&3}function qe(D,F){var I=F&7,B=F>>>3;return(D[B]|(I<=5?0:D[B+1]<<8))>>>I&7}function it(D,F){var I=F&7,B=F>>>3;return(D[B]|(I<=4?0:D[B+1]<<8))>>>I&15}function rt(D,F){var I=F&7,B=F>>>3;return(D[B]|(I<=3?0:D[B+1]<<8))>>>I&31}function Re(D,F){var I=F&7,B=F>>>3;return(D[B]|(I<=1?0:D[B+1]<<8))>>>I&127}function Dt(D,F,I){var B=F&7,V=F>>>3,Y=(1<<I)-1,ce=D[V]>>>B;return I<8-B||(ce|=D[V+1]<<8-B,I<16-B)||(ce|=D[V+2]<<16-B,I<24-B)||(ce|=D[V+3]<<24-B),ce&Y}function $t(D,F,I){var B=F&7,V=F>>>3;return B<=5?D[V]|=(I&7)<<B:(D[V]|=I<<B&255,D[V+1]=(I&7)>>8-B),F+3}function dn(D,F,I){var B=F&7,V=F>>>3;return I=(I&1)<<B,D[V]|=I,F+1}function en(D,F,I){var B=F&7,V=F>>>3;return I<<=B,D[V]|=I&255,I>>>=8,D[V+1]=I,F+8}function Gn(D,F,I){var B=F&7,V=F>>>3;return I<<=B,D[V]|=I&255,I>>>=8,D[V+1]=I&255,D[V+2]=I>>>8,F+16}function Nn(D,F){var I=D.length,B=2*I>F?2*I:F+5,V=0;if(I>=F)return D;if(wt){var Y=N_(B);if(D.copy)D.copy(Y);else for(;V<D.length;++V)Y[V]=D[V];return Y}else if(ke){var ce=new Uint8Array(B);if(ce.set)ce.set(D);else for(;V<I;++V)ce[V]=D[V];return ce}return D.length=B,D}function on(D){for(var F=new Array(D),I=0;I<D;++I)F[I]=0;return F}function wn(D,F,I){var B=1,V=0,Y=0,ce=0,xe=0,le=D.length,he=ke?new Uint16Array(32):on(32);for(Y=0;Y<32;++Y)he[Y]=0;for(Y=le;Y<I;++Y)D[Y]=0;le=D.length;var me=ke?new Uint16Array(le):on(le);for(Y=0;Y<le;++Y)he[V=D[Y]]++,B<V&&(B=V),me[Y]=0;for(he[0]=0,Y=1;Y<=B;++Y)he[Y+16]=xe=xe+he[Y-1]<<1;for(Y=0;Y<le;++Y)xe=D[Y],xe!=0&&(me[Y]=he[xe+16]++);var Ae=0;for(Y=0;Y<le;++Y)if(Ae=D[Y],Ae!=0)for(xe=Z(me[Y],B)>>B-Ae,ce=(1<<B+4-Ae)-1;ce>=0;--ce)F[xe|ce<<Ae]=Ae&15|Y<<4;return B}var ln=ke?new Uint16Array(512):on(512),qt=ke?new Uint16Array(32):on(32);if(!ke){for(var Ne=0;Ne<512;++Ne)ln[Ne]=0;for(Ne=0;Ne<32;++Ne)qt[Ne]=0}(function(){for(var D=[],F=0;F<32;F++)D.push(5);wn(D,qt,32);var I=[];for(F=0;F<=143;F++)I.push(8);for(;F<=255;F++)I.push(9);for(;F<=279;F++)I.push(7);for(;F<=287;F++)I.push(8);wn(I,ln,288)})();var Pe=function(){for(var F=ke?new Uint8Array(32768):[],I=0,B=0;I<we.length-1;++I)for(;B<we[I+1];++B)F[B]=I;for(;B<32768;++B)F[B]=29;var V=ke?new Uint8Array(259):[];for(I=0,B=0;I<ie.length-1;++I)for(;B<ie[I+1];++B)V[B]=I;function Y(xe,le){for(var he=0;he<xe.length;){var me=Math.min(65535,xe.length-he),Ae=he+me==xe.length;for(le.write_shift(1,+Ae),le.write_shift(2,me),le.write_shift(2,~me&65535);me-- >0;)le[le.l++]=xe[he++]}return le.l}function ce(xe,le){for(var he=0,me=0,Ae=ke?new Uint16Array(32768):[];me<xe.length;){var Oe=Math.min(65535,xe.length-me);if(Oe<10){for(he=$t(le,he,+(me+Oe==xe.length)),he&7&&(he+=8-(he&7)),le.l=he/8|0,le.write_shift(2,Oe),le.write_shift(2,~Oe&65535);Oe-- >0;)le[le.l++]=xe[me++];he=le.l*8;continue}he=$t(le,he,+(me+Oe==xe.length)+2);for(var je=0;Oe-- >0;){var Me=xe[me];je=(je<<5^Me)&32767;var Ue=-1,tt=0;if((Ue=Ae[je])&&(Ue|=me&-32768,Ue>me&&(Ue-=32768),Ue<me))for(;xe[Ue+tt]==xe[me+tt]&&tt<250;)++tt;if(tt>2){Me=V[tt],Me<=22?he=en(le,he,Ce[Me+1]>>1)-1:(en(le,he,3),he+=5,en(le,he,Ce[Me-23]>>5),he+=3);var It=Me<8?0:Me-4>>2;It>0&&(Gn(le,he,tt-ie[Me]),he+=It),Me=F[me-Ue],he=en(le,he,Ce[Me]>>3),he-=3;var Ft=Me<4?0:Me-2>>1;Ft>0&&(Gn(le,he,me-Ue-we[Me]),he+=Ft);for(var Ot=0;Ot<tt;++Ot)Ae[je]=me&32767,je=(je<<5^xe[me])&32767,++me;Oe-=tt-1}else Me<=143?Me=Me+48:he=dn(le,he,1),he=en(le,he,Ce[Me]),Ae[je]=me&32767,++me}he=en(le,he,0)-1}return le.l=(he+7)/8|0,le.l}return function(le,he){return le.length<8?Y(le,he):ce(le,he)}}();function De(D){var F=bn(50+Math.floor(D.length*1.1)),I=Pe(D,F);return F.slice(0,I)}var Be=ke?new Uint16Array(32768):on(32768),Tt=ke?new Uint16Array(32768):on(32768),ot=ke?new Uint16Array(128):on(128),Bt=1,hn=1;function vr(D,F){var I=rt(D,F)+257;F+=5;var B=rt(D,F)+1;F+=5;var V=it(D,F)+4;F+=4;for(var Y=0,ce=ke?new Uint8Array(19):on(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,he=ke?new Uint8Array(8):on(8),me=ke?new Uint8Array(8):on(8),Ae=ce.length,Oe=0;Oe<V;++Oe)ce[q[Oe]]=Y=qe(D,F),le<Y&&(le=Y),he[Y]++,F+=3;var je=0;for(he[0]=0,Oe=1;Oe<=le;++Oe)me[Oe]=je=je+he[Oe-1]<<1;for(Oe=0;Oe<Ae;++Oe)(je=ce[Oe])!=0&&(xe[Oe]=me[je]++);var Me=0;for(Oe=0;Oe<Ae;++Oe)if(Me=ce[Oe],Me!=0){je=Ce[xe[Oe]]>>8-Me;for(var Ue=(1<<7-Me)-1;Ue>=0;--Ue)ot[je|Ue<<Me]=Me&7|Oe<<3}var tt=[];for(le=1;tt.length<I+B;)switch(je=ot[Re(D,F)],F+=je&7,je>>>=3){case 16:for(Y=3+yt(D,F),F+=2,je=tt[tt.length-1];Y-- >0;)tt.push(je);break;case 17:for(Y=3+qe(D,F),F+=3;Y-- >0;)tt.push(0);break;case 18:for(Y=11+Re(D,F),F+=7;Y-- >0;)tt.push(0);break;default:tt.push(je),le<je&&(le=je);break}var It=tt.slice(0,I),Ft=tt.slice(I);for(Oe=I;Oe<286;++Oe)It[Oe]=0;for(Oe=B;Oe<30;++Oe)Ft[Oe]=0;return Bt=wn(It,Be,286),hn=wn(Ft,Tt,30),F}function cr(D,F){if(D[0]==3&&!(D[1]&3))return[js(F),2];for(var I=0,B=0,V=N_(F||1<<18),Y=0,ce=V.length>>>0,xe=0,le=0;(B&1)==0;){if(B=qe(D,I),I+=3,B>>>1)B>>1==1?(xe=9,le=5):(I=vr(D,I),xe=Bt,le=hn);else{I&7&&(I+=8-(I&7));var he=D[I>>>3]|D[(I>>>3)+1]<<8;if(I+=32,he>0)for(!F&&ce<Y+he&&(V=Nn(V,Y+he),ce=V.length);he-- >0;)V[Y++]=D[I>>>3],I+=8;continue}for(;;){!F&&ce<Y+32767&&(V=Nn(V,Y+32767),ce=V.length);var me=Dt(D,I,xe),Ae=B>>>1==1?ln[me]:Be[me];if(I+=Ae&15,Ae>>>=4,(Ae>>>8&255)===0)V[Y++]=Ae;else{if(Ae==256)break;Ae-=257;var Oe=Ae<8?0:Ae-4>>2;Oe>5&&(Oe=0);var je=Y+ie[Ae];Oe>0&&(je+=Dt(D,I,Oe),I+=Oe),me=Dt(D,I,le),Ae=B>>>1==1?qt[me]:Tt[me],I+=Ae&15,Ae>>>=4;var Me=Ae<4?0:Ae-2>>1,Ue=we[Ae];for(Me>0&&(Ue+=Dt(D,I,Me),I+=Me),!F&&ce<je&&(V=Nn(V,je+100),ce=V.length);Y<je;)V[Y]=V[Y-Ue],++Y}}}return F?[V,I+7>>>3]:[V.slice(0,Y),I+7>>>3]}function Rr(D,F){var I=D.slice(D.l||0),B=cr(I,F);return D.l+=B[1],B[0]}function ve(D,F){if(D)typeof console<"u"&&console.error(F);else throw new Error(F)}function Ve(D,F){var I=D;jn(I,0);var B=[],V=[],Y={FileIndex:B,FullPaths:V};L(Y,{root:F.root});for(var ce=I.length-4;(I[ce]!=80||I[ce+1]!=75||I[ce+2]!=5||I[ce+3]!=6)&&ce>=0;)--ce;I.l=ce+4,I.l+=4;var xe=I.read_shift(2);I.l+=6;var le=I.read_shift(4);for(I.l=le,ce=0;ce<xe;++ce){I.l+=20;var he=I.read_shift(4),me=I.read_shift(4),Ae=I.read_shift(2),Oe=I.read_shift(2),je=I.read_shift(2);I.l+=8;var Me=I.read_shift(4),Ue=c(I.slice(I.l+Ae,I.l+Ae+Oe));I.l+=Ae+Oe+je;var tt=I.l;I.l=Me+4,Ke(I,he,me,Y,Ue),I.l=tt}return Y}function Ke(D,F,I,B,V){D.l+=2;var Y=D.read_shift(2),ce=D.read_shift(2),xe=l(D);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var le=D.read_shift(4),he=D.read_shift(4),me=D.read_shift(4),Ae=D.read_shift(2),Oe=D.read_shift(2),je="",Me=0;Me<Ae;++Me)je+=String.fromCharCode(D[D.l++]);if(Oe){var Ue=c(D.slice(D.l,D.l+Oe));(Ue[21589]||{}).mt&&(xe=Ue[21589].mt),((V||{})[21589]||{}).mt&&(xe=V[21589].mt)}D.l+=Oe;var tt=D.slice(D.l,D.l+he);switch(ce){case 8:tt=z(D,me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var It=!1;Y&8&&(le=D.read_shift(4),le==134695760&&(le=D.read_shift(4),It=!0),he=D.read_shift(4),me=D.read_shift(4)),he!=F&&ve(It,"Bad compressed size: "+F+" != "+he),me!=I&&ve(It,"Bad uncompressed size: "+I+" != "+me),pn(B,je,tt,{unsafe:!0,mt:xe})}function Fe(D,F){var I=F||{},B=[],V=[],Y=bn(1),ce=I.compression?8:0,xe=0,le=0,he=0,me=0,Ae=0,Oe=D.FullPaths[0],je=Oe,Me=D.FileIndex[0],Ue=[],tt=0;for(le=1;le<D.FullPaths.length;++le)if(je=D.FullPaths[le].slice(Oe.length),Me=D.FileIndex[le],!(!Me.size||!Me.content||je=="Sh33tJ5")){var It=me,Ft=bn(je.length);for(he=0;he<je.length;++he)Ft.write_shift(1,je.charCodeAt(he)&127);Ft=Ft.slice(0,Ft.l),Ue[Ae]=eO.buf(Me.content,0);var Ot=Me.content;ce==8&&(Ot=J(Ot)),Y=bn(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,xe),Y.write_shift(2,ce),Me.mt?i(Y,Me.mt):Y.write_shift(4,0),Y.write_shift(-4,Ue[Ae]),Y.write_shift(4,Ot.length),Y.write_shift(4,Me.content.length),Y.write_shift(2,Ft.length),Y.write_shift(2,0),me+=Y.length,B.push(Y),me+=Ft.length,B.push(Ft),me+=Ot.length,B.push(Ot),Y=bn(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,xe),Y.write_shift(2,ce),Y.write_shift(4,0),Y.write_shift(-4,Ue[Ae]),Y.write_shift(4,Ot.length),Y.write_shift(4,Me.content.length),Y.write_shift(2,Ft.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,It),tt+=Y.l,V.push(Y),tt+=Ft.length,V.push(Ft),++Ae}return Y=bn(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,Ae),Y.write_shift(2,Ae),Y.write_shift(4,tt),Y.write_shift(4,me),Y.write_shift(2,0),Ms([Ms(B),Ms(V),Y])}var lt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function mt(D,F){if(D.ctype)return D.ctype;var I=D.name||"",B=I.match(/\.([^\.]+)$/);return B&&lt[B[1]]||F&&(B=(I=F).match(/[\.\\]([^\.\\])+$/),B&&lt[B[1]])?lt[B[1]]:"application/octet-stream"}function Xt(D){for(var F=k_(D),I=[],B=0;B<F.length;B+=76)I.push(F.slice(B,B+76));return I.join(`\r
`)+`\r
`}function Dr(D){var F=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var me=he.charCodeAt(0).toString(16).toUpperCase();return"="+(me.length==1?"0"+me:me)});F=F.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),F.charAt(0)==`
`&&(F="=0D"+F.slice(1)),F=F.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],B=F.split(`\r
`),V=0;V<B.length;++V){var Y=B[V];if(Y.length==0){I.push("");continue}for(var ce=0;ce<Y.length;){var xe=76,le=Y.slice(ce,ce+xe);le.charAt(xe-1)=="="?xe--:le.charAt(xe-2)=="="?xe-=2:le.charAt(xe-3)=="="&&(xe-=3),le=Y.slice(ce,ce+xe),ce+=xe,ce<Y.length&&(le+="="),I.push(le)}}return I.join(`\r
`)}function ea(D){for(var F=[],I=0;I<D.length;++I){for(var B=D[I];I<=D.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+D[++I];F.push(B)}for(var V=0;V<F.length;++V)F[V]=F[V].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return ua(F.join(`\r
`))}function Oi(D,F,I){for(var B="",V="",Y="",ce,xe=0;xe<10;++xe){var le=F[xe];if(!le||le.match(/^\s*$/))break;var he=le.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":B=he[2].trim();break;case"content-type":Y=he[2].trim();break;case"content-transfer-encoding":V=he[2].trim();break}}switch(++xe,V.toLowerCase()){case"base64":ce=ua(Nr(F.slice(xe).join("")));break;case"quoted-printable":ce=ea(F.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var me=pn(D,B.slice(I.length),ce,{unsafe:!0});Y&&(me.ctype=Y)}function al(D,F){if(W(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=F&&F.root||"",B=(wt&&Buffer.isBuffer(D)?D.toString("binary"):W(D)).split(`\r
`),V=0,Y="";for(V=0;V<B.length;++V)if(Y=B[V],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),I||(I=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),Y.slice(0,I.length)!=I););var ce=(B[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var xe="--"+(ce[1]||""),le=[],he=[],me={FileIndex:le,FullPaths:he};L(me);var Ae,Oe=0;for(V=0;V<B.length;++V){var je=B[V];je!==xe&&je!==xe+"--"||(Oe++&&Oi(me,B.slice(Ae,V),I),Ae=V)}return me}function Mr(D,F){var I=F||{},B=I.boundary||"SheetJS";B="------="+B;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],Y=D.FullPaths[0],ce=Y,xe=D.FileIndex[0],le=1;le<D.FullPaths.length;++le)if(ce=D.FullPaths[le].slice(Y.length),xe=D.FileIndex[le],!(!xe.size||!xe.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(tt){return"_x"+tt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(tt){return"_u"+tt.charCodeAt(0).toString(16)+"_"});for(var he=xe.content,me=wt&&Buffer.isBuffer(he)?he.toString("binary"):W(he),Ae=0,Oe=Math.min(1024,me.length),je=0,Me=0;Me<=Oe;++Me)(je=me.charCodeAt(Me))>=32&&je<128&&++Ae;var Ue=Ae>=Oe*4/5;V.push(B),V.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+ce),V.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),V.push("Content-Type: "+mt(xe,ce)),V.push(""),V.push(Ue?Dr(me):Xt(me))}return V.push(B+`--\r
`),V.join(`\r
`)}function mn(D){var F={};return L(F,D),F}function pn(D,F,I,B){var V=B&&B.unsafe;V||L(D);var Y=!V&&Ct.find(D,F);if(!Y){var ce=D.FullPaths[0];F.slice(0,ce.length)==ce?ce=F:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+F).replace("//","/")),Y={name:a(F),type:2},D.FileIndex.push(Y),D.FullPaths.push(ce),V||Ct.utils.cfb_gc(D)}return Y.content=I,Y.size=I?I.length:0,B&&(B.CLSID&&(Y.clsid=B.CLSID),B.mt&&(Y.mt=B.mt),B.ct&&(Y.ct=B.ct)),Y}function ga(D,F){L(D);var I=Ct.find(D,F);if(I){for(var B=0;B<D.FileIndex.length;++B)if(D.FileIndex[B]==I)return D.FileIndex.splice(B,1),D.FullPaths.splice(B,1),!0}return!1}function zs(D,F,I){L(D);var B=Ct.find(D,F);if(B){for(var V=0;V<D.FileIndex.length;++V)if(D.FileIndex[V]==B)return D.FileIndex[V].name=a(I),D.FullPaths[V]=I,!0}return!1}function sl(D){M(D,!0)}return e.find=X,e.read=H,e.parse=g,e.write=U,e.writeFile=ne,e.utils={cfb_new:mn,cfb_add:pn,cfb_del:ga,cfb_mov:zs,cfb_gc:sl,ReadShift:xc,CheckField:A2,prep_blob:jn,bconcat:Ms,use_zlib:R,_deflateRaw:De,_inflateRaw:Rr,consts:ue},e}();function tO(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var n=e.read();return e.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+t)}function Ra(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function Xm(t){for(var e=[],n=Ra(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}var Hf=new Date(1899,11,30,0,0,0);function lr(t,e){var n=t.getTime(),r=Hf.getTime()+(t.getTimezoneOffset()-Hf.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var i2=new Date,nO=Hf.getTime()+(i2.getTimezoneOffset()-Hf.getTimezoneOffset())*6e4,P_=i2.getTimezoneOffset();function id(t){var e=new Date;return e.setTime(t*24*60*60*1e3+nO),e.getTimezoneOffset()!==P_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-P_)*6e4),e}function rO(t){var e=0,n=0,r=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(n=1,i>3&&(r=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=n*parseInt(a[i],10)}return e}var U_=new Date("2017-02-19T19:06:09.000Z"),o2=isNaN(U_.getFullYear())?new Date("2/19/17"):U_,aO=o2.getFullYear()==2017;function Ln(t,e){var n=new Date(t);if(aO)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(o2.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function bi(t,e){if(wt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return uc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return uc(Yw(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return uc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return uc(new TextDecoder("utf-16be").decode(t.slice(2)))}var n={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return n[i]||i})}catch{}for(var r=[],a=0;a!=t.length;++a)r.push(String.fromCharCode(t[a]));return r.join("")}function Vn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Vn(t[n]));return e}function an(t,e){for(var n="";n.length<e;)n+=t;return n}function ma(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,i){return n=-n,i}),!isNaN(e=Number(r)))?e/n:e}var sO=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jo(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),a=e.getMonth(),i=e.getDate();if(isNaN(i))return n;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&sO.indexOf(l)==-1)return n}else if(l.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||i>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}var iO=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(n,r,a){if(t||typeof r=="string")return n.split(r);for(var i=n.split(r),l=[i[0]],c=1;c<i.length;++c)l.push(a),l.push(i[c]);return l}}();function l2(t){return t?t.content&&t.type?bi(t.content,!0):t.data?oc(t.data):t.asNodeBuffer&&wt?oc(t.asNodeBuffer().toString("binary")):t.asBinary?oc(t.asBinary()):t._data&&t._data.getContent?oc(bi(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function c2(t){if(!t)return null;if(t.data)return C_(t.data);if(t.asNodeBuffer&&wt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?C_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function oO(t){return t&&t.name.slice(-4)===".bin"?c2(t):l2(t)}function qr(t,e){for(var n=t.FullPaths||Ra(t.files),r=e.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),i=0;i<n.length;++i){var l=n[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return t.files?t.files[n[i]]:t.FileIndex[i]}return null}function Zm(t,e){var n=qr(t,e);if(n==null)throw new Error("Cannot find file "+e+" in zip");return n}function yn(t,e,n){if(!n)return oO(Zm(t,e));if(!e)return null;try{return yn(t,e)}catch{return null}}function kr(t,e,n){if(!n)return l2(Zm(t,e));if(!e)return null;try{return kr(t,e)}catch{return null}}function lO(t,e,n){return c2(Zm(t,e))}function B_(t){for(var e=t.FullPaths||Ra(t.files),n=[],r=0;r<e.length;++r)e[r].slice(-1)!="/"&&n.push(e[r].replace(/^Root Entry[\/]/,""));return n.sort()}function cO(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return wt?r=Ni(n):r=k8(n),Ct.utils.cfb_add(t,e,r)}Ct.utils.cfb_add(t,e,n)}else t.file(e,n)}function u2(t,e){switch(e.type){case"base64":return Ct.read(t,{type:"base64"});case"binary":return Ct.read(t,{type:"binary"});case"buffer":case"array":return Ct.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function cc(t,e){if(t.charAt(0)=="/")return t.slice(1);var n=e.split("/");e.slice(-1)!="/"&&n.pop();for(var r=t.split("/");r.length!==0;){var a=r.shift();a===".."?n.pop():a!=="."&&n.push(a)}return n.join("/")}var f2=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,uO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,j_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,fO=/<[^>]*>/g,tr=f2.match(j_)?j_:fO,dO=/<\w*:/,hO=/<(\/?)\w+:/;function et(t,e,n){for(var r={},a=0,i=0;a!==t.length&&!((i=t.charCodeAt(a))===32||i===10||i===13);++a);if(e||(r[0]=t.slice(0,a)),a===t.length)return r;var l=t.match(uO),c=0,d="",f=0,g="",y="",T=1;if(l)for(f=0;f!=l.length;++f){for(y=l[f],i=0;i!=y.length&&y.charCodeAt(i)!==61;++i);for(g=y.slice(0,i).trim();y.charCodeAt(i+1)==32;)++i;for(T=(a=y.charCodeAt(i+1))==34||a==39?1:0,d=y.slice(i+1+T,y.length-T),c=0;c!=g.length&&g.charCodeAt(c)!==58;++c);if(c===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),r[g]=d,r[g.toLowerCase()]=d;else{var w=(c===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(c+1);if(r[w]&&g.slice(c-3,c)=="ext")continue;r[w]=d,r[w.toLowerCase()]=d}}return r}function Da(t){return t.replace(hO,"<$1")}var d2={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},mO=Xm(d2),kt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function n(r){var a=r+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(t,function(c,d){return d2[c]||String.fromCharCode(parseInt(d,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,d){return String.fromCharCode(parseInt(d,16))});var l=a.indexOf("]]>");return n(a.slice(0,i))+a.slice(i+9,l)+n(a.slice(l+3))}}(),pO=/[&<>'"]/g,gO=/[\u0000-\u001f]/g;function Qm(t){var e=t+"";return e.replace(pO,function(n){return mO[n]}).replace(/\n/g,"<br/>").replace(gO,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}var V_=function(){var t=/&#(\d+);/g;function e(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(t,e)}}();function Qt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Nh(t){for(var e="",n=0,r=0,a=0,i=0,l=0,c=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(a=t.charCodeAt(n++),r>191&&r<224){l=(r&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(i=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(a&63)<<6|i&63);continue}l=t.charCodeAt(n++),c=((r&7)<<18|(a&63)<<12|(i&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function H_(t){var e=js(2*t.length),n,r,a=1,i=0,l=0,c;for(r=0;r<t.length;r+=a)a=1,(c=t.charCodeAt(r))<128?n=c:c<224?(n=(c&31)*64+(t.charCodeAt(r+1)&63),a=2):c<240?(n=(c&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),a=3):(a=4,n=(c&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,l=55296+(n>>>10&1023),n=56320+(n&1023)),l!==0&&(e[i++]=l&255,e[i++]=l>>>8,l=0),e[i++]=n%256,e[i++]=n>>>8;return e.slice(0,i).toString("ucs2")}function G_(t){return Ni(t,"binary").toString("utf8")}var pf="foo bar bazâð£",Wt=wt&&(G_(pf)==Nh(pf)&&G_||H_(pf)==Nh(pf)&&H_)||Nh,uc=wt?function(t){return Ni(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,a=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},Fc=function(){var t={};return function(n,r){var a=n+"|"+(r||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),h2=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)r=r.replace(t[a][0],t[a][1]);return r}}(),xO=function(){var t={};return function(n){return t[n]!==void 0?t[n]:t[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),vO=/<\/?(?:vt:)?variant>/g,yO=/<(?:vt:)([^>]*)>([\s\S]*)</;function $_(t,e){var n=et(t),r=t.match(xO(n.baseType))||[],a=[];if(r.length!=n.size){if(e.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(i){var l=i.replace(vO,"").match(yO);l&&a.push({v:Wt(l[2]),t:l[1]})}),a}var _O=/(^\s|\s$|\n)/;function TO(t){return Ra(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function wO(t,e,n){return"<"+t+(n!=null?TO(n):"")+(e!=null?(e.match(_O)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function ep(t){if(wt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Wt(Ri(Jm(t)));throw new Error("Bad input format: expected Buffer or string")}var Oc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,EO={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},SO=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function bO(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,i=5;i>=0;--i)a=a*256+t[e+i];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function CO(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,a=0,i=0,l=r?-e:e;isFinite(l)?l==0?a=i=0:(a=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(e)?26985:0);for(var c=0;c<=5;++c,i/=256)t[n+c]=i&255;t[n+6]=(a&15)<<4|i&15,t[n+7]=a>>4|r}var z_=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var a=0,i=t[0][r].length;a<i;a+=n)e.push.apply(e,t[0][r].slice(a,a+n));return e},q_=wt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ni(e)})):z_(t)}:z_,Y_=function(t,e,n){for(var r=[],a=e;a<n;a+=2)r.push(String.fromCharCode(Wa(t,a)));return r.join("").replace(ir,"")},tp=wt?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(ir,""):Y_(t,e,n)}:Y_,J_=function(t,e,n){for(var r=[],a=e;a<e+n;++a)r.push(("0"+t[a].toString(16)).slice(-2));return r.join("")},m2=wt?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):J_(t,e,n)}:J_,W_=function(t,e,n){for(var r=[],a=e;a<n;a++)r.push(String.fromCharCode(Do(t,a)));return r.join("")},$c=wt?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):W_(e,n,r)}:W_,p2=function(t,e){var n=Ar(t,e);return n>0?$c(t,e+4,e+4+n-1):""},g2=p2,x2=function(t,e){var n=Ar(t,e);return n>0?$c(t,e+4,e+4+n-1):""},v2=x2,y2=function(t,e){var n=2*Ar(t,e);return n>0?$c(t,e+4,e+4+n-1):""},_2=y2,T2=function(e,n){var r=Ar(e,n);return r>0?tp(e,n+4,n+4+r):""},w2=T2,E2=function(t,e){var n=Ar(t,e);return n>0?$c(t,e+4,e+4+n):""},S2=E2,b2=function(t,e){return bO(t,e)},Gf=b2,C2=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};wt&&(g2=function(e,n){if(!Buffer.isBuffer(e))return p2(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},v2=function(e,n){if(!Buffer.isBuffer(e))return x2(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},_2=function(e,n){if(!Buffer.isBuffer(e))return y2(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},w2=function(e,n){if(!Buffer.isBuffer(e))return T2(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},S2=function(e,n){if(!Buffer.isBuffer(e))return E2(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},Gf=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):b2(e,n)},C2=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Do=function(t,e){return t[e]},Wa=function(t,e){return t[e+1]*256+t[e]},AO=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},Ar=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},hi=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},kO=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function xc(t,e){var n="",r,a,i=[],l,c,d,f;switch(e){case"dbcs":if(f=this.l,wt&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(d=0;d<t;++d)n+=String.fromCharCode(Wa(this,f)),f+=2;t*=2;break;case"utf8":n=$c(this,this.l,this.l+t);break;case"utf16le":t*=2,n=tp(this,this.l,this.l+t);break;case"wstr":return xc.call(this,t,"dbcs");case"lpstr-ansi":n=g2(this,this.l),t=4+Ar(this,this.l);break;case"lpstr-cp":n=v2(this,this.l),t=4+Ar(this,this.l);break;case"lpwstr":n=_2(this,this.l),t=4+2*Ar(this,this.l);break;case"lpp4":t=4+Ar(this,this.l),n=w2(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ar(this,this.l),n=S2(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(l=Do(this,this.l+t++))!==0;)i.push(mf(l));n=i.join("");break;case"_wstr":for(t=0,n="";(l=Wa(this,this.l+t))!==0;)i.push(mf(l)),t+=2;t+=2,n=i.join("");break;case"dbcs-cont":for(n="",f=this.l,d=0;d<t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Do(this,f),this.l=f+1,c=xc.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(mf(Wa(this,f))),f+=2}n=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",f=this.l,d=0;d!=t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Do(this,f),this.l=f+1,c=xc.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(mf(Do(this,f))),f+=1}n=i.join("");break;default:switch(t){case 1:return r=Do(this,this.l),this.l++,r;case 2:return r=(e==="i"?AO:Wa)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(t>0?hi:kO)(this,this.l),this.l+=4,r):(a=Ar(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=Gf(this,this.l):a=Gf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:n=m2(this,this.l,t);break}}return this.l+=t,n}var NO=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},RO=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},DO=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function MO(t,e,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=e.length;++a)DO(this,e.charCodeAt(a),this.l+2*a);r=2*e.length}else if(n==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;r=e.length}else if(n==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,NO(this,e,this.l);break;case 8:if(r=8,n==="f"){CO(this,e,this.l);break}case 16:break;case-4:r=4,RO(this,e,this.l);break}return this.l+=r,this}function A2(t,e){var n=m2(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function jn(t,e){t.l=e,t.read_shift=xc,t.chk=A2,t.write_shift=MO}function Qn(t,e){t.l+=e}function bn(t){var e=js(t);return jn(e,0),e}function as(t,e,n){if(t){var r,a,i;jn(t,t.l||0);for(var l=t.length,c=0,d=0;t.l<l;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var f=Wf[c]||Wf[65535];for(r=t.read_shift(1),i=r&127,a=1;a<4&&r&128;++a)i+=((r=t.read_shift(1))&127)<<7*a;d=t.l+i;var g=f.f&&f.f(t,i,n);if(t.l=d,e(g,f,c))return}}}function mm(){var t=[],e=wt?256:2048,n=function(f){var g=bn(f);return jn(g,0),g},r=n(e),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},i=function(f){return r&&f<r.length-r.l?r:(a(),r=n(Math.max(f+1,e)))},l=function(){return a(),Ms(t)},c=function(f){a(),r=f,r.l==null&&(r.l=r.length),i(e)};return{next:i,push:c,end:l,_bufs:t}}function vc(t,e,n){var r=Vn(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function K_(t,e,n){var r=Vn(t);return r.s=vc(r.s,e.s,n),r.e=vc(r.e,e.s,n),r}function yc(t,e){if(t.cRel&&t.c<0)for(t=Vn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Vn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=st(t);return!t.cRel&&t.cRel!=null&&(n=OO(n)),!t.rRel&&t.rRel!=null&&(n=IO(n)),n}function Rh(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+An(t.s.c)+":"+(t.e.cRel?"":"$")+An(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Hn(t.s.r)+":"+(t.e.rRel?"":"$")+Hn(t.e.r):yc(t.s,e.biff)+":"+yc(t.e,e.biff)}function np(t){return parseInt(FO(t),10)-1}function Hn(t){return""+(t+1)}function IO(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function FO(t){return t.replace(/\$(\d+)$/,"$1")}function rp(t){for(var e=LO(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function An(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function OO(t){return t.replace(/^([A-Z])/,"$$$1")}function LO(t){return t.replace(/^\$([A-Z])/,"$1")}function PO(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function sr(t){for(var e=0,n=0,r=0;r<t.length;++r){var a=t.charCodeAt(r);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:e-1}}function st(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function nl(t){var e=t.indexOf(":");return e==-1?{s:sr(t),e:sr(t)}:{s:sr(t.slice(0,e)),e:sr(t.slice(e+1))}}function At(t,e){return typeof e>"u"||typeof e=="number"?At(t.s,t.e):(typeof t!="string"&&(t=st(t)),typeof e!="string"&&(e=st(e)),t==e?t:t+":"+e)}function sn(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,i=t.length;for(n=0;r<i&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.s.c=--n,n=0;r<i&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(e.s.r=--n,r===i||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=i&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.e.c=--n,n=0;r!=i&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return e.e.r=--n,e}function X_(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Wr(t.z,n?lr(e):e)}catch{}try{return t.w=Wr((t.XF||{}).numFmtId||(n?14:0),n?lr(e):e)}catch{return""+e}}function ts(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?Ii[t.v]||t.v:e==null?X_(t,t.v):X_(t,e))}function $s(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function k2(t,e,n){var r=n||{},a=t?Array.isArray(t):r.dense,i=t||(a?[]:{}),l=0,c=0;if(i&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?sr(r.origin):r.origin;l=d.r,c=d.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var g=sn(i["!ref"]);f.s.c=g.s.c,f.s.r=g.s.r,f.e.c=Math.max(f.e.c,g.e.c),f.e.r=Math.max(f.e.r,g.e.r),l==-1&&(f.e.r=l=g.e.r+1)}for(var y=0;y!=e.length;++y)if(e[y]){if(!Array.isArray(e[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var T=0;T!=e[y].length;++T)if(!(typeof e[y][T]>"u")){var w={v:e[y][T]},E=l+y,S=c+T;if(f.s.r>E&&(f.s.r=E),f.s.c>S&&(f.s.c=S),f.e.r<E&&(f.e.r=E),f.e.c<S&&(f.e.c=S),e[y][T]&&typeof e[y][T]=="object"&&!Array.isArray(e[y][T])&&!(e[y][T]instanceof Date))w=e[y][T];else if(Array.isArray(w.v)&&(w.f=e[y][T][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(r.nullError)w.t="e",w.v=0;else if(r.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=r.dateNF||ut[14],r.cellDates?(w.t="d",w.w=Wr(w.z,lr(w.v))):(w.t="n",w.v=lr(w.v),w.w=Wr(w.z,w.v))):w.t="s";if(a)i[E]||(i[E]=[]),i[E][S]&&i[E][S].z&&(w.z=i[E][S].z),i[E][S]=w;else{var b=st({c:S,r:E});i[b]&&i[b].z&&(w.z=i[b].z),i[b]=w}}}return f.s.c<1e7&&(i["!ref"]=At(f)),i}function rl(t,e){return k2(null,t,e)}function UO(t){return t.read_shift(4,"i")}function Zn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function BO(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function ap(t,e){var n=t.l,r=t.read_shift(1),a=Zn(t),i=[],l={t:a,h:a};if((r&1)!==0){for(var c=t.read_shift(4),d=0;d!=c;++d)i.push(BO(t));l.r=i}else l.r=[{ich:0,ifnt:0}];return t.l=n+e,l}var jO=ap;function Qr(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function Di(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var VO=Zn;function sp(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var HO=Zn,pm=sp;function ip(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var a=r===0?Gf([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):hi(e,0)>>2;return n?a/100:a}function N2(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Mi=N2;function Wn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function GO(t){var e={},n=t.read_shift(1),r=n>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),l=t.read_shift(1),c=t.read_shift(1),d=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=a;var f=gi[a];f&&(e.rgb=Pc(f));break;case 2:e.rgb=Pc([l,c,d]);break;case 3:e.theme=a;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function $O(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function R2(t,e){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=t.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[t.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function zO(t){return R2(t,1)}function qO(t){return R2(t,2)}var op=2,gr=3,gf=11,Z_=12,$f=19,xf=64,YO=65,JO=71,WO=4108,KO=4126,On=80,D2=81,XO=[On,D2],ZO={1:{n:"CodePage",t:op},2:{n:"Category",t:On},3:{n:"PresentationFormat",t:On},4:{n:"ByteCount",t:gr},5:{n:"LineCount",t:gr},6:{n:"ParagraphCount",t:gr},7:{n:"SlideCount",t:gr},8:{n:"NoteCount",t:gr},9:{n:"HiddenCount",t:gr},10:{n:"MultimediaClipCount",t:gr},11:{n:"ScaleCrop",t:gf},12:{n:"HeadingPairs",t:WO},13:{n:"TitlesOfParts",t:KO},14:{n:"Manager",t:On},15:{n:"Company",t:On},16:{n:"LinksUpToDate",t:gf},17:{n:"CharacterCount",t:gr},19:{n:"SharedDoc",t:gf},22:{n:"HyperlinksChanged",t:gf},23:{n:"AppVersion",t:gr,p:"version"},24:{n:"DigSig",t:YO},26:{n:"ContentType",t:On},27:{n:"ContentStatus",t:On},28:{n:"Language",t:On},29:{n:"Version",t:On},255:{},2147483648:{n:"Locale",t:$f},2147483651:{n:"Behavior",t:$f},1919054434:{}},QO={1:{n:"CodePage",t:op},2:{n:"Title",t:On},3:{n:"Subject",t:On},4:{n:"Author",t:On},5:{n:"Keywords",t:On},6:{n:"Comments",t:On},7:{n:"Template",t:On},8:{n:"LastAuthor",t:On},9:{n:"RevNumber",t:On},10:{n:"EditTime",t:xf},11:{n:"LastPrinted",t:xf},12:{n:"CreatedDate",t:xf},13:{n:"ModifiedDate",t:xf},14:{n:"PageCount",t:gr},15:{n:"WordCount",t:gr},16:{n:"CharCount",t:gr},17:{n:"Thumbnail",t:JO},18:{n:"Application",t:On},19:{n:"DocSecurity",t:gr},255:{},2147483648:{n:"Locale",t:$f},2147483651:{n:"Behavior",t:$f},1919054434:{}},Q_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},eL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function tL(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var nL=tL([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),gi=Vn(nL),Ii={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},M2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},eT={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function rL(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function aL(t){var e=rL();if(!t||!t.match)return e;var n={};if((t.match(tr)||[]).forEach(function(r){var a=et(r);switch(a[0].replace(dO,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[a.Extension]=a.ContentType;break;case"<Override":e[eT[a.ContentType]]!==void 0&&e[eT[a.ContentType]].push(a.PartName);break}}),e.xmlns!==EO.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=n,delete e.calcchains,e}var Io={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function gm(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function _c(t,e){var n={"!id":{}};if(!t)return n;e.charAt(0)!=="/"&&(e="/"+e);var r={};return(t.match(tr)||[]).forEach(function(a){var i=et(a);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:cc(i.Target,e);n[c]=l,r[i.Id]=l}}),n["!id"]=r,n}var sL="application/vnd.oasis.opendocument.spreadsheet";function iL(t,e){for(var n=ep(t),r,a;r=Oc.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(a=et(r[0],!1),a.path=="/"&&a.type!==sL)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw r}}var Tc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],oL=function(){for(var t=new Array(Tc.length),e=0;e<Tc.length;++e){var n=Tc[e],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);t[e]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return t}();function I2(t){var e={};t=Wt(t);for(var n=0;n<Tc.length;++n){var r=Tc[n],a=t.match(oL[n]);a!=null&&a.length>0&&(e[r[1]]=kt(a[1])),r[2]==="date"&&e[r[1]]&&(e[r[1]]=Ln(e[r[1]]))}return e}var lL=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function F2(t,e,n,r){var a=[];if(typeof t=="string")a=$_(t,r);else for(var i=0;i<t.length;++i)a=a.concat(t[i].map(function(g){return{v:g}}));var l=typeof e=="string"?$_(e,r).map(function(g){return g.v}):e,c=0,d=0;if(l.length>0)for(var f=0;f!==a.length;f+=2){switch(d=+a[f+1].v,a[f].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":n.Worksheets=d,n.SheetNames=l.slice(c,c+d);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":n.NamedRanges=d,n.DefinedNames=l.slice(c,c+d);break;case"Charts":case"Diagramme":n.Chartsheets=d,n.ChartNames=l.slice(c,c+d);break}c+=d}}function cL(t,e,n){var r={};return e||(e={}),t=Wt(t),lL.forEach(function(a){var i=(t.match(Fc(a[0]))||[])[1];switch(a[2]){case"string":i&&(e[a[1]]=kt(i));break;case"bool":e[a[1]]=i==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&F2(r.HeadingPairs,r.TitlesOfParts,e,n),e}var uL=/<[^>]+>[^<]*/g;function fL(t,e){var n={},r="",a=t.match(uL);if(a)for(var i=0;i!=a.length;++i){var l=a[i],c=et(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=kt(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var d=l.split(">"),f=d[0].slice(4),g=d[1];switch(f){case"lpstr":case"bstr":case"lpwstr":n[r]=kt(g);break;case"bool":n[r]=Qt(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(g,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(g);break;case"filetime":case"date":n[r]=Ln(g);break;case"cy":case"error":n[r]=kt(g);break;default:if(f.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,d)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return n}var dL={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Dh;function hL(t,e,n){Dh||(Dh=Xm(dL)),e=Dh[e]||e,t[e]=n}function lp(t){var e=t.read_shift(4),n=t.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function O2(t,e,n){var r=t.l,a=t.read_shift(0,"lpstr-cp");if(n)for(;t.l-r&3;)++t.l;return a}function L2(t,e,n){var r=t.read_shift(0,"lpwstr");return r}function P2(t,e,n){return e===31?L2(t):O2(t,e,n)}function xm(t,e,n){return P2(t,e,n===!1?0:4)}function mL(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return P2(t,e,0)}function pL(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r){var a=t.l;n[r]=t.read_shift(0,"lpwstr").replace(ir,""),t.l-a&2&&(t.l+=2)}return n}function gL(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r)n[r]=t.read_shift(0,"lpstr-cp").replace(ir,"");return n}function xL(t){var e=t.l,n=zf(t,D2);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var r=zf(t,gr);return[n,r]}function vL(t){for(var e=t.read_shift(4),n=[],r=0;r<e/2;++r)n.push(xL(t));return n}function tT(t,e){for(var n=t.read_shift(4),r={},a=0;a!=n;++a){var i=t.read_shift(4),l=t.read_shift(4);r[i]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(ir,"").replace(lc,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),r}function U2(t){var e=t.read_shift(4),n=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),n}function yL(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function zf(t,e,n){var r=t.read_shift(2),a,i=n||{};if(t.l+=2,e!==Z_&&r!==e&&XO.indexOf(e)===-1&&!((e&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+e+" saw "+r);switch(e===Z_?r:e){case 2:return a=t.read_shift(2,"i"),i.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return O2(t,r,4).replace(ir,"");case 31:return L2(t);case 64:return lp(t);case 65:return U2(t);case 71:return yL(t);case 80:return xm(t,r,!i.raw).replace(ir,"");case 81:return mL(t,r).replace(ir,"");case 4108:return vL(t);case 4126:case 4127:return r==4127?pL(t):gL(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function nT(t,e){var n=t.l,r=t.read_shift(4),a=t.read_shift(4),i=[],l=0,c=0,d=-1,f={};for(l=0;l!=a;++l){var g=t.read_shift(4),y=t.read_shift(4);i[l]=[g,y+n]}i.sort(function(k,C){return k[1]-C[1]});var T={};for(l=0;l!=a;++l){if(t.l!==i[l][1]){var w=!0;if(l>0&&e)switch(e[i[l-1][0]].t){case 2:t.l+2===i[l][1]&&(t.l+=2,w=!1);break;case 80:t.l<=i[l][1]&&(t.l=i[l][1],w=!1);break;case 4108:t.l<=i[l][1]&&(t.l=i[l][1],w=!1);break}if((!e||l==0)&&t.l<=i[l][1]&&(w=!1,t.l=i[l][1]),w)throw new Error("Read Error: Expected address "+i[l][1]+" at "+t.l+" :"+l)}if(e){var E=e[i[l][0]];if(T[E.n]=zf(t,E.t,{raw:!0}),E.p==="version"&&(T[E.n]=String(T[E.n]>>16)+"."+("0000"+String(T[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(T[E.n]){case 0:T[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:fa(c=T[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+T[E.n])}}else if(i[l][0]===1){if(c=T.CodePage=zf(t,op),fa(c),d!==-1){var S=t.l;t.l=i[d][1],f=tT(t,c),t.l=S}}else if(i[l][0]===0){if(c===0){d=l,t.l=i[l+1][1];continue}f=tT(t,c)}else{var b=f[i[l][0]],N;switch(t[t.l]){case 65:t.l+=4,N=U2(t);break;case 30:t.l+=4,N=xm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,N=xm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,N=t.read_shift(4,"i");break;case 19:t.l+=4,N=t.read_shift(4);break;case 5:t.l+=4,N=t.read_shift(8,"f");break;case 11:t.l+=4,N=fn(t,4);break;case 64:t.l+=4,N=Ln(lp(t));break;default:throw new Error("unparsed value: "+t[t.l])}T[b]=N}}return t.l=n+r,T}function rT(t,e,n){var r=t.content;if(!r)return{};jn(r,0);var a,i,l,c,d=0;r.chk("feff","Byte Order: "),r.read_shift(2);var f=r.read_shift(4),g=r.read_shift(16);if(g!==Ct.utils.consts.HEADER_CLSID&&g!==n)throw new Error("Bad PropertySet CLSID "+g);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),d=r.read_shift(4));var y=nT(r,e),T={SystemIdentifier:f};for(var w in y)T[w]=y[w];if(T.FMTID=i,a===1)return T;if(d-r.l==2&&(r.l+=2),r.l!==d)throw new Error("Length mismatch 2: "+r.l+" !== "+d);var E;try{E=nT(r,null)}catch{}for(w in E)T[w]=E[w];return T.FMTID=[i,l],T}function As(t,e){return t.read_shift(e),null}function _L(t,e,n){for(var r=[],a=t.l+e;t.l<a;)r.push(n(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return r}function fn(t,e){return t.read_shift(e)===1}function _n(t){return t.read_shift(2,"u")}function B2(t,e){return _L(t,e,_n)}function TL(t){var e=t.read_shift(1),n=t.read_shift(1);return n===1?e:e===1}function zc(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var l=r?t.read_shift(r,a):"";return l}function wL(t){var e=t.read_shift(2),n=t.read_shift(1),r=n&4,a=n&8,i=1+(n&1),l=0,c,d={};a&&(l=t.read_shift(2)),r&&(c=t.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",g=e===0?"":t.read_shift(e,f);return a&&(t.l+=4*l),r&&(t.l+=c),d.t=g,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function Ci(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function qc(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):Ci(t,r,n)}function Fi(t,e,n){if(n.biff>5)return qc(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function EL(t){var e=t.read_shift(1);t.l++;var n=t.read_shift(2);return t.l+=2,[e,n]}function SL(t){var e=t.read_shift(4),n=t.l,r=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),t.l=n);var a=t.read_shift((r?e-24:e)>>1,"utf16le").replace(ir,"");return r&&(t.l+=24),a}function bL(t){for(var e=t.read_shift(2),n="";e-- >0;)n+="../";var r=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return n+r.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(i>>1,"utf16le").replace(ir,"");return n+l}function CL(t,e){var n=t.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return SL(t);case"0303000000000000c000000000000046":return bL(t);default:throw new Error("Unsupported Moniker "+n)}}function vf(t){var e=t.read_shift(4),n=e>0?t.read_shift(e,"utf16le").replace(ir,""):"";return n}function AL(t,e){var n=t.l+e,r=t.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=t.read_shift(2);t.l+=2;var i,l,c,d,f="",g,y;a&16&&(i=vf(t,n-t.l)),a&128&&(l=vf(t,n-t.l)),(a&257)===257&&(c=vf(t,n-t.l)),(a&257)===1&&(d=CL(t,n-t.l)),a&8&&(f=vf(t,n-t.l)),a&32&&(g=t.read_shift(16)),a&64&&(y=lp(t)),t.l=n;var T=l||c||d||"";T&&f&&(T+="#"+f),T||(T="#"+f),a&2&&T.charAt(0)=="/"&&T.charAt(1)!="/"&&(T="file://"+T);var w={Target:T};return g&&(w.guid=g),y&&(w.time=y),i&&(w.Tooltip=i),w}function j2(t){var e=t.read_shift(1),n=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1);return[e,n,r,a]}function V2(t,e){var n=j2(t);return n[3]=0,n}function Ma(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return{r:e,c:n,ixfe:r}}function kL(t){var e=t.read_shift(2),n=t.read_shift(2);return t.l+=8,{type:e,flags:n}}function NL(t,e,n){return e===0?"":Fi(t,e,n)}function RL(t,e,n){var r=n.biff>8?4:2,a=t.read_shift(r),i=t.read_shift(r,"i"),l=t.read_shift(r,"i");return[a,i,l]}function H2(t){var e=t.read_shift(2),n=ip(t);return[e,n]}function DL(t,e,n){t.l+=4,e-=4;var r=t.l+e,a=zc(t,e,n),i=t.read_shift(2);if(r-=t.l,i!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+i);return t.l+=i,a}function od(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{s:{c:r,r:e},e:{c:a,r:n}}}function G2(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(1),a=t.read_shift(1);return{s:{c:r,r:e},e:{c:a,r:n}}}var ML=G2;function $2(t){t.l+=4;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return t.l+=12,[n,e,r]}function IL(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function FL(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function qn(t){t.l+=2,t.l+=t.read_shift(2)}var OL={0:qn,4:qn,5:qn,6:qn,7:FL,8:qn,9:qn,10:qn,11:qn,12:qn,13:IL,14:qn,15:qn,16:qn,17:qn,18:qn,19:qn,20:qn,21:$2};function LL(t,e){for(var n=t.l+e,r=[];t.l<n;){var a=t.read_shift(2);t.l-=2;try{r.push(OL[a](t,n-t.l))}catch{return t.l=n,r}}return t.l!=n&&(t.l=n),r}function yf(t,e){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=t.read_shift(2),e-=2,e>=2&&(n.dt=t.read_shift(2),t.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return t.read_shift(e),n}function PL(t,e){return e===0||t.read_shift(2),1200}function UL(t,e,n){if(n.enc)return t.l+=e,"";var r=t.l,a=Fi(t,0,n);return t.read_shift(e+r-t.l),a}function BL(t,e,n){var r=n&&n.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function jL(t,e,n){var r=t.read_shift(4),a=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=zc(t,0,n);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:i,name:l}}function VL(t,e){for(var n=t.l+e,r=t.read_shift(4),a=t.read_shift(4),i=[],l=0;l!=a&&t.l<n;++l)i.push(wL(t));return i.Count=r,i.Unique=a,i}function HL(t,e){var n={};return n.dsst=t.read_shift(2),t.l+=e-2,n}function GL(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var n=t.read_shift(2);t.l+=4;var r=t.read_shift(1);return t.l+=3,r&7&&(e.level=r&7),r&32&&(e.hidden=!0),r&64&&(e.hpt=n/20),e}function $L(t){var e=kL(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var n=t.read_shift(4);return n!==0}function zL(t){return t.read_shift(2),t.read_shift(4)}function aT(t,e,n){var r=0;n&&n.biff==2||(r=t.read_shift(2));var a=t.read_shift(2);n&&n.biff==2&&(r=1-(a>>15),a&=32767);var i={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[i,a]}function qL(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),d=t.read_shift(2),f=t.read_shift(2);return{Pos:[e,n],Dim:[r,a],Flags:i,CurTab:l,FirstTab:c,Selected:d,TabRatio:f}}function YL(t,e,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=t.read_shift(2);return{RTL:r&64}}function JL(){}function WL(t,e,n){var r={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return r.name=zc(t,0,n),r}function KL(t){var e=Ma(t);return e.isst=t.read_shift(4),e}function XL(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=t.l+e,a=Ma(t);n.biff==2&&t.l++;var i=qc(t,r-t.l,n);return a.val=i,a}function ZL(t,e,n){var r=t.read_shift(2),a=Fi(t,0,n);return[r,a]}var QL=Fi;function sT(t,e,n){var r=t.l+e,a=n.biff==8||!n.biff?4:2,i=t.read_shift(a),l=t.read_shift(a),c=t.read_shift(2),d=t.read_shift(2);return t.l=r,{s:{r:i,c},e:{r:l,c:d}}}function eP(t){var e=t.read_shift(2),n=t.read_shift(2),r=H2(t);return{r:e,c:n,ixfe:r[0],rknum:r[1]}}function tP(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),i=[];t.l<n;)i.push(H2(t));if(t.l!==n)throw new Error("MulRK read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:i}}function nP(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),i=[];t.l<n;)i.push(t.read_shift(2));if(t.l!==n)throw new Error("MulBlank read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:i}}function rP(t,e,n,r){var a={},i=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(4),d=t.read_shift(2);return a.patternType=eL[c>>26],r.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=d&127,a.icvBack=d>>7&127,a.fsxButton=d>>14&1),a}function aP(t,e,n){var r={};return r.ifnt=t.read_shift(2),r.numFmtId=t.read_shift(2),r.flags=t.read_shift(2),r.fStyle=r.flags>>2&1,e-=6,r.data=rP(t,e,r.fStyle,n),r}function sP(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function iT(t,e,n){var r=Ma(t);(n.biff==2||e==9)&&++t.l;var a=TL(t);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function iP(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=Ma(t),a=Wn(t);return r.val=a,r}var oT=NL;function oP(t,e,n){var r=t.l+e,a=t.read_shift(2),i=t.read_shift(2);if(n.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Ci(t,i),c=[];r>t.l;)c.push(qc(t));return[i,a,l,c]}function lT(t,e,n){var r=t.read_shift(2),a,i={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(a=DL(t,e-2,n)),i.body=a||t.read_shift(e-2),typeof a=="string"&&(i.Name=a),i}var lP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function cT(t,e,n){var r=t.l+e,a=t.read_shift(2),i=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(n&&n.biff==2?1:2),d=0;(!n||n.biff>=5)&&(n.biff!=5&&(t.l+=2),d=t.read_shift(2),n.biff==5&&(t.l+=2),t.l+=4);var f=Ci(t,l,n);a&32&&(f=lP[f.charCodeAt(0)]);var g=r-t.l;n&&n.biff==2&&--g;var y=r==t.l||c===0||!(g>0)?[]:G9(t,g,n,c);return{chKey:i,Name:f,itab:d,rgce:y}}function z2(t,e,n){if(n.biff<8)return cP(t,e,n);for(var r=[],a=t.l+e,i=t.read_shift(n.biff>8?4:2);i--!==0;)r.push(RL(t,n.biff>8?12:6,n));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return r}function cP(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=zc(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function uP(t,e,n){if(n.biff<8){t.l+=e;return}var r=t.read_shift(2),a=t.read_shift(2),i=Ci(t,r,n),l=Ci(t,a,n);return[i,l]}function fP(t,e,n){var r=G2(t);t.l++;var a=t.read_shift(1);return e-=8,[$9(t,e,n),a,r]}function uT(t,e,n){var r=ML(t);switch(n.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[r,V9(t,e,n)]}function dP(t){var e=t.read_shift(4)!==0,n=t.read_shift(4)!==0,r=t.read_shift(4);return[e,n,r]}function hP(t,e,n){if(!(n.biff<8)){var r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=Fi(t,0,n);return n.biff<8&&t.read_shift(1),[{r,c:a},c,l,i]}}function mP(t,e,n){return hP(t,e,n)}function pP(t,e){for(var n=[],r=t.read_shift(2);r--;)n.push(od(t));return n}function gP(t,e,n){if(n&&n.biff<8)return vP(t,e,n);var r=$2(t),a=LL(t,e-22,r[1]);return{cmo:r,ft:a}}var xP={8:function(t,e){var n=t.l+e;t.l+=10;var r=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=n,{fmt:r}}};function vP(t,e,n){t.l+=4;var r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((xP[r]||Qn)(t,e,n)),{cmo:[a,r,i],ft:l}}function yP(t,e,n){var r=t.l,a="";try{t.l+=4;var i=(n.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:l=EL(t,6,n);var c=t.read_shift(2);t.read_shift(2),_n(t,2);var d=t.read_shift(2);t.l+=d;for(var f=1;f<t.lens.length-1;++f){if(t.l-r!=t.lens[f])throw new Error("TxO: bad continue record");var g=t[t.l],y=Ci(t,t.lens[f+1]-t.lens[f]-1);if(a+=y,a.length>=(g?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return t.l=r+e,{t:a}}catch{return t.l=r+e,{t:a}}}function _P(t,e){var n=od(t);t.l+=16;var r=AL(t,e-24);return[n,r]}function TP(t,e){t.read_shift(2);var n=od(t),r=t.read_shift((e-10)/2,"dbcs-cont");return r=r.replace(ir,""),[n,r]}function wP(t){var e=[0,0],n;return n=t.read_shift(2),e[0]=Q_[n]||n,n=t.read_shift(2),e[1]=Q_[n]||n,e}function EP(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(V2(t));return n}function SP(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(V2(t));return n}function bP(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function q2(t,e,n){if(!n.cellStyles)return Qn(t,e);var r=n&&n.biff>=12?4:2,a=t.read_shift(r),i=t.read_shift(r),l=t.read_shift(r),c=t.read_shift(r),d=t.read_shift(2);r==2&&(t.l+=2);var f={s:a,e:i,w:l,ixfe:c,flags:d};return(n.biff>=5||!n.biff)&&(f.level=d>>8&7),f}function CP(t,e){var n={};return e<32||(t.l+=16,n.header=Wn(t),n.footer=Wn(t),t.l+=2),n}function AP(t,e,n){var r={area:!1};if(n.biff!=5)return t.l+=e,r;var a=t.read_shift(1);return t.l+=3,a&16&&(r.area=!0),r}var kP=Ma,NP=B2,RP=qc;function DP(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a={fmt:e,env:n,len:r,data:t.slice(t.l,t.l+r)};return t.l+=r,a}function MP(t,e,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=Ma(t);++t.l;var a=Fi(t,e-7,n);return r.t="str",r.val=a,r}function IP(t){var e=Ma(t);++t.l;var n=Wn(t);return e.t="n",e.val=n,e}function FP(t){var e=Ma(t);++t.l;var n=t.read_shift(2);return e.t="n",e.val=n,e}function OP(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function LP(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function PP(t,e,n){var r=t.l+e,a=Ma(t),i=t.read_shift(2),l=Ci(t,i,n);return t.l=r,a.t="str",a.val=l,a}var UP=[2,3,48,49,131,139,140,245],fT=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Xm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(c,d){var f=[],g=js(1);switch(d.type){case"base64":g=ua(Nr(c));break;case"binary":g=ua(c);break;case"buffer":case"array":g=c;break}jn(g,0);var y=g.read_shift(1),T=!!(y&136),w=!1,E=!1;switch(y){case 2:break;case 3:break;case 48:w=!0,T=!0;break;case 49:w=!0,T=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var S=0,b=521;y==2&&(S=g.read_shift(2)),g.l+=3,y!=2&&(S=g.read_shift(4)),S>1048576&&(S=1e6),y!=2&&(b=g.read_shift(2));var N=g.read_shift(2),k=d.codepage||1252;y!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(k=t[g[g.l]]),g.l+=1,g.l+=2),E&&(g.l+=36);for(var C=[],P={},j=Math.min(g.length,y==2?521:b-10-(w?264:0)),H=E?32:11;g.l<j&&g[g.l]!=13;)switch(P={},P.name=Mc.utils.decode(k,g.slice(g.l,g.l+H)).replace(/[\u0000\r\n].*$/g,""),g.l+=H,P.type=String.fromCharCode(g.read_shift(1)),y!=2&&!E&&(P.offset=g.read_shift(4)),P.len=g.read_shift(1),y==2&&(P.offset=g.read_shift(2)),P.dec=g.read_shift(1),P.name.length&&C.push(P),y!=2&&(g.l+=E?13:14),P.type){case"B":(!w||P.len!=8)&&d.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(g[g.l]!==13&&(g.l=b-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=b;var L=0,K=0;for(f[0]=[],K=0;K!=C.length;++K)f[0][K]=C[K].name;for(;S-- >0;){if(g[g.l]===42){g.l+=N;continue}for(++g.l,f[++L]=[],K=0,K=0;K!=C.length;++K){var M=g.slice(g.l,g.l+C[K].len);g.l+=C[K].len,jn(M,0);var Q=Mc.utils.decode(k,M);switch(C[K].type){case"C":Q.trim().length&&(f[L][K]=Q.replace(/\s+$/,""));break;case"D":Q.length===8?f[L][K]=new Date(+Q.slice(0,4),+Q.slice(4,6)-1,+Q.slice(6,8)):f[L][K]=Q;break;case"F":f[L][K]=parseFloat(Q.trim());break;case"+":case"I":f[L][K]=E?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(Q.trim().toUpperCase()){case"Y":case"T":f[L][K]=!0;break;case"N":case"F":f[L][K]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Q+"|")}break;case"M":if(!T)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));f[L][K]="##MEMO##"+(E?parseInt(Q.trim(),10):M.read_shift(4));break;case"N":Q=Q.replace(/\u0000/g,"").trim(),Q&&Q!="."&&(f[L][K]=+Q||0);break;case"@":f[L][K]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":f[L][K]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":f[L][K]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[L][K]=-M.read_shift(-8,"f");break;case"B":if(w&&C[K].len==8){f[L][K]=M.read_shift(8,"f");break}case"G":case"P":M.l+=C[K].len;break;case"0":if(C[K].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[K].type)}}}if(y!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=C,f}function r(c,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var g=rl(n(c,f),f);return g["!cols"]=f.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete f.DBF,g}function a(c,d){try{return $s(r(c,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,d){var f=d||{};if(+f.codepage>=0&&fa(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var g=mm(),y=Sm(c,{header:1,raw:!0,cellDates:!0}),T=y[0],w=y.slice(1),E=c["!cols"]||[],S=0,b=0,N=0,k=1;for(S=0;S<T.length;++S){if(((E[S]||{}).DBF||{}).name){T[S]=E[S].DBF.name,++N;continue}if(T[S]!=null){if(++N,typeof T[S]=="number"&&(T[S]=T[S].toString(10)),typeof T[S]!="string")throw new Error("DBF Invalid column name "+T[S]+" |"+typeof T[S]+"|");if(T.indexOf(T[S])!==S){for(b=0;b<1024;++b)if(T.indexOf(T[S]+"_"+b)==-1){T[S]+="_"+b;break}}}}var C=sn(c["!ref"]),P=[],j=[],H=[];for(S=0;S<=C.e.c-C.s.c;++S){var L="",K="",M=0,Q=[];for(b=0;b<w.length;++b)w[b][S]!=null&&Q.push(w[b][S]);if(Q.length==0||T[S]==null){P[S]="?";continue}for(b=0;b<Q.length;++b){switch(typeof Q[b]){case"number":K="B";break;case"string":K="C";break;case"boolean":K="L";break;case"object":K=Q[b]instanceof Date?"D":"C";break;default:K="C"}M=Math.max(M,String(Q[b]).length),L=L&&L!=K?"C":K}M>250&&(M=250),K=((E[S]||{}).DBF||{}).type,K=="C"&&E[S].DBF.len>M&&(M=E[S].DBF.len),L=="B"&&K=="N"&&(L="N",H[S]=E[S].DBF.dec,M=E[S].DBF.len),j[S]=L=="C"||K=="N"?M:i[L]||0,k+=j[S],P[S]=L}var X=g.next(32);for(X.write_shift(4,318902576),X.write_shift(4,w.length),X.write_shift(2,296+32*N),X.write_shift(2,k),S=0;S<4;++S)X.write_shift(4,0);for(X.write_shift(4,0|(+e[zw]||3)<<8),S=0,b=0;S<T.length;++S)if(T[S]!=null){var ee=g.next(32),ye=(T[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ee.write_shift(1,ye,"sbcs"),ee.write_shift(1,P[S]=="?"?"C":P[S],"sbcs"),ee.write_shift(4,b),ee.write_shift(1,j[S]||i[P[S]]||0),ee.write_shift(1,H[S]||0),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(1,0),ee.write_shift(4,0),ee.write_shift(4,0),b+=j[S]||i[P[S]]||0}var Ie=g.next(264);for(Ie.write_shift(4,13),S=0;S<65;++S)Ie.write_shift(4,0);for(S=0;S<w.length;++S){var Te=g.next(k);for(Te.write_shift(1,0),b=0;b<T.length;++b)if(T[b]!=null)switch(P[b]){case"L":Te.write_shift(1,w[S][b]==null?63:w[S][b]?84:70);break;case"B":Te.write_shift(8,w[S][b]||0,"f");break;case"N":var re="0";for(typeof w[S][b]=="number"&&(re=w[S][b].toFixed(H[b]||0)),N=0;N<j[b]-re.length;++N)Te.write_shift(1,32);Te.write_shift(1,re,"sbcs");break;case"D":w[S][b]?(Te.write_shift(4,("0000"+w[S][b].getFullYear()).slice(-4),"sbcs"),Te.write_shift(2,("00"+(w[S][b].getMonth()+1)).slice(-2),"sbcs"),Te.write_shift(2,("00"+w[S][b].getDate()).slice(-2),"sbcs")):Te.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(w[S][b]!=null?w[S][b]:"").slice(0,j[b]);for(Te.write_shift(1,ue,"sbcs"),N=0;N<j[b]-ue.length;++N)Te.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}}(),BP=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ra(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(T,w){var E=t[w];return typeof E=="number"?A_(E):E},r=function(T,w,E){var S=w.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return S==59?T:A_(S)};t["|"]=254;function a(T,w){switch(w.type){case"base64":return i(Nr(T),w);case"binary":return i(T,w);case"buffer":return i(wt&&Buffer.isBuffer(T)?T.toString("binary"):Ri(T),w);case"array":return i(bi(T),w)}throw new Error("Unrecognized type "+w.type)}function i(T,w){var E=T.split(/[\n\r]+/),S=-1,b=-1,N=0,k=0,C=[],P=[],j=null,H={},L=[],K=[],M=[],Q=0,X;for(+w.codepage>=0&&fa(+w.codepage);N!==E.length;++N){Q=0;var ee=E[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),ye=ee.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),Ie=ye[0],Te;if(ee.length>0)switch(Ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ye[1].charAt(0)=="P"&&P.push(ee.slice(3).replace(/;;/g,";"));break;case"C":var re=!1,ue=!1,ne=!1,W=!1,U=-1,G=-1;for(k=1;k<ye.length;++k)switch(ye[k].charAt(0)){case"A":break;case"X":b=parseInt(ye[k].slice(1))-1,ue=!0;break;case"Y":for(S=parseInt(ye[k].slice(1))-1,ue||(b=0),X=C.length;X<=S;++X)C[X]=[];break;case"K":Te=ye[k].slice(1),Te.charAt(0)==='"'?Te=Te.slice(1,Te.length-1):Te==="TRUE"?Te=!0:Te==="FALSE"?Te=!1:isNaN(ma(Te))?isNaN(Jo(Te).getDate())||(Te=Ln(Te)):(Te=ma(Te),j!==null&&tl(j)&&(Te=id(Te))),re=!0;break;case"E":W=!0;var R=Po(ye[k].slice(1),{r:S,c:b});C[S][b]=[C[S][b],R];break;case"S":ne=!0,C[S][b]=[C[S][b],"S5S"];break;case"G":break;case"R":U=parseInt(ye[k].slice(1))-1;break;case"C":G=parseInt(ye[k].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+ee)}if(re&&(C[S][b]&&C[S][b].length==2?C[S][b][0]=Te:C[S][b]=Te,j=null),ne){if(W)throw new Error("SYLK shared formula cannot have own formula");var z=U>-1&&C[U][G];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");C[S][b][1]=nE(z[1],{r:S-U,c:b-G})}break;case"F":var J=0;for(k=1;k<ye.length;++k)switch(ye[k].charAt(0)){case"X":b=parseInt(ye[k].slice(1))-1,++J;break;case"Y":for(S=parseInt(ye[k].slice(1))-1,X=C.length;X<=S;++X)C[X]=[];break;case"M":Q=parseInt(ye[k].slice(1))/20;break;case"F":break;case"G":break;case"P":j=P[parseInt(ye[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=ye[k].slice(1).split(" "),X=parseInt(M[0],10);X<=parseInt(M[1],10);++X)Q=parseInt(M[2],10),K[X-1]=Q===0?{hidden:!0}:{wch:Q},Wo(K[X-1]);break;case"C":b=parseInt(ye[k].slice(1))-1,K[b]||(K[b]={});break;case"R":S=parseInt(ye[k].slice(1))-1,L[S]||(L[S]={}),Q>0?(L[S].hpt=Q,L[S].hpx=Uc(Q)):Q===0&&(L[S].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+ee)}J<1&&(j=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+ee)}}return L.length>0&&(H["!rows"]=L),K.length>0&&(H["!cols"]=K),w&&w.sheetRows&&(C=C.slice(0,w.sheetRows)),[C,H]}function l(T,w){var E=a(T,w),S=E[0],b=E[1],N=rl(S,w);return Ra(b).forEach(function(k){N[k]=b[k]}),N}function c(T,w){return $s(l(T,w),w)}function d(T,w,E,S){var b="C;Y"+(E+1)+";X"+(S+1)+";K";switch(T.t){case"n":b+=T.v||0,T.f&&!T.F&&(b+=";E"+b7(T.f,{r:E,c:S}));break;case"b":b+=T.v?"TRUE":"FALSE";break;case"e":b+=T.w||T.v;break;case"d":b+='"'+(T.w||T.v)+'"';break;case"s":b+='"'+T.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function f(T,w){w.forEach(function(E,S){var b="F;W"+(S+1)+" "+(S+1)+" ";E.hidden?b+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=Yf(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=Jf(E.wpx)),typeof E.wch=="number"&&(b+=Math.round(E.wch))),b.charAt(b.length-1)!=" "&&T.push(b)})}function g(T,w){w.forEach(function(E,S){var b="F;";E.hidden?b+="M0;":E.hpt?b+="M"+20*E.hpt+";":E.hpx&&(b+="M"+20*Q2(E.hpx)+";"),b.length>2&&T.push(b+"R"+(S+1))})}function y(T,w){var E=["ID;PWXL;N;E"],S=[],b=sn(T["!ref"]),N,k=Array.isArray(T),C=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),T["!cols"]&&f(E,T["!cols"]),T["!rows"]&&g(E,T["!rows"]),E.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var P=b.s.r;P<=b.e.r;++P)for(var j=b.s.c;j<=b.e.c;++j){var H=st({r:P,c:j});N=k?(T[P]||[])[j]:T[H],!(!N||N.v==null&&(!N.f||N.F))&&S.push(d(N,T,P,j))}return E.join(C)+C+S.join(C)+C+"E"+C}return{to_workbook:c,to_sheet:l,from_sheet:y}}(),jP=function(){function t(i,l){switch(l.type){case"base64":return e(Nr(i),l);case"binary":return e(i,l);case"buffer":return e(wt&&Buffer.isBuffer(i)?i.toString("binary"):Ri(i),l);case"array":return e(bi(i),l)}throw new Error("Unrecognized type "+l.type)}function e(i,l){for(var c=i.split(`
`),d=-1,f=-1,g=0,y=[];g!==c.length;++g){if(c[g].trim()==="BOT"){y[++d]=[],f=0;continue}if(!(d<0)){var T=c[g].trim().split(","),w=T[0],E=T[1];++g;for(var S=c[g]||"";(S.match(/["]/g)||[]).length&1&&g<c.length-1;)S+=`
`+c[++g];switch(S=S.trim(),+w){case-1:if(S==="BOT"){y[++d]=[],f=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?y[d][f]=!0:S==="FALSE"?y[d][f]=!1:isNaN(ma(E))?isNaN(Jo(E).getDate())?y[d][f]=E:y[d][f]=Ln(E):y[d][f]=ma(E),++f;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),y[d][f++]=S!==""?S:null;break}if(S==="EOD")break}}return l&&l.sheetRows&&(y=y.slice(0,l.sheetRows)),y}function n(i,l){return rl(t(i,l),l)}function r(i,l){return $s(n(i,l),l)}var a=function(){var i=function(d,f,g,y,T){d.push(f),d.push(g+","+y),d.push('"'+T.replace(/"/g,'""')+'"')},l=function(d,f,g,y){d.push(f+","+g),d.push(f==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(d){var f=[],g=sn(d["!ref"]),y,T=Array.isArray(d);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,g.e.r-g.s.r+1,""),i(f,"TUPLES",0,g.e.c-g.s.c+1,""),i(f,"DATA",0,0,"");for(var w=g.s.r;w<=g.e.r;++w){l(f,-1,0,"BOT");for(var E=g.s.c;E<=g.e.c;++E){var S=st({r:w,c:E});if(y=T?(d[w]||[])[E]:d[S],!y){l(f,1,0,"");continue}switch(y.t){case"n":var b=y.w;!b&&y.v!=null&&(b=y.v),b==null?y.f&&!y.F?l(f,1,0,"="+y.f):l(f,1,0,""):l(f,0,b,"V");break;case"b":l(f,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=Wr(y.z||ut[14],lr(Ln(y.v)))),l(f,0,y.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var N=`\r
`,k=f.join(N);return k}}();return{to_workbook:r,to_sheet:n,from_sheet:a}}(),VP=function(){function t(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(y,T){for(var w=y.split(`
`),E=-1,S=-1,b=0,N=[];b!==w.length;++b){var k=w[b].trim().split(":");if(k[0]==="cell"){var C=sr(k[1]);if(N.length<=C.r)for(E=N.length;E<=C.r;++E)N[E]||(N[E]=[]);switch(E=C.r,S=C.c,k[2]){case"t":N[E][S]=t(k[3]);break;case"v":N[E][S]=+k[3];break;case"vtf":var P=k[k.length-1];case"vtc":switch(k[3]){case"nl":N[E][S]=!!+k[4];break;default:N[E][S]=+k[4];break}k[2]=="vtf"&&(N[E][S]=[N[E][S],P])}}}return T&&T.sheetRows&&(N=N.slice(0,T.sheetRows)),N}function r(y,T){return rl(n(y,T),T)}function a(y,T){return $s(r(y,T),T)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(y){if(!y||!y["!ref"])return"";for(var T=[],w=[],E,S="",b=nl(y["!ref"]),N=Array.isArray(y),k=b.s.r;k<=b.e.r;++k)for(var C=b.s.c;C<=b.e.c;++C)if(S=st({r:k,c:C}),E=N?(y[k]||[])[C]:y[S],!(!E||E.v==null||E.t==="z")){switch(w=["cell",S,"t"],E.t){case"s":case"str":w.push(e(E.v));break;case"n":E.f?(w[2]="vtf",w[3]="n",w[4]=E.v,w[5]=e(E.f)):(w[2]="v",w[3]=E.v);break;case"b":w[2]="vt"+(E.f?"f":"c"),w[3]="nl",w[4]=E.v?"1":"0",w[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var P=lr(Ln(E.v));w[2]="vtc",w[3]="nd",w[4]=""+P,w[5]=E.w||Wr(E.z||ut[14],P);break;case"e":continue}T.push(w.join(":"))}return T.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),T.push("valueformat:1:text-wiki"),T.join(`
`)}function g(y){return[i,l,c,l,f(y),d].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:g}}(),Lc=function(){function t(g,y,T,w,E){E.raw?y[T][w]=g:g===""||(g==="TRUE"?y[T][w]=!0:g==="FALSE"?y[T][w]=!1:isNaN(ma(g))?isNaN(Jo(g).getDate())?y[T][w]=g:y[T][w]=Ln(g):y[T][w]=ma(g))}function e(g,y){var T=y||{},w=[];if(!g||g.length===0)return w;for(var E=g.split(/[\r\n]/),S=E.length-1;S>=0&&E[S].length===0;)--S;for(var b=10,N=0,k=0;k<=S;++k)N=E[k].indexOf(" "),N==-1?N=E[k].length:N++,b=Math.max(b,N);for(k=0;k<=S;++k){w[k]=[];var C=0;for(t(E[k].slice(0,b).trim(),w,k,C,T),C=1;C<=(E[k].length-b)/10+1;++C)t(E[k].slice(b+(C-1)*10,b+C*10).trim(),w,k,C,T)}return T.sheetRows&&(w=w.slice(0,T.sheetRows)),w}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(g){for(var y={},T=!1,w=0,E=0;w<g.length;++w)(E=g.charCodeAt(w))==34?T=!T:!T&&E in n&&(y[E]=(y[E]||0)+1);E=[];for(w in y)Object.prototype.hasOwnProperty.call(y,w)&&E.push([y[w],w]);if(!E.length){y=r;for(w in y)Object.prototype.hasOwnProperty.call(y,w)&&E.push([y[w],w])}return E.sort(function(S,b){return S[0]-b[0]||r[S[1]]-r[b[1]]}),n[E.pop()[1]]||44}function i(g,y){var T=y||{},w="",E=T.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(w=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(w=g.charAt(4),g=g.slice(6)):w=a(g.slice(0,1024)):T&&T.FS?w=T.FS:w=a(g.slice(0,1024));var b=0,N=0,k=0,C=0,P=0,j=w.charCodeAt(0),H=!1,L=0,K=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var M=T.dateNF!=null?Z8(T.dateNF):null;function Q(){var X=g.slice(C,P),ee={};if(X.charAt(0)=='"'&&X.charAt(X.length-1)=='"'&&(X=X.slice(1,-1).replace(/""/g,'"')),X.length===0)ee.t="z";else if(T.raw)ee.t="s",ee.v=X;else if(X.trim().length===0)ee.t="s",ee.v=X;else if(X.charCodeAt(0)==61)X.charCodeAt(1)==34&&X.charCodeAt(X.length-1)==34?(ee.t="s",ee.v=X.slice(2,-1).replace(/""/g,'"')):A7(X)?(ee.t="n",ee.f=X.slice(1)):(ee.t="s",ee.v=X);else if(X=="TRUE")ee.t="b",ee.v=!0;else if(X=="FALSE")ee.t="b",ee.v=!1;else if(!isNaN(k=ma(X)))ee.t="n",T.cellText!==!1&&(ee.w=X),ee.v=k;else if(!isNaN(Jo(X).getDate())||M&&X.match(M)){ee.z=T.dateNF||ut[14];var ye=0;M&&X.match(M)&&(X=Q8(X,T.dateNF,X.match(M)||[]),ye=1),T.cellDates?(ee.t="d",ee.v=Ln(X,ye)):(ee.t="n",ee.v=lr(Ln(X,ye))),T.cellText!==!1&&(ee.w=Wr(ee.z,ee.v instanceof Date?lr(ee.v):ee.v)),T.cellNF||delete ee.z}else ee.t="s",ee.v=X;if(ee.t=="z"||(T.dense?(E[b]||(E[b]=[]),E[b][N]=ee):E[st({c:N,r:b})]=ee),C=P+1,K=g.charCodeAt(C),S.e.c<N&&(S.e.c=N),S.e.r<b&&(S.e.r=b),L==j)++N;else if(N=0,++b,T.sheetRows&&T.sheetRows<=b)return!0}e:for(;P<g.length;++P)switch(L=g.charCodeAt(P)){case 34:K===34&&(H=!H);break;case j:case 10:case 13:if(!H&&Q())break e;break}return P-C>0&&Q(),E["!ref"]=At(S),E}function l(g,y){return!(y&&y.PRN)||y.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?i(g,y):rl(e(g,y),y)}function c(g,y){var T="",w=y.type=="string"?[0,0,0,0]:gp(g,y);switch(y.type){case"base64":T=Nr(g);break;case"binary":T=g;break;case"buffer":y.codepage==65001?T=g.toString("utf8"):y.codepage&&typeof Mc<"u"||(T=wt&&Buffer.isBuffer(g)?g.toString("binary"):Ri(g));break;case"array":T=bi(g);break;case"string":T=g;break;default:throw new Error("Unrecognized type "+y.type)}return w[0]==239&&w[1]==187&&w[2]==191?T=Wt(T.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?T=Wt(T):y.type=="binary"&&typeof Mc<"u",T.slice(0,19)=="socialcalc:version:"?VP.to_sheet(y.type=="string"?T:Wt(T),y):l(T,y)}function d(g,y){return $s(c(g,y),y)}function f(g){for(var y=[],T=sn(g["!ref"]),w,E=Array.isArray(g),S=T.s.r;S<=T.e.r;++S){for(var b=[],N=T.s.c;N<=T.e.c;++N){var k=st({r:S,c:N});if(w=E?(g[S]||[])[N]:g[k],!w||w.v==null){b.push("          ");continue}for(var C=(w.w||(ts(w),w.w)||"").slice(0,10);C.length<10;)C+=" ";b.push(C+(N===0?" ":""))}y.push(b.join(""))}return y.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:f}}();function HP(t,e){var n=e||{},r=!!n.WTF;n.WTF=!0;try{var a=BP.to_workbook(t,n);return n.WTF=r,a}catch(i){if(n.WTF=r,!i.message.match(/SYLK bad record ID/)&&r)throw i;return Lc.to_workbook(t,e)}}var wc=function(){function t(R,z,J){if(R){jn(R,R.l||0);for(var q=J.Enum||U;R.l<R.length;){var ie=R.read_shift(2),we=q[ie]||q[65535],_e=R.read_shift(2),ke=R.l+_e,Ce=we.f&&we.f(R,_e,J);if(R.l=ke,z(Ce,we,ie))return}}}function e(R,z){switch(z.type){case"base64":return n(ua(Nr(R)),z);case"binary":return n(ua(R),z);case"buffer":case"array":return n(R,z)}throw"Unsupported type "+z.type}function n(R,z){if(!R)return R;var J=z||{},q=J.dense?[]:{},ie="Sheet1",we="",_e=0,ke={},Ce=[],He=[],Z={s:{r:0,c:0},e:{r:0,c:0}},yt=J.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)J.Enum=U,t(R,function(Re,Dt,$t){switch($t){case 0:J.vers=Re,Re>=4096&&(J.qpro=!0);break;case 6:Z=Re;break;case 204:Re&&(we=Re);break;case 222:we=Re;break;case 15:case 51:J.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:$t==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=J.dateNF||ut[14],J.cellDates&&(Re[1].t="d",Re[1].v=id(Re[1].v))),J.qpro&&Re[3]>_e&&(q["!ref"]=At(Z),ke[ie]=q,Ce.push(ie),q=J.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},_e=Re[3],ie=we||"Sheet"+(_e+1),we="");var dn=J.dense?(q[Re[0].r]||[])[Re[0].c]:q[st(Re[0])];if(dn){dn.t=Re[1].t,dn.v=Re[1].v,Re[1].z!=null&&(dn.z=Re[1].z),Re[1].f!=null&&(dn.f=Re[1].f);break}J.dense?(q[Re[0].r]||(q[Re[0].r]=[]),q[Re[0].r][Re[0].c]=Re[1]):q[st(Re[0])]=Re[1];break}},J);else if(R[2]==26||R[2]==14)J.Enum=G,R[2]==14&&(J.qpro=!0,R.l=0),t(R,function(Re,Dt,$t){switch($t){case 204:ie=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>_e&&(q["!ref"]=At(Z),ke[ie]=q,Ce.push(ie),q=J.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},_e=Re[3],ie="Sheet"+(_e+1)),yt>0&&Re[0].r>=yt)break;J.dense?(q[Re[0].r]||(q[Re[0].r]=[]),q[Re[0].r][Re[0].c]=Re[1]):q[st(Re[0])]=Re[1],Z.e.c<Re[0].c&&(Z.e.c=Re[0].c),Z.e.r<Re[0].r&&(Z.e.r=Re[0].r);break;case 27:Re[14e3]&&(He[Re[14e3][0]]=Re[14e3][1]);break;case 1537:He[Re[0]]=Re[1],Re[0]==_e&&(ie=Re[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(q["!ref"]=At(Z),ke[we||ie]=q,Ce.push(we||ie),!He.length)return{SheetNames:Ce,Sheets:ke};for(var qe={},it=[],rt=0;rt<He.length;++rt)ke[Ce[rt]]?(it.push(He[rt]||Ce[rt]),qe[He[rt]]=ke[He[rt]]||ke[Ce[rt]]):(it.push(He[rt]),qe[He[rt]]={"!ref":"A1"});return{SheetNames:it,Sheets:qe}}function r(R,z){var J=z||{};if(+J.codepage>=0&&fa(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var q=mm(),ie=sn(R["!ref"]),we=Array.isArray(R),_e=[];oa(q,0,i(1030)),oa(q,6,d(ie));for(var ke=Math.min(ie.e.r,8191),Ce=ie.s.r;Ce<=ke;++Ce)for(var He=Hn(Ce),Z=ie.s.c;Z<=ie.e.c;++Z){Ce===ie.s.r&&(_e[Z]=An(Z));var yt=_e[Z]+He,qe=we?(R[Ce]||[])[Z]:R[yt];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?oa(q,13,w(Ce,Z,qe.v)):oa(q,14,S(Ce,Z,qe.v));else{var it=ts(qe);oa(q,15,y(Ce,Z,it.slice(0,239)))}}return oa(q,1),q.end()}function a(R,z){var J=z||{};if(+J.codepage>=0&&fa(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var q=mm();oa(q,0,l(R));for(var ie=0,we=0;ie<R.SheetNames.length;++ie)(R.Sheets[R.SheetNames[ie]]||{})["!ref"]&&oa(q,27,W(R.SheetNames[ie],we++));var _e=0;for(ie=0;ie<R.SheetNames.length;++ie){var ke=R.Sheets[R.SheetNames[ie]];if(!(!ke||!ke["!ref"])){for(var Ce=sn(ke["!ref"]),He=Array.isArray(ke),Z=[],yt=Math.min(Ce.e.r,8191),qe=Ce.s.r;qe<=yt;++qe)for(var it=Hn(qe),rt=Ce.s.c;rt<=Ce.e.c;++rt){qe===Ce.s.r&&(Z[rt]=An(rt));var Re=Z[rt]+it,Dt=He?(ke[qe]||[])[rt]:ke[Re];if(!(!Dt||Dt.t=="z"))if(Dt.t=="n")oa(q,23,Q(qe,rt,_e,Dt.v));else{var $t=ts(Dt);oa(q,22,L(qe,rt,_e,$t.slice(0,239)))}}++_e}}return oa(q,1),q.end()}function i(R){var z=bn(2);return z.write_shift(2,R),z}function l(R){var z=bn(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var J=0,q=0,ie=0,we=0;we<R.SheetNames.length;++we){var _e=R.SheetNames[we],ke=R.Sheets[_e];if(!(!ke||!ke["!ref"])){++ie;var Ce=nl(ke["!ref"]);J<Ce.e.r&&(J=Ce.e.r),q<Ce.e.c&&(q=Ce.e.c)}}return J>8191&&(J=8191),z.write_shift(2,J),z.write_shift(1,ie),z.write_shift(1,q),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function c(R,z,J){var q={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&J.qpro?(q.s.c=R.read_shift(1),R.l++,q.s.r=R.read_shift(2),q.e.c=R.read_shift(1),R.l++,q.e.r=R.read_shift(2),q):(q.s.c=R.read_shift(2),q.s.r=R.read_shift(2),z==12&&J.qpro&&(R.l+=2),q.e.c=R.read_shift(2),q.e.r=R.read_shift(2),z==12&&J.qpro&&(R.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function d(R){var z=bn(8);return z.write_shift(2,R.s.c),z.write_shift(2,R.s.r),z.write_shift(2,R.e.c),z.write_shift(2,R.e.r),z}function f(R,z,J){var q=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(q[0].c=R.read_shift(1),q[3]=R.read_shift(1),q[0].r=R.read_shift(2),R.l+=2):(q[2]=R.read_shift(1),q[0].c=R.read_shift(2),q[0].r=R.read_shift(2)),q}function g(R,z,J){var q=R.l+z,ie=f(R,z,J);if(ie[1].t="s",J.vers==20768){R.l++;var we=R.read_shift(1);return ie[1].v=R.read_shift(we,"utf8"),ie}return J.qpro&&R.l++,ie[1].v=R.read_shift(q-R.l,"cstr"),ie}function y(R,z,J){var q=bn(7+J.length);q.write_shift(1,255),q.write_shift(2,z),q.write_shift(2,R),q.write_shift(1,39);for(var ie=0;ie<q.length;++ie){var we=J.charCodeAt(ie);q.write_shift(1,we>=128?95:we)}return q.write_shift(1,0),q}function T(R,z,J){var q=f(R,z,J);return q[1].v=R.read_shift(2,"i"),q}function w(R,z,J){var q=bn(7);return q.write_shift(1,255),q.write_shift(2,z),q.write_shift(2,R),q.write_shift(2,J,"i"),q}function E(R,z,J){var q=f(R,z,J);return q[1].v=R.read_shift(8,"f"),q}function S(R,z,J){var q=bn(13);return q.write_shift(1,255),q.write_shift(2,z),q.write_shift(2,R),q.write_shift(8,J,"f"),q}function b(R,z,J){var q=R.l+z,ie=f(R,z,J);if(ie[1].v=R.read_shift(8,"f"),J.qpro)R.l=q;else{var we=R.read_shift(2);P(R.slice(R.l,R.l+we),ie),R.l+=we}return ie}function N(R,z,J){var q=z&32768;return z&=-32769,z=(q?R:0)+(z>=8192?z-16384:z),(q?"":"$")+(J?An(z):Hn(z))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(R,z){jn(R,0);for(var J=[],q=0,ie="",we="",_e="",ke="";R.l<R.length;){var Ce=R[R.l++];switch(Ce){case 0:J.push(R.read_shift(8,"f"));break;case 1:we=N(z[0].c,R.read_shift(2),!0),ie=N(z[0].r,R.read_shift(2),!1),J.push(we+ie);break;case 2:{var He=N(z[0].c,R.read_shift(2),!0),Z=N(z[0].r,R.read_shift(2),!1);we=N(z[0].c,R.read_shift(2),!0),ie=N(z[0].r,R.read_shift(2),!1),J.push(He+Z+":"+we+ie)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(R.read_shift(2));break;case 6:{for(var yt="";Ce=R[R.l++];)yt+=String.fromCharCode(Ce);J.push('"'+yt.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:ke=J.pop(),_e=J.pop(),J.push(["AND","OR"][Ce-20]+"("+_e+","+ke+")");break;default:if(Ce<32&&C[Ce])ke=J.pop(),_e=J.pop(),J.push(_e+C[Ce]+ke);else if(k[Ce]){if(q=k[Ce][1],q==69&&(q=R[R.l++]),q>J.length){console.error("WK1 bad formula parse 0x"+Ce.toString(16)+":|"+J.join("|")+"|");return}var qe=J.slice(-q);J.length-=q,J.push(k[Ce][0]+"("+qe.join(",")+")")}else return Ce<=7?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=24?console.error("WK1 unsupported op "+Ce.toString(16)):Ce<=30?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=115?console.error("WK1 unsupported function opcode "+Ce.toString(16)):console.error("WK1 unrecognized opcode "+Ce.toString(16))}}J.length==1?z[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function j(R){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=R.read_shift(2),z[3]=R[R.l++],z[0].c=R[R.l++],z}function H(R,z){var J=j(R);return J[1].t="s",J[1].v=R.read_shift(z-4,"cstr"),J}function L(R,z,J,q){var ie=bn(6+q.length);ie.write_shift(2,R),ie.write_shift(1,J),ie.write_shift(1,z),ie.write_shift(1,39);for(var we=0;we<q.length;++we){var _e=q.charCodeAt(we);ie.write_shift(1,_e>=128?95:_e)}return ie.write_shift(1,0),ie}function K(R,z){var J=j(R);J[1].v=R.read_shift(2);var q=J[1].v>>1;if(J[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return J[1].v=q,J}function M(R,z){var J=j(R),q=R.read_shift(4),ie=R.read_shift(4),we=R.read_shift(2);if(we==65535)return q===0&&ie===3221225472?(J[1].t="e",J[1].v=15):q===0&&ie===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var _e=we&32768;return we=(we&32767)-16446,J[1].v=(1-_e*2)*(ie*Math.pow(2,we+32)+q*Math.pow(2,we)),J}function Q(R,z,J,q){var ie=bn(14);if(ie.write_shift(2,R),ie.write_shift(1,J),ie.write_shift(1,z),q==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var we=0,_e=0,ke=0,Ce=0;return q<0&&(we=1,q=-q),_e=Math.log2(q)|0,q/=Math.pow(2,_e-31),Ce=q>>>0,(Ce&2147483648)==0&&(q/=2,++_e,Ce=q>>>0),q-=Ce,Ce|=2147483648,Ce>>>=0,q*=Math.pow(2,32),ke=q>>>0,ie.write_shift(4,ke),ie.write_shift(4,Ce),_e+=16383+(we?32768:0),ie.write_shift(2,_e),ie}function X(R,z){var J=M(R);return R.l+=z-14,J}function ee(R,z){var J=j(R),q=R.read_shift(4);return J[1].v=q>>6,J}function ye(R,z){var J=j(R),q=R.read_shift(8,"f");return J[1].v=q,J}function Ie(R,z){var J=ye(R);return R.l+=z-10,J}function Te(R,z){return R[R.l+z-1]==0?R.read_shift(z,"cstr"):""}function re(R,z){var J=R[R.l++];J>z-1&&(J=z-1);for(var q="";q.length<J;)q+=String.fromCharCode(R[R.l++]);return q}function ue(R,z,J){if(!(!J.qpro||z<21)){var q=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var ie=R.read_shift(z-21,"cstr");return[q,ie]}}function ne(R,z){for(var J={},q=R.l+z;R.l<q;){var ie=R.read_shift(2);if(ie==14e3){for(J[ie]=[0,""],J[ie][0]=R.read_shift(2);R[R.l];)J[ie][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return J}function W(R,z){var J=bn(5+R.length);J.write_shift(2,14e3),J.write_shift(2,z);for(var q=0;q<R.length;++q){var ie=R.charCodeAt(q);J[J.l++]=ie>127?95:ie}return J[J.l++]=0,J}var U={0:{n:"BOF",f:_n},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:T},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Te},222:{n:"SHEETNAMELP",f:re},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:H},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:K},25:{n:"FORMULA19",f:X},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ee},38:{n:"??"},39:{n:"NUMBER27",f:ye},40:{n:"FORMULA28",f:Ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:e}}();function GP(t){var e={},n=t.match(tr),r=0,a=!1;if(n)for(;r!=n.length;++r){var i=et(n[r]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=qm[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return e}var $P=function(){var t=Fc("t"),e=Fc("rPr");function n(i){var l=i.match(t);if(!l)return{t:"s",v:""};var c={t:"s",v:kt(l[1])},d=i.match(e);return d&&(c.s=GP(d[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(n).filter(function(c){return c.v})}}(),zP=function(){var e=/(\r\n|\n)/g;function n(a,i,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),l.push("</b>")),a.i&&(i.push("<i>"),l.push("</i>")),a.strike&&(i.push("<s>"),l.push("</s>"));var d=a.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(i.push("<"+d+">"),l.push("</"+d+">")),l.push("</span>"),a}function r(a){var i=[[],a.v,[]];return a.v?(a.s&&n(a.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(r).join("")}}(),qP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,YP=/<(?:\w+:)?r>/,JP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function cp(t,e){var n=e?e.cellHTML:!0,r={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=kt(Wt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Wt(t),n&&(r.h=Qm(r.t))):t.match(YP)&&(r.r=Wt(t),r.t=kt(Wt((t.replace(JP,"").match(qP)||[]).join("").replace(tr,""))),n&&(r.h=zP($P(r.r)))),r):{t:""}}var WP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,KP=/<(?:\w+:)?(?:si|sstItem)>/g,XP=/<\/(?:\w+:)?(?:si|sstItem)>/;function ZP(t,e){var n=[],r="";if(!t)return n;var a=t.match(WP);if(a){r=a[2].replace(KP,"").split(XP);for(var i=0;i!=r.length;++i){var l=cp(r[i].trim(),e);l!=null&&(n[n.length]=l)}a=et(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}function QP(t){return[t.read_shift(4),t.read_shift(4)]}function eU(t,e){var n=[],r=!1;return as(t,function(i,l,c){switch(c){case 159:n.Count=i[0],n.Unique=i[1];break;case 19:n.push(i);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function Y2(t){for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function Za(t,e){var n={};return n.Major=t.read_shift(2),n.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),n}function tU(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Za(t,4),e.U=Za(t,4),e.W=Za(t,4),e}function nU(t){for(var e=t.read_shift(4),n=t.l+e-4,r={},a=t.read_shift(4),i=[];a-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(r.name=t.read_shift(0,"lpp4"),r.comps=i,t.l!=n)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+n);return r}function rU(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(nU(t));return e}function aU(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function sU(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Za(t,4),e.U=Za(t,4),e.W=Za(t,4),e}function iU(t){var e=sU(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function J2(t,e){var n=t.l+e,r={};r.Flags=t.read_shift(4)&63,t.l+=4,r.AlgID=t.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=t.read_shift(4),r.KeySize=t.read_shift(4),r.ProviderType=t.read_shift(4),t.l+=8,r.CSPName=t.read_shift(n-t.l>>1,"utf16le"),t.l=n,r}function W2(t,e){var n={},r=t.l+e;return t.l+=4,n.Salt=t.slice(t.l,t.l+16),t.l+=16,n.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),n.VerifierHash=t.slice(t.l,r),t.l=r,n}function oU(t){var e=Za(t);switch(e.Minor){case 2:return[e.Minor,lU(t)];case 3:return[e.Minor,cU()];case 4:return[e.Minor,uU(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function lU(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var n=t.read_shift(4),r=J2(t,n),a=W2(t,t.length-t.l);return{t:"Std",h:r,v:a}}function cU(){throw new Error("File is password-protected: ECMA-376 Extensible")}function uU(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var n=t.read_shift(t.length-t.l,"utf8"),r={};return n.replace(tr,function(i){var l=et(i);switch(Da(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function fU(t,e){var n={},r=n.EncryptionVersionInfo=Za(t,4);if(e-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,n.EncryptionHeader=J2(t,a),e-=a,n.EncryptionVerifier=W2(t,e),n}function dU(t){var e={},n=e.EncryptionVersionInfo=Za(t,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function hU(t){var e=0,n,r=Y2(t),a=r.length+1,i,l,c,d,f;for(n=js(a),n[0]=r.length,i=1;i!=a;++i)n[i]=r[i-1];for(i=a-1;i>=0;--i)l=n[i],c=(e&16384)===0?0:1,d=e<<1&32767,f=c|d,e=f^l;return e^52811}var K2=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},i=function(l){for(var c=e[l.length-1],d=104,f=l.length-1;f>=0;--f)for(var g=l[f],y=0;y!=7;++y)g&64&&(c^=n[d]),g*=2,--d;return c};return function(l){for(var c=Y2(l),d=i(c),f=c.length,g=js(16),y=0;y!=16;++y)g[y]=0;var T,w,E;for((f&1)===1&&(T=d>>8,g[f]=a(t[0],T),--f,T=d&255,w=c[c.length-1],g[f]=a(w,T));f>0;)--f,T=d>>8,g[f]=a(c[f],T),--f,T=d&255,g[f]=a(c[f],T);for(f=15,E=15-c.length;E>0;)T=d>>8,g[f]=a(t[E],T),--f,--E,T=d&255,g[f]=a(c[f],T),--f,--E;return g}}(),mU=function(t,e,n,r,a){a||(a=e),r||(r=K2(t));var i,l;for(i=0;i!=e.length;++i)l=e[i],l^=r[n],l=(l>>5|l<<3)&255,a[i]=l,++n;return[a,n,r]},pU=function(t){var e=0,n=K2(t);return function(r){var a=mU("",r,e,n);return e=a[1],a[0]}};function gU(t,e,n,r){var a={key:_n(t),verificationBytes:_n(t)};return n.password&&(a.verifier=hU(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=pU(n.password)),a}function xU(t,e,n){var r=n||{};return r.Info=t.read_shift(2),t.l-=2,r.Info===1?r.Data=dU(t):r.Data=fU(t,e),r}function vU(t,e,n){var r={Type:n.biff>=8?t.read_shift(2):0};return r.Type?xU(t,e-2,r):gU(t,n.biff>=8?e:e-2,n,r),r}var yU=function(){function t(a,i){switch(i.type){case"base64":return e(Nr(a),i);case"binary":return e(a,i);case"buffer":return e(wt&&Buffer.isBuffer(a)?a.toString("binary"):Ri(a),i);case"array":return e(bi(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){var l=i||{},c=l.dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(g,y){Array.isArray(c)&&(c[y]=[]);for(var T=/\\\w+\b/g,w=0,E,S=-1;E=T.exec(g);){switch(E[0]){case"\\cell":var b=g.slice(w,T.lastIndex-E[0].length);if(b[0]==" "&&(b=b.slice(1)),++S,b.length){var N={v:b,t:"s"};Array.isArray(c)?c[y][S]=N:c[st({r:y,c:S})]=N}break}w=T.lastIndex}S>f.e.c&&(f.e.c=S)}),c["!ref"]=At(f),c}function n(a,i){return $s(t(a,i),i)}function r(a){for(var i=["{\\rtf1\\ansi"],l=sn(a["!ref"]),c,d=Array.isArray(a),f=l.s.r;f<=l.e.r;++f){i.push("\\trowd\\trautofit1");for(var g=l.s.c;g<=l.e.c;++g)i.push("\\cellx"+(g+1));for(i.push("\\pard\\intbl"),g=l.s.c;g<=l.e.c;++g){var y=st({r:f,c:g});c=d?(a[f]||[])[g]:a[y],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(ts(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}}();function _U(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Pc(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}function TU(t){var e=t[0]/255,n=t[1]/255,r=t[2]/255,a=Math.max(e,n,r),i=Math.min(e,n,r),l=a-i;if(l===0)return[0,0,e];var c=0,d=0,f=a+i;switch(d=l/(f>1?2-f:f),a){case e:c=((n-r)/l+6)%6;break;case n:c=(r-e)/l+2;break;case r:c=(e-n)/l+4;break}return[c/6,d,f/2]}function wU(t){var e=t[0],n=t[1],r=t[2],a=n*2*(r<.5?r:1-r),i=r-a/2,l=[i,i,i],c=6*e,d;if(n!==0)switch(c|0){case 0:case 6:d=a*c,l[0]+=a,l[1]+=d;break;case 1:d=a*(2-c),l[0]+=d,l[1]+=a;break;case 2:d=a*(c-2),l[1]+=a,l[2]+=d;break;case 3:d=a*(4-c),l[1]+=d,l[2]+=a;break;case 4:d=a*(c-4),l[2]+=a,l[0]+=d;break;case 5:d=a*(6-c),l[2]+=d,l[0]+=a;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function qf(t,e){if(e===0)return t;var n=TU(_U(t));return e<0?n[2]=n[2]*(1+e):n[2]=1-(1-n[2])*(1-e),Pc(wU(n))}var X2=6,EU=15,SU=1,ar=X2;function Yf(t){return Math.floor((t+Math.round(128/ar)/256)*ar)}function Jf(t){return Math.floor((t-5)/ar*100+.5)/100}function vm(t){return Math.round((t*ar+5)/ar*256)/256}function Mh(t){return vm(Jf(Yf(t)))}function up(t){var e=Math.abs(t-Mh(t)),n=ar;if(e>.005)for(ar=SU;ar<EU;++ar)Math.abs(t-Mh(t))<=e&&(e=Math.abs(t-Mh(t)),n=ar);ar=n}function Wo(t){t.width?(t.wpx=Yf(t.width),t.wch=Jf(t.wpx),t.MDW=ar):t.wpx?(t.wch=Jf(t.wpx),t.width=vm(t.wch),t.MDW=ar):typeof t.wch=="number"&&(t.width=vm(t.wch),t.wpx=Yf(t.width),t.MDW=ar),t.customWidth&&delete t.customWidth}var bU=96,Z2=bU;function Q2(t){return t*96/Z2}function Uc(t){return t*Z2/96}var CU={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function AU(t,e,n,r){e.Borders=[];var a={},i=!1;(t[0].match(tr)||[]).forEach(function(l){var c=et(l);switch(Da(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=Qt(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=Qt(c.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function kU(t,e,n,r){e.Fills=[];var a={},i=!1;(t[0].match(tr)||[]).forEach(function(l){var c=et(l);switch(Da(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function NU(t,e,n,r){e.Fonts=[];var a={},i=!1;(t[0].match(tr)||[]).forEach(function(l){var c=et(l);switch(Da(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Wt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?Qt(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?Qt(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?Qt(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?Qt(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?Qt(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?Qt(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?Qt(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=qm[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=Qt(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var d=gi[a.color.index];a.color.index==81&&(d=gi[1]),d||(d=gi[1]),a.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=qf(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function RU(t,e,n){e.NumberFmt=[];for(var r=Ra(ut),a=0;a<r.length;++a)e.NumberFmt[r[a]]=ut[r[a]];var i=t[0].match(tr);if(i)for(a=0;a<i.length;++a){var l=et(i[a]);switch(Da(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=kt(Wt(l.formatCode)),d=parseInt(l.numFmtId,10);if(e.NumberFmt[d]=c,d>0){if(d>392){for(d=392;d>60&&e.NumberFmt[d]!=null;--d);e.NumberFmt[d]=c}pi(c,d)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var _f=["numFmtId","fillId","fontId","borderId","xfId"],Tf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function DU(t,e,n){e.CellXf=[];var r,a=!1;(t[0].match(tr)||[]).forEach(function(i){var l=et(i),c=0;switch(Da(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<_f.length;++c)r[_f[c]]&&(r[_f[c]]=parseInt(r[_f[c]],10));for(c=0;c<Tf.length;++c)r[Tf[c]]&&(r[Tf[c]]=Qt(r[Tf[c]]));if(e.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[r.numFmtId]==e.NumberFmt[c]){r.numFmtId=c;break}}e.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};l.vertical&&(d.vertical=l.vertical),l.horizontal&&(d.horizontal=l.horizontal),l.textRotation!=null&&(d.textRotation=l.textRotation),l.indent&&(d.indent=l.indent),l.wrapText&&(d.wrapText=Qt(l.wrapText)),r.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var MU=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,d,f){var g={};if(!c)return g;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var y;return(y=c.match(e))&&RU(y,g,f),(y=c.match(a))&&NU(y,g,d,f),(y=c.match(r))&&kU(y,g,d,f),(y=c.match(i))&&AU(y,g,d,f),(y=c.match(n))&&DU(y,g,f),g}}();function IU(t,e){var n=t.read_shift(2),r=Zn(t);return[n,r]}function FU(t,e,n){var r={};r.sz=t.read_shift(2)/20;var a=$O(t);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var i=t.read_shift(2);switch(i===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(r.underline=l);var c=t.read_shift(1);c>0&&(r.family=c);var d=t.read_shift(1);switch(d>0&&(r.charset=d),t.l++,r.color=GO(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Zn(t),r}var OU=Qn;function LU(t,e){var n=t.l+e,r=t.read_shift(2),a=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:a}}var PU=Qn;function UU(t,e,n){var r={};r.NumberFmt=[];for(var a in ut)r.NumberFmt[a]=ut[a];r.CellXf=[],r.Fonts=[];var i=[],l=!1;return as(t,function(d,f,g){switch(g){case 44:r.NumberFmt[d[0]]=d[1],pi(d[1],d[0]);break;case 43:r.Fonts.push(d),d.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(d.color.rgb=qf(e.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&r.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(g),l=!0;break;case 38:i.pop(),l=!1;break;default:if(f.T>0)i.push(g);else if(f.T<0)i.pop();else if(!l||n.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),r}var BU=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function jU(t,e,n){e.themeElements.clrScheme=[];var r={};(t[0].match(tr)||[]).forEach(function(a){var i=et(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=i.val;break;case"<a:sysClr":r.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[BU.indexOf(i[0])]=r,r={}):r.name=i[0].slice(3,i[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function VU(){}function HU(){}var GU=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,$U=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,zU=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function qU(t,e,n){e.themeElements={};var r;[["clrScheme",GU,jU],["fontScheme",$U,VU],["fmtScheme",zU,HU]].forEach(function(a){if(!(r=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,e,n)})}var YU=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function eE(t,e){(!t||t.length===0)&&(t=JU());var n,r={};if(!(n=t.match(YU)))throw new Error("themeElements not found in theme");return qU(n[0],r,e),r.raw=t,r}function JU(t,e){var n=[f2];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function WU(t,e,n){var r=t.l+e,a=t.read_shift(4);if(a!==124226){if(!n.cellStyles){t.l=r;return}var i=t.slice(t.l);t.l=r;var l;try{l=u2(i,{type:"array"})}catch{return}var c=kr(l,"theme/theme/theme1.xml",!0);if(c)return eE(c,n)}}function KU(t){return t.read_shift(4)}function XU(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=ZU(t,4);break;case 2:e.xclrValue=j2(t);break;case 3:e.xclrValue=KU(t);break;case 4:t.l+=4;break}return t.l+=8,e}function ZU(t,e){return Qn(t,e)}function QU(t,e){return Qn(t,e)}function e7(t){var e=t.read_shift(2),n=t.read_shift(2)-4,r=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=XU(t);break;case 6:r[1]=QU(t,n);break;case 14:case 15:r[1]=t.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+n)}return r}function t7(t,e){var n=t.l+e;t.l+=2;var r=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),i=[];a-- >0;)i.push(e7(t,n-t.l));return{ixfe:r,ext:i}}function n7(t,e){e.forEach(function(n){n[0]})}function r7(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Zn(t)}}function a7(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function s7(t){return t.l+=4,t.read_shift(4)!=0}function i7(t,e,n){var r={Types:[],Cell:[],Value:[]},a=n||{},i=[],l=!1,c=2;return as(t,function(d,f,g){switch(g){case 335:r.Types.push({name:d.name});break;case 51:d.forEach(function(y){c==1?r.Cell.push({type:r.Types[y[0]-1].name,index:y[1]}):c==0&&r.Value.push({type:r.Types[y[0]-1].name,index:y[1]})});break;case 337:c=d?1:0;break;case 338:c=2;break;case 35:i.push(g),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!f.T){if(!l||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),r}function o7(t,e,n){var r={Types:[],Cell:[],Value:[]};if(!t)return r;var a=!1,i=2,l;return t.replace(tr,function(c){var d=et(c);switch(Da(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<r.Types.length;++f)r.Types[f].name==d.name&&(l=r.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?r.Cell.push({type:r.Types[d.t-1].name,index:+d.v}):i==0&&r.Value.push({type:r.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+d.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return c}),r}function l7(t){var e=[];if(!t)return e;var n=1;return(t.match(tr)||[]).forEach(function(r){var a=et(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?n=a.i:a.i=n,e.push(a);break}}),e}function c7(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=st(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function u7(t,e,n){var r=[];return as(t,function(i,l,c){switch(c){case 63:r.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function f7(t,e,n,r){if(!t)return t;var a=r||{},i=!1;as(t,function(c,d,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!d.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function d7(t,e){if(!t)return"??";var n=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][n].Target}function dT(t,e,n,r){var a=Array.isArray(t),i;e.forEach(function(l){var c=sr(l.ref);if(a?(t[c.r]||(t[c.r]=[]),i=t[c.r][c.c]):i=t[l.ref],!i){i={t:"z"},a?t[c.r][c.c]=i:t[l.ref]=i;var d=sn(t["!ref"]||"BDWGO1000001:A1");d.s.r>c.r&&(d.s.r=c.r),d.e.r<c.r&&(d.e.r=c.r),d.s.c>c.c&&(d.s.c=c.c),d.e.c<c.c&&(d.e.c=c.c);var f=At(d);f!==t["!ref"]&&(t["!ref"]=f)}i.c||(i.c=[]);var g={a:l.author,t:l.t,r:l.r,T:n};l.h&&(g.h=l.h);for(var y=i.c.length-1;y>=0;--y){if(!n&&i.c[y].T)return;n&&!i.c[y].T&&i.c.splice(y,1)}if(n&&r){for(y=0;y<r.length;++y)if(g.a==r[y].id){g.a=r[y].name||g.a;break}}i.c.push(g)})}function h7(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&n.push(c[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var d=et(c[0]),f={author:d.authorId&&n[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},g=sr(d.ref);if(!(e.sheetRows&&e.sheetRows<=g.r)){var y=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),T=!!y&&!!y[1]&&cp(y[1])||{r:"",t:"",h:""};f.r=T.r,T.r=="<t></t>"&&(T.t=T.h=""),f.t=(T.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(f.h=T.h),r.push(f)}}}}),r}function m7(t,e){var n=[],r=!1,a={},i=0;return t.replace(tr,function(c,d){var f=et(c);switch(Da(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&n.push(a);break;case"<text>":case"<text":i=d+c.length;break;case"</text>":a.t=t.slice(i,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),n}function p7(t,e){var n=[],r=!1;return t.replace(tr,function(i){var l=et(i);switch(Da(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),n}function g7(t){var e={};e.iauthor=t.read_shift(4);var n=Mi(t);return e.rfx=n.s,e.ref=st(n.s),t.l+=16,e}var x7=Zn;function v7(t,e){var n=[],r=[],a={},i=!1;return as(t,function(c,d,f){switch(f){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}var y7="application/vnd.ms-office.vbaProject";function _7(t){var e=Ct.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ct.utils.cfb_add(e,a,t.FileIndex[r].content)}}),Ct.write(e)}function T7(){return{"!type":"dialog"}}function w7(){return{"!type":"dialog"}}function E7(){return{"!type":"macro"}}function S7(){return{"!type":"macro"}}var Po=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,a,i,l){var c=!1,d=!1;i.length==0?d=!0:i.charAt(0)=="["&&(d=!0,i=i.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,g=l.length>0?parseInt(l,10)|0:0;return c?g+=e.c:--g,d?f+=e.r:--f,a+(c?"":"$")+An(g)+(d?"":"$")+Hn(f)}return function(a,i){return e=i,a.replace(t,n)}}(),tE=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,b7=function(){return function(e,n){return e.replace(tE,function(r,a,i,l,c,d){var f=rp(l)-(i?0:n.c),g=np(d)-(c?0:n.r),y=g==0?"":c?g+1:"["+g+"]",T=f==0?"":i?f+1:"["+f+"]";return a+"R"+y+"C"+T})}}();function nE(t,e){return t.replace(tE,function(n,r,a,i,l,c){return r+(a=="$"?a+i:An(rp(i)+e.c))+(l=="$"?l+c:Hn(np(c)+e.r))})}function C7(t,e,n){var r=nl(e),a=r.s,i=sr(n),l={r:i.r-a.r,c:i.c-a.c};return nE(t,l)}function A7(t){return t.length!=1}function hT(t){return t.replace(/_xlfn\./g,"")}function vn(t){t.l+=1}function Vs(t,e){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function rE(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return aE(t);n.biff==12&&(r=4)}var a=t.read_shift(r),i=t.read_shift(r),l=Vs(t),c=Vs(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function aE(t){var e=Vs(t),n=Vs(t),r=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function k7(t,e,n){if(n.biff<8)return aE(t);var r=t.read_shift(n.biff==12?4:2),a=t.read_shift(n.biff==12?4:2),i=Vs(t),l=Vs(t);return{s:{r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function sE(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return N7(t);var r=t.read_shift(n&&n.biff==12?4:2),a=Vs(t);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function N7(t){var e=Vs(t),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function R7(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function D7(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return M7(t);var a=t.read_shift(r>=12?4:2),i=t.read_shift(2),l=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:l,rRel:c}}function M7(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),a==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:a,rRel:r}}function I7(t,e,n){var r=(t[t.l++]&96)>>5,a=rE(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function F7(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(n)switch(n.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var l=rE(t,i,n);return[r,a,l]}function O7(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function L7(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(n)switch(n.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[r,a]}function P7(t,e,n){var r=(t[t.l++]&96)>>5,a=k7(t,e-1,n);return[r,a]}function U7(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function mT(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function B7(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),a=[],i=0;i<=r;++i)a.push(t.read_shift(n&&n.biff==2?1:2));return a}function j7(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function V7(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function H7(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function G7(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function iE(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function $7(t){return t.read_shift(2),iE(t)}function z7(t){return t.read_shift(2),iE(t)}function q7(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=sE(t,0,n);return[r,a]}function Y7(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=D7(t,0,n);return[r,a]}function J7(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var i=sE(t,0,n);return[r,a,i]}function W7(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(n&&n.biff<=3?1:2);return[K9[a],cE[a],r]}function K7(t,e,n){var r=t[t.l++],a=t.read_shift(1),i=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:X7(t);return[a,(i[0]===0?cE:W9)[i[1]]]}function X7(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Z7(t,e,n){t.l+=n&&n.biff==2?3:4}function Q7(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function e9(t){return t.l++,Ii[t.read_shift(1)]}function t9(t){return t.l++,t.read_shift(2)}function n9(t){return t.l++,t.read_shift(1)!==0}function r9(t){return t.l++,Wn(t)}function a9(t,e,n){return t.l++,zc(t,e-1,n)}function s9(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=fn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=Ii[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=Wn(t);break;case 2:n[1]=Fi(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function i9(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),a=[],i=0;i!=r;++i)a.push((n.biff==12?Mi:od)(t));return a}function o9(t,e,n){var r=0,a=0;n.biff==12?(r=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var i=0,l=[];i!=r&&(l[i]=[]);++i)for(var c=0;c!=a;++c)l[i][c]=s9(t,n.biff);return l}function l9(t,e,n){var r=t.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=t.read_shift(a);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,i]}function c9(t,e,n){if(n.biff==5)return u9(t);var r=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[r,a,i]}function u9(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function f9(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function d9(t,e,n){var r=t.read_shift(1)>>>5&3,a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function h9(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function m9(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[r,a]}var p9=Qn,g9=Qn,x9=Qn;function Yc(t,e,n){return t.l+=2,[R7(t)]}function fp(t){return t.l+=6,[]}var v9=Yc,y9=fp,_9=fp,T9=Yc;function oE(t){return t.l+=2,[_n(t),t.read_shift(2)&1]}var w9=Yc,E9=oE,S9=fp,b9=Yc,C9=Yc,A9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function k9(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),l=A9[n>>2&31];return{ixti:e,coltype:n&3,rt:l,idx:r,c:a,C:i}}function N9(t){return t.l+=2,[t.read_shift(4)]}function R9(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function D9(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function M9(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function I9(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function F9(t){return t.l+=4,[0,0]}var pT={1:{n:"PtgExp",f:Q7},2:{n:"PtgTbl",f:x9},3:{n:"PtgAdd",f:vn},4:{n:"PtgSub",f:vn},5:{n:"PtgMul",f:vn},6:{n:"PtgDiv",f:vn},7:{n:"PtgPower",f:vn},8:{n:"PtgConcat",f:vn},9:{n:"PtgLt",f:vn},10:{n:"PtgLe",f:vn},11:{n:"PtgEq",f:vn},12:{n:"PtgGe",f:vn},13:{n:"PtgGt",f:vn},14:{n:"PtgNe",f:vn},15:{n:"PtgIsect",f:vn},16:{n:"PtgUnion",f:vn},17:{n:"PtgRange",f:vn},18:{n:"PtgUplus",f:vn},19:{n:"PtgUminus",f:vn},20:{n:"PtgPercent",f:vn},21:{n:"PtgParen",f:vn},22:{n:"PtgMissArg",f:vn},23:{n:"PtgStr",f:a9},26:{n:"PtgSheet",f:R9},27:{n:"PtgEndSheet",f:D9},28:{n:"PtgErr",f:e9},29:{n:"PtgBool",f:n9},30:{n:"PtgInt",f:t9},31:{n:"PtgNum",f:r9},32:{n:"PtgArray",f:U7},33:{n:"PtgFunc",f:W7},34:{n:"PtgFuncVar",f:K7},35:{n:"PtgName",f:l9},36:{n:"PtgRef",f:q7},37:{n:"PtgArea",f:I7},38:{n:"PtgMemArea",f:f9},39:{n:"PtgMemErr",f:p9},40:{n:"PtgMemNoMem",f:g9},41:{n:"PtgMemFunc",f:d9},42:{n:"PtgRefErr",f:h9},43:{n:"PtgAreaErr",f:O7},44:{n:"PtgRefN",f:Y7},45:{n:"PtgAreaN",f:P7},46:{n:"PtgMemAreaN",f:M9},47:{n:"PtgMemNoMemN",f:I9},57:{n:"PtgNameX",f:c9},58:{n:"PtgRef3d",f:J7},59:{n:"PtgArea3d",f:F7},60:{n:"PtgRefErr3d",f:m9},61:{n:"PtgAreaErr3d",f:L7},255:{}},O9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},L9={1:{n:"PtgElfLel",f:oE},2:{n:"PtgElfRw",f:b9},3:{n:"PtgElfCol",f:v9},6:{n:"PtgElfRwV",f:C9},7:{n:"PtgElfColV",f:T9},10:{n:"PtgElfRadical",f:w9},11:{n:"PtgElfRadicalS",f:S9},13:{n:"PtgElfColS",f:y9},15:{n:"PtgElfColSV",f:_9},16:{n:"PtgElfRadicalLel",f:E9},25:{n:"PtgList",f:k9},29:{n:"PtgSxName",f:N9},255:{}},P9={0:{n:"PtgAttrNoop",f:F9},1:{n:"PtgAttrSemi",f:G7},2:{n:"PtgAttrIf",f:V7},4:{n:"PtgAttrChoose",f:B7},8:{n:"PtgAttrGoto",f:j7},16:{n:"PtgAttrSum",f:Z7},32:{n:"PtgAttrBaxcel",f:mT},33:{n:"PtgAttrBaxcel",f:mT},64:{n:"PtgAttrSpace",f:$7},65:{n:"PtgAttrSpaceSemi",f:z7},128:{n:"PtgAttrIfError",f:H7},255:{}};function Jc(t,e,n,r){if(r.biff<8)return Qn(t,e);for(var a=t.l+e,i=[],l=0;l!==n.length;++l)switch(n[l][0]){case"PtgArray":n[l][1]=o9(t,0,r),i.push(n[l][1]);break;case"PtgMemArea":n[l][2]=i9(t,n[l][1],r),i.push(n[l][2]);break;case"PtgExp":r&&r.biff==12&&(n[l][1][1]=t.read_shift(4),i.push(n[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[l][0]}return e=a-t.l,e!==0&&i.push(Qn(t,e)),i}function Wc(t,e,n){for(var r=t.l+e,a,i,l=[];r!=t.l;)e=r-t.l,i=t[t.l],a=pT[i]||pT[O9[i]],(i===24||i===25)&&(a=(i===24?L9:P9)[t[t.l+1]]),!a||!a.f?Qn(t,e):l.push([a.n,a.f(t,e,n)]);return l}function U9(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],a=[],i=0;i<r.length;++i){var l=r[i];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var B9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function j9(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function lE(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(t[r[0]][0]){case 357:return a=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[r[0]][0][3]?(a=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function gT(t,e,n){var r=lE(t,e,n);return r=="#REF"?r:j9(r,n)}function Jn(t,e,n,r,a){var i=a&&a.biff||8,l={s:{c:0,r:0}},c=[],d,f,g,y=0,T=0,w,E="";if(!t[0]||!t[0][0])return"";for(var S=-1,b="",N=0,k=t[0].length;N<k;++N){var C=t[0][N];switch(C[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),f=c.pop(),S>=0){switch(t[0][S][1][0]){case 0:b=an(" ",t[0][S][1][1]);break;case 1:b=an("\r",t[0][S][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}f=f+b,S=-1}c.push(f+B9[C[0]]+d);break;case"PtgIsect":d=c.pop(),f=c.pop(),c.push(f+" "+d);break;case"PtgUnion":d=c.pop(),f=c.pop(),c.push(f+","+d);break;case"PtgRange":d=c.pop(),f=c.pop(),c.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=vc(C[1][1],l,a),c.push(yc(g,i));break;case"PtgRefN":g=n?vc(C[1][1],n,a):C[1][1],c.push(yc(g,i));break;case"PtgRef3d":y=C[1][1],g=vc(C[1][2],l,a),E=gT(r,y,a),c.push(E+"!"+yc(g,i));break;case"PtgFunc":case"PtgFuncVar":var P=C[1][0],j=C[1][1];P||(P=0),P&=127;var H=P==0?[]:c.slice(-P);c.length-=P,j==="User"&&(j=H.shift()),c.push(j+"("+H.join(",")+")");break;case"PtgBool":c.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(C[1]);break;case"PtgNum":c.push(String(C[1]));break;case"PtgStr":c.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(C[1]);break;case"PtgAreaN":w=K_(C[1][1],n?{s:n}:l,a),c.push(Rh(w,a));break;case"PtgArea":w=K_(C[1][1],l,a),c.push(Rh(w,a));break;case"PtgArea3d":y=C[1][1],w=C[1][2],E=gT(r,y,a),c.push(E+"!"+Rh(w,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":T=C[1][2];var L=(r.names||[])[T-1]||(r[0]||[])[T],K=L?L.Name:"SH33TJSNAME"+String(T);K&&K.slice(0,6)=="_xlfn."&&!a.xlfn&&(K=K.slice(6)),c.push(K);break;case"PtgNameX":var M=C[1][1];T=C[1][2];var Q;if(a.biff<=5)M<0&&(M=-M),r[M]&&(Q=r[M][T]);else{var X="";if(((r[M]||[])[0]||[])[0]==14849||(((r[M]||[])[0]||[])[0]==1025?r[M][T]&&r[M][T].itab>0&&(X=r.SheetNames[r[M][T].itab-1]+"!"):X=r.SheetNames[T-1]+"!"),r[M]&&r[M][T])X+=r[M][T].Name;else if(r[0]&&r[0][T])X+=r[0][T].Name;else{var ee=(lE(r,M,a)||"").split(";;");ee[T-1]?X=ee[T-1]:X+="SH33TJSERRX"}c.push(X);break}Q||(Q={Name:"SH33TJSERRY"}),c.push(Q.Name);break;case"PtgParen":var ye="(",Ie=")";if(S>=0){switch(b="",t[0][S][1][0]){case 2:ye=an(" ",t[0][S][1][1])+ye;break;case 3:ye=an("\r",t[0][S][1][1])+ye;break;case 4:Ie=an(" ",t[0][S][1][1])+Ie;break;case 5:Ie=an("\r",t[0][S][1][1])+Ie;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}S=-1}c.push(ye+c.pop()+Ie);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":g={c:C[1][1],r:C[1][0]};var Te={c:n.c,r:n.r};if(r.sharedf[st(g)]){var re=r.sharedf[st(g)];c.push(Jn(re,l,Te,r,a))}else{var ue=!1;for(d=0;d!=r.arrayf.length;++d)if(f=r.arrayf[d],!(g.c<f[0].s.c||g.c>f[0].e.c)&&!(g.r<f[0].s.r||g.r>f[0].e.r)){c.push(Jn(f[1],l,Te,r,a)),ue=!0;break}ue||c.push(C[1])}break;case"PtgArray":c.push("{"+U9(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&ne.indexOf(t[0][N][0])==-1){C=t[0][S];var W=!0;switch(C[1][0]){case 4:W=!1;case 0:b=an(" ",C[1][1]);break;case 5:W=!1;case 1:b=an("\r",C[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}c.push((W?b:"")+c.pop()+(W?"":b)),S=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function V9(t,e,n){var r=t.l+e,a=n.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],Qn(t,e-2)];var c=Wc(t,l,n);return e!==l+a&&(i=Jc(t,e-l-a,c,n)),t.l=r,[c,i]}function H9(t,e,n){var r=t.l+e,a=n.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],Qn(t,e-2)];var c=Wc(t,l,n);return e!==l+a&&(i=Jc(t,e-l-a,c,n)),t.l=r,[c,i]}function G9(t,e,n,r){var a=t.l+e,i=Wc(t,r,n),l;return a!==t.l&&(l=Jc(t,a-t.l,i,n)),[i,l]}function $9(t,e,n){var r=t.l+e,a,i=t.read_shift(2),l=Wc(t,i,n);return i==65535?[[],Qn(t,e-2)]:(e!==i+2&&(a=Jc(t,r-i-2,l,n)),[l,a])}function z9(t){var e;if(Wa(t,t.l+6)!==65535)return[Wn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Ih(t,e,n){var r=t.l+e,a=Ma(t);n.biff==2&&++t.l;var i=z9(t),l=t.read_shift(1);n.biff!=2&&(t.read_shift(1),n.biff>=5&&t.read_shift(4));var c=H9(t,r-t.l,n);return{cell:a,val:i[0],formula:c,shared:l>>3&1,tt:i[1]}}function ld(t,e,n){var r=t.read_shift(4),a=Wc(t,r,n),i=t.read_shift(4),l=i>0?Jc(t,i,a,n):null;return[a,l]}var q9=ld,cd=ld,Y9=ld,J9=ld,W9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},cE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},K9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xT(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,n){return n.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Fh(t){var e=t.split(":"),n=e[0].split(".")[0];return[n,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Ec={},Uo={};function Sc(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(n=[1,1,1,1,.5,.5]),t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function uE(t,e,n,r,a,i){try{r.cellNF&&(t.z=ut[e])}catch(c){if(r.WTF)throw c}if(!(t.t==="z"&&!r.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Ln(t.v)),(!r||r.cellText!==!1)&&t.t!=="z")try{if(ut[e]==null&&pi(X8[e]||"General",e),t.t==="e")t.w=t.w||Ii[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Ic(t.v);else if(t.t==="d"){var l=lr(t.v);(l|0)===l?t.w=l.toString(10):t.w=Ic(l)}else{if(t.v===void 0)return"";t.w=Si(t.v,Uo)}else t.t==="d"?t.w=Wr(e,lr(t.v),Uo):t.w=Wr(e,t.v,Uo)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&n!=null)try{t.s=i.Fills[n],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=qf(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),r.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=qf(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),r.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&i.Fills)throw c}}}function X9(t,e){var n=sn(e);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(t["!ref"]=At(n))}var Z9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Q9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,eB=/<(?:\w:)?hyperlink [^>]*>/mg,tB=/"(\w*:\w*)"/,nB=/<(?:\w:)?col\b[^>]*[\/]?>/g,rB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,aB=/<(?:\w:)?pageMargins[^>]*\/>/g,fE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,iB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function oB(t,e,n,r,a,i,l){if(!t)return t;r||(r={"!id":{}});var c=e.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",g="",y=t.match(Q9);y?(f=t.slice(0,y.index),g=t.slice(y.index+y[0].length)):f=g=t;var T=f.match(fE);T?dp(T[0],c,a,n):(T=f.match(sB))&&lB(T[0],T[1]||"",c,a,n);var w=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(w>0){var E=f.slice(w,w+50).match(tB);E&&X9(c,E[1])}var S=f.match(iB);S&&S[1]&&mB(S[1],a);var b=[];if(e.cellStyles){var N=f.match(nB);N&&fB(b,N)}y&&pB(y[1],c,e,d,i,l);var k=g.match(rB);k&&(c["!autofilter"]=dB(k[0]));var C=[],P=g.match(Z9);if(P)for(w=0;w!=P.length;++w)C[w]=sn(P[w].slice(P[w].indexOf('"')+1));var j=g.match(eB);j&&cB(c,j,r);var H=g.match(aB);if(H&&(c["!margins"]=uB(et(H[0]))),!c["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(c["!ref"]=At(d)),e.sheetRows>0&&c["!ref"]){var L=sn(c["!ref"]);e.sheetRows<=+L.e.r&&(L.e.r=e.sheetRows-1,L.e.r>d.e.r&&(L.e.r=d.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>d.e.c&&(L.e.c=d.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),c["!fullref"]=c["!ref"],c["!ref"]=At(L))}return b.length>0&&(c["!cols"]=b),C.length>0&&(c["!merges"]=C),c}function dp(t,e,n,r){var a=et(t);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=kt(Wt(a.codeName)))}function lB(t,e,n,r,a){dp(t.slice(0,t.indexOf(">")),n,r,a)}function cB(t,e,n){for(var r=Array.isArray(t),a=0;a!=e.length;++a){var i=et(Wt(e[a]),!0);if(!i.ref)return;var l=((n||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+kt(i.location))):(i.Target="#"+kt(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=sn(i.ref),d=c.s.r;d<=c.e.r;++d)for(var f=c.s.c;f<=c.e.c;++f){var g=st({c:f,r:d});r?(t[d]||(t[d]=[]),t[d][f]||(t[d][f]={t:"z",v:void 0}),t[d][f].l=i):(t[g]||(t[g]={t:"z",v:void 0}),t[g].l=i)}}}function uB(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(n){t[n]&&(e[n]=parseFloat(t[n]))}),e}function fB(t,e){for(var n=!1,r=0;r!=e.length;++r){var a=et(e[r],!0);a.hidden&&(a.hidden=Qt(a.hidden));var i=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,up(a.width)),Wo(a);i<=l;)t[i++]=Vn(a)}}function dB(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var hB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function mB(t,e){e.Views||(e.Views=[{}]),(t.match(hB)||[]).forEach(function(n,r){var a=et(n);e.Views[r]||(e.Views[r]={}),+a.zoomScale&&(e.Views[r].zoom=+a.zoomScale),Qt(a.rightToLeft)&&(e.Views[r].RTL=!0)})}var pB=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Fc("v"),l=Fc("f");return function(d,f,g,y,T,w){for(var E=0,S="",b=[],N=[],k=0,C=0,P=0,j="",H,L,K=0,M=0,Q,X,ee=0,ye=0,Ie=Array.isArray(w.CellXf),Te,re=[],ue=[],ne=Array.isArray(f),W=[],U={},G=!1,R=!!g.sheetStubs,z=d.split(e),J=0,q=z.length;J!=q;++J){S=z[J].trim();var ie=S.length;if(ie!==0){var we=0;e:for(E=0;E<ie;++E)switch(S[E]){case">":if(S[E-1]!="/"){++E;break e}if(g&&g.cellStyles){if(L=et(S.slice(we,E),!0),K=L.r!=null?parseInt(L.r,10):K+1,M=-1,g.sheetRows&&g.sheetRows<K)continue;U={},G=!1,L.ht&&(G=!0,U.hpt=parseFloat(L.ht),U.hpx=Uc(U.hpt)),L.hidden=="1"&&(G=!0,U.hidden=!0),L.outlineLevel!=null&&(G=!0,U.level=+L.outlineLevel),G&&(W[K-1]=U)}break;case"<":we=E;break}if(we>=E)break;if(L=et(S.slice(we,E),!0),K=L.r!=null?parseInt(L.r,10):K+1,M=-1,!(g.sheetRows&&g.sheetRows<K)){y.s.r>K-1&&(y.s.r=K-1),y.e.r<K-1&&(y.e.r=K-1),g&&g.cellStyles&&(U={},G=!1,L.ht&&(G=!0,U.hpt=parseFloat(L.ht),U.hpx=Uc(U.hpt)),L.hidden=="1"&&(G=!0,U.hidden=!0),L.outlineLevel!=null&&(G=!0,U.level=+L.outlineLevel),G&&(W[K-1]=U)),b=S.slice(E).split(t);for(var _e=0;_e!=b.length&&b[_e].trim().charAt(0)=="<";++_e);for(b=b.slice(_e),E=0;E!=b.length;++E)if(S=b[E].trim(),S.length!==0){if(N=S.match(n),k=E,C=0,P=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,N!=null&&N.length===2){for(k=0,j=N[1],C=0;C!=j.length&&!((P=j.charCodeAt(C)-64)<1||P>26);++C)k=26*k+P;--k,M=k}else++M;for(C=0;C!=S.length&&S.charCodeAt(C)!==62;++C);if(++C,L=et(S.slice(0,C),!0),L.r||(L.r=st({r:K-1,c:M})),j=S.slice(C),H={t:""},(N=j.match(i))!=null&&N[1]!==""&&(H.v=kt(N[1])),g.cellFormula){if((N=j.match(l))!=null&&N[1]!==""){if(H.f=kt(Wt(N[1])).replace(/\r\n/g,`
`),g.xlfn||(H.f=hT(H.f)),N[0].indexOf('t="array"')>-1)H.F=(j.match(a)||[])[1],H.F.indexOf(":")>-1&&re.push([sn(H.F),H.F]);else if(N[0].indexOf('t="shared"')>-1){X=et(N[0]);var ke=kt(Wt(N[1]));g.xlfn||(ke=hT(ke)),ue[parseInt(X.si,10)]=[X,ke,L.r]}}else(N=j.match(/<f[^>]*\/>/))&&(X=et(N[0]),ue[X.si]&&(H.f=C7(ue[X.si][1],ue[X.si][2],L.r)));var Ce=sr(L.r);for(C=0;C<re.length;++C)Ce.r>=re[C][0].s.r&&Ce.r<=re[C][0].e.r&&Ce.c>=re[C][0].s.c&&Ce.c<=re[C][0].e.c&&(H.F=re[C][1])}if(L.t==null&&H.v===void 0)if(H.f||H.F)H.v=0,H.t="n";else if(R)H.t="z";else continue;else H.t=L.t||"n";switch(y.s.c>M&&(y.s.c=M),y.e.c<M&&(y.e.c=M),H.t){case"n":if(H.v==""||H.v==null){if(!R)continue;H.t="z"}else H.v=parseFloat(H.v);break;case"s":if(typeof H.v>"u"){if(!R)continue;H.t="z"}else Q=Ec[parseInt(H.v,10)],H.v=Q.t,H.r=Q.r,g.cellHTML&&(H.h=Q.h);break;case"str":H.t="s",H.v=H.v!=null?Wt(H.v):"",g.cellHTML&&(H.h=Qm(H.v));break;case"inlineStr":N=j.match(r),H.t="s",N!=null&&(Q=cp(N[1]))?(H.v=Q.t,g.cellHTML&&(H.h=Q.h)):H.v="";break;case"b":H.v=Qt(H.v);break;case"d":g.cellDates?H.v=Ln(H.v,1):(H.v=lr(Ln(H.v,1)),H.t="n");break;case"e":(!g||g.cellText!==!1)&&(H.w=H.v),H.v=M2[H.v];break}if(ee=ye=0,Te=null,Ie&&L.s!==void 0&&(Te=w.CellXf[L.s],Te!=null&&(Te.numFmtId!=null&&(ee=Te.numFmtId),g.cellStyles&&Te.fillId!=null&&(ye=Te.fillId))),uE(H,ee,ye,g,T,w),g.cellDates&&Ie&&H.t=="n"&&tl(ut[ee])&&(H.t="d",H.v=id(H.v)),L.cm&&g.xlmeta){var He=(g.xlmeta.Cell||[])[+L.cm-1];He&&He.type=="XLDAPR"&&(H.D=!0)}if(ne){var Z=sr(L.r);f[Z.r]||(f[Z.r]=[]),f[Z.r][Z.c]=H}else f[L.r]=H}}}}W.length>0&&(f["!rows"]=W)}}();function gB(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=r,i&7&&(n.level=i&7),i&16&&(n.hidden=!0),i&32&&(n.hpt=a/20),n}var xB=Mi;function vB(){}function yB(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=VO(t),n}function _B(t){var e=Qr(t);return[e]}function TB(t){var e=Di(t);return[e]}function wB(t){var e=Qr(t),n=t.read_shift(1);return[e,n,"b"]}function EB(t){var e=Di(t),n=t.read_shift(1);return[e,n,"b"]}function SB(t){var e=Qr(t),n=t.read_shift(1);return[e,n,"e"]}function bB(t){var e=Di(t),n=t.read_shift(1);return[e,n,"e"]}function CB(t){var e=Qr(t),n=t.read_shift(4);return[e,n,"s"]}function AB(t){var e=Di(t),n=t.read_shift(4);return[e,n,"s"]}function kB(t){var e=Qr(t),n=Wn(t);return[e,n,"n"]}function dE(t){var e=Di(t),n=Wn(t);return[e,n,"n"]}function NB(t){var e=Qr(t),n=ip(t);return[e,n,"n"]}function RB(t){var e=Di(t),n=ip(t);return[e,n,"n"]}function DB(t){var e=Qr(t),n=ap(t);return[e,n,"is"]}function MB(t){var e=Qr(t),n=Zn(t);return[e,n,"str"]}function IB(t){var e=Di(t),n=Zn(t);return[e,n,"str"]}function FB(t,e,n){var r=t.l+e,a=Qr(t);a.r=n["!row"];var i=t.read_shift(1),l=[a,i,"b"];if(n.cellFormula){t.l+=2;var c=cd(t,r-t.l,n);l[3]=Jn(c,null,a,n.supbooks,n)}else t.l=r;return l}function OB(t,e,n){var r=t.l+e,a=Qr(t);a.r=n["!row"];var i=t.read_shift(1),l=[a,i,"e"];if(n.cellFormula){t.l+=2;var c=cd(t,r-t.l,n);l[3]=Jn(c,null,a,n.supbooks,n)}else t.l=r;return l}function LB(t,e,n){var r=t.l+e,a=Qr(t);a.r=n["!row"];var i=Wn(t),l=[a,i,"n"];if(n.cellFormula){t.l+=2;var c=cd(t,r-t.l,n);l[3]=Jn(c,null,a,n.supbooks,n)}else t.l=r;return l}function PB(t,e,n){var r=t.l+e,a=Qr(t);a.r=n["!row"];var i=Zn(t),l=[a,i,"str"];if(n.cellFormula){t.l+=2;var c=cd(t,r-t.l,n);l[3]=Jn(c,null,a,n.supbooks,n)}else t.l=r;return l}var UB=Mi;function BB(t,e){var n=t.l+e,r=Mi(t),a=sp(t),i=Zn(t),l=Zn(t),c=Zn(t);t.l=n;var d={rfx:r,relId:a,loc:i,display:c};return l&&(d.Tooltip=l),d}function jB(){}function VB(t,e,n){var r=t.l+e,a=N2(t),i=t.read_shift(1),l=[a];if(l[2]=i,n.cellFormula){var c=q9(t,r-t.l,n);l[1]=c}else t.l=r;return l}function HB(t,e,n){var r=t.l+e,a=Mi(t),i=[a];if(n.cellFormula){var l=J9(t,r-t.l,n);i[1]=l,t.l=r}else t.l=r;return i}var GB=["left","right","top","bottom","header","footer"];function $B(t){var e={};return GB.forEach(function(n){e[n]=Wn(t)}),e}function zB(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function qB(){}function YB(){}function JB(t,e,n,r,a,i,l){if(!t)return t;var c=e||{};r||(r={"!id":{}});var d=c.dense?[]:{},f,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,T=!1,w,E,S,b,N,k,C,P,j,H=[];c.biff=12,c["!row"]=0;var L=0,K=!1,M=[],Q={},X=c.supbooks||a.supbooks||[[]];if(X.sharedf=Q,X.arrayf=M,X.SheetNames=a.SheetNames||a.Sheets.map(function(ne){return ne.name}),!c.supbooks&&(c.supbooks=X,a.Names))for(var ee=0;ee<a.Names.length;++ee)X[0][ee+1]=a.Names[ee];var ye=[],Ie=[],Te=!1;Wf[16]={n:"BrtShortReal",f:dE};var re;if(as(t,function(W,U,G){if(!T)switch(G){case 148:f=W;break;case 0:w=W,c.sheetRows&&c.sheetRows<=w.r&&(T=!0),P=Hn(b=w.r),c["!row"]=w.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=Uc(W.hpt)),Ie[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:W[2]},W[2]){case"n":E.v=W[1];break;case"s":C=Ec[W[1]],E.v=C.t,E.r=C.r;break;case"b":E.v=!!W[1];break;case"e":E.v=W[1],c.cellText!==!1&&(E.w=Ii[E.v]);break;case"str":E.t="s",E.v=W[1];break;case"is":E.t="s",E.v=W[1].t;break}if((S=l.CellXf[W[0].iStyleRef])&&uE(E,S.numFmtId,null,c,i,l),N=W[0].c==-1?N+1:W[0].c,c.dense?(d[b]||(d[b]=[]),d[b][N]=E):d[An(N)+P]=E,c.cellFormula){for(K=!1,L=0;L<M.length;++L){var R=M[L];w.r>=R[0].s.r&&w.r<=R[0].e.r&&N>=R[0].s.c&&N<=R[0].e.c&&(E.F=At(R[0]),K=!0)}!K&&W.length>3&&(E.f=W[3])}if(g.s.r>w.r&&(g.s.r=w.r),g.s.c>N&&(g.s.c=N),g.e.r<w.r&&(g.e.r=w.r),g.e.c<N&&(g.e.c=N),c.cellDates&&S&&E.t=="n"&&tl(ut[S.numFmtId])){var z=mi(E.v);z&&(E.t="d",E.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}re&&(re.type=="XLDAPR"&&(E.D=!0),re=void 0);break;case 1:case 12:if(!c.sheetStubs||y)break;E={t:"z",v:void 0},N=W[0].c==-1?N+1:W[0].c,c.dense?(d[b]||(d[b]=[]),d[b][N]=E):d[An(N)+P]=E,g.s.r>w.r&&(g.s.r=w.r),g.s.c>N&&(g.s.c=N),g.e.r<w.r&&(g.e.r=w.r),g.e.c<N&&(g.e.c=N),re&&(re.type=="XLDAPR"&&(E.D=!0),re=void 0);break;case 176:H.push(W);break;case 49:re=((c.xlmeta||{}).Cell||[])[W-1];break;case 494:var J=r["!id"][W.relId];for(J?(W.Target=J.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=J):W.relId==""&&(W.Target="#"+W.loc),b=W.rfx.s.r;b<=W.rfx.e.r;++b)for(N=W.rfx.s.c;N<=W.rfx.e.c;++N)c.dense?(d[b]||(d[b]=[]),d[b][N]||(d[b][N]={t:"z",v:void 0}),d[b][N].l=W):(k=st({c:N,r:b}),d[k]||(d[k]={t:"z",v:void 0}),d[k].l=W);break;case 426:if(!c.cellFormula)break;M.push(W),j=c.dense?d[b][N]:d[An(N)+P],j.f=Jn(W[1],g,{r:w.r,c:N},X,c),j.F=At(W[0]);break;case 427:if(!c.cellFormula)break;Q[st(W[0].s)]=W[1],j=c.dense?d[b][N]:d[An(N)+P],j.f=Jn(W[1],g,{r:w.r,c:N},X,c);break;case 60:if(!c.cellStyles)break;for(;W.e>=W.s;)ye[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},Te||(Te=!0,up(W.w/256)),Wo(ye[W.e+1]);break;case 161:d["!autofilter"]={ref:At(W)};break;case 476:d["!margins"]=W;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),W.name&&(a.Sheets[n].CodeName=W.name),(W.above||W.left)&&(d["!outline"]={above:W.above,left:W.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),W.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:y=!0;break;case 38:y=!1;break;default:if(!U.T){if(!y||c.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},c),delete c.supbooks,delete c["!row"],!d["!ref"]&&(g.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(d["!ref"]=At(f||g)),c.sheetRows&&d["!ref"]){var ue=sn(d["!ref"]);c.sheetRows<=+ue.e.r&&(ue.e.r=c.sheetRows-1,ue.e.r>g.e.r&&(ue.e.r=g.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>g.e.c&&(ue.e.c=g.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),d["!fullref"]=d["!ref"],d["!ref"]=At(ue))}return H.length>0&&(d["!merges"]=H),ye.length>0&&(d["!cols"]=ye),Ie.length>0&&(d["!rows"]=Ie),d}function WB(t){var e=[],n=t.match(/^<c:numCache>/),r;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=n?+l[2]:l[2])});var a=kt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){r=i.replace(/<.*?>/g,"")}),[e,a,r]}function KB(t,e,n,r,a,i){var l=i||{"!type":"chart"};if(!t)return i;var c=0,d=0,f="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(y){var T=WB(y);g.s.r=g.s.c=0,g.e.c=c,f=An(c),T[0].forEach(function(w,E){l[f+Hn(E)]={t:"n",v:w,z:T[1]},d=E}),g.e.r<d&&(g.e.r=d),++c}),c>0&&(l["!ref"]=At(g)),l}function XB(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,c=t.match(fE);return c&&dp(c[0],i,a,n),(l=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}function ZB(t,e){t.l+=10;var n=Zn(t);return{name:n}}function QB(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return as(t,function(d,f,g){switch(g){case 550:i["!rel"]=d;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),d.name&&(a.Sheets[n].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},e),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}var hE=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ej=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tj=[],nj=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function vT(t,e){for(var n=0;n!=t.length;++n)for(var r=t[n],a=0;a!=e.length;++a){var i=e[a];if(r[i[0]]==null)r[i[0]]=i[1];else switch(i[2]){case"bool":typeof r[i[0]]=="string"&&(r[i[0]]=Qt(r[i[0]]));break;case"int":typeof r[i[0]]=="string"&&(r[i[0]]=parseInt(r[i[0]],10));break}}}function yT(t,e){for(var n=0;n!=e.length;++n){var r=e[n];if(t[r[0]]==null)t[r[0]]=r[1];else switch(r[2]){case"bool":typeof t[r[0]]=="string"&&(t[r[0]]=Qt(t[r[0]]));break;case"int":typeof t[r[0]]=="string"&&(t[r[0]]=parseInt(t[r[0]],10));break}}}function mE(t){yT(t.WBProps,hE),yT(t.CalcPr,nj),vT(t.WBView,ej),vT(t.Sheets,tj),Uo.date1904=Qt(t.WBProps.date1904)}var rj="][*?/\\".split("");function aj(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return rj.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}var sj=/<\w+:workbook/;function ij(t,e){if(!t)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",i={},l=0;if(t.replace(tr,function(d,f){var g=et(d);switch(Da(g[0])){case"<?xml":break;case"<workbook":d.match(sj)&&(a="xmlns"+d.match(/<(\w+):/)[1]),n.xmlns=g[a];break;case"</workbook>":break;case"<fileVersion":delete g[0],n.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":hE.forEach(function(y){if(g[y[0]]!=null)switch(y[2]){case"bool":n.WBProps[y[0]]=Qt(g[y[0]]);break;case"int":n.WBProps[y[0]]=parseInt(g[y[0]],10);break;default:n.WBProps[y[0]]=g[y[0]]}}),g.codeName&&(n.WBProps.CodeName=Wt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],n.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=kt(Wt(g.name)),delete g[0],n.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":i={},i.Name=Wt(g.name),g.comment&&(i.Comment=g.comment),g.localSheetId&&(i.Sheet=+g.localSheetId),Qt(g.hidden||"0")&&(i.Hidden=!0),l=f+d.length;break;case"</definedName>":i.Ref=kt(Wt(t.slice(l,f))),n.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete g[0],n.CalcPr=g;break;case"<calcPr/>":delete g[0],n.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&e.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return d}),SO.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return mE(n),n}function oj(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=pm(t),n.name=Zn(t),n}function lj(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var a=e>8?Zn(t):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function cj(t,e){var n={};return t.read_shift(4),n.ArchID=t.read_shift(4),t.l+=e-8,n}function uj(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),i=HO(t),l=Y9(t,0,n),c=sp(t);t.l=r;var d={Name:i,Ptg:l};return a<268435455&&(d.Sheet=a),c&&(d.Comment=c),d}function fj(t,e){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;e||(e={}),e.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Wf[16]={n:"BrtFRTArchID$",f:cj},as(t,function(d,f,g){switch(g){case 156:l.SheetNames.push(d.name),n.Sheets.push(d);break;case 153:n.WBProps=d;break;case 39:d.Sheet!=null&&(e.SID=d.Sheet),d.Ref=Jn(d.Ptg,null,null,l,e),delete e.SID,delete d.Ptg,i.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([g,d]):l[0]=[g,d],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(d),l.XTI=l.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(g),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(g),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||e.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},e),mE(n),n.Names=i,n.supbooks=l,n}function dj(t,e,n){return e.slice(-4)===".bin"?fj(t,n):ij(t,n)}function hj(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?JB(t,r,n,a,i,l,c):oB(t,r,n,a,i,l,c)}function mj(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?QB(t,r,n,a,i):XB(t,r,n,a,i)}function pj(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?E7():S7()}function gj(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?T7():w7()}function xj(t,e,n,r){return e.slice(-4)===".bin"?UU(t,n,r):MU(t,n,r)}function vj(t,e,n){return eE(t,n)}function yj(t,e,n){return e.slice(-4)===".bin"?eU(t,n):ZP(t,n)}function _j(t,e,n){return e.slice(-4)===".bin"?v7(t,n):h7(t,n)}function Tj(t,e,n){return e.slice(-4)===".bin"?u7(t):l7(t)}function wj(t,e,n,r){return n.slice(-4)===".bin"?f7(t,e,n,r):void 0}function Ej(t,e,n){return e.slice(-4)===".bin"?i7(t,e,n):o7(t,e,n)}var pE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ia(t,e){var n=t.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var a=t.match(pE),i,l,c,d;if(a)for(d=0;d!=a.length;++d)i=a[d].match(gE),(l=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(l+1),r[c]=i[2].slice(1,i[2].length-1));return r}function Sj(t){var e=t.split(/\s+/),n={};if(e.length===1)return n;var r=t.match(pE),a,i,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(gE),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),n[l]=a[2].slice(1,a[2].length-1));return n}var bc;function bj(t,e){var n=bc[t]||kt(t);return n==="General"?Si(e):Wr(n,e)}function Cj(t,e,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Qt(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Ln(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}t[kt(e)]=a}function Aj(t,e,n){if(t.t!=="z"){if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||Ii[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Ic(t.v):t.w=Si(t.v):t.w=bj(e||"General",t.v)}catch(i){if(n.WTF)throw i}try{var r=bc[e]||e||"General";if(n.cellNF&&(t.z=r),n.cellDates&&t.t=="n"&&tl(r)){var a=mi(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(n.WTF)throw i}}}function kj(t,e,n){if(n.cellStyles&&e.Interior){var r=e.Interior;r.Pattern&&(r.patternType=CU[r.Pattern]||r.Pattern)}t[e.ID]=e}function Nj(t,e,n,r,a,i,l,c,d,f){var g="General",y=r.StyleID,T={};f=f||{};var w=[],E=0;for(y===void 0&&c&&(y=c.StyleID),y===void 0&&l&&(y=l.StyleID);i[y]!==void 0&&(i[y].nf&&(g=i[y].nf),i[y].Interior&&w.push(i[y].Interior),!!i[y].Parent);)y=i[y].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=Qt(t);break;case"String":r.t="s",r.r=V_(kt(t)),r.v=t.indexOf("<")>-1?kt(e||t).replace(/<.*?>/g,""):r.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),r.v=(Ln(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=kt(t):r.v<60&&(r.v=r.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+t),r.t||(r.t="n");break;case"Error":r.t="e",r.v=M2[t],f.cellText!==!1&&(r.w=t);break;default:t==""&&e==""?r.t="z":(r.t="s",r.v=V_(e||t));break}if(Aj(r,g,f),f.cellFormula!==!1)if(r.Formula){var S=kt(r.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),r.f=Po(S,a),delete r.Formula,r.ArrayRange=="RC"?r.F=Po("RC:RC",a):r.ArrayRange&&(r.F=Po(r.ArrayRange,a),d.push([sn(r.F),r.F]))}else for(E=0;E<d.length;++E)a.r>=d[E][0].s.r&&a.r<=d[E][0].e.r&&a.c>=d[E][0].s.c&&a.c<=d[E][0].e.c&&(r.F=d[E][1]);f.cellStyles&&(w.forEach(function(b){!T.patternType&&b.patternType&&(T.patternType=b.patternType)}),r.s=T),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function Rj(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Oh(t,e){var n=e||{};a2();var r=oc(ep(t));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=Wt(r));var a=r.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Vn(n);return l.type="string",Lc.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Dt){a.indexOf("<"+Dt)>=0&&(i=!0)}),i)return Bj(r,n);bc={"General Number":"General","General Date":ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ut[15],"Short Date":ut[14],"Long Time":ut[19],"Medium Time":ut[18],"Short Time":ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ut[2],Standard:ut[4],Percent:ut[10],Scientific:ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,d=[],f,g={},y=[],T=n.dense?[]:{},w="",E={},S={},b=ia('<Data ss:Type="String">'),N=0,k=0,C=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},H={},L="",K=0,M=[],Q={},X={},ee=0,ye=[],Ie=[],Te={},re=[],ue,ne=!1,W=[],U=[],G={},R=0,z=0,J={Sheets:[],WBProps:{date1904:!1}},q={};Oc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";c=Oc.exec(r);)switch(c[3]=(ie=c[3]).toLowerCase()){case"data":if(ie=="data"){if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break}if(d[d.length-1][1])break;c[1]==="/"?Nj(r.slice(N,c.index),L,b,d[d.length-1][0]=="comment"?Te:E,{c:k,r:C},j,re[k],S,W,n):(L="",b=ia(c[0]),N=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Ie.length>0&&(E.c=Ie),(!n.sheetRows||n.sheetRows>C)&&E.v!==void 0&&(n.dense?(T[C]||(T[C]=[]),T[C][k]=E):T[An(k)+Hn(C)]=E),E.HRef&&(E.l={Target:kt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(R=k+(parseInt(E.MergeAcross,10)|0),z=C+(parseInt(E.MergeDown,10)|0),M.push({s:{c:k,r:C},e:{c:R,r:z}})),!n.sheetStubs)E.MergeAcross?k=R+1:++k;else if(E.MergeAcross||E.MergeDown){for(var we=k;we<=R;++we)for(var _e=C;_e<=z;++_e)(we>k||_e>C)&&(n.dense?(T[_e]||(T[_e]=[]),T[_e][we]={t:"z"}):T[An(we)+Hn(_e)]={t:"z"});k=R+1}else++k;else E=Sj(c[0]),E.Index&&(k=+E.Index-1),k<P.s.c&&(P.s.c=k),k>P.e.c&&(P.e.c=k),c[0].slice(-2)==="/>"&&++k,Ie=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(C<P.s.r&&(P.s.r=C),C>P.e.r&&(P.e.r=C),c[0].slice(-2)==="/>"&&(S=ia(c[0]),S.Index&&(C=+S.Index-1)),k=0,++C):(S=ia(c[0]),S.Index&&(C=+S.Index-1),G={},(S.AutoFitHeight=="0"||S.Height)&&(G.hpx=parseInt(S.Height,10),G.hpt=Q2(G.hpx),U[C]=G),S.Hidden=="1"&&(G.hidden=!0,U[C]=G));break;case"worksheet":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));y.push(w),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(T["!ref"]=At(P),n.sheetRows&&n.sheetRows<=P.e.r&&(T["!fullref"]=T["!ref"],P.e.r=n.sheetRows-1,T["!ref"]=At(P))),M.length&&(T["!merges"]=M),re.length>0&&(T["!cols"]=re),U.length>0&&(T["!rows"]=U),g[w]=T}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=k=0,d.push([c[3],!1]),f=ia(c[0]),w=kt(f.Name),T=n.dense?[]:{},M=[],W=[],U=[],q={name:w,Hidden:0},J.Sheets.push(q);break;case"table":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;d.push([c[3],!1]),re=[],ne=!1}break;case"style":c[1]==="/"?kj(j,H,n):H=ia(c[0]);break;case"numberformat":H.nf=kt(ia(c[0]).Format||"General"),bc[H.nf]&&(H.nf=bc[H.nf]);for(var ke=0;ke!=392&&ut[ke]!=H.nf;++ke);if(ke==392){for(ke=57;ke!=392;++ke)if(ut[ke]==null){pi(H.nf,ke);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(ue=ia(c[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!ne&&ue.wpx>10){ne=!0,ar=X2;for(var Ce=0;Ce<re.length;++Ce)re[Ce]&&Wo(re[Ce])}ne&&Wo(ue),re[ue.Index-1||re.length]=ue;for(var He=0;He<+ue.Span;++He)re[re.length]=Vn(ue);break;case"namedrange":if(c[1]==="/")break;J.Names||(J.Names=[]);var Z=et(c[0]),yt={Name:Z.Name,Ref:Po(Z.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(yt.Sheet=J.Sheets.length-1),J.Names.push(yt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?L+=r.slice(K,c.index):K=c.index+c[0].length;break;case"interior":if(!n.cellStyles)break;H.Interior=ia(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?hL(Q,ie,r.slice(ee,c.index)):ee=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else d.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));Rj(Te),Ie.push(Te)}else d.push([c[3],!1]),f=ia(c[0]),Te={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var qe=ia(c[0]);T["!autofilter"]={ref:Po(qe.Range).replace(/\$/g,"")},d.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"null":break;default:if(d.length==0&&c[3]=="document"||d.length==0&&c[3]=="uof")return bT(r,n);var it=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:it=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:it=!1}break;case"excelworkbook":switch(c[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:it=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:it=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(ee,c.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else ee=c.index+c[0].length;break;case"header":T["!margins"]||Sc(T["!margins"]={},"xlml"),isNaN(+et(c[0]).Margin)||(T["!margins"].header=+et(c[0]).Margin);break;case"footer":T["!margins"]||Sc(T["!margins"]={},"xlml"),isNaN(+et(c[0]).Margin)||(T["!margins"].footer=+et(c[0]).Margin);break;case"pagemargins":var rt=et(c[0]);T["!margins"]||Sc(T["!margins"]={},"xlml"),isNaN(+rt.Top)||(T["!margins"].top=+rt.Top),isNaN(+rt.Left)||(T["!margins"].left=+rt.Left),isNaN(+rt.Right)||(T["!margins"].right=+rt.Right),isNaN(+rt.Bottom)||(T["!margins"].bottom=+rt.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":T["!outline"]||(T["!outline"]={}),T["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":T["!outline"]||(T["!outline"]={}),T["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:it=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:it=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:it=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:it=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:it=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:it=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:it=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:it=!1}break;case"smarttags":break;default:it=!1;break}if(it||c[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?Cj(X,ie,ye,r.slice(ee,c.index)):(ye=c,ee=c.index+c[0].length);break}if(n.WTF)throw"Unrecognized tag: "+c[3]+"|"+d.join("|")}var Re={};return!n.bookSheets&&!n.bookProps&&(Re.Sheets=g),Re.SheetNames=y,Re.Workbook=J,Re.SSF=Vn(ut),Re.Props=Q,Re.Custprops=X,Re}function ym(t,e){switch(pp(e=e||{}),e.type||"base64"){case"base64":return Oh(Nr(t),e);case"binary":case"buffer":case"file":return Oh(t,e);case"array":return Oh(Ri(t),e)}}function Dj(t){var e={},n=t.content;if(n.l=28,e.AnsiUserType=n.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=zO(n),n.length-n.l<=4)return e;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,e.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(e.UnicodeClipboardFormat=qO(n),r=n.read_shift(4),r==0||r>40))return e;n.l-=4,e.Reserved2=n.read_shift(0,"lpwstr")}var Mj=[60,1084,2066,2165,2175];function Ij(t,e,n,r,a){var i=r,l=[],c=n.slice(n.l,n.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),n.l+=i;for(var d=Wa(n,n.l),f=_m[d],g=0;f!=null&&Mj.indexOf(d)>-1;)i=Wa(n,n.l+2),g=n.l+4,d==2066?g+=4:(d==2165||d==2175)&&(g+=12),c=n.slice(g,n.l+4+i),l.push(c),n.l+=4+i,f=_m[d=Wa(n,n.l)];var y=Ms(l);jn(y,0);var T=0;y.lens=[];for(var w=0;w<l.length;++w)y.lens.push(T),T+=l[w].length;if(y.length<r)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+y.length+" < "+r;return e.f(y,y.length,a)}function Ea(t,e,n){if(t.t!=="z"&&t.XF){var r=0;try{r=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ut[r])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ii[t.v]:r===0||r=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Ic(t.v):t.w=Si(t.v):t.w=Wr(r,t.v,{date1904:!!n,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&r&&t.t=="n"&&tl(ut[r]||String(r))){var a=mi(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function wf(t,e,n){return{v:t,ixfe:e,t:n}}function Fj(t,e){var n={opts:{}},r={},a=e.dense?[]:{},i={},l={},c=null,d=[],f="",g={},y,T="",w,E,S,b,N={},k=[],C,P,j=[],H=[],L={Sheets:[],WBProps:{date1904:!1},Views:[{}]},K={},M=function(De){return De<8?gi[De]:De<64&&H[De-8]||gi[De]},Q=function(De,Be,Tt){var ot=Be.XF.data;if(!(!ot||!ot.patternType||!Tt||!Tt.cellStyles)){Be.s={},Be.s.patternType=ot.patternType;var Bt;(Bt=Pc(M(ot.icvFore)))&&(Be.s.fgColor={rgb:Bt}),(Bt=Pc(M(ot.icvBack)))&&(Be.s.bgColor={rgb:Bt})}},X=function(De,Be,Tt){if(!(G>1)&&!(Tt.sheetRows&&De.r>=Tt.sheetRows)){if(Tt.cellStyles&&Be.XF&&Be.XF.data&&Q(De,Be,Tt),delete Be.ixfe,delete Be.XF,y=De,T=st(De),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),De.r<l.s.r&&(l.s.r=De.r),De.c<l.s.c&&(l.s.c=De.c),De.r+1>l.e.r&&(l.e.r=De.r+1),De.c+1>l.e.c&&(l.e.c=De.c+1),Tt.cellFormula&&Be.f){for(var ot=0;ot<k.length;++ot)if(!(k[ot][0].s.c>De.c||k[ot][0].s.r>De.r)&&!(k[ot][0].e.c<De.c||k[ot][0].e.r<De.r)){Be.F=At(k[ot][0]),(k[ot][0].s.c!=De.c||k[ot][0].s.r!=De.r)&&delete Be.f,Be.f&&(Be.f=""+Jn(k[ot][1],l,De,W,ee));break}}Tt.dense?(a[De.r]||(a[De.r]=[]),a[De.r][De.c]=Be):a[T]=Be}},ee={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(ee.password=e.password);var ye,Ie=[],Te=[],re=[],ue=[],ne=!1,W=[];W.SheetNames=ee.snames,W.sharedf=ee.sharedf,W.arrayf=ee.arrayf,W.names=[],W.XTI=[];var U=0,G=0,R=0,z=[],J=[],q;ee.codepage=1200,fa(1200);for(var ie=!1;t.l<t.length-1;){var we=t.l,_e=t.read_shift(2);if(_e===0&&U===10)break;var ke=t.l===t.length?0:t.read_shift(2),Ce=_m[_e];if(Ce&&Ce.f){if(e.bookSheets&&U===133&&_e!==133)break;if(U=_e,Ce.r===2||Ce.r==12){var He=t.read_shift(2);if(ke-=2,!ee.enc&&He!==_e&&((He&255)<<8|He>>8)!==_e)throw new Error("rt mismatch: "+He+"!="+_e);Ce.r==12&&(t.l+=10,ke-=10)}var Z={};if(_e===10?Z=Ce.f(t,ke,ee):Z=Ij(_e,Ce,t,ke,ee),G==0&&[9,521,1033,2057].indexOf(U)===-1)continue;switch(_e){case 34:n.opts.Date1904=L.WBProps.date1904=Z;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(ee.enc||(t.l=0),ee.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:ee.lastuser=Z;break;case 66:var yt=Number(Z);switch(yt){case 21010:yt=1200;break;case 32768:yt=1e4;break;case 32769:yt=1252;break}fa(ee.codepage=yt),ie=!0;break;case 317:ee.rrtabid=Z;break;case 25:ee.winlocked=Z;break;case 439:n.opts.RefreshAll=Z;break;case 12:n.opts.CalcCount=Z;break;case 16:n.opts.CalcDelta=Z;break;case 17:n.opts.CalcIter=Z;break;case 13:n.opts.CalcMode=Z;break;case 14:n.opts.CalcPrecision=Z;break;case 95:n.opts.CalcSaveRecalc=Z;break;case 15:ee.CalcRefMode=Z;break;case 2211:n.opts.FullCalc=Z;break;case 129:Z.fDialog&&(a["!type"]="dialog"),Z.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Z.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:j.push(Z);break;case 430:W.push([Z]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(Z);break;case 24:case 536:q={Name:Z.Name,Ref:Jn(Z.rgce,l,null,W,ee)},Z.itab>0&&(q.Sheet=Z.itab-1),W.names.push(q),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(J[Z.itab-1]={ref:At(Z.rgce[0][0][1][2])});break;case 22:ee.ExternCount=Z;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(Z),W.XTI=W.XTI.concat(Z);break;case 2196:if(ee.biff<8)break;q!=null&&(q.Comment=Z[1]);break;case 18:a["!protect"]=Z;break;case 19:Z!==0&&ee.WTF&&console.error("Password verifier: "+Z);break;case 133:i[Z.pos]=Z,ee.snames.push(Z.name);break;case 10:{if(--G)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=At(l),e.sheetRows&&e.sheetRows<=l.e.r){var qe=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=At(l),l.e.r=qe}l.e.r++,l.e.c++}Ie.length>0&&(a["!merges"]=Ie),Te.length>0&&(a["!objects"]=Te),re.length>0&&(a["!cols"]=re),ue.length>0&&(a["!rows"]=ue),L.Sheets.push(K)}f===""?g=a:r[f]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ee.biff===8&&(ee.biff={9:2,521:3,1033:4}[_e]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),ee.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(ee.biff=5,ie=!0,fa(ee.codepage=28591)),ee.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(ee.biff=2),G++)break;if(a=e.dense?[]:{},ee.biff<8&&!ie&&(ie=!0,fa(ee.codepage=e.codepage||1252)),ee.biff<5||Z.BIFFVer==0&&Z.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var it={pos:t.l-ke,name:f};i[it.pos]=it,ee.snames.push(f)}else f=(i[we]||{name:""}).name;Z.dt==32&&(a["!type"]="chart"),Z.dt==64&&(a["!type"]="macro"),Ie=[],Te=[],ee.arrayf=k=[],re=[],ue=[],ne=!1,K={Hidden:(i[we]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[Z.r]||[])[Z.c]:a[st({c:Z.c,r:Z.r})])&&++Z.c,C={ixfe:Z.ixfe,XF:j[Z.ixfe]||{},v:Z.val,t:"n"},R>0&&(C.z=z[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),X({c:Z.c,r:Z.r},C,e);break;case 5:case 517:C={ixfe:Z.ixfe,XF:j[Z.ixfe],v:Z.val,t:Z.t},R>0&&(C.z=z[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),X({c:Z.c,r:Z.r},C,e);break;case 638:C={ixfe:Z.ixfe,XF:j[Z.ixfe],v:Z.rknum,t:"n"},R>0&&(C.z=z[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),X({c:Z.c,r:Z.r},C,e);break;case 189:for(var rt=Z.c;rt<=Z.C;++rt){var Re=Z.rkrec[rt-Z.c][0];C={ixfe:Re,XF:j[Re],v:Z.rkrec[rt-Z.c][1],t:"n"},R>0&&(C.z=z[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),X({c:rt,r:Z.r},C,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){c=Z;break}if(C=wf(Z.val,Z.cell.ixfe,Z.tt),C.XF=j[C.ixfe],e.cellFormula){var Dt=Z.formula;if(Dt&&Dt[0]&&Dt[0][0]&&Dt[0][0][0]=="PtgExp"){var $t=Dt[0][0][1][0],dn=Dt[0][0][1][1],en=st({r:$t,c:dn});N[en]?C.f=""+Jn(Z.formula,l,Z.cell,W,ee):C.F=((e.dense?(a[$t]||[])[dn]:a[en])||{}).F}else C.f=""+Jn(Z.formula,l,Z.cell,W,ee)}R>0&&(C.z=z[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),X(Z.cell,C,e),c=Z}break;case 7:case 519:if(c)c.val=Z,C=wf(Z,c.cell.ixfe,"s"),C.XF=j[C.ixfe],e.cellFormula&&(C.f=""+Jn(c.formula,l,c.cell,W,ee)),R>0&&(C.z=z[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),X(c.cell,C,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(Z);var Gn=st(Z[0].s);if(w=e.dense?(a[Z[0].s.r]||[])[Z[0].s.c]:a[Gn],e.cellFormula&&w){if(!c||!Gn||!w)break;w.f=""+Jn(Z[1],l,Z[0],W,ee),w.F=At(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(T){if(!c)break;N[st(c.cell)]=Z[0],w=e.dense?(a[c.cell.r]||[])[c.cell.c]:a[st(c.cell)],(w||{}).f=""+Jn(Z[0],l,y,W,ee)}}break;case 253:C=wf(d[Z.isst].t,Z.ixfe,"s"),d[Z.isst].h&&(C.h=d[Z.isst].h),C.XF=j[C.ixfe],R>0&&(C.z=z[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),X({c:Z.c,r:Z.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:Z.ixfe,XF:j[Z.ixfe],t:"z"},R>0&&(C.z=z[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),X({c:Z.c,r:Z.r},C,e));break;case 190:if(e.sheetStubs)for(var Nn=Z.c;Nn<=Z.C;++Nn){var on=Z.ixfe[Nn-Z.c];C={ixfe:on,XF:j[on],t:"z"},R>0&&(C.z=z[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),X({c:Nn,r:Z.r},C,e)}break;case 214:case 516:case 4:C=wf(Z.val,Z.ixfe,"s"),C.XF=j[C.ixfe],R>0&&(C.z=z[C.ixfe>>8&63]),Ea(C,e,n.opts.Date1904),X({c:Z.c,r:Z.r},C,e);break;case 0:case 512:G===1&&(l=Z);break;case 252:d=Z;break;case 1054:if(ee.biff==4){z[R++]=Z[1];for(var wn=0;wn<R+163&&ut[wn]!=Z[1];++wn);wn>=163&&pi(Z[1],R+163)}else pi(Z[1],Z[0]);break;case 30:{z[R++]=Z;for(var ln=0;ln<R+163&&ut[ln]!=Z;++ln);ln>=163&&pi(Z,R+163)}break;case 229:Ie=Ie.concat(Z);break;case 93:Te[Z.cmo[0]]=ee.lastobj=Z;break;case 438:ee.lastobj.TxO=Z;break;case 127:ee.lastobj.ImData=Z;break;case 440:for(b=Z[0].s.r;b<=Z[0].e.r;++b)for(S=Z[0].s.c;S<=Z[0].e.c;++S)w=e.dense?(a[b]||[])[S]:a[st({c:S,r:b})],w&&(w.l=Z[1]);break;case 2048:for(b=Z[0].s.r;b<=Z[0].e.r;++b)for(S=Z[0].s.c;S<=Z[0].e.c;++S)w=e.dense?(a[b]||[])[S]:a[st({c:S,r:b})],w&&w.l&&(w.l.Tooltip=Z[1]);break;case 28:{if(ee.biff<=5&&ee.biff>=2)break;w=e.dense?(a[Z[0].r]||[])[Z[0].c]:a[st(Z[0])];var qt=Te[Z[2]];w||(e.dense?(a[Z[0].r]||(a[Z[0].r]=[]),w=a[Z[0].r][Z[0].c]={t:"z"}):w=a[st(Z[0])]={t:"z"},l.e.r=Math.max(l.e.r,Z[0].r),l.s.r=Math.min(l.s.r,Z[0].r),l.e.c=Math.max(l.e.c,Z[0].c),l.s.c=Math.min(l.s.c,Z[0].c)),w.c||(w.c=[]),E={a:Z[1],t:qt.TxO.t},w.c.push(E)}break;case 2173:n7(j[Z.ixfe],Z.ext);break;case 125:{if(!ee.cellStyles)break;for(;Z.e>=Z.s;)re[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},ne||(ne=!0,up(Z.w/256)),Wo(re[Z.e+1])}break;case 520:{var Ne={};Z.level!=null&&(ue[Z.r]=Ne,Ne.level=Z.level),Z.hidden&&(ue[Z.r]=Ne,Ne.hidden=!0),Z.hpt&&(ue[Z.r]=Ne,Ne.hpt=Z.hpt,Ne.hpx=Uc(Z.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Sc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[_e]]=Z;break;case 161:a["!margins"]||Sc(a["!margins"]={}),a["!margins"].header=Z.header,a["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(L.Views[0].RTL=!0);break;case 146:H=Z;break;case 2198:ye=Z;break;case 140:P=Z;break;case 442:f?K.CodeName=Z||K.name:L.WBProps.CodeName=Z||"ThisWorkbook";break}}else Ce||console.error("Missing Info for XLS Record 0x"+_e.toString(16)),t.l+=ke}return n.SheetNames=Ra(i).sort(function(Pe,De){return Number(Pe)-Number(De)}).map(function(Pe){return i[Pe].name}),e.bookSheets||(n.Sheets=r),!n.SheetNames.length&&g["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=g)):n.Preamble=g,n.Sheets&&J.forEach(function(Pe,De){n.Sheets[n.SheetNames[De]]["!autofilter"]=Pe}),n.Strings=d,n.SSF=Vn(ut),ee.enc&&(n.Encryption=ee.enc),ye&&(n.Themes=ye),n.Metadata={},P!==void 0&&(n.Metadata.Country=P),W.names.length>0&&(L.Names=W.names),n.Workbook=L,n}var _T={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Oj(t,e,n){var r=Ct.find(t,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=rT(r,ZO,_T.DSI);for(var i in a)e[i]=a[i]}catch(f){if(n.WTF)throw f}var l=Ct.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var c=rT(l,QO,_T.SI);for(var d in c)e[d]==null&&(e[d]=c[d])}catch(f){if(n.WTF)throw f}e.HeadingPairs&&e.TitlesOfParts&&(F2(e.HeadingPairs,e.TitlesOfParts,e,n),delete e.HeadingPairs,delete e.TitlesOfParts)}function xE(t,e){e||(e={}),pp(e),qw(),e.codepage&&Ym(e.codepage);var n,r;if(t.FullPaths){if(Ct.find(t,"/encryption"))throw new Error("File is password-protected");n=Ct.find(t,"!CompObj"),r=Ct.find(t,"/Workbook")||Ct.find(t,"/Book")}else{switch(e.type){case"base64":t=ua(Nr(t));break;case"binary":t=ua(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}jn(t,0),r={content:t}}var a,i;if(n&&Dj(n),e.bookProps&&!e.bookSheets)a={};else{var l=wt?"buffer":"array";if(r&&r.content)a=Fj(r.content,e);else if((i=Ct.find(t,"PerfectOffice_MAIN"))&&i.content)a=wc.to_workbook(i.content,(e.type=l,e));else if((i=Ct.find(t,"NativeContent_MAIN"))&&i.content)a=wc.to_workbook(i.content,(e.type=l,e));else throw(i=Ct.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Ct.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=_7(t))}var c={};return t.FullPaths&&Oj(t,c,e),a.Props=a.Custprops=c,e.bookFiles&&(a.cfb=t),a}var Wf={0:{f:gB},1:{f:_B},2:{f:NB},3:{f:SB},4:{f:wB},5:{f:kB},6:{f:MB},7:{f:CB},8:{f:PB},9:{f:LB},10:{f:FB},11:{f:OB},12:{f:TB},13:{f:RB},14:{f:bB},15:{f:EB},16:{f:dE},17:{f:IB},18:{f:AB},19:{f:ap},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:uj},40:{},42:{},43:{f:FU},44:{f:IU},45:{f:OU},46:{f:PU},47:{f:LU},48:{},49:{f:UO},50:{},51:{f:a7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:q2},62:{f:DB},63:{f:c7},64:{f:qB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:zB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:yB},148:{f:xB,p:16},151:{f:jB},152:{},153:{f:lj},154:{},155:{},156:{f:oj},157:{},158:{},159:{T:1,f:QP},160:{T:-1},161:{T:1,f:Mi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:UB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:r7},336:{T:-1},337:{f:s7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:z2},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:VB},427:{f:HB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$B},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:vB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:BB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:x7},633:{T:1},634:{T:-1},635:{T:1,f:g7},636:{T:-1},637:{f:jO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:ZB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:YB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},_m={6:{f:Ih},10:{f:As},12:{f:_n},13:{f:_n},14:{f:fn},15:{f:fn},16:{f:Wn},17:{f:fn},18:{f:fn},19:{f:_n},20:{f:oT},21:{f:oT},23:{f:z2},24:{f:cT},25:{f:fn},26:{},27:{},28:{f:mP},29:{},34:{f:fn},35:{f:lT},38:{f:Wn},39:{f:Wn},40:{f:Wn},41:{f:Wn},42:{f:fn},43:{f:fn},47:{f:vU},49:{f:WL},51:{f:_n},60:{},61:{f:qL},64:{f:fn},65:{f:JL},66:{f:_n},77:{},80:{},81:{},82:{},85:{f:_n},89:{},90:{},91:{},92:{f:UL},93:{f:gP},94:{},95:{f:fn},96:{},97:{},99:{f:fn},125:{f:q2},128:{f:sP},129:{f:BL},130:{f:_n},131:{f:fn},132:{f:fn},133:{f:jL},134:{},140:{f:wP},141:{f:_n},144:{},146:{f:SP},151:{},152:{},153:{},154:{},155:{},156:{f:_n},157:{},158:{},160:{f:NP},161:{f:CP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:tP},190:{f:nP},193:{f:As},197:{},198:{},199:{},200:{},201:{},202:{f:fn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_n},220:{},221:{f:fn},222:{},224:{f:aP},225:{f:PL},226:{f:As},227:{},229:{f:pP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:VL},253:{f:KL},255:{f:HL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:B2},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:fn},353:{f:As},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:oP},431:{f:fn},432:{},433:{},434:{},437:{},438:{f:yP},439:{f:fn},440:{f:_P},441:{},442:{f:qc},443:{},444:{f:_n},445:{},446:{},448:{f:As},449:{f:zL,r:2},450:{f:As},512:{f:sT},513:{f:kP},515:{f:iP},516:{f:XL},517:{f:iT},519:{f:RP},520:{f:GL},523:{},545:{f:uT},549:{f:aT},566:{},574:{f:YL},638:{f:eP},659:{},1048:{},1054:{f:ZL},1084:{},1212:{f:fP},2048:{f:TP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:yf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:As},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:bP,r:12},2173:{f:t7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:fn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:uP,r:12},2197:{},2198:{f:WU,r:12},2199:{},2200:{},2201:{},2202:{f:dP,r:12},2203:{f:As},2204:{},2205:{},2206:{},2207:{},2211:{f:$L},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_n},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:AP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:EP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:sT},1:{},2:{f:FP},3:{f:IP},4:{f:MP},5:{f:iT},7:{f:OP},8:{},9:{f:yf},11:{},22:{f:_n},30:{f:QL},31:{},32:{},33:{f:uT},36:{},37:{f:aT},50:{f:LP},62:{},52:{},67:{},68:{f:_n},69:{},86:{},126:{},127:{f:DP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:PP},223:{},234:{},354:{},421:{},518:{f:Ih},521:{f:yf},536:{f:cT},547:{f:lT},561:{},579:{},1030:{f:Ih},1033:{f:yf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function oa(t,e,n,r){var a=e;if(!isNaN(a)){var i=(n||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,i),i>0&&C2(n)&&t.push(n)}}function TT(t,e){var n=e||{},r=n.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),l=a.index,c=i&&i.index||t.length,d=iO(t.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,g=0,y=0,T=0,w={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(l=0;l<d.length;++l){var S=d[l].trim(),b=S.slice(0,3).toLowerCase();if(b=="<tr"){if(++f,n.sheetRows&&n.sheetRows<=f){--f;break}g=0;continue}if(!(b!="<td"&&b!="<th")){var N=S.split(/<\/t[dh]>/i);for(c=0;c<N.length;++c){var k=N[c].trim();if(k.match(/<t[dh]/i)){for(var C=k,P=0;C.charAt(0)=="<"&&(P=C.indexOf(">"))>-1;)C=C.slice(P+1);for(var j=0;j<E.length;++j){var H=E[j];H.s.c==g&&H.s.r<f&&f<=H.e.r&&(g=H.e.c+1,j=-1)}var L=et(k.slice(0,k.indexOf(">")));T=L.colspan?+L.colspan:1,((y=+L.rowspan)>1||T>1)&&E.push({s:{r:f,c:g},e:{r:f+(y||1)-1,c:g+T-1}});var K=L.t||L["data-t"]||"";if(!C.length){g+=T;continue}if(C=h2(C),w.s.r>f&&(w.s.r=f),w.e.r<f&&(w.e.r=f),w.s.c>g&&(w.s.c=g),w.e.c<g&&(w.e.c=g),!C.length){g+=T;continue}var M={t:"s",v:C};n.raw||!C.trim().length||K=="s"||(C==="TRUE"?M={t:"b",v:!0}:C==="FALSE"?M={t:"b",v:!1}:isNaN(ma(C))?isNaN(Jo(C).getDate())||(M={t:"d",v:Ln(C)},n.cellDates||(M={t:"n",v:lr(M.v)}),M.z=n.dateNF||ut[14]):M={t:"n",v:ma(C)}),n.dense?(r[f]||(r[f]=[]),r[f][g]=M):r[st({r:f,c:g})]=M,g+=T}}}}return r["!ref"]=At(w),E.length&&(r["!merges"]=E),r}function Lj(t,e,n,r){for(var a=t["!merges"]||[],i=[],l=e.s.c;l<=e.e.c;++l){for(var c=0,d=0,f=0;f<a.length;++f)if(!(a[f].s.r>n||a[f].s.c>l)&&!(a[f].e.r<n||a[f].e.c<l)){if(a[f].s.r<n||a[f].s.c<l){c=-1;break}c=a[f].e.r-a[f].s.r+1,d=a[f].e.c-a[f].s.c+1;break}if(!(c<0)){var g=st({r:n,c:l}),y=r.dense?(t[n]||[])[l]:t[g],T=y&&y.v!=null&&(y.h||Qm(y.w||(ts(y),y.w)||""))||"",w={};c>1&&(w.rowspan=c),d>1&&(w.colspan=d),r.editable?T='<span contenteditable="true">'+T+"</span>":y&&(w["data-t"]=y&&y.t||"z",y.v!=null&&(w["data-v"]=y.v),y.z!=null&&(w["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(T='<a href="'+y.l.Target+'">'+T+"</a>")),w.id=(r.id||"sjs")+"-"+g,i.push(wO("td",T,w))}}var E="<tr>";return E+i.join("")+"</tr>"}var Pj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Uj="</body></html>";function Bj(t,e){var n=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return $s(TT(n[0],e),e);var r=xp();return n.forEach(function(a,i){vp(r,TT(a,e),"Sheet"+(i+1))}),r}function jj(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Vj(t,e){var n=e||{},r=n.header!=null?n.header:Pj,a=n.footer!=null?n.footer:Uj,i=[r],l=nl(t["!ref"]);n.dense=Array.isArray(t),i.push(jj(t,l,n));for(var c=l.s.r;c<=l.e.r;++c)i.push(Lj(t,l,c,n));return i.push("</table>"+a),i.join("")}function vE(t,e,n){var r=n||{},a=0,i=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?sr(r.origin):r.origin;a=l.r,i=l.c}var c=e.getElementsByTagName("tr"),d=Math.min(r.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var g=nl(t["!ref"]);f.s.r=Math.min(f.s.r,g.s.r),f.s.c=Math.min(f.s.c,g.s.c),f.e.r=Math.max(f.e.r,g.e.r),f.e.c=Math.max(f.e.c,g.e.c),a==-1&&(f.e.r=a=g.e.r+1)}var y=[],T=0,w=t["!rows"]||(t["!rows"]=[]),E=0,S=0,b=0,N=0,k=0,C=0;for(t["!cols"]||(t["!cols"]=[]);E<c.length&&S<d;++E){var P=c[E];if(wT(P)){if(r.display)continue;w[S]={hidden:!0}}var j=P.children;for(b=N=0;b<j.length;++b){var H=j[b];if(!(r.display&&wT(H))){var L=H.hasAttribute("data-v")?H.getAttribute("data-v"):H.hasAttribute("v")?H.getAttribute("v"):h2(H.innerHTML),K=H.getAttribute("data-z")||H.getAttribute("z");for(T=0;T<y.length;++T){var M=y[T];M.s.c==N+i&&M.s.r<S+a&&S+a<=M.e.r&&(N=M.e.c+1-i,T=-1)}C=+H.getAttribute("colspan")||1,((k=+H.getAttribute("rowspan")||1)>1||C>1)&&y.push({s:{r:S+a,c:N+i},e:{r:S+a+(k||1)-1,c:N+i+(C||1)-1}});var Q={t:"s",v:L},X=H.getAttribute("data-t")||H.getAttribute("t")||"";L!=null&&(L.length==0?Q.t=X||"z":r.raw||L.trim().length==0||X=="s"||(L==="TRUE"?Q={t:"b",v:!0}:L==="FALSE"?Q={t:"b",v:!1}:isNaN(ma(L))?isNaN(Jo(L).getDate())||(Q={t:"d",v:Ln(L)},r.cellDates||(Q={t:"n",v:lr(Q.v)}),Q.z=r.dateNF||ut[14]):Q={t:"n",v:ma(L)})),Q.z===void 0&&K!=null&&(Q.z=K);var ee="",ye=H.getElementsByTagName("A");if(ye&&ye.length)for(var Ie=0;Ie<ye.length&&!(ye[Ie].hasAttribute("href")&&(ee=ye[Ie].getAttribute("href"),ee.charAt(0)!="#"));++Ie);ee&&ee.charAt(0)!="#"&&(Q.l={Target:ee}),r.dense?(t[S+a]||(t[S+a]=[]),t[S+a][N+i]=Q):t[st({c:N+i,r:S+a})]=Q,f.e.c<N+i&&(f.e.c=N+i),N+=C}}++S}return y.length&&(t["!merges"]=(t["!merges"]||[]).concat(y)),f.e.r=Math.max(f.e.r,S-1+a),t["!ref"]=At(f),S>=d&&(t["!fullref"]=At((f.e.r=c.length-E+S-1+a,f))),t}function yE(t,e){var n=e||{},r=n.dense?[]:{};return vE(r,t,e)}function Hj(t,e){return $s(yE(t,e),e)}function wT(t){var e="",n=Gj(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Gj(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function $j(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=kt(e.replace(/<[^>]*>/g,""));return[n]}var ET={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function _E(t,e){var n=e||{},r=ep(t),a=[],i,l,c={name:""},d="",f=0,g,y,T={},w=[],E=n.dense?[]:{},S,b,N={value:""},k="",C=0,P=[],j=-1,H=-1,L={s:{r:1e6,c:1e7},e:{r:0,c:0}},K=0,M={},Q=[],X={},ee=0,ye=0,Ie=[],Te=1,re=1,ue=[],ne={Names:[]},W={},U=["",""],G=[],R={},z="",J=0,q=!1,ie=!1,we=0;for(Oc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=Oc.exec(r);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"工作表":S[1]==="/"?(L.e.c>=L.s.c&&L.e.r>=L.s.r?E["!ref"]=At(L):E["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=L.e.r&&(E["!fullref"]=E["!ref"],L.e.r=n.sheetRows-1,E["!ref"]=At(L)),Q.length&&(E["!merges"]=Q),Ie.length&&(E["!rows"]=Ie),g.name=g.名称||g.name,typeof JSON<"u"&&JSON.stringify(g),w.push(g.name),T[g.name]=E,ie=!1):S[0].charAt(S[0].length-2)!=="/"&&(g=et(S[0],!1),j=H=-1,L.s.r=L.s.c=1e7,L.e.r=L.e.c=0,E=n.dense?[]:{},Q=[],Ie=[],ie=!0);break;case"table-row-group":S[1]==="/"?--K:++K;break;case"table-row":case"行":if(S[1]==="/"){j+=Te,Te=1;break}if(y=et(S[0],!1),y.行号?j=y.行号-1:j==-1&&(j=0),Te=+y["number-rows-repeated"]||1,Te<10)for(we=0;we<Te;++we)K>0&&(Ie[j+we]={level:K});H=-1;break;case"covered-table-cell":S[1]!=="/"&&++H,n.sheetStubs&&(n.dense?(E[j]||(E[j]=[]),E[j][H]={t:"z"}):E[st({r:j,c:H})]={t:"z"}),k="",P=[];break;case"table-cell":case"数据":if(S[0].charAt(S[0].length-2)==="/")++H,N=et(S[0],!1),re=parseInt(N["number-columns-repeated"]||"1",10),b={t:"z",v:null},N.formula&&n.cellFormula!=!1&&(b.f=xT(kt(N.formula))),(N.数据类型||N["value-type"])=="string"&&(b.t="s",b.v=kt(N["string-value"]||""),n.dense?(E[j]||(E[j]=[]),E[j][H]=b):E[st({r:j,c:H})]=b),H+=re-1;else if(S[1]!=="/"){++H,k="",C=0,P=[],re=1;var _e=Te?j+Te-1:j;if(H>L.e.c&&(L.e.c=H),H<L.s.c&&(L.s.c=H),j<L.s.r&&(L.s.r=j),_e>L.e.r&&(L.e.r=_e),N=et(S[0],!1),G=[],R={},b={t:N.数据类型||N["value-type"],v:null},n.cellFormula)if(N.formula&&(N.formula=kt(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(ee=parseInt(N["number-matrix-rows-spanned"],10)||0,ye=parseInt(N["number-matrix-columns-spanned"],10)||0,X={s:{r:j,c:H},e:{r:j+ee-1,c:H+ye-1}},b.F=At(X),ue.push([X,b.F])),N.formula)b.f=xT(N.formula);else for(we=0;we<ue.length;++we)j>=ue[we][0].s.r&&j<=ue[we][0].e.r&&H>=ue[we][0].s.c&&H<=ue[we][0].e.c&&(b.F=ue[we][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(ee=parseInt(N["number-rows-spanned"],10)||0,ye=parseInt(N["number-columns-spanned"],10)||0,X={s:{r:j,c:H},e:{r:j+ee-1,c:H+ye-1}},Q.push(X)),N["number-columns-repeated"]&&(re=parseInt(N["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=Qt(N["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(N.value);break;case"percentage":b.t="n",b.v=parseFloat(N.value);break;case"currency":b.t="n",b.v=parseFloat(N.value);break;case"date":b.t="d",b.v=Ln(N["date-value"]),n.cellDates||(b.t="n",b.v=lr(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=rO(N["time-value"])/86400,n.cellDates&&(b.t="d",b.v=id(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(N.数据数值);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",N["string-value"]!=null&&(k=kt(N["string-value"]),P=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(q=!1,b.t==="s"&&(b.v=k||"",P.length&&(b.R=P),q=C==0),W.Target&&(b.l=W),G.length>0&&(b.c=G,G=[]),k&&n.cellText!==!1&&(b.w=k),q&&(b.t="z",delete b.v),(!q||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=j))for(var ke=0;ke<Te;++ke){if(re=parseInt(N["number-columns-repeated"]||"1",10),n.dense)for(E[j+ke]||(E[j+ke]=[]),E[j+ke][H]=ke==0?b:Vn(b);--re>0;)E[j+ke][H+re]=Vn(b);else for(E[st({r:j+ke,c:H})]=b;--re>0;)E[st({r:j+ke,c:H+re})]=Vn(b);L.e.c<=H&&(L.e.c=H)}re=parseInt(N["number-columns-repeated"]||"1",10),H+=re-1,re=0,b={},k="",P=[]}W={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i;R.t=k,P.length&&(R.R=P),R.a=z,G.push(R)}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);z="",J=0,k="",C=0,P=[];break;case"creator":S[1]==="/"?z=r.slice(J,S.index):J=S.index+S[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);k="",C=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(M[c.name]=d,(i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&(d="",c=et(S[0],!1),a.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=et(S[0],!1),d+=ET[S[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=et(S[0],!1),d+=ET[S[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":d+=r.slice(f,S.index);break}else f=S.index+S[0].length;break;case"named-range":l=et(S[0],!1),U=Fh(l["cell-range-address"]);var Ce={Name:l.name,Ref:U[0]+"!"+U[1]};ie&&(Ce.Sheet=w.length),ne.Names.push(Ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(S[1]==="/"&&(!N||!N["string-value"])){var He=$j(r.slice(C,S.index));k=(k.length>0?k+`
`:"")+He[0]}else et(S[0],!1),C=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{U=Fh(et(S[0])["target-range-address"]),T[U[0]]["!autofilter"]={ref:U[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(W=et(S[0],!1),!W.href)break;W.Target=kt(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(U=Fh(W.Target.slice(1)),W.Target="#"+U[0]+"!"+U[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(n.WTF)throw new Error(S)}}var Z={Sheets:T,SheetNames:w,Workbook:ne};return n.bookSheets&&delete Z.Sheets,Z}function ST(t,e){e=e||{},qr(t,"META-INF/manifest.xml")&&iL(yn(t,"META-INF/manifest.xml"),e);var n=kr(t,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=_E(Wt(n),e);return qr(t,"meta.xml")&&(r.Props=I2(yn(t,"meta.xml"))),r}function bT(t,e){return _E(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function hp(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Tm(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Wt(Ri(t))}function wm(t){var e=t.reduce(function(a,i){return a+i.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(a){n.set(a,r),r+=a.length}),n}function CT(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function zj(t,e){for(var n=(t[e+15]&127)<<7|t[e+14]>>1,r=t[e+14]&1,a=e+13;a>=e;--a)r=r*256+t[a];return(t[e+15]&128?-r:r)*Math.pow(10,n-6176)}function Bc(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function kn(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function Xn(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],a=Bc(t,n),i=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(i){case 0:{for(var d=n[0];t[n[0]++]>=128;);c=t.slice(d,n[0])}break;case 5:l=4,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 1:l=8,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 2:l=Bc(t,n),c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(r))}var f={data:c,type:i};e[a]==null?e[a]=[f]:e[a].push(f)}return e}function mp(t,e){return(t==null?void 0:t.map(function(n){return e(n.data)}))||[]}function qj(t){for(var e,n=[],r=[0];r[0]<t.length;){var a=Bc(t,r),i=Xn(t.slice(r[0],r[0]+a));r[0]+=a;var l={id:kn(i[1][0].data),messages:[]};i[2].forEach(function(c){var d=Xn(c.data),f=kn(d[3][0].data);l.messages.push({meta:d,data:t.slice(r[0],r[0]+f)}),r[0]+=f}),(e=i[3])!=null&&e[0]&&(l.merge=kn(i[3][0].data)>>>0>0),n.push(l)}return n}function Yj(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=Bc(e,n),a=[];n[0]<e.length;){var i=e[n[0]]&3;if(i==0){var l=e[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=e[n[0]],c>1&&(l|=e[n[0]+1]<<8),c>2&&(l|=e[n[0]+2]<<16),c>3&&(l|=e[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(e.slice(n[0],n[0]+l)),n[0]+=l;continue}else{var d=0,f=0;if(i==1?(f=(e[n[0]]>>2&7)+4,d=(e[n[0]++]&224)<<3,d|=e[n[0]++]):(f=(e[n[0]++]>>2)+1,i==2?(d=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(d=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),a=[wm(a)],d==0)throw new Error("Invalid offset 0");if(d>a[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(a.push(a[0].slice(-d)),f-=d;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-d,-d+f))}}var g=wm(a);if(g.length!=r)throw new Error("Unexpected length: ".concat(g.length," != ").concat(r));return g}function Jj(t){for(var e=[],n=0;n<t.length;){var r=t[n++],a=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push(Yj(r,t.slice(n,n+a))),n+=a}if(n!==t.length)throw new Error("data is not a valid framed stream!");return wm(e)}function Wj(t,e,n,r){var a=hp(t),i=a.getUint32(4,!0),l=(r>1?12:8)+CT(i&(r>1?3470:398))*4,c=-1,d=-1,f=NaN,g=new Date(2001,0,1);i&512&&(c=a.getUint32(l,!0),l+=4),l+=CT(i&(r>1?12288:4096))*4,i&16&&(d=a.getUint32(l,!0),l+=4),i&32&&(f=a.getFloat64(l,!0),l+=8),i&64&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var y;switch(t[2]){case 0:break;case 2:y={t:"n",v:f};break;case 3:y={t:"s",v:e[d]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:f>0};break;case 7:y={t:"n",v:f/86400};break;case 8:y={t:"e",v:0};break;case 9:if(c>-1)y={t:"s",v:n[c]};else if(d>-1)y={t:"s",v:e[d]};else if(!isNaN(f))y={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return y}function Kj(t,e,n){var r=hp(t),a=r.getUint32(8,!0),i=12,l=-1,c=-1,d=NaN,f=NaN,g=new Date(2001,0,1);a&1&&(d=zj(t,i),i+=16),a&2&&(f=r.getFloat64(i,!0),i+=8),a&4&&(g.setTime(g.getTime()+r.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=r.getUint32(i,!0),i+=4),a&16&&(l=r.getUint32(i,!0),i+=4);var y;switch(t[1]){case 0:break;case 2:y={t:"n",v:d};break;case 3:y={t:"s",v:e[c]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:f>0};break;case 7:y={t:"n",v:f/86400};break;case 8:y={t:"e",v:0};break;case 9:if(l>-1)y={t:"s",v:n[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:y={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return y}function Xj(t,e,n){switch(t[0]){case 0:case 1:case 2:case 3:return Wj(t,e,n,t[0]);case 5:return Kj(t,e,n);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Ps(t){var e=Xn(t);return Bc(e[1][0].data)}function AT(t,e){var n=Xn(e.data),r=kn(n[1][0].data),a=n[3],i=[];return(a||[]).forEach(function(l){var c=Xn(l.data),d=kn(c[1][0].data)>>>0;switch(r){case 1:i[d]=Tm(c[3][0].data);break;case 8:{var f=t[Ps(c[9][0].data)][0],g=Xn(f.data),y=t[Ps(g[1][0].data)][0],T=kn(y.meta[1][0].data);if(T!=2001)throw new Error("2000 unexpected reference to ".concat(T));var w=Xn(y.data);i[d]=w[3].map(function(E){return Tm(E.data)}).join("")}break}}),i}function Zj(t,e){var n,r,a,i,l,c,d,f,g,y,T,w,E,S,b=Xn(t),N=kn(b[1][0].data)>>>0,k=kn(b[2][0].data)>>>0,C=((r=(n=b[8])==null?void 0:n[0])==null?void 0:r.data)&&kn(b[8][0].data)>0||!1,P,j;if((i=(a=b[7])==null?void 0:a[0])!=null&&i.data&&e!=0)P=(c=(l=b[7])==null?void 0:l[0])==null?void 0:c.data,j=(f=(d=b[6])==null?void 0:d[0])==null?void 0:f.data;else if((y=(g=b[4])==null?void 0:g[0])!=null&&y.data&&e!=1)P=(w=(T=b[4])==null?void 0:T[0])==null?void 0:w.data,j=(S=(E=b[3])==null?void 0:E[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var H=C?4:1,L=hp(P),K=[],M=0;M<P.length/2;++M){var Q=L.getUint16(M*2,!0);Q<65535&&K.push([M,Q])}if(K.length!=k)throw"Expected ".concat(k," cells, found ").concat(K.length);var X=[];for(M=0;M<K.length-1;++M)X[K[M][0]]=j.subarray(K[M][1]*H,K[M+1][1]*H);return K.length>=1&&(X[K[K.length-1][0]]=j.subarray(K[K.length-1][1]*H)),{R:N,cells:X}}function Qj(t,e){var n,r=Xn(e.data),a=(n=r==null?void 0:r[7])!=null&&n[0]?kn(r[7][0].data)>>>0>0?1:0:-1,i=mp(r[5],function(l){return Zj(l,a)});return{nrows:kn(r[4][0].data)>>>0,data:i.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(d,f){if(l[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));l[c.R][f]=d}),l},[])}}function eV(t,e,n){var r,a=Xn(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(kn(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(kn(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=At(i);var l=Xn(a[4][0].data),c=AT(t,t[Ps(l[4][0].data)][0]),d=(r=l[17])!=null&&r[0]?AT(t,t[Ps(l[17][0].data)][0]):[],f=Xn(l[3][0].data),g=0;f[1].forEach(function(y){var T=Xn(y.data),w=t[Ps(T[2][0].data)][0],E=kn(w.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var S=Qj(t,w);S.data.forEach(function(b,N){b.forEach(function(k,C){var P=st({r:g+N,c:C}),j=Xj(k,c,d);j&&(n[P]=j)})}),g+=S.nrows})}function tV(t,e){var n=Xn(e.data),r={"!ref":"A1"},a=t[Ps(n[2][0].data)],i=kn(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return eV(t,a[0],r),r}function nV(t,e){var n,r=Xn(e.data),a={name:(n=r[1])!=null&&n[0]?Tm(r[1][0].data):"",sheets:[]},i=mp(r[2],Ps);return i.forEach(function(l){t[l].forEach(function(c){var d=kn(c.meta[1][0].data);d==6e3&&a.sheets.push(tV(t,c))})}),a}function rV(t,e){var n=xp(),r=Xn(e.data),a=mp(r[1],Ps);if(a.forEach(function(i){t[i].forEach(function(l){var c=kn(l.meta[1][0].data);if(c==2){var d=nV(t,l);d.sheets.forEach(function(f,g){vp(n,f,g==0?d.name:d.name+"_"+g,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function Lh(t){var e,n,r,a,i={},l=[];if(t.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var f;try{f=Jj(d.content)}catch(y){return console.log("?? "+d.content.length+" "+(y.message||y))}var g;try{g=qj(f)}catch(y){return console.log("## "+(y.message||y))}g.forEach(function(y){i[y.id]=y.messages,l.push(y.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(n=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&kn(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||l.forEach(function(d){i[d].forEach(function(f){var g=kn(f.meta[1][0].data)>>>0;if(g==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return rV(i,c)}function aV(t){return function(n){for(var r=0;r!=t.length;++r){var a=t[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function pp(t){aV([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function sV(t){return Io.WS.indexOf(t)>-1?"sheet":t==Io.CS?"chart":t==Io.DS?"dialog":t==Io.MS?"macro":t&&t.length?t:"sheet"}function iV(t,e){if(!t)return 0;try{t=e.map(function(r){return r.id||(r.id=r.strRelID),[r.name,t["!id"][r.id].Target,sV(t["!id"][r.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function oV(t,e,n,r,a,i,l,c,d,f,g,y){try{i[r]=_c(kr(t,n,!0),e);var T=yn(t,e),w;switch(c){case"sheet":w=hj(T,e,a,d,i[r],f,g,y);break;case"chart":if(w=mj(T,e,a,d,i[r],f,g,y),!w||!w["!drawel"])break;var E=cc(w["!drawel"].Target,e),S=gm(E),b=d7(kr(t,E,!0),_c(kr(t,S,!0),E)),N=cc(b,E),k=gm(N);w=KB(kr(t,N,!0),N,d,_c(kr(t,k,!0),N),f,w);break;case"macro":w=pj(T,e,a,d,i[r],f,g,y);break;case"dialog":w=gj(T,e,a,d,i[r],f,g,y);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=w;var C=[];i&&i[r]&&Ra(i[r]).forEach(function(P){var j="";if(i[r][P].Type==Io.CMNT){j=cc(i[r][P].Target,e);var H=_j(yn(t,j,!0),j,d);if(!H||!H.length)return;dT(w,H,!1)}i[r][P].Type==Io.TCMNT&&(j=cc(i[r][P].Target,e),C=C.concat(m7(yn(t,j,!0),d)))}),C&&C.length&&dT(w,C,!0,d.people||[])}catch(P){if(d.WTF)throw P}}function $r(t){return t.charAt(0)=="/"?t.slice(1):t}function lV(t,e){if(a2(),e=e||{},pp(e),qr(t,"META-INF/manifest.xml")||qr(t,"objectdata.xml"))return ST(t,e);if(qr(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Lh<"u"){if(t.FileIndex)return Lh(t);var n=Ct.utils.cfb_new();return B_(t).forEach(function(Ie){cO(n,Ie,lO(t,Ie))}),Lh(n)}throw new Error("Unsupported NUMBERS file")}if(!qr(t,"[Content_Types].xml"))throw qr(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):qr(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=B_(t),a=aL(kr(t,"[Content_Types].xml")),i=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",yn(t,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!yn(t,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var d={},f={};if(!e.bookSheets&&!e.bookProps){if(Ec=[],a.sst)try{Ec=yj(yn(t,$r(a.sst)),a.sst,e)}catch(Ie){if(e.WTF)throw Ie}e.cellStyles&&a.themes.length&&(d=vj(kr(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(f=xj(yn(t,$r(a.style)),a.style,d,e))}a.links.map(function(Ie){try{var Te=_c(kr(t,gm($r(Ie))),Ie);return wj(yn(t,$r(Ie)),Te,Ie,e)}catch{}});var g=dj(yn(t,$r(a.workbooks[0])),a.workbooks[0],e),y={},T="";a.coreprops.length&&(T=yn(t,$r(a.coreprops[0]),!0),T&&(y=I2(T)),a.extprops.length!==0&&(T=yn(t,$r(a.extprops[0]),!0),T&&cL(T,y,e)));var w={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(T=kr(t,$r(a.custprops[0]),!0),T&&(w=fL(T,e)));var E={};if((e.bookSheets||e.bookProps)&&(g.Sheets?l=g.Sheets.map(function(Te){return Te.name}):y.Worksheets&&y.SheetNames.length>0&&(l=y.SheetNames),e.bookProps&&(E.Props=y,E.Custprops=w),e.bookSheets&&typeof l<"u"&&(E.SheetNames=l),e.bookSheets?E.SheetNames:e.bookProps))return E;l={};var S={};e.bookDeps&&a.calcchain&&(S=Tj(yn(t,$r(a.calcchain)),a.calcchain));var b=0,N={},k,C;{var P=g.Sheets;y.Worksheets=P.length,y.SheetNames=[];for(var j=0;j!=P.length;++j)y.SheetNames[j]=P[j].name}var H=i?"bin":"xml",L=a.workbooks[0].lastIndexOf("/"),K=(a.workbooks[0].slice(0,L+1)+"_rels/"+a.workbooks[0].slice(L+1)+".rels").replace(/^\//,"");qr(t,K)||(K="xl/_rels/workbook."+H+".rels");var M=_c(kr(t,K,!0),K.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=Ej(yn(t,$r(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=p7(yn(t,$r(a.people[0])),e)),M&&(M=iV(M,g.Sheets));var Q=yn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=y.Worksheets;++b){var X="sheet";if(M&&M[b]?(k="xl/"+M[b][1].replace(/[\/]?xl\//,""),qr(t,k)||(k=M[b][1]),qr(t,k)||(k=K.replace(/_rels\/.*$/,"")+M[b][1]),X=M[b][2]):(k="xl/worksheets/sheet"+(b+1-Q)+"."+H,k=k.replace(/sheet0\./,"sheet.")),C=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(b!=e.sheets)continue e;break;case"string":if(y.SheetNames[b].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var ee=!1,ye=0;ye!=e.sheets.length;++ye)typeof e.sheets[ye]=="number"&&e.sheets[ye]==b&&(ee=1),typeof e.sheets[ye]=="string"&&e.sheets[ye].toLowerCase()==y.SheetNames[b].toLowerCase()&&(ee=1);if(!ee)continue e}}oV(t,k,C,y.SheetNames[b],b,N,l,X,e,g,d,f)}return E={Directory:a,Workbook:g,Props:y,Custprops:w,Deps:S,Sheets:l,SheetNames:y.SheetNames,Strings:Ec,Styles:f,Themes:d,SSF:Vn(ut)},e&&e.bookFiles&&(t.files?(E.keys=r,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Ie,Te){Ie=Ie.replace(/^Root Entry[\/]/,""),E.keys.push(Ie),E.files[Ie]=t.FileIndex[Te]}))),e&&e.bookVBA&&(a.vba.length>0?E.vbaraw=yn(t,$r(a.vba[0]),!0):a.defaults&&a.defaults.bin===y7&&(E.vbaraw=yn(t,"xl/vbaProject.bin",!0))),E}function cV(t,e){var n=e||{},r="Workbook",a=Ct.find(t,r);try{if(r="/!DataSpaces/Version",a=Ct.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(tU(a.content),r="/!DataSpaces/DataSpaceMap",a=Ct.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=rU(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ct.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=aU(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ct.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);iU(a.content)}catch{}if(r="/EncryptionInfo",a=Ct.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=oU(a.content);if(r="/EncryptedPackage",a=Ct.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,n.password||"",n);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function gp(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=Nr(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function uV(t,e){return Ct.find(t,"EncryptedPackage")?cV(t,e):xE(t,e)}function fV(t,e){var n,r=t,a=e||{};return a.type||(a.type=wt&&Buffer.isBuffer(t)?"buffer":"base64"),n=u2(r,a),lV(n,a)}function TE(t,e){var n=0;e:for(;n<t.length;)switch(t.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return ym(t.slice(n),e);default:break e}return Lc.to_workbook(t,e)}function dV(t,e){var n="",r=gp(t,e);switch(e.type){case"base64":n=Nr(t);break;case"binary":n=t;break;case"buffer":n=t.toString("binary");break;case"array":n=bi(t);break;default:throw new Error("Unrecognized type "+e.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=Wt(n)),e.type="binary",TE(n,e)}function hV(t,e){var n=t;return e.type=="base64"&&(n=Nr(n)),n=Mc.utils.decode(1200,n.slice(2),"str"),e.type="binary",TE(n,e)}function mV(t){return t.match(/[^\x00-\x7F]/)?uc(t):t}function Ph(t,e,n,r){return r?(n.type="string",Lc.to_workbook(t,n)):Lc.to_workbook(e,n)}function Em(t,e){qw();var n=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Em(new Uint8Array(t),(n=Vn(n),n.type="array",n));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=t,a=[0,0,0,0],i=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),Uo={},n.dateNF&&(Uo.dateNF=n.dateNF),n.type||(n.type=wt&&Buffer.isBuffer(t)?"buffer":"base64"),n.type=="file"&&(n.type=wt?"buffer":"binary",r=tO(t),typeof Uint8Array<"u"&&!wt&&(n.type="array")),n.type=="string"&&(i=!0,n.type="binary",n.codepage=65001,r=mV(t)),n.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return n=Vn(n),n.type="array",Em(Jm(r),n)}switch((a=gp(r,n))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return uV(Ct.read(r,n),n);break;case 9:if(a[1]<=8)return xE(r,n);break;case 60:return ym(r,n);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return HP(r,n);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return jP.to_workbook(r,n);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?fV(r,n):Ph(t,r,n,i);case 239:return a[3]===60?ym(r,n):Ph(t,r,n,i);case 255:if(a[1]===254)return hV(r,n);if(a[1]===0&&a[2]===2&&a[3]===0)return wc.to_workbook(r,n);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return wc.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return fT.to_workbook(r,n);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return yU.to_workbook(r,n);break;case 10:case 13:case 32:return dV(r,n);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return UP.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?fT.to_workbook(r,n):Ph(t,r,n,i)}function pV(t,e,n,r,a,i,l,c){var d=Hn(n),f=c.defval,g=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),y=!0,T=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(T,"__rowNum__",{value:n,enumerable:!1})}catch{T.__rowNum__=n}else T.__rowNum__=n;if(!l||t[n])for(var w=e.s.c;w<=e.e.c;++w){var E=l?t[n][w]:t[r[w]+d];if(E===void 0||E.t===void 0){if(f===void 0)continue;i[w]!=null&&(T[i[w]]=f);continue}var S=E.v;switch(E.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(i[w]!=null){if(S==null)if(E.t=="e"&&S===null)T[i[w]]=null;else if(f!==void 0)T[i[w]]=f;else if(g&&S===null)T[i[w]]=null;else continue;else T[i[w]]=g&&(E.t!=="n"||E.t==="n"&&c.rawNumbers!==!1)?S:ts(E,S,c);S!=null&&(y=!1)}}return{row:T,isempty:y}}function Sm(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,i=[],l=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},g=f.range!=null?f.range:t["!ref"];switch(f.header===1?r=1:f.header==="A"?r=2:Array.isArray(f.header)?r=3:f.header==null&&(r=0),typeof g){case"string":d=sn(g);break;case"number":d=sn(t["!ref"]),d.s.r=g;break;default:d=g}r>0&&(a=0);var y=Hn(d.s.r),T=[],w=[],E=0,S=0,b=Array.isArray(t),N=d.s.r,k=0,C={};b&&!t[N]&&(t[N]=[]);var P=f.skipHidden&&t["!cols"]||[],j=f.skipHidden&&t["!rows"]||[];for(k=d.s.c;k<=d.e.c;++k)if(!(P[k]||{}).hidden)switch(T[k]=An(k),n=b?t[N][k]:t[T[k]+y],r){case 1:i[k]=k-d.s.c;break;case 2:i[k]=T[k];break;case 3:i[k]=f.header[k-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=l=ts(n,null,f),S=C[l]||0,!S)C[l]=1;else{do c=l+"_"+S++;while(C[c]);C[l]=S,C[c]=1}i[k]=c}for(N=d.s.r+a;N<=d.e.r;++N)if(!(j[N]||{}).hidden){var H=pV(t,d,N,T,r,i,b,f);(H.isempty===!1||(r===1?f.blankrows!==!1:f.blankrows))&&(w[E++]=H.row)}return w.length=E,w}var kT=/"/g;function gV(t,e,n,r,a,i,l,c){for(var d=!0,f=[],g="",y=Hn(n),T=e.s.c;T<=e.e.c;++T)if(r[T]){var w=c.dense?(t[n]||[])[T]:t[r[T]+y];if(w==null)g="";else if(w.v!=null){d=!1,g=""+(c.rawNumbers&&w.t=="n"?w.v:ts(w,null,c));for(var E=0,S=0;E!==g.length;++E)if((S=g.charCodeAt(E))===a||S===i||S===34||c.forceQuotes){g='"'+g.replace(kT,'""')+'"';break}g=="ID"&&(g='"ID"')}else w.f!=null&&!w.F?(d=!1,g="="+w.f,g.indexOf(",")>=0&&(g='"'+g.replace(kT,'""')+'"')):g="";f.push(g)}return c.blankrows===!1&&d?null:f.join(l)}function wE(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var a=sn(t["!ref"]),i=r.FS!==void 0?r.FS:",",l=i.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,d=c.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),g="",y=[];r.dense=Array.isArray(t);for(var T=r.skipHidden&&t["!cols"]||[],w=r.skipHidden&&t["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(T[E]||{}).hidden||(y[E]=An(E));for(var S=0,b=a.s.r;b<=a.e.r;++b)(w[b]||{}).hidden||(g=gV(t,a,b,y,l,d,i,r),g!=null&&(r.strip&&(g=g.replace(f,"")),(g||r.blankrows!==!1)&&n.push((S++?c:"")+g)));return delete r.dense,n.join("")}function xV(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=wE(t,e);return n}function vV(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var a=sn(t["!ref"]),i="",l=[],c,d=[],f=Array.isArray(t);for(c=a.s.c;c<=a.e.c;++c)l[c]=An(c);for(var g=a.s.r;g<=a.e.r;++g)for(i=Hn(g),c=a.s.c;c<=a.e.c;++c)if(e=l[c]+i,n=f?(t[g]||[])[c]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}d[d.length]=e+"="+r}return d}function EE(t,e,n){var r=n||{},a=+!r.skipHeader,i=t||{},l=0,c=0;if(i&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?sr(r.origin):r.origin;l=d.r,c=d.c}var f,g={s:{c:0,r:0},e:{c,r:l+e.length-1+a}};if(i["!ref"]){var y=sn(i["!ref"]);g.e.c=Math.max(g.e.c,y.e.c),g.e.r=Math.max(g.e.r,y.e.r),l==-1&&(l=y.e.r+1,g.e.r=l+e.length-1+a)}else l==-1&&(l=0,g.e.r=e.length-1+a);var T=r.header||[],w=0;e.forEach(function(S,b){Ra(S).forEach(function(N){(w=T.indexOf(N))==-1&&(T[w=T.length]=N);var k=S[N],C="z",P="",j=st({c:c+w,r:l+b+a});f=jc(i,j),k&&typeof k=="object"&&!(k instanceof Date)?i[j]=k:(typeof k=="number"?C="n":typeof k=="boolean"?C="b":typeof k=="string"?C="s":k instanceof Date?(C="d",r.cellDates||(C="n",k=lr(k)),P=r.dateNF||ut[14]):k===null&&r.nullError&&(C="e",k=0),f?(f.t=C,f.v=k,delete f.w,delete f.R,P&&(f.z=P)):i[j]=f={t:C,v:k},P&&(f.z=P))})}),g.e.c=Math.max(g.e.c,c+T.length-1);var E=Hn(l);if(a)for(w=0;w<T.length;++w)i[An(w+c)+E]={t:"s",v:T[w]};return i["!ref"]=At(g),i}function yV(t,e){return EE(null,t,e)}function jc(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=sr(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?jc(t,st(e)):jc(t,st({r:e,c:n||0}))}function _V(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function xp(){return{SheetNames:[],Sheets:{}}}function vp(t,e,n,r){var a=1;if(!n)for(;a<=65535&&t.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var l=i&&i[1]||n;for(++a;a<=65535&&t.SheetNames.indexOf(n=l+a)!=-1;++a);}if(aj(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function TV(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=_V(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function wV(t,e){return t.z=e,t}function SE(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function EV(t,e,n){return SE(t,"#"+e,n)}function SV(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function bV(t,e,n,r){for(var a=typeof e!="string"?e:sn(e),i=typeof e=="string"?e:At(e),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var d=jc(t,l,c);d.t="n",d.F=i,delete d.v,l==a.s.r&&c==a.s.c&&(d.f=n,r&&(d.D=!0))}return t}var CV={encode_col:An,encode_row:Hn,encode_cell:st,encode_range:At,decode_col:rp,decode_row:np,split_cell:PO,decode_cell:sr,decode_range:nl,format_cell:ts,sheet_add_aoa:k2,sheet_add_json:EE,sheet_add_dom:vE,aoa_to_sheet:rl,json_to_sheet:yV,table_to_sheet:yE,table_to_book:Hj,sheet_to_csv:wE,sheet_to_txt:xV,sheet_to_json:Sm,sheet_to_html:Vj,sheet_to_formulae:vV,sheet_to_row_object_array:Sm,sheet_get_cell:jc,book_new:xp,book_append_sheet:vp,book_set_sheet_visibility:TV,cell_set_number_format:wV,cell_set_hyperlink:SE,cell_set_internal_link:EV,cell_add_comment:SV,sheet_set_array_formula:bV,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const AV=({matrixData:t,onUpdate:e})=>{const n=(d,f)=>e({...t,headers:t.headers.map((g,y)=>y===d?f:g)}),r=(d,f,g)=>e({...t,rows:t.rows.map((y,T)=>T===d?y.map((w,E)=>E===f?g:w):y)}),a=()=>e({...t,rows:[...t.rows,Array(t.headers.length).fill("")]}),i=d=>e({...t,rows:t.rows.filter((f,g)=>g!==d)}),l=()=>{const d=`列 ${t.headers.length+1}`;e({headers:[...t.headers,d],rows:t.rows.map(f=>[...f,""])})},c=d=>{t.headers.length<=1||e({headers:t.headers.filter((f,g)=>g!==d),rows:t.rows.map(f=>f.filter((g,y)=>y!==d))})};return x.jsxs("div",{className:"overflow-x-auto p-1 bg-slate-50 rounded-md border",children:[x.jsxs("table",{className:"w-full text-xs border-collapse",children:[x.jsx("thead",{children:x.jsxs("tr",{className:"bg-slate-200",children:[t.headers.map((d,f)=>x.jsx("th",{className:"border border-slate-300 p-0 font-semibold text-slate-700",children:x.jsxs("div",{className:"flex items-center justify-between gap-1 px-1",children:[x.jsx("input",{type:"text",value:d,onChange:g=>n(f,g.target.value),className:"w-full bg-transparent outline-none text-center font-semibold text-slate-800"}),x.jsx("button",{onClick:()=>c(f),className:"text-red-500 hover:text-red-700 opacity-30 hover:opacity-100",title:"列を削除",children:x.jsx(ha,{className:"w-3 h-3"})})]})},f)),x.jsx("th",{className:"border border-slate-300 p-1 w-10"})]})}),x.jsx("tbody",{children:t.rows.map((d,f)=>x.jsxs("tr",{children:[d.map((g,y)=>x.jsx("td",{className:"border border-slate-300 p-0",children:x.jsx("input",{type:"text",value:g,onChange:T=>r(f,y,T.target.value),className:"w-full bg-white text-slate-900 outline-none p-1 focus:bg-blue-50"})},y)),x.jsx("td",{className:"border border-slate-300 p-1 text-center",children:x.jsx("button",{onClick:()=>i(f),className:"text-red-500 hover:text-red-700",title:"行を削除",children:x.jsx(ha,{className:"w-3 h-3"})})})]},f))})]}),x.jsxs("div",{className:"flex gap-2 mt-2",children:[x.jsxs("button",{onClick:a,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[x.jsx(Bs,{className:"w-3 h-3"}),"行を追加"]}),x.jsxs("button",{onClick:l,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[x.jsx(Bs,{className:"w-3 h-3"}),"列を追加"]})]})]})},NT=t=>{const e=Math.cos(2*Math.PI*t),n=Math.sin(2*Math.PI*t);return[e,n]},kV=({data:t,title:e})=>{const n=t.reduce((l,c)=>l+c.value,0);if(n===0)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"});let r=0;const a=["#4A90E2","#50E3C2","#F5A623","#F8E71C","#7ED321","#9013FE","#BD10E0","#4A4A4A"],i=t.map((l,c)=>{const d=l.value/n,[f,g]=NT(r);r+=d;const[y,T]=NT(r),w=d>.5?1:0;return{path:`M ${f} ${g} A 1 1 0 ${w} 1 ${y} ${T} L 0 0`,color:a[c%a.length],label:l.label,value:l.value}});return x.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"font-bold text-sm mb-2",children:e}),x.jsx("svg",{viewBox:"-1.2 -1.2 2.4 2.4",className:"w-32 h-32 mb-2",children:i.map((l,c)=>x.jsx("path",{d:l.path,fill:l.color},c))}),x.jsx("div",{className:"text-[10px] space-y-0.5 w-full",children:i.map((l,c)=>x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:l.color}}),x.jsx("span",{children:l.label})]}),x.jsxs("span",{children:[l.value," (",(l.value/n*100).toFixed(1),"%)"]})]},c))})]})},NV=({data:t,title:e})=>{if(t.length<2)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"Need at least 2 data points for a line chart."});const n=Math.max(...t.map(r=>r.value),0);return x.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:e}),x.jsxs("svg",{viewBox:"0 0 100 50",className:"w-full h-40",children:[[0,.25,.5,.75,1].map(r=>x.jsx("line",{x1:"0",y1:50-r*45,x2:"100",y2:50-r*45,stroke:"#f0f0f0",strokeWidth:"0.5"},r)),x.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1",points:t.map((r,a)=>`${a/(t.length-1)*100},${50-r.value/n*45}`).join(" ")}),t.map((r,a)=>x.jsx("circle",{cx:`${a/(t.length-1)*100}`,cy:`${50-r.value/n*45}`,r:"1.5",fill:"#4a90e2"},a))]})]})},RV=({data:t,title:e})=>{const n=Math.max(...t.map(r=>r.value),0);return n===0?x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"}):x.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:e}),x.jsx("div",{className:"space-y-1",children:t.map(r=>x.jsxs("div",{className:"flex items-center text-xs",children:[x.jsx("div",{className:"w-24 truncate pr-2 text-right text-slate-600",children:r.label}),x.jsx("div",{className:"flex-grow bg-slate-200 rounded-full h-4",children:x.jsx("div",{className:"bg-blue-500 h-4 rounded-full text-white text-right pr-1",style:{width:`${r.value/n*100}%`},children:x.jsx("span",{className:"text-[10px]",children:r.value})})})]},r.label))})]})},DV=({actionItem:t,onSave:e,onClose:n,generateUniqueId:r})=>{var N;const[a,i]=se.useState(t.report||{notes:"",attachments:[],matrixData:null}),[l,c]=se.useState("bar"),d=se.useRef(null),f=se.useRef(null),g=k=>{i(C=>({...C,...k}))},y=()=>{e({...t,report:a})},T=k=>{var L;const C=(L=k.target.files)==null?void 0:L[0];if(!C)return;const P=5,j=P*1024*1024;if(C.size>j){alert(`ファイルサイズが大きすぎます。${P}MB未満のファイルを選択してください。`),k.target&&(k.target.value="");return}const H=new FileReader;H.onload=K=>{var M;if(typeof((M=K.target)==null?void 0:M.result)=="string"){const Q={id:r("attach"),name:C.name,type:C.type,dataUrl:K.target.result};g({attachments:[...a.attachments||[],Q]})}else alert("ファイルの読み込みに失敗しました。")},H.onerror=()=>{alert("ファイルの読み込み中にエラーが発生しました。")},H.readAsDataURL(C),k.target&&(k.target.value="")},w=k=>{var C;g({attachments:(C=a.attachments)==null?void 0:C.filter(P=>P.id!==k)})},E=k=>{var j;const C=(j=k.target.files)==null?void 0:j[0];if(!C)return;const P=new FileReader;P.onload=H=>{var L;try{const K=(L=H.target)==null?void 0:L.result,M=Em(K,{type:"array"}),Q=M.SheetNames[0],X=M.Sheets[Q],ee=CV.sheet_to_json(X,{header:1});if(!Array.isArray(ee)||ee.length===0){alert("Excelファイルが空か、有効なデータが含まれていません。"),k.target&&(k.target.value="");return}const ye=ee[0];if(!Array.isArray(ye)){alert("Excelファイルのヘッダー行が読み取れませんでした。"),k.target&&(k.target.value="");return}const Ie=ye.map(String),Te=ee.slice(1),re=[];for(const ue of Te)if(Array.isArray(ue)){const ne=Array(Ie.length).fill("");for(let W=0;W<Ie.length;W++)ne[W]=ue[W]!==null&&ue[W]!==void 0?String(ue[W]):"";re.push(ne)}g({matrixData:{headers:Ie,rows:re}})}catch(K){console.error("Error parsing Excel file:",K),alert(`Excelファイルの解析中にエラーが発生しました: ${K instanceof Error?K.message:"Unknown error"}`)}finally{k.target&&(k.target.value="")}},P.readAsArrayBuffer(C)},S=(((N=a.matrixData)==null?void 0:N.rows)||[]).map(k=>({label:k[0],value:parseFloat(k[1])||0})).filter(k=>k.label&&!isNaN(k.value)),b=()=>{if(!a.matrixData||S.length===0)return null;switch(l){case"line":return x.jsx(NV,{data:S,title:"データチャート"});case"pie":return x.jsx(kV,{data:S,title:"データチャート"});case"bar":default:return x.jsx(RV,{data:S,title:"データチャート"})}};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[70]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"実施レポート"}),x.jsx("p",{className:"text-sm text-slate-500",children:t.text})]}),x.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(er,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-5 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"text-sm font-semibold text-slate-700",children:"実施内容・メモ"}),x.jsx("textarea",{value:a.notes,onChange:k=>g({notes:k.target.value}),className:"w-full mt-1 p-2 border rounded-md h-32 bg-slate-50 focus:bg-white text-slate-800",placeholder:"実施した内容、結果、考察などを記録..."})]}),x.jsxs("div",{children:[x.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center mb-2",children:["添付ファイル",x.jsx("button",{onClick:()=>{var k;return(k=d.current)==null?void 0:k.click()},className:"p-1 hover:bg-slate-200 rounded-full",children:x.jsx(Yo,{className:"w-5 h-5"})}),x.jsx("input",{type:"file",ref:d,onChange:T,className:"hidden",multiple:!1})]}),x.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-48 overflow-y-auto border p-2 rounded-md bg-slate-50",children:(a.attachments||[]).map(k=>x.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-24",children:[x.jsx("a",{href:k.dataUrl,download:k.name,className:"block w-full h-full","aria-label":`Download ${k.name}`,children:k.type.startsWith("image/")?x.jsx("img",{src:k.dataUrl,alt:k.name,className:"w-full h-full object-cover"}):x.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-2 hover:bg-slate-200",children:x.jsx(Yo,{className:"w-8 h-8 text-slate-500"})})}),x.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:x.jsx("p",{className:"text-white text-[10px] truncate",title:k.name,children:k.name})}),x.jsx("button",{onClick:()=>w(k.id),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:x.jsx(ha,{className:"w-3 h-3"})})]},k.id))})]})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center",children:["データ・マトリクス",x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>{var k;return(k=f.current)==null?void 0:k.click()},className:"p-1 hover:bg-slate-200 rounded-full",title:"Excelからインポート",children:x.jsx(Dw,{className:"w-5 h-5 text-green-600"})}),x.jsx("input",{type:"file",ref:f,onChange:E,className:"hidden",accept:".xlsx, .xls, .csv"}),a.matrixData&&S.length>0&&x.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-200 p-0.5",children:[x.jsx("button",{onClick:()=>c("bar"),className:`px-2 py-0.5 rounded-full text-xs ${l==="bar"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Bar"}),x.jsx("button",{onClick:()=>c("line"),className:`px-2 py-0.5 rounded-full text-xs ${l==="line"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Line"}),x.jsx("button",{onClick:()=>c("pie"),className:`px-2 py-0.5 rounded-full text-xs ${l==="pie"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Pie"})]}),x.jsx("button",{onClick:()=>g({matrixData:a.matrixData?null:{headers:["項目","値"],rows:[["",""]]}}),className:"p-1 hover:bg-slate-200 rounded-full",title:a.matrixData?"マトリクスを削除":"マトリクスを追加",children:a.matrixData?x.jsx(ha,{className:"w-5 h-5 text-red-500"}):x.jsx(ad,{className:"w-5 h-5"})})]})]}),a.matrixData?x.jsx(AV,{matrixData:a.matrixData,onUpdate:k=>g({matrixData:k})}):null,x.jsx("div",{className:"mt-4",children:b()})]})]}),x.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[x.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:"キャンセル"}),x.jsx("button",{onClick:y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"保存して閉じる"})]})]})})},MV=({items:t,taskName:e,onClose:n,onUpdateActionItem:r})=>{var S;const[a,i]=se.useState(null),[l,c]=se.useState(null),d=se.useMemo(()=>new Set(t.map(b=>b.subStep.id)).size<=1,[t]),f=se.useMemo(()=>{let b=[...t];return a!==null&&b.sort((N,k)=>{let C="",P="";switch(a.key){case"status":C=N.actionItem.completed,P=k.actionItem.completed;break;case"dueDate":C=N.actionItem.dueDate||"9999-12-31",P=k.actionItem.dueDate||"9999-12-31";break;case"completedDate":C=N.actionItem.completedDate||"9999-12-31",P=k.actionItem.completedDate||"9999-12-31";break;case"text":C=(N.actionItem.text||"").toLowerCase(),P=(k.actionItem.text||"").toLowerCase();break;case"subStep":C=(N.subStep.text||"").toLowerCase(),P=(k.subStep.text||"").toLowerCase();break;case"responsible":C=(N.actionItem.responsible||"").toLowerCase(),P=(k.actionItem.responsible||"").toLowerCase();break}return C<P?a.direction==="ascending"?-1:1:C>P?a.direction==="ascending"?1:-1:0}),b},[t,a]),g=b=>{let N="ascending";a&&a.key===b&&a.direction==="ascending"&&(N="descending"),i({key:b,direction:N})},y=b=>!a||a.key!==b?x.jsx(Ei,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):a.direction==="ascending"?x.jsx(Rc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Ei,{className:"w-3 h-3 ml-1 text-blue-600"}),T=(b,N,k,C)=>{r(b,N,{[k]:C}),c(null)},w=({value:b,itemId:N,field:k,subStepId:C,actionItemId:P,placeholder:j,type:H="text"})=>{const L=(l==null?void 0:l.itemId)===N&&(l==null?void 0:l.field)===k,[K,M]=se.useState(b);useEffect(()=>{M(b)},[b]);const Q=()=>{T(C,P,k,K)},X=ee=>{ee.key==="Enter"?Q():ee.key==="Escape"&&(M(b),c(null))};return L?x.jsx("input",{type:H,value:K,onChange:ee=>M(ee.target.value),onBlur:Q,onKeyDown:X,className:"w-full px-1 py-0.5 text-xs border border-blue-500 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:j,autoFocus:!0}):x.jsx("div",{onClick:()=>{c({itemId:N,field:k})},className:"cursor-pointer hover:bg-slate-100 px-1 py-0.5 rounded min-h-[1.5rem] flex items-center",title:"クリックして編集",children:b||x.jsx("span",{className:"text-slate-400 italic",children:j})})},E=({sortKey:b,label:N,className:k})=>x.jsx("th",{scope:"col",className:`p-0 ${k||""}`,children:x.jsxs("button",{onClick:()=>g(b),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[x.jsx("span",{children:N}),y(b)]})});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"アクションアイテム一覧"}),x.jsx("p",{className:"text-sm text-slate-500",children:d?`タスク: ${e} / サブステップ: ${((S=t[0])==null?void 0:S.subStep.text)||""}`:`タスク: ${e}`})]}),x.jsx("button",{onClick:n,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(er,{className:"w-6 h-6 text-slate-500"})})]}),x.jsx("main",{className:"flex-grow p-4 overflow-auto",children:x.jsxs("table",{className:"w-full border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx(E,{sortKey:"status",label:"状態",className:"w-28 border border-slate-300"}),x.jsx(E,{sortKey:"text",label:"アクションアイテム",className:"w-2/5 border border-slate-300"}),!d&&x.jsx(E,{sortKey:"subStep",label:"所属サブステップ",className:"w-1/5 border border-slate-300"}),x.jsx(E,{sortKey:"responsible",label:"担当者",className:"w-40 border border-slate-300"}),x.jsx(E,{sortKey:"dueDate",label:"期日",className:"w-40 border border-slate-300"}),x.jsx(E,{sortKey:"completedDate",label:"完了日",className:"w-40 border border-slate-300"})]})}),x.jsxs("tbody",{className:"bg-white",children:[f.map(({actionItem:b,subStep:N})=>{var k;return x.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"p-2 border border-slate-300 align-top text-center",children:b.completed?x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[x.jsx(nd,{className:"w-4 h-4 mr-1"}),"完了"]}):x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[x.jsx(rd,{className:"w-4 h-4 mr-1"}),"未完了"]})}),x.jsxs("td",{className:"p-2 border border-slate-300 align-top font-medium text-slate-800",children:[b.text,b.report&&Array.isArray(b.report.attachments)&&b.report.attachments.length>0&&x.jsx("div",{className:"mt-2 pt-2 border-t border-slate-200 space-y-1",children:b.report.attachments.map(C=>x.jsxs("a",{href:C.dataUrl,target:"_blank",rel:"noopener noreferrer",download:C.name,className:"flex items-center gap-1.5 text-xs text-blue-600 hover:underline",children:[x.jsx(Yo,{className:"w-3.5 h-3.5"}),x.jsx("span",{children:C.name})]},C.id))}),((k=b.report)==null?void 0:k.notes)&&x.jsx("p",{className:"text-xs text-slate-500 mt-1 pt-1 border-t border-slate-200 whitespace-pre-wrap",children:b.report.notes})]}),!d&&x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:N.text}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:x.jsx(w,{value:b.responsible||"",itemId:b.id,field:"responsible",subStepId:N.id,actionItemId:b.id,placeholder:"担当者を入力"})}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:x.jsx(w,{value:b.dueDate||"",itemId:b.id,field:"dueDate",subStepId:N.id,actionItemId:b.id,placeholder:"期日を選択",type:"date"})}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:x.jsx(w,{value:b.completedDate||"",itemId:b.id,field:"completedDate",subStepId:N.id,actionItemId:b.id,placeholder:"完了日を選択",type:"date"})})]},b.id)}),t.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:d?5:6,className:"text-center py-10 text-slate-500",children:"アクションアイテムはありません。"})})]})]})}),x.jsx("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:x.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"閉じる"})})]})})},IV=({task:t,isOpen:e,onClose:n,onReportGenerated:r})=>{const[a,i]=se.useState(""),[l,c]=se.useState(new Set),[d,f]=se.useState(!1),[g,y]=se.useState(null),T=se.useMemo(()=>{var C,P,j,H;const k=[];return k.push({id:`task-data-${t.id}`,name:`基本タスク情報: ${t.title}`,type:"Task Data",source:{name:`タスクデータ: ${t.title}`,type:"json",content:t}}),(P=(C=t.extendedDetails)==null?void 0:C.attachments)==null||P.forEach(L=>{k.push({id:L.id,name:`添付: ${L.name}`,type:"Attachment",source:{name:L.name,type:L.type.startsWith("image/")?"image":"text",content:L.dataUrl}})}),(H=(j=t.extendedDetails)==null?void 0:j.subSteps)==null||H.forEach(L=>{var K;(K=L.actionItems)==null||K.forEach(M=>{var Q,X,ee;(Q=M.report)!=null&&Q.matrixData&&k.push({id:`matrix-${M.id}`,name:`データ: ${M.text} (${L.text})`,type:"Data Matrix",source:{name:`データマトリクス: ${M.text}`,type:"json",content:M.report.matrixData}}),(ee=(X=M.report)==null?void 0:X.attachments)==null||ee.forEach(ye=>{k.push({id:ye.id,name:`添付: ${ye.name} (${M.text})`,type:"Attachment",source:{name:ye.name,type:ye.type.startsWith("image/")?"image":"text",content:ye.dataUrl}})})})}),k},[t]),w=se.useMemo(()=>T.find(k=>k.type==="Task Data"),[T]),E=se.useMemo(()=>T.filter(k=>k.type!=="Task Data"),[T]);se.useEffect(()=>{if(e){const k=new Set;w&&k.add(w.id),c(k)}},[e,w]);const S=k=>{const C=T.find(P=>P.id===k);(C==null?void 0:C.type)!=="Task Data"&&c(P=>{const j=new Set(P);return j.has(k)?j.delete(k):j.add(k),j})},b=async()=>{if(!a.trim()){y("レポート作成の目的を入力してください。");return}if(l.size===0){y("少なくとも1つの資料を選択してください。");return}f(!0),y(null);try{const k=T.filter(P=>l.has(P.id)).map(P=>P.source),C=await uw(k,a);r(C)}catch(k){y(k instanceof Error?k.message:"レポートの生成中にエラーが発生しました。")}finally{f(!1)}};if(!e)return null;const N=k=>{switch(k){case"Task Data":return x.jsx(wi,{className:"w-5 h-5 text-blue-600"});case"Attachment":return x.jsx(Yo,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return x.jsx(ad,{className:"w-5 h-5 text-purple-600"});default:return x.jsx(wi,{className:"w-5 h-5 text-slate-500"})}};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"カスタムレポート作成"}),x.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(er,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-8",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"1. 資料の選択"}),x.jsxs("div",{className:"mb-4",children:[x.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:"常に使用される情報:"}),x.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md bg-slate-200",children:[x.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"w-4 h-4 accent-blue-600"}),w&&N(w.type),x.jsx("span",{className:"text-sm text-slate-800 font-medium truncate",title:w==null?void 0:w.name,children:w==null?void 0:w.name})]})]}),E.length>0&&x.jsxs(x.Fragment,{children:[x.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:"追加の資料 (任意):"}),x.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-80 overflow-y-auto space-y-2",children:E.map(k=>x.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-slate-100 cursor-pointer",children:[x.jsx("input",{type:"checkbox",checked:l.has(k.id),onChange:()=>S(k.id),className:"w-4 h-4 accent-blue-600"}),N(k.type),x.jsx("span",{className:"text-sm text-slate-700 truncate",title:k.name,children:k.name})]},k.id))})]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"2. レポート作成の指示"}),x.jsx("textarea",{value:a,onChange:k=>i(k.target.value),placeholder:"例：選択した資料を基に、プロジェクトの技術的な課題とそれに対する解決策をまとめたスライドを作成してください。",rows:8,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),g&&x.jsx("div",{className:"mt-2",children:x.jsx(es,{message:g})})]})]}),x.jsxs("footer",{className:"flex-shrink-0 p-5 bg-slate-100 border-t flex justify-end items-center gap-4",children:[x.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:"キャンセル"}),x.jsxs("button",{onClick:b,disabled:d,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[d?x.jsx(Cn,{size:"sm",color:"border-white"}):x.jsx(Ti,{className:"w-5 h-5"}),x.jsx("span",{children:d?"生成中...":"レポートを生成"})]})]})]})})},Uh=({value:t,onChange:e,placeholder:n})=>x.jsx("textarea",{value:t,onChange:r=>e(r.target.value),placeholder:n,rows:3,className:"w-full h-full text-sm bg-transparent outline-none p-2 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-blue-50 resize-none text-slate-800 placeholder-slate-400"}),FV=({isOpen:t,onClose:e,onSave:n,task:r,generateUniqueId:a})=>{var L;const[i,l]=se.useState([]),[c,d]=se.useState(!1),[f,g]=se.useState(null),[y,T]=se.useState({key:"status",direction:"ascending"});se.useEffect(()=>{var K;t&&l(((K=r.extendedDetails)==null?void 0:K.decisions)||[])},[t,(L=r.extendedDetails)==null?void 0:L.decisions]);const w=se.useMemo(()=>{let K=[...i];return y!==null&&K.sort((M,Q)=>{let X="",ee="";switch(y.key){case"status":X=M.status==="undecided"?0:1,ee=Q.status==="undecided"?0:1;break;case"date":X=M.date||"9999-12-31",ee=Q.date||"9999-12-31";break;default:X=(M[y.key]||"").toLowerCase(),ee=(Q[y.key]||"").toLowerCase()}return X<ee?y.direction==="ascending"?-1:1:X>ee?y.direction==="ascending"?1:-1:0}),K},[i,y]),E=K=>{let M="ascending";y&&y.key===K&&y.direction==="ascending"&&(M="descending"),T({key:K,direction:M})},S=K=>!y||y.key!==K?x.jsx(Ei,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):y.direction==="ascending"?x.jsx(Rc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Ei,{className:"w-3 h-3 ml-1 text-blue-600"}),b=({sortKey:K,label:M,className:Q})=>x.jsx("th",{className:`p-0 border border-slate-300 ${Q||""}`,children:x.jsxs("button",{onClick:()=>E(K),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[x.jsx("span",{children:M}),S(K)]})}),N=async()=>{d(!0),g(null);try{const M=(await OM(r,i)).map(Q=>Q.id==="NEW"?{...Q,id:a("dec_ai")}:Q);l(M)}catch(K){g(K instanceof Error?K.message:"決定事項の抽出に失敗しました。")}finally{d(!1)}},k=(K,M)=>{l(Q=>Q.map(X=>X.id===K?{...X,...M}:X))},C=(K,M)=>{const Q=i.find(ee=>ee.id===K);if(!Q)return;const X={status:M};M==="decided"&&!Q.date?X.date=new Date().toISOString().split("T")[0]:M==="undecided"&&(X.date=void 0),k(K,X)},P=K=>{l(M=>M.filter(Q=>Q.id!==K))},j=()=>{const K={id:a("dec_manual"),question:"",status:"undecided"};l(M=>[K,...M])},H=()=>{n(i)};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[50]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"決定事項の管理"}),x.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[x.jsxs("button",{onClick:N,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-cyan-600 rounded-md hover:bg-cyan-700 disabled:bg-slate-400",children:[c?x.jsx(Cn,{size:"sm",color:"border-white"}):x.jsx(Ti,{className:"w-5 h-5"}),x.jsx("span",{children:"AIでリストを更新"})]}),x.jsxs("button",{onClick:j,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300 disabled:bg-slate-400",children:[x.jsx(Mw,{className:"w-5 h-5"}),x.jsx("span",{children:"手動で追加"})]}),x.jsx("button",{onClick:e,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(er,{className:"w-6 h-6 text-slate-500"})})]})]}),f&&x.jsx("div",{className:"p-4",children:x.jsx(es,{message:f})}),x.jsx("main",{className:"flex-grow p-4 overflow-auto",children:x.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx(b,{sortKey:"status",label:"ステータス",className:"w-32"}),x.jsx(b,{sortKey:"question",label:"決定すべき項目 (Question)",className:"w-[25%]"}),x.jsx(b,{sortKey:"decision",label:"決定した内容 (Decision)",className:"w-[25%]"}),x.jsx(b,{sortKey:"reasoning",label:"理由/重要性",className:"w-[25%]"}),x.jsx(b,{sortKey:"date",label:"日付",className:"w-36"}),x.jsx("th",{className:"p-2 border border-slate-300 w-16",children:"アクション"})]})}),x.jsxs("tbody",{children:[w.map(K=>x.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"border border-slate-300 align-top p-2",children:x.jsxs("select",{value:K.status,onChange:M=>C(K.id,M.target.value),className:`w-full p-2 rounded-md font-semibold text-xs border ${K.status==="decided"?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:[x.jsx("option",{value:"undecided",children:"未決定"}),x.jsx("option",{value:"decided",children:"決定済み"})]})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(Uh,{value:K.question||"",onChange:M=>k(K.id,{question:M}),placeholder:"例：どのクラウドプロバイダーを利用するか？"})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(Uh,{value:K.decision||"",onChange:M=>k(K.id,{decision:M}),placeholder:"決定内容..."})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(Uh,{value:K.reasoning||"",onChange:M=>k(K.id,{reasoning:M}),placeholder:"理由や背景..."})}),x.jsx("td",{className:"border border-slate-300 align-top p-2",children:x.jsx("input",{type:"date",value:K.date||"",onChange:M=>k(K.id,{date:M.target.value}),className:"w-full bg-transparent border-b border-dotted border-slate-400 outline-none p-1 text-xs text-slate-600 focus:border-solid focus:border-blue-500 disabled:border-none disabled:bg-slate-100",disabled:K.status==="undecided"})}),x.jsx("td",{className:"border border-slate-300 text-center align-middle",children:x.jsx("button",{onClick:()=>P(K.id),className:"text-red-400 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors",title:"この項目を削除",children:x.jsx(ha,{className:"w-5 h-5"})})})]},K.id)),i.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:6,className:"text-center py-12 text-slate-500 bg-white border border-slate-300",children:"決定事項はありません。「手動で追加」するか、「AIでリストを更新」してください。"})})]})]})}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:[x.jsx("button",{onClick:e,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:"キャンセル"}),x.jsx("button",{onClick:H,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"変更を保存"})]})]})}):null},OV=({task:t,onClose:e,onUpdateTaskCoreInfo:n,onUpdateExtendedDetails:r,generateUniqueId:a,projectGoal:i,targetDate:l})=>{var cr,Rr;const[c,d]=se.useState(t.title),[f,g]=se.useState(t.description),[y,T]=se.useState(t.status||_t.NOT_STARTED),[w,E]=se.useState(t.extendedDetails||{subSteps:[],resources:"",responsible:"",notes:"",numericalTarget:void 0,dueDate:"",reportDeck:void 0,resourceMatrix:null,attachments:[],decisions:[],subStepCanvasSize:{width:1200,height:800}}),[S,b]=se.useState(!1),[N,k]=se.useState(!1),[C,P]=se.useState(null),[j,H]=se.useState([]),[L,K]=se.useState(!1),[M,Q]=se.useState(!1),[X,ee]=se.useState(null),[ye,Ie]=se.useState(null),[Te,re]=se.useState(!1),[ue,ne]=se.useState(!1),[W,U]=se.useState(!1),[G,R]=se.useState(!1),[z,J]=se.useState(null),[q,ie]=se.useState({x:0,y:0}),[we,_e]=se.useState(null),[ke,Ce]=se.useState({x:0,y:0}),He=se.useRef(null),Z=se.useRef(null),yt=ve=>({x:10,y:ve*90+10}),qe=ve=>{E(Ve=>({...Ve,...ve}))},it=()=>{n(t.id,{title:c,description:f,status:y}),r(t.id,w),e()},rt=async()=>{k(!0),P(null);try{const ve={...t,title:c,description:f,extendedDetails:w},Ve=await FM(ve);H(Ve),b(!0)}catch(ve){P(ve instanceof Error?ve.message:"ステップ提案の生成に失敗しました。")}finally{k(!1)}},Re=({newSubSteps:ve,newActionItems:Ve})=>{const Ke=[...w.subSteps];ve.forEach((Fe,lt)=>{const mt={id:a("substep"),text:Fe.title,notes:Fe.description,position:yt(Ke.length+lt),status:ba.NOT_STARTED,actionItems:[]};Ke.push(mt)}),Ve.forEach(({targetSubStepId:Fe,title:lt})=>{const mt=Ke.find(Xt=>Xt.id===Fe);if(mt){const Xt={id:a("action"),text:lt,completed:!1};mt.actionItems=[...mt.actionItems||[],Xt]}}),qe({subSteps:Ke}),b(!1)},Dt=()=>{const ve={id:a("substep"),text:"新しいサブステップ",position:yt(w.subSteps.length),status:ba.NOT_STARTED,actionItems:[]};qe({subSteps:[...w.subSteps,ve]})},$t=(ve,Ve)=>{const Ke=w.subSteps.map(Fe=>Fe.id===ve?{...Fe,...Ve}:Fe);qe({subSteps:Ke})},dn=ve=>{const Ve=w.subSteps.filter(Ke=>Ke.id!==ve).map(Ke=>({...Ke,nextSubStepIds:(Ke.nextSubStepIds||[]).filter(Fe=>Fe!==ve)}));qe({subSteps:Ve})},en=ve=>{const Ve={id:a("action"),text:"新しいアクションアイテム",completed:!1},Ke=w.subSteps.map(Fe=>Fe.id===ve?{...Fe,actionItems:[...Fe.actionItems||[],Ve]}:Fe);qe({subSteps:Ke})},Gn=(ve,Ve,Ke)=>{const Fe=w.subSteps.map(lt=>lt.id===ve?{...lt,actionItems:(lt.actionItems||[]).map(mt=>mt.id===Ve?{...mt,...Ke}:mt)}:lt);qe({subSteps:Fe})},Nn=(ve,Ve)=>{const Ke=w.subSteps.map(Fe=>Fe.id===ve?{...Fe,actionItems:(Fe.actionItems||[]).filter(lt=>lt.id!==Ve)}:Fe);qe({subSteps:Ke})},on=async()=>{Q(!0),ee(null);try{const ve={...t,title:c,description:f,extendedDetails:w},Ve=await LM(ve,i);qe({reportDeck:Ve}),K(!0)}catch(ve){ee(ve instanceof Error?ve.message:"スライドの生成に失敗しました。")}finally{Q(!1)}},wn=()=>{w.reportDeck?K(!0):on()},ln=ve=>{qe({reportDeck:ve})},qt=ve=>{var mt;const Ve=(mt=ve.target.files)==null?void 0:mt[0];if(!Ve)return;const Ke=5,Fe=Ke*1024*1024;if(Ve.size>Fe){alert(`ファイルサイズが大きすぎます。${Ke}MB未満のファイルを選択してください。`),ve.target&&(ve.target.value="");return}const lt=new FileReader;lt.onload=Xt=>{var Dr;if(typeof((Dr=Xt.target)==null?void 0:Dr.result)=="string"){const ea={id:a("attach"),name:Ve.name,type:Ve.type,dataUrl:Xt.target.result};qe({attachments:[...w.attachments||[],ea]})}},lt.readAsDataURL(Ve),ve.target&&(ve.target.value="")},Ne=ve=>{var Ve;qe({attachments:((Ve=w.attachments)==null?void 0:Ve.filter(Ke=>Ke.id!==ve))||[]})},Pe=(ve,Ve)=>{var Fe,lt;J(Ve);const Ke=w.subSteps.find(mt=>mt.id===Ve);if(Ke&&He.current){const mt=He.current.getBoundingClientRect();ie({x:ve.clientX-mt.left-(((Fe=Ke.position)==null?void 0:Fe.x)||0),y:ve.clientY-mt.top-(((lt=Ke.position)==null?void 0:lt.y)||0)})}},De=ve=>{if(ve.preventDefault(),!z||!He.current)return;const Ve=He.current.getBoundingClientRect(),Ke=Math.max(0,ve.clientX-Ve.left-q.x),Fe=Math.max(0,ve.clientY-Ve.top-q.y);$t(z,{position:{x:Ke,y:Fe}}),J(null)},Be=(ve,Ve)=>{if(!He.current)return;const Ke=He.current.getBoundingClientRect(),Fe={x:Ve.clientX-Ke.left,y:Ve.clientY-Ke.top};_e({fromId:ve,fromPos:Fe})},Tt=ve=>{if(!we||we.fromId===ve){_e(null);return}const Ve=w.subSteps.find(Ke=>Ke.id===we.fromId);if(Ve){const Ke=Array.from(new Set([...Ve.nextSubStepIds||[],ve]));$t(Ve.id,{nextSubStepIds:Ke})}_e(null)},ot=ve=>{if(!we||!He.current)return;const Ve=He.current.getBoundingClientRect();Ce({x:ve.clientX-Ve.left,y:ve.clientY-Ve.top})},Bt=se.useMemo(()=>{const ve=[];return w.subSteps.forEach(Ve=>{(Ve.actionItems||[]).forEach(Ke=>{ve.push({actionItem:Ke,subStep:Ve})})}),ve},[w.subSteps]),hn=ve=>{switch(ve){case ba.COMPLETED:return"#22c55e";case ba.IN_PROGRESS:return"#3b82f6";default:return"#94a3b8"}},vr=se.useMemo(()=>{const ve=[];return w.subSteps.forEach(Ve=>{var Ke;if((Ke=Ve.nextSubStepIds)!=null&&Ke.length&&Ve.position){const Fe={x:Ve.position.x+192,y:Ve.position.y+38};Ve.nextSubStepIds.forEach(lt=>{const mt=w.subSteps.find(Xt=>Xt.id===lt);if(mt&&mt.position){const Xt={x:mt.position.x,y:mt.position.y+38};ve.push({id:`${Ve.id}-${lt}`,from:Fe,to:Xt})}})}}),ve},[w.subSteps]);return L&&w.reportDeck?x.jsx(Gm,{tasks:[{...t,title:c,description:f,extendedDetails:w}],initialDeck:w.reportDeck,onSave:ln,onClose:()=>K(!1),projectGoal:i,targetDate:l,reportScope:"task",generateUniqueId:a}):x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"fixed bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[50] inset-0",children:x.jsxs("div",{className:`bg-white rounded-xl shadow-2xl flex flex-col ${G?"w-full h-full":"w-full max-w-7xl max-h-[95vh]"}`,children:[x.jsxs("header",{className:"flex items-center justify-between p-4 border-b border-slate-200 flex-shrink-0",children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-800 truncate mr-4",children:["タスク詳細: ",c]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>R(!G),className:"p-2 text-slate-500 hover:text-slate-700 rounded-full hover:bg-slate-100",title:G?"ウィンドウ表示":"フルスクリーン表示",children:G?x.jsx(uF,{className:"w-5 h-5"}):x.jsx(cF,{className:"w-5 h-5"})}),x.jsx("button",{onClick:e,className:"p-2 text-slate-500 hover:text-slate-700 rounded-full hover:bg-slate-100",title:"閉じる",children:x.jsx(er,{className:"w-6 h-6"})})]})]}),x.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[x.jsxs("aside",{className:"w-80 border-r border-slate-200 flex flex-col bg-slate-50",children:[x.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto flex-grow",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"タスクタイトル"}),x.jsx("input",{type:"text",value:c,onChange:ve=>d(ve.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"説明"}),x.jsx("textarea",{value:f,onChange:ve=>g(ve.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"ステータス"}),x.jsx("select",{value:y,onChange:ve=>T(ve.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",children:Object.values(_t).map(ve=>x.jsx("option",{value:ve,children:ve},ve))})]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-1 flex items-center",children:[x.jsx(rF,{className:"w-4 h-4 mr-1"}),"担当者"]}),x.jsx("input",{type:"text",value:w.responsible,onChange:ve=>qe({responsible:ve.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"担当者名"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"期日"}),x.jsx("input",{type:"date",value:w.dueDate||"",onChange:ve=>qe({dueDate:ve.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-1 flex items-center",children:[x.jsx(tF,{className:"w-4 h-4 mr-1"}),"必要リソース"]}),x.jsx("textarea",{value:w.resources,onChange:ve=>qe({resources:ve.target.value}),rows:2,className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"必要な人員、設備、予算など"})]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-1 flex items-center",children:[x.jsx(eF,{className:"w-4 h-4 mr-1"}),"メモ"]}),x.jsx("textarea",{value:w.notes,onChange:ve=>qe({notes:ve.target.value}),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"追加のメモや注意事項"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"添付ファイル"}),x.jsx("button",{onClick:()=>{var ve;return(ve=Z.current)==null?void 0:ve.click()},className:"w-full p-2 border-2 border-dashed border-slate-300 rounded-md hover:border-blue-400 text-sm text-slate-600 hover:text-blue-600",children:"ファイルを追加"}),x.jsx("input",{type:"file",ref:Z,onChange:qt,className:"hidden",multiple:!1}),w.attachments&&w.attachments.length>0&&x.jsx("div",{className:"mt-2 space-y-1",children:w.attachments.map(ve=>x.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border text-xs",children:[x.jsx("span",{className:"truncate",children:ve.name}),x.jsx("button",{onClick:()=>Ne(ve.id),className:"text-red-500 hover:text-red-700 ml-2",children:x.jsx(ha,{className:"w-3 h-3"})})]},ve.id))})]})]}),x.jsxs("div",{className:"p-4 border-t border-slate-200 space-y-2",children:[x.jsxs("button",{onClick:rt,disabled:N,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-slate-400 text-sm",children:[N?x.jsx(Cn,{size:"sm",color:"border-white"}):x.jsx(Ti,{className:"w-4 h-4"}),"AIでステップ提案"]}),x.jsxs("button",{onClick:wn,disabled:M,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-teal-600 text-white rounded-md hover:bg-teal-700 disabled:bg-slate-400 text-sm",children:[M?x.jsx(Cn,{size:"sm",color:"border-white"}):x.jsx(Hm,{className:"w-4 h-4"}),w.reportDeck?"レポート編集":"レポート作成"]}),x.jsxs("button",{onClick:()=>re(!0),className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm",children:[x.jsx(Fw,{className:"w-4 h-4"}),"このタスクのアクションアイテム一覧"]}),x.jsxs("button",{onClick:()=>ne(!0),className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm",children:[x.jsx(Ti,{className:"w-4 h-4"}),"カスタムレポート作成"]}),x.jsxs("button",{onClick:()=>U(!0),className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 text-sm",children:[x.jsx(ad,{className:"w-4 h-4"}),"決定事項の管理"]})]})]}),x.jsxs("main",{className:"flex-grow flex flex-col",children:[x.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between bg-white",children:[x.jsxs("h4",{className:"font-semibold text-slate-800",children:["サブステップ計画 (",w.subSteps.length,")"]}),x.jsxs("button",{onClick:Dt,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:[x.jsx(Bs,{className:"w-4 h-4"}),"サブステップ追加"]})]}),x.jsxs("div",{ref:He,className:"flex-grow relative overflow-auto bg-slate-100 p-4",onDragOver:ve=>ve.preventDefault(),onDrop:De,onMouseMove:ot,onMouseUp:()=>_e(null),style:{width:((cr=w.subStepCanvasSize)==null?void 0:cr.width)||1200,height:((Rr=w.subStepCanvasSize)==null?void 0:Rr.height)||800},children:[w.subSteps.map(ve=>{var Ve,Ke;return x.jsxs("div",{draggable:!0,onDragStart:Fe=>Pe(Fe,ve.id),onMouseUp:()=>Tt(ve.id),className:"absolute bg-white rounded-lg shadow-md border-l-4 p-3 cursor-move hover:shadow-lg transition-shadow",style:{left:((Ve=ve.position)==null?void 0:Ve.x)||0,top:((Ke=ve.position)==null?void 0:Ke.y)||0,width:192,minHeight:76,borderLeftColor:hn(ve.status)},children:[x.jsxs("div",{className:"flex items-start justify-between mb-2",children:[x.jsx("input",{type:"text",value:ve.text,onChange:Fe=>$t(ve.id,{text:Fe.target.value}),className:"font-semibold text-sm bg-transparent border-none outline-none flex-grow mr-2",placeholder:"サブステップ名"}),x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx("button",{onMouseDown:Fe=>Be(ve.id,Fe),className:"w-3 h-3 bg-blue-500 rounded-full hover:bg-blue-600",title:"接続"}),x.jsx("button",{onClick:()=>dn(ve.id),className:"text-red-500 hover:text-red-700",title:"削除",children:x.jsx(ha,{className:"w-3 h-3"})})]})]}),x.jsx("select",{value:ve.status||ba.NOT_STARTED,onChange:Fe=>$t(ve.id,{status:Fe.target.value}),className:"text-xs mb-2 w-full border border-slate-300 rounded px-1 py-0.5",children:Object.values(ba).map(Fe=>x.jsx("option",{value:Fe,children:Fe},Fe))}),x.jsxs("div",{className:"space-y-1",children:[(ve.actionItems||[]).map(Fe=>x.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[x.jsx("button",{onClick:()=>Gn(ve.id,Fe.id,{completed:!Fe.completed}),className:"flex-shrink-0",children:Fe.completed?x.jsx(nd,{className:"w-3 h-3 text-green-600"}):x.jsx(rd,{className:"w-3 h-3 text-slate-400"})}),x.jsx("input",{type:"text",value:Fe.text,onChange:lt=>Gn(ve.id,Fe.id,{text:lt.target.value}),className:"flex-grow bg-transparent border-none outline-none text-xs",placeholder:"アクションアイテム"}),x.jsx("button",{onClick:()=>Ie({subStepId:ve.id,actionItem:Fe}),className:"text-blue-500 hover:text-blue-700",title:"レポート",children:x.jsx(Yo,{className:"w-3 h-3"})}),x.jsx("button",{onClick:()=>Nn(ve.id,Fe.id),className:"text-red-500 hover:text-red-700",title:"削除",children:x.jsx(ha,{className:"w-3 h-3"})})]},Fe.id)),x.jsxs("button",{onClick:()=>en(ve.id),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[x.jsx(Bs,{className:"w-3 h-3"}),"アクション追加"]})]})]},ve.id)}),x.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",style:{zIndex:1},children:[vr.map(ve=>x.jsx("line",{x1:ve.from.x,y1:ve.from.y,x2:ve.to.x,y2:ve.to.y,stroke:"#64748b",strokeWidth:"2",markerEnd:"url(#arrowhead)"},ve.id)),we&&x.jsx("line",{x1:we.fromPos.x,y1:we.fromPos.y,x2:ke.x,y2:ke.y,stroke:"#3b82f6",strokeWidth:"2",strokeDasharray:"5,5"}),x.jsx("defs",{children:x.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",children:x.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#64748b"})})})]})]})]})]}),x.jsxs("footer",{className:"p-4 bg-slate-50 border-t border-slate-200 flex justify-end gap-3",children:[C&&x.jsx(es,{message:C}),X&&x.jsx(es,{message:X}),x.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:"キャンセル"}),x.jsx("button",{onClick:it,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"変更を保存"})]})]})}),S&&x.jsx(S8,{proposals:j,existingSubSteps:w.subSteps,onConfirm:Re,onClose:()=>b(!1)}),ye&&x.jsx(DV,{actionItem:ye.actionItem,onSave:ve=>{Gn(ye.subStepId,ve.id,ve),Ie(null)},onClose:()=>Ie(null),generateUniqueId:a}),Te&&x.jsx(MV,{items:Bt,taskName:c,onClose:()=>re(!1),onUpdateActionItem:Gn}),ue&&x.jsx(IV,{task:{...t,title:c,description:f,extendedDetails:w},isOpen:ue,onClose:()=>ne(!1),onReportGenerated:ve=>{qe({reportDeck:ve}),ne(!1),K(!0)}}),W&&x.jsx(FV,{isOpen:W,onClose:()=>U(!1),onSave:ve=>{qe({decisions:ve}),U(!1)},task:{...t,title:c,description:f,extendedDetails:w},generateUniqueId:a})]})},LV=({onClose:t,onSubmit:e})=>{const[n,r]=se.useState(""),[a,i]=se.useState(""),[l,c]=se.useState(""),d=f=>{if(f.preventDefault(),!n.trim()){c("タスクのタイトルは必須です。");return}if(!a.trim()){c("タスクの説明は必須です。");return}e({title:n,description:a}),c("")};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"新しいタスクを追加"}),x.jsx("button",{onClick:t,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"閉じる","aria-label":"タスク追加モーダルを閉じる",children:x.jsx(er,{className:"w-6 h-6"})})]}),x.jsxs("form",{onSubmit:d,children:[x.jsxs("div",{className:"p-6 space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"taskTitle",className:"block text-sm font-medium text-slate-700 mb-1",children:"タスクタイトル"}),x.jsx("input",{type:"text",id:"taskTitle",value:n,onChange:f=>r(f.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:"例: 市場調査を実施"})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"taskDescription",className:"block text-sm font-medium text-slate-700 mb-1",children:"タスク説明"}),x.jsx("textarea",{id:"taskDescription",value:a,onChange:f=>i(f.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:"例: 競合製品の分析とターゲット顧客の特定"})]}),l&&x.jsx("p",{className:"text-sm text-red-600",children:l})]}),x.jsxs("footer",{className:"p-6 bg-slate-50 border-t border-slate-200 flex justify-end space-x-3 rounded-b-xl",children:[x.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"キャンセル"}),x.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"タスクを追加"})]})]})]})})},PV=({onSetApiKey:t,error:e,isLoading:n})=>{const[r,a]=se.useState(""),i=l=>{l.preventDefault(),t(r)};return x.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[x.jsxs("div",{className:"w-full max-w-md bg-white shadow-2xl rounded-xl p-8",children:[x.jsxs("div",{className:"text-center mb-8",children:[x.jsx(Ti,{className:"w-12 h-12 mx-auto text-blue-600 mb-4"}),x.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"AI Project Planner"}),x.jsx("p",{className:"text-slate-600 mt-2",children:"始めるには、Google Gemini APIキーを入力してください。"})]}),x.jsxs("form",{onSubmit:i,className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"apiKey",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(Dc,{className:"w-5 h-5 mr-2 text-slate-500"}),"Gemini API Key"]}),x.jsx("input",{id:"apiKey",type:"password",value:r,onChange:l=>a(l.target.value),placeholder:"APIキーをここに貼り付け",className:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-800 placeholder-slate-400"})]}),e&&x.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:e}),x.jsx("button",{type:"submit",disabled:n||!r,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:n?x.jsx(Cn,{size:"sm"}):"保存して開始"})]}),x.jsxs("div",{className:"text-center mt-6",children:[x.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"APIキーの取得はこちら"}),x.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"APIキーはセッション中のみブラウザに保存されます。"})]})]}),x.jsx("footer",{className:"mt-8 text-center",children:x.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},UV=({isOpen:t,onClose:e,onSuccess:n})=>{const[r,a]=se.useState(!0),[i,l]=se.useState(""),[c,d]=se.useState(""),[f,g]=se.useState(!1),[y,T]=se.useState(null),w=async E=>{E.preventDefault(),g(!0),T(null);try{if(r){const{error:S}=await bt.auth.signInWithPassword({email:i,password:c});if(S)throw S}else{const{error:S}=await bt.auth.signUp({email:i,password:c});if(S)throw S}n()}catch(S){T(S instanceof Error?S.message:"認証に失敗しました")}finally{g(!1)}};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center",children:[x.jsx(Dc,{className:"w-6 h-6 mr-2 text-blue-600"}),r?"ログイン":"アカウント作成"]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(er,{className:"w-5 h-5"})})]}),x.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"メールアドレス"}),x.jsx("input",{type:"email",id:"email",value:i,onChange:E=>l(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"パスワード"}),x.jsx("input",{type:"password",id:"password",value:c,onChange:E=>d(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:6})]}),y&&x.jsx("div",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:y}),x.jsx("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:f?x.jsx(Cn,{size:"sm",color:"border-white"}):r?"ログイン":"アカウント作成"}),x.jsx("div",{className:"text-center",children:x.jsx("button",{type:"button",onClick:()=>a(!r),className:"text-sm text-blue-600 hover:underline",children:r?"アカウントをお持ちでない方はこちら":"すでにアカウントをお持ちの方はこちら"})})]})]})}):null},BV=({isOpen:t,onClose:e,onSelectProject:n,onCreateNew:r})=>{const[a,i]=se.useState([]),[l,c]=se.useState(!1),[d,f]=se.useState(null),g=async()=>{c(!0),f(null);try{const w=await Nc.getProjects();i(w)}catch(w){f(w instanceof Error?w.message:"プロジェクトの読み込みに失敗しました")}finally{c(!1)}};se.useEffect(()=>{t&&g()},[t]);const y=async(w,E)=>{if(E.stopPropagation(),!!confirm("このプロジェクトを削除しますか？この操作は取り消せません。"))try{await Nc.deleteProject(w),await g()}catch(S){f(S instanceof Error?S.message:"プロジェクトの削除に失敗しました")}},T=w=>{const E={projectGoal:w.goal,targetDate:w.targetDate,tasks:w.tasks,ganttData:w.ganttData},S=JSON.stringify(E,null,2),b=new Blob([S],{type:"application/json"}),N=URL.createObjectURL(b),k=document.createElement("a");k.href=N,k.download=`${w.title}.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(N)};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"プロジェクト一覧"}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[x.jsx(Bs,{className:"w-5 h-5"}),"新規作成"]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(er,{className:"w-6 h-6"})})]})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[d&&x.jsx(es,{message:d}),l?x.jsx("div",{className:"flex items-center justify-center py-12",children:x.jsx(Cn,{size:"lg",text:"プロジェクトを読み込み中..."})}):a.length===0?x.jsxs("div",{className:"text-center py-12",children:[x.jsx("p",{className:"text-slate-500 text-lg mb-4",children:"プロジェクトがありません"}),x.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mx-auto",children:[x.jsx(Bs,{className:"w-5 h-5"}),"最初のプロジェクトを作成"]})]}):x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(w=>x.jsxs("div",{onClick:()=>n(w),className:"bg-slate-50 rounded-lg p-4 cursor-pointer hover:bg-slate-100 transition-colors border border-slate-200 hover:border-blue-300",children:[x.jsxs("div",{className:"flex items-start justify-between mb-3",children:[x.jsx("h4",{className:"font-semibold text-slate-800 truncate flex-grow",children:w.title}),x.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[x.jsx("button",{onClick:E=>{E.stopPropagation(),T(w)},className:"p-1 text-slate-500 hover:text-blue-600 rounded",title:"JSONでダウンロード",children:x.jsx(qo,{className:"w-4 h-4"})}),x.jsx("button",{onClick:E=>y(w.id,E),className:"p-1 text-slate-500 hover:text-red-600 rounded",title:"削除",children:x.jsx(ha,{className:"w-4 h-4"})})]})]}),x.jsxs("div",{className:"space-y-2 text-sm text-slate-600",children:[x.jsxs("p",{className:"flex items-start",children:[x.jsx(Bm,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0 mt-0.5"}),x.jsx("span",{className:"line-clamp-2",children:w.goal})]}),x.jsxs("p",{className:"flex items-center",children:[x.jsx(Um,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0"}),new Date(w.targetDate+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"})]}),x.jsxs("p",{className:"text-xs text-slate-500",children:["タスク数: ",w.tasks.length," | 更新: ",new Date(w.updatedAt).toLocaleDateString("ja-JP")]})]})]},w.id))})]})]})}):null},Ka={subSteps:[],resources:"",responsible:"",notes:"",numericalTarget:void 0,dueDate:"",reportDeck:void 0,resourceMatrix:null,attachments:[],decisions:[],subStepCanvasSize:{width:1200,height:800}},jV=()=>[{id:"apqp_1",title:"フェーズ1: 計画とプログラムの定義",description:"顧客の声を収集し、ビジネスプランと製品/プロセスベンチマークを定義する。設計・品質目標を設定。",status:_t.NOT_STARTED,nextTaskIds:["apqp_2"]},{id:"apqp_2",title:"フェーズ2: 製品設計と開発",description:"DFMEA、製品仕様、図面を作成し、プロトタイプを製作・管理する。材料仕様とサプライヤーを確定。",status:_t.NOT_STARTED,nextTaskIds:["apqp_3"]},{id:"apqp_3",title:"フェーズ3: 工程設計と開発",description:"製造工程フローチャート、PFMEA、コントロールプランを作成する。測定システム分析(MSA)計画を立案。",status:_t.NOT_STARTED,nextTaskIds:["apqp_4"]},{id:"apqp_4",title:"フェーズ4: 製品と工程の妥当性確認",description:"トライアウト生産を実施し、MSAと初期工程能力調査(SPC)を行う。生産部品承認プロセス(PPAP)を完了。",status:_t.NOT_STARTED,nextTaskIds:["apqp_5"]},{id:"apqp_5",title:"フェーズ5: フィードバック、評価、是正処置",description:"量産を開始し、ばらつきを低減させる。顧客満足度を評価し、継続的改善を実施する。",status:_t.NOT_STARTED,nextTaskIds:[]}].map(e=>({...e,extendedDetails:{...Ka,...e.extendedDetails||{}}})),VV=()=>[{id:"change_1",title:"1. 変更要求と影響分析",description:"変更要求を特定し、品質、コスト、納期、安全性への影響を評価する。",status:_t.NOT_STARTED,nextTaskIds:["change_2"]},{id:"change_2",title:"2. 変更計画と承認",description:"詳細な変更計画（スケジュール、リソース、検証計画）を作成し、変更管理委員会(CCB)の承認を得る。",status:_t.NOT_STARTED,nextTaskIds:["change_3"]},{id:"change_3",title:"3. 変更の実施と検証",description:"計画に基づき変更を実施。変更後のプロセスでトライアル生産を行い、結果を検証する。",status:_t.NOT_STARTED,nextTaskIds:["change_4"]},{id:"change_4",title:"4. 文書化とトレーニング",description:"FMEA、コントロールプラン、作業手順書等の関連文書をすべて更新し、関係者にトレーニングを実施する。",status:_t.NOT_STARTED,nextTaskIds:["change_5"]},{id:"change_5",title:"5. 変更のレビューとクローズ",description:"変更後のプロセスパフォーマンスを監視し、有効性をレビュー。問題がなければ変更をクローズする。",status:_t.NOT_STARTED,nextTaskIds:[]}].map(e=>({...e,extendedDetails:{...Ka,...e.extendedDetails||{}}})),HV=()=>[{id:"eval_1",title:"1. 顧客要求の分析",description:"顧客から提供された製品仕様、図面、品質要求、生産量を詳細に分析する。",status:_t.NOT_STARTED,nextTaskIds:["eval_2"]},{id:"eval_2",title:"2. 既存設備の能力評価 (ギャップ分析)",description:"要求仕様に対し、既存の設備・工程能力を評価し、ギャップ（治工具、精度、サイクルタイム等）を特定する。",status:_t.NOT_STARTED,nextTaskIds:["eval_3"]},{id:"eval_3",title:"3. 評価用トライアル計画の立案",description:"ギャップを埋めるための暫定対策を講じ、評価用トライアルの計画（材料、段取り、測定項目）を立案する。",status:_t.NOT_STARTED,nextTaskIds:["eval_4"]},{id:"eval_4",title:"4. 評価トライアルの実施とデータ収集",description:"計画に基づきトライアルを実施し、寸法、性能、外観等のデータを収集する。",status:_t.NOT_STARTED,nextTaskIds:["eval_5"]},{id:"eval_5",title:"5. 評価レポート作成と顧客への報告",description:"トライアル結果をまとめ、実現可能性、課題、推奨事項を記載したレポートを作成し、顧客に報告する。",status:_t.NOT_STARTED,nextTaskIds:[]}].map(e=>({...e,extendedDetails:{...Ka,...e.extendedDetails||{}}})),GV=()=>[{id:"dmaic_1",title:"フェーズ1: 定義 (Define)",description:"プロジェクトの目的、範囲、目標を明確にし、現状の問題点とビジネスインパクトを特定する。",status:_t.NOT_STARTED,nextTaskIds:["dmaic_2"]},{id:"dmaic_2",title:"フェーズ2: 測定 (Measure)",description:"現状プロセスのパフォーマンスを測定するためのデータを収集し、KPIを設定してベースラインを確立する。",status:_t.NOT_STARTED,nextTaskIds:["dmaic_3"]},{id:"dmaic_3",title:"フェーズ3: 分析 (Analyze)",description:"収集データを分析し、問題の根本原因を特定する。特性要因図やパレート図などを活用。",status:_t.NOT_STARTED,nextTaskIds:["dmaic_4"]},{id:"dmaic_4",title:"フェーズ4: 改善 (Improve)",description:"根本原因に対する解決策を立案・テストし、最も効果的な改善策をパイロット導入する。",status:_t.NOT_STARTED,nextTaskIds:["dmaic_5"]},{id:"dmaic_5",title:"フェーズ5: 管理 (Control)",description:"改善策を標準化し、効果をモニタリングする管理体制を構築する。成果を文書化し水平展開を検討。",status:_t.NOT_STARTED,nextTaskIds:[]}].map(e=>({...e,extendedDetails:{...Ka,...e.extendedDetails||{}}})),$V=()=>[{id:"mod_1",title:"1. 改造計画の立案と承認",description:"改造の目的（生産性、安全性、品質向上など）、目標仕様、スコープを定義し、関連部署からの承認を得る。",status:_t.NOT_STARTED,nextTaskIds:["mod_2"]},{id:"mod_2",title:"2. 改造設計と部品手配",description:"具体的な改造内容（機械、電気、ソフトウェア）を設計し、図面を作成する。必要な部品や材料を発注・手配する。",status:_t.NOT_STARTED,nextTaskIds:["mod_3"]},{id:"mod_3",title:"3. 設備改造の実施と初期トライアル",description:"安全手順に従い、設備の改造作業を実施する。改造後、初期の動作確認とトライアル運転を行う。",status:_t.NOT_STARTED,nextTaskIds:["mod_4"]},{id:"mod_4",title:"4. パフォーマンス評価と安全性検証",description:"一定期間の連続運転を行い、生産性、品質、サイクルタイムなどのパフォーマンスを評価し、安全性を検証する。",status:_t.NOT_STARTED,nextTaskIds:["mod_5"]},{id:"mod_5",title:"5. 標準化とプロジェクト完了",description:"設備関連の図面、作業標準書、保全計画を更新する。関係者へのトレーニングを実施し、プロジェクトを完了させる。",status:_t.NOT_STARTED,nextTaskIds:[]}].map(e=>({...e,extendedDetails:{...Ka,...e.extendedDetails||{}}})),zV=()=>{const[t,e]=se.useState(null),[n,r]=se.useState(null),[a,i]=se.useState(""),[l,c]=se.useState(""),[d,f]=se.useState([]),[g,y]=se.useState(null),[T,w]=se.useState(null),[E,S]=se.useState(null),[b,N]=se.useState(!1),[k,C]=se.useState(null),[P,j]=se.useState(pr.INPUT_FORM),[H,L]=se.useState(!1),[K,M]=se.useState(!1),[Q,X]=se.useState(!1),[ee,ye]=se.useState([]),[Ie,Te]=se.useState([]),[re,ue]=se.useState(null);se.useEffect(()=>{const{data:{subscription:Ne}}=bt.auth.onAuthStateChange((Pe,De)=>{e((De==null?void 0:De.user)??null),De!=null&&De.user||(S(null),f([]),i(""),c(""),w(null),j(pr.INPUT_FORM))});return bt.auth.getSession().then(({data:{session:Pe}})=>{e((Pe==null?void 0:Pe.user)??null)}),()=>Ne.unsubscribe()},[]),se.useEffect(()=>{const Ne=sessionStorage.getItem("gemini-api-key");Ne&&ie(Ne)},[]);const ne=Ne=>{ye(Pe=>[...Pe.slice(-10),Ne]),Te([])},W=se.useCallback((Ne="id")=>`${Ne}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,[]),U=(Ne,Pe)=>{const De=JSON.stringify(Ne,null,2),Be=new Blob([De],{type:"application/json"}),Tt=URL.createObjectURL(Be),ot=document.createElement("a");ot.href=Tt,ot.download=Pe,document.body.appendChild(ot),ot.click(),document.body.removeChild(ot),URL.revokeObjectURL(Tt)},G=Ne=>new Promise((Pe,De)=>{const Be=new FileReader;Be.onload=Tt=>{var ot;try{typeof((ot=Tt.target)==null?void 0:ot.result)=="string"?Pe(JSON.parse(Tt.target.result)):De(new Error("Failed to read file."))}catch(Bt){De(new Error(`Invalid JSON: ${Bt.message}`))}},Be.onerror=()=>De(new Error("File read error.")),Be.readAsText(Ne)}),R=se.useCallback(Ne=>{if(Ne.length===0)return Ne;const Pe=new Map(Ne.map(Fe=>[Fe.id,Fe])),De=new Map(Ne.map(Fe=>[Fe.id,0])),Be=new Map;Ne.forEach(Fe=>{Be.set(Fe.id,[]),(Fe.nextTaskIds||[]).forEach(lt=>{var mt;Pe.has(lt)&&(De.set(lt,(De.get(lt)||0)+1),(mt=Be.get(Fe.id))==null||mt.push(lt))})});const Tt=Ne.filter(Fe=>(De.get(Fe.id)||0)===0).map(Fe=>Fe.id),ot=[];let Bt=0;const hn=new Set;for(;Tt.length>0;){const Fe=Tt.length;ot[Bt]=[];for(let lt=0;lt<Fe;lt++){const mt=Tt.shift();hn.add(mt),ot[Bt].push(mt),(Be.get(mt)||[]).forEach(Xt=>{De.set(Xt,(De.get(Xt)||0)-1),(De.get(Xt)||0)===0&&Tt.push(Xt)})}Bt++}const vr=Ne.filter(Fe=>!hn.has(Fe.id));vr.length>0&&ot.push(vr.map(Fe=>Fe.id));const cr=380,Rr=60,ve=50,Ve=280,Ke=new Map;return ot.forEach((Fe,lt)=>{const mt=Fe.length*Ve+(Fe.length-1)*ve,Xt=Math.max(20,(500-mt)/2);Fe.forEach((Dr,ea)=>{Ke.set(Dr,{x:lt*(cr+Rr)+20,y:Xt+ea*(Ve+ve)})})}),Ne.map((Fe,lt)=>({...Fe,position:Ke.get(Fe.id)||Fe.position||{x:20,y:20+lt*100}}))},[]),z=Ne=>{ne(d),f(Ne)},J=()=>{if(ee.length>0){const Ne=ee[ee.length-1];ye(Pe=>Pe.slice(0,-1)),Te(Pe=>[d,...Pe]),f(Ne)}},q=()=>{if(Ie.length>0){const Ne=Ie[0];Te(Pe=>Pe.slice(1)),ye(Pe=>[...Pe,d]),f(Ne)}},ie=Ne=>{Ne.trim()&&(By(Ne),sessionStorage.setItem("gemini-api-key",Ne),r(Ne),C(null))},we=()=>{sessionStorage.removeItem("gemini-api-key"),r(null),By("")},_e=async()=>{await bt.auth.signOut()},ke=async()=>{if(!(!t||!E))try{await Nc.updateProject(E,{tasks:d,ganttData:T})}catch(Ne){console.error("プロジェクトの自動保存に失敗しました:",Ne)}};se.useEffect(()=>{if(E&&d.length>0){const Ne=setTimeout(ke,2e3);return()=>clearTimeout(Ne)}},[d,T,E]);const Ce=()=>{i(""),c(""),f([]),w(null),ue(null),S(null),j(pr.INPUT_FORM),C(null),ye([]),Te([])},He=()=>{U({projectGoal:a,targetDate:l,tasks:d,ganttData:T},"project-plan.json")},Z=async Ne=>{try{const Pe=await G(Ne);if(Pe.projectGoal&&Pe.targetDate&&Array.isArray(Pe.tasks))i(Pe.projectGoal),c(Pe.targetDate),f(Pe.tasks.map(De=>({...De,extendedDetails:{...Ka,...De.extendedDetails||{}}}))),w(Pe.ganttData||null),ue(null),S(null),j(pr.PROJECT_FLOW),ye([]),Te([]);else throw new Error("Invalid project file format.")}catch(Pe){const De=Pe.message;C(De),De.toLowerCase().includes("api key")&&we()}},yt=Ne=>{i(Ne.goal),c(Ne.targetDate),f(Ne.tasks.map(Pe=>({...Pe,extendedDetails:{...Ka,...Pe.extendedDetails||{}}}))),w(Ne.ganttData||null),S(Ne.id),ue(null),j(pr.PROJECT_FLOW),ye([]),Te([]),X(!1)},qe=()=>{X(!1),Ce()},it=({title:Ne,description:Pe})=>{const De={id:W("task"),title:Ne,description:Pe,extendedDetails:Ka,status:_t.NOT_STARTED,position:{x:20,y:20}};z(Be=>R([...Be,De])),L(!1)},rt=Ne=>{z(Pe=>Pe.filter(De=>De.id!==Ne).map(De=>({...De,nextTaskIds:(De.nextTaskIds||[]).filter(Be=>Be!==Ne)})))},Re=(Ne,Pe)=>{z(De=>De.map(Be=>Be.id===Ne?{...Be,status:Pe}:Be))},Dt=(Ne,Pe)=>{z(De=>De.map(Be=>Be.id===Ne?{...Be,nextTaskIds:Pe}:Be))},$t=(Ne,Pe)=>{f(De=>De.map(Be=>Be.id===Ne?{...Be,position:Pe}:Be))},dn=(Ne,Pe)=>{z(De=>De.map(Be=>Be.id===Ne?{...Be,...Pe}:Be))},en=(Ne,Pe)=>{z(De=>De.map(Be=>Be.id===Ne?{...Be,extendedDetails:Pe}:Be))},Gn=(Ne,Pe,De)=>{let Be=[];switch(Ne){case"process-design":Be=jV();break;case"process-change":Be=VV();break;case"new-product-eval":Be=HV();break;case"improvement-project":Be=GV();break;case"equipment-modification":Be=$V();break}i(Pe),c(De),f(R(Be)),w(null),ue(null),S(null),j(pr.PROJECT_FLOW),ye([]),Te([]),C(null)},Nn=async(Ne,Pe)=>{N(!0),C(null);try{i(Ne),c(Pe);const De=await IM(Ne,Pe),Be=R(De.map(Tt=>({...Tt,extendedDetails:Ka,status:_t.NOT_STARTED})));if(f(Be),w(null),ue(null),S(null),j(pr.PROJECT_FLOW),ye([]),Te([]),t)try{const Tt=await Nc.createProject(`AI生成プロジェクト - ${new Date().toLocaleDateString("ja-JP")}`,Ne,Pe,Be);S(Tt.id)}catch(Tt){console.error("プロジェクトの自動保存に失敗しました:",Tt)}}catch(De){const Be=De.message;Be.toLowerCase().includes("api key")&&we(),C(Be)}finally{N(!1)}},on=Ne=>{y(Ne),j(pr.TASK_DETAIL)},wn=()=>{y(null),j(pr.PROJECT_FLOW)},ln=Ne=>{ue(Ne)},qt=()=>{if(!t)return x.jsx(UV,{isOpen:!0,onClose:()=>{},onSuccess:()=>M(!1)});if(!n)return x.jsx(PV,{onSetApiKey:ie,error:k});if(k)return x.jsxs("div",{className:"p-4",children:[x.jsx(es,{message:k}),x.jsx("button",{onClick:()=>{C(null),n?j(pr.INPUT_FORM):we()},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded",children:"最初に戻る"})]});switch(P){case pr.PROJECT_FLOW:return x.jsx(E8,{tasks:d,projectGoal:a,targetDate:l,onSelectTask:on,onUpdateTaskExtendedDetails:()=>{},onUpdateTaskPosition:$t,onStartNewProject:Ce,onExportProject:He,onAddTask:()=>L(!0),onRemoveTask:rt,onUpdateTaskStatus:Re,onImportSingleTask:()=>{},onAutoLayout:()=>z(Ne=>R([...Ne])),onUndo:J,canUndo:ee.length>0,onRedo:q,canRedo:Ie.length>0,generateUniqueId:W,onUpdateTaskConnections:Dt,ganttData:T,setGanttData:w,onCustomReportGenerated:ln,onClearApiKey:we,onOpenProjectList:()=>X(!0),onLogout:_e,currentProjectId:E,onSaveProject:ke});case pr.TASK_DETAIL:return g&&x.jsx(OV,{task:g,onClose:wn,onUpdateTaskCoreInfo:dn,onUpdateExtendedDetails:en,generateUniqueId:W,projectGoal:a,targetDate:l});case pr.INPUT_FORM:default:return x.jsx(hF,{onSubmit:Nn,isLoading:b,onImportProject:Z,onLoadTemplate:Gn,initialGoal:a,initialDate:l,onOpenProjectList:()=>X(!0),onLogout:_e,user:t})}};return x.jsxs("div",{className:"h-full w-full",children:[qt(),H&&x.jsx(LV,{onClose:()=>L(!1),onSubmit:it}),Q&&x.jsx(BV,{isOpen:Q,onClose:()=>X(!1),onSelectProject:yt,onCreateNew:qe}),re&&x.jsx(Gm,{tasks:d,initialDeck:re,onSave:Ne=>ue(Ne),onClose:()=>ue(null),projectGoal:a,targetDate:l,reportScope:"project",generateUniqueId:W})]})},bE=document.getElementById("root");if(!bE)throw new Error("Could not find root element to mount to");const qV=Hb.createRoot(bE);qV.render(x.jsx(Bo.StrictMode,{children:x.jsx(zV,{})}));
