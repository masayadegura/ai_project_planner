(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();function Om(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function UC(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var wh={exports:{}},oc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1;function BC(){if(n1)return oc;n1=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,a,i){var l=null;if(i!==void 0&&(l=""+i),a.key!==void 0&&(l=""+a.key),"key"in a){i={};for(var c in a)c!=="key"&&(i[c]=a[c])}else i=a;return a=i.ref,{$$typeof:t,type:r,key:l,ref:a!==void 0?a:null,props:i}}return oc.Fragment=e,oc.jsx=n,oc.jsxs=n,oc}var r1;function jC(){return r1||(r1=1,wh.exports=BC()),wh.exports}var x=jC(),Eh={exports:{}},mt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a1;function VC(){if(a1)return mt;a1=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.iterator;function _(N){return N===null||typeof N!="object"?null:(N=y&&N[y]||N["@@iterator"],typeof N=="function"?N:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function C(N,Z,M){this.props=N,this.context=Z,this.refs=S,this.updater=M||w}C.prototype.isReactComponent={},C.prototype.setState=function(N,Z){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,Z,"setState")},C.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function R(){}R.prototype=C.prototype;function k(N,Z,M){this.props=N,this.context=Z,this.refs=S,this.updater=M||w}var b=k.prototype=new R;b.constructor=k,E(b,C.prototype),b.isPureReactComponent=!0;var O=Array.isArray,U={H:null,A:null,T:null,S:null,V:null},j=Object.prototype.hasOwnProperty;function F(N,Z,M,V,Y,z){return M=z.ref,{$$typeof:t,type:N,key:Z,ref:M!==void 0?M:null,props:z}}function K(N,Z){return F(N.type,Z,void 0,void 0,void 0,N.props)}function P(N){return typeof N=="object"&&N!==null&&N.$$typeof===t}function ne(N){var Z={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(M){return Z[M]})}var Q=/\/+/g;function te(N,Z){return typeof N=="object"&&N!==null&&N.key!=null?ne(""+N.key):Z.toString(36)}function _e(){}function Le(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(_e,_e):(N.status="pending",N.then(function(Z){N.status==="pending"&&(N.status="fulfilled",N.value=Z)},function(Z){N.status==="pending"&&(N.status="rejected",N.reason=Z)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function Te(N,Z,M,V,Y){var z=typeof N;(z==="undefined"||z==="boolean")&&(N=null);var ie=!1;if(N===null)ie=!0;else switch(z){case"bigint":case"string":case"number":ie=!0;break;case"object":switch(N.$$typeof){case t:case e:ie=!0;break;case g:return ie=N._init,Te(ie(N._payload),Z,M,V,Y)}}if(ie)return Y=Y(N),ie=V===""?"."+te(N,0):V,O(Y)?(M="",ie!=null&&(M=ie.replace(Q,"$&/")+"/"),Te(Y,Z,M,"",function(Re){return Re})):Y!=null&&(P(Y)&&(Y=K(Y,M+(Y.key==null||N&&N.key===Y.key?"":(""+Y.key).replace(Q,"$&/")+"/")+ie)),Z.push(Y)),1;ie=0;var ye=V===""?".":V+":";if(O(N))for(var Ce=0;Ce<N.length;Ce++)V=N[Ce],z=ye+te(V,Ce),ie+=Te(V,Z,M,z,Y);else if(Ce=_(N),typeof Ce=="function")for(N=Ce.call(N),Ce=0;!(V=N.next()).done;)V=V.value,z=ye+te(V,Ce++),ie+=Te(V,Z,M,z,Y);else if(z==="object"){if(typeof N.then=="function")return Te(Le(N),Z,M,V,Y);throw Z=String(N),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return ie}function ae(N,Z,M){if(N==null)return N;var V=[],Y=0;return Te(N,V,"","",function(z){return Z.call(M,z,Y++)}),V}function ue(N){if(N._status===-1){var Z=N._result;Z=Z(),Z.then(function(M){(N._status===0||N._status===-1)&&(N._status=1,N._result=M)},function(M){(N._status===0||N._status===-1)&&(N._status=2,N._result=M)}),N._status===-1&&(N._status=0,N._result=Z)}if(N._status===1)return N._result.default;throw N._result}var re=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)};function W(){}return mt.Children={map:ae,forEach:function(N,Z,M){ae(N,function(){Z.apply(this,arguments)},M)},count:function(N){var Z=0;return ae(N,function(){Z++}),Z},toArray:function(N){return ae(N,function(Z){return Z})||[]},only:function(N){if(!P(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},mt.Component=C,mt.Fragment=n,mt.Profiler=a,mt.PureComponent=k,mt.StrictMode=r,mt.Suspense=d,mt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,mt.__COMPILER_RUNTIME={__proto__:null,c:function(N){return U.H.useMemoCache(N)}},mt.cache=function(N){return function(){return N.apply(null,arguments)}},mt.cloneElement=function(N,Z,M){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var V=E({},N.props),Y=N.key,z=void 0;if(Z!=null)for(ie in Z.ref!==void 0&&(z=void 0),Z.key!==void 0&&(Y=""+Z.key),Z)!j.call(Z,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&Z.ref===void 0||(V[ie]=Z[ie]);var ie=arguments.length-2;if(ie===1)V.children=M;else if(1<ie){for(var ye=Array(ie),Ce=0;Ce<ie;Ce++)ye[Ce]=arguments[Ce+2];V.children=ye}return F(N.type,Y,void 0,void 0,z,V)},mt.createContext=function(N){return N={$$typeof:l,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:i,_context:N},N},mt.createElement=function(N,Z,M){var V,Y={},z=null;if(Z!=null)for(V in Z.key!==void 0&&(z=""+Z.key),Z)j.call(Z,V)&&V!=="key"&&V!=="__self"&&V!=="__source"&&(Y[V]=Z[V]);var ie=arguments.length-2;if(ie===1)Y.children=M;else if(1<ie){for(var ye=Array(ie),Ce=0;Ce<ie;Ce++)ye[Ce]=arguments[Ce+2];Y.children=ye}if(N&&N.defaultProps)for(V in ie=N.defaultProps,ie)Y[V]===void 0&&(Y[V]=ie[V]);return F(N,z,void 0,void 0,null,Y)},mt.createRef=function(){return{current:null}},mt.forwardRef=function(N){return{$$typeof:c,render:N}},mt.isValidElement=P,mt.lazy=function(N){return{$$typeof:g,_payload:{_status:-1,_result:N},_init:ue}},mt.memo=function(N,Z){return{$$typeof:f,type:N,compare:Z===void 0?null:Z}},mt.startTransition=function(N){var Z=U.T,M={};U.T=M;try{var V=N(),Y=U.S;Y!==null&&Y(M,V),typeof V=="object"&&V!==null&&typeof V.then=="function"&&V.then(W,re)}catch(z){re(z)}finally{U.T=Z}},mt.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},mt.use=function(N){return U.H.use(N)},mt.useActionState=function(N,Z,M){return U.H.useActionState(N,Z,M)},mt.useCallback=function(N,Z){return U.H.useCallback(N,Z)},mt.useContext=function(N){return U.H.useContext(N)},mt.useDebugValue=function(){},mt.useDeferredValue=function(N,Z){return U.H.useDeferredValue(N,Z)},mt.useEffect=function(N,Z,M){var V=U.H;if(typeof M=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return V.useEffect(N,Z)},mt.useId=function(){return U.H.useId()},mt.useImperativeHandle=function(N,Z,M){return U.H.useImperativeHandle(N,Z,M)},mt.useInsertionEffect=function(N,Z){return U.H.useInsertionEffect(N,Z)},mt.useLayoutEffect=function(N,Z){return U.H.useLayoutEffect(N,Z)},mt.useMemo=function(N,Z){return U.H.useMemo(N,Z)},mt.useOptimistic=function(N,Z){return U.H.useOptimistic(N,Z)},mt.useReducer=function(N,Z,M){return U.H.useReducer(N,Z,M)},mt.useRef=function(N){return U.H.useRef(N)},mt.useState=function(N){return U.H.useState(N)},mt.useSyncExternalStore=function(N,Z,M){return U.H.useSyncExternalStore(N,Z,M)},mt.useTransition=function(){return U.H.useTransition()},mt.version="19.1.0",mt}var s1;function Lm(){return s1||(s1=1,Eh.exports=VC()),Eh.exports}var ce=Lm();const ls=Om(ce);var Sh={exports:{}},lc={},Ch={exports:{}},bh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i1;function HC(){return i1||(i1=1,function(t){function e(ae,ue){var re=ae.length;ae.push(ue);e:for(;0<re;){var W=re-1>>>1,N=ae[W];if(0<a(N,ue))ae[W]=ue,ae[re]=N,re=W;else break e}}function n(ae){return ae.length===0?null:ae[0]}function r(ae){if(ae.length===0)return null;var ue=ae[0],re=ae.pop();if(re!==ue){ae[0]=re;e:for(var W=0,N=ae.length,Z=N>>>1;W<Z;){var M=2*(W+1)-1,V=ae[M],Y=M+1,z=ae[Y];if(0>a(V,re))Y<N&&0>a(z,V)?(ae[W]=z,ae[Y]=re,W=Y):(ae[W]=V,ae[M]=re,W=M);else if(Y<N&&0>a(z,re))ae[W]=z,ae[Y]=re,W=Y;else break e}}return ue}function a(ae,ue){var re=ae.sortIndex-ue.sortIndex;return re!==0?re:ae.id-ue.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var d=[],f=[],g=1,y=null,_=3,w=!1,E=!1,S=!1,C=!1,R=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function O(ae){for(var ue=n(f);ue!==null;){if(ue.callback===null)r(f);else if(ue.startTime<=ae)r(f),ue.sortIndex=ue.expirationTime,e(d,ue);else break;ue=n(f)}}function U(ae){if(S=!1,O(ae),!E)if(n(d)!==null)E=!0,j||(j=!0,te());else{var ue=n(f);ue!==null&&Te(U,ue.startTime-ae)}}var j=!1,F=-1,K=5,P=-1;function ne(){return C?!0:!(t.unstable_now()-P<K)}function Q(){if(C=!1,j){var ae=t.unstable_now();P=ae;var ue=!0;try{e:{E=!1,S&&(S=!1,k(F),F=-1),w=!0;var re=_;try{t:{for(O(ae),y=n(d);y!==null&&!(y.expirationTime>ae&&ne());){var W=y.callback;if(typeof W=="function"){y.callback=null,_=y.priorityLevel;var N=W(y.expirationTime<=ae);if(ae=t.unstable_now(),typeof N=="function"){y.callback=N,O(ae),ue=!0;break t}y===n(d)&&r(d),O(ae)}else r(d);y=n(d)}if(y!==null)ue=!0;else{var Z=n(f);Z!==null&&Te(U,Z.startTime-ae),ue=!1}}break e}finally{y=null,_=re,w=!1}ue=void 0}}finally{ue?te():j=!1}}}var te;if(typeof b=="function")te=function(){b(Q)};else if(typeof MessageChannel<"u"){var _e=new MessageChannel,Le=_e.port2;_e.port1.onmessage=Q,te=function(){Le.postMessage(null)}}else te=function(){R(Q,0)};function Te(ae,ue){F=R(function(){ae(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ae){ae.callback=null},t.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<ae?Math.floor(1e3/ae):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(ae){switch(_){case 1:case 2:case 3:var ue=3;break;default:ue=_}var re=_;_=ue;try{return ae()}finally{_=re}},t.unstable_requestPaint=function(){C=!0},t.unstable_runWithPriority=function(ae,ue){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var re=_;_=ae;try{return ue()}finally{_=re}},t.unstable_scheduleCallback=function(ae,ue,re){var W=t.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?W+re:W):re=W,ae){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=re+N,ae={id:g++,callback:ue,priorityLevel:ae,startTime:re,expirationTime:N,sortIndex:-1},re>W?(ae.sortIndex=re,e(f,ae),n(d)===null&&ae===n(f)&&(S?(k(F),F=-1):S=!0,Te(U,re-W))):(ae.sortIndex=N,e(d,ae),E||w||(E=!0,j||(j=!0,te()))),ae},t.unstable_shouldYield=ne,t.unstable_wrapCallback=function(ae){var ue=_;return function(){var re=_;_=ue;try{return ae.apply(this,arguments)}finally{_=re}}}}(bh)),bh}var o1;function GC(){return o1||(o1=1,Ch.exports=HC()),Ch.exports}var Ah={exports:{}},Zn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l1;function $C(){if(l1)return Zn;l1=1;var t=Lm();function e(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(d,f,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:d,containerInfo:f,implementation:g}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Zn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Zn.createPortal=function(d,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return i(d,f,null,g)},Zn.flushSync=function(d){var f=l.T,g=r.p;try{if(l.T=null,r.p=2,d)return d()}finally{l.T=f,r.p=g,r.d.f()}},Zn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(d,f))},Zn.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},Zn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var g=f.as,y=c(g,f.crossOrigin),_=typeof f.integrity=="string"?f.integrity:void 0,w=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?r.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:_,fetchPriority:w}):g==="script"&&r.d.X(d,{crossOrigin:y,integrity:_,fetchPriority:w,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Zn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=c(f.as,f.crossOrigin);r.d.M(d,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(d)},Zn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,y=c(g,f.crossOrigin);r.d.L(d,g,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Zn.preloadModule=function(d,f){if(typeof d=="string")if(f){var g=c(f.as,f.crossOrigin);r.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(d)},Zn.requestFormReset=function(d){r.d.r(d)},Zn.unstable_batchedUpdates=function(d,f){return d(f)},Zn.useFormState=function(d,f,g){return l.H.useFormState(d,f,g)},Zn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Zn.version="19.1.0",Zn}var c1;function zC(){if(c1)return Ah.exports;c1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Ah.exports=$C(),Ah.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u1;function qC(){if(u1)return lc;u1=1;var t=GC(),e=Lm(),n=zC();function r(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var o=s,u=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(u=o.return),s=o.return;while(s)}return o.tag===3?u:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function c(s){if(i(s)!==s)throw Error(r(188))}function d(s){var o=s.alternate;if(!o){if(o=i(s),o===null)throw Error(r(188));return o!==s?null:s}for(var u=s,p=o;;){var v=u.return;if(v===null)break;var T=v.alternate;if(T===null){if(p=v.return,p!==null){u=p;continue}break}if(v.child===T.child){for(T=v.child;T;){if(T===u)return c(v),s;if(T===p)return c(v),o;T=T.sibling}throw Error(r(188))}if(u.return!==p.return)u=v,p=T;else{for(var A=!1,I=v.child;I;){if(I===u){A=!0,u=v,p=T;break}if(I===p){A=!0,p=v,u=T;break}I=I.sibling}if(!A){for(I=T.child;I;){if(I===u){A=!0,u=T,p=v;break}if(I===p){A=!0,p=T,u=v;break}I=I.sibling}if(!A)throw Error(r(189))}}if(u.alternate!==p)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?s:o}function f(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=f(s),o!==null)return o;s=s.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),R=Symbol.for("react.provider"),k=Symbol.for("react.consumer"),b=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),ne=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function te(s){return s===null||typeof s!="object"?null:(s=Q&&s[Q]||s["@@iterator"],typeof s=="function"?s:null)}var _e=Symbol.for("react.client.reference");function Le(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===_e?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case E:return"Fragment";case C:return"Profiler";case S:return"StrictMode";case U:return"Suspense";case j:return"SuspenseList";case P:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case b:return(s.displayName||"Context")+".Provider";case k:return(s._context.displayName||"Context")+".Consumer";case O:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case F:return o=s.displayName||null,o!==null?o:Le(s.type)||"Memo";case K:o=s._payload,s=s._init;try{return Le(s(o))}catch{}}return null}var Te=Array.isArray,ae=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},W=[],N=-1;function Z(s){return{current:s}}function M(s){0>N||(s.current=W[N],W[N]=null,N--)}function V(s,o){N++,W[N]=s.current,s.current=o}var Y=Z(null),z=Z(null),ie=Z(null),ye=Z(null);function Ce(s,o){switch(V(ie,o),V(z,s),V(Y,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?Rv(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=Rv(o),s=Dv(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}M(Y),V(Y,s)}function Re(){M(Y),M(z),M(ie)}function Ee(s){s.memoizedState!==null&&V(ye,s);var o=Y.current,u=Dv(o,s.type);o!==u&&(V(z,s),V(Y,u))}function Ke(s){z.current===s&&(M(Y),M(z)),ye.current===s&&(M(ye),nc._currentValue=re)}var J=Object.prototype.hasOwnProperty,xt=t.unstable_scheduleCallback,et=t.unstable_cancelCallback,St=t.unstable_shouldYield,st=t.unstable_requestPaint,Me=t.unstable_now,jt=t.unstable_getCurrentPriorityLevel,nn=t.unstable_ImmediatePriority,xn=t.unstable_UserBlockingPriority,on=t.unstable_NormalPriority,lr=t.unstable_LowPriority,Ct=t.unstable_IdlePriority,vn=t.log,Nn=t.unstable_setDisableYieldValue,Xt=null,zt=null;function De(s){if(typeof vn=="function"&&Nn(s),zt&&typeof zt.setStrictMode=="function")try{zt.setStrictMode(Xt,s)}catch{}}var Ie=Math.clz32?Math.clz32:ft,Fe=Math.log,je=Math.LN2;function ft(s){return s>>>=0,s===0?32:31-(Fe(s)/je|0)|0}var lt=256,cn=4194304;function Gn(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function vr(s,o,u){var p=s.pendingLanes;if(p===0)return 0;var v=0,T=s.suspendedLanes,A=s.pingedLanes;s=s.warmLanes;var I=p&134217727;return I!==0?(p=I&~T,p!==0?v=Gn(p):(A&=I,A!==0?v=Gn(A):u||(u=I&~s,u!==0&&(v=Gn(u))))):(I=p&~T,I!==0?v=Gn(I):A!==0?v=Gn(A):u||(u=p&~s,u!==0&&(v=Gn(u)))),v===0?0:o!==0&&o!==v&&(o&T)===0&&(T=v&-v,u=o&-o,T>=u||T===32&&(u&4194048)!==0)?o:v}function yr(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function Sa(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hr(){var s=lt;return lt<<=1,(lt&4194048)===0&&(lt=256),s}function Gr(){var s=cn;return cn<<=1,(cn&62914560)===0&&(cn=4194304),s}function $r(s){for(var o=[],u=0;31>u;u++)o.push(s);return o}function vt(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function un(s,o,u,p,v,T){var A=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var I=s.entanglements,ee=s.expirationTimes,he=s.hiddenUpdates;for(u=A&~u;0<u;){var Se=31-Ie(u),ke=1<<Se;I[Se]=0,ee[Se]=-1;var ge=he[Se];if(ge!==null)for(he[Se]=null,Se=0;Se<ge.length;Se++){var xe=ge[Se];xe!==null&&(xe.lane&=-536870913)}u&=~ke}p!==0&&$n(s,p,0),T!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=T&~(A&~o))}function $n(s,o,u){s.pendingLanes|=o,s.suspendedLanes&=~o;var p=31-Ie(o);s.entangledLanes|=o,s.entanglements[p]=s.entanglements[p]|1073741824|u&4194090}function cr(s,o){var u=s.entangledLanes|=o;for(s=s.entanglements;u;){var p=31-Ie(u),v=1<<p;v&o|s[p]&o&&(s[p]|=o),u&=~v}}function oa(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function la(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ms(){var s=ue.p;return s!==0?s:(s=window.event,s===void 0?32:Kv(s.type))}function Be(s,o){var u=ue.p;try{return ue.p=s,o()}finally{ue.p=u}}var Xe=Math.random().toString(36).slice(2),Ze="__reactFiber$"+Xe,bt="__reactProps$"+Xe,yn="__reactContainer$"+Xe,dt="__reactEvents$"+Xe,zr="__reactListeners$"+Xe,D="__reactHandles$"+Xe,H="__reactResources$"+Xe,L="__reactMarker$"+Xe;function B(s){delete s[Ze],delete s[bt],delete s[dt],delete s[zr],delete s[D]}function G(s){var o=s[Ze];if(o)return o;for(var u=s.parentNode;u;){if(o=u[yn]||u[Ze]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(s=Ov(s);s!==null;){if(u=s[Ze])return u;s=Ov(s)}return o}s=u,u=s.parentNode}return null}function q(s){if(s=s[Ze]||s[yn]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function de(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(r(33))}function ve(s){var o=s[H];return o||(o=s[H]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function le(s){s[L]=!0}var me=new Set,pe={};function Ne(s,o){Pe(s,o),Pe(s+"Capture",o)}function Pe(s,o){for(pe[s]=o,s=0;s<o.length;s++)me.add(o[s])}var He=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Oe={},X={};function we(s){return J.call(X,s)?!0:J.call(Oe,s)?!1:He.test(s)?X[s]=!0:(Oe[s]=!0,!1)}function Ae(s,o,u){if(we(o))if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+u)}}function Ve(s,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+u)}}function $e(s,o,u,p){if(p===null)s.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(o,u,""+p)}}var ht,Ot;function At(s){if(ht===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);ht=o&&o[1]||"",Ot=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ht+s+Ot}var Lt=!1;function fn(s,o){if(!s||Lt)return"";Lt=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(xe){var ge=xe}Reflect.construct(s,[],ke)}else{try{ke.call()}catch(xe){ge=xe}s.call(ke.prototype)}}else{try{throw Error()}catch(xe){ge=xe}(ke=s())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(xe){if(xe&&ge&&typeof xe.stack=="string")return[xe.stack,ge.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=p.DetermineComponentFrameRoot(),A=T[0],I=T[1];if(A&&I){var ee=A.split(`
`),he=I.split(`
`);for(v=p=0;p<ee.length&&!ee[p].includes("DetermineComponentFrameRoot");)p++;for(;v<he.length&&!he[v].includes("DetermineComponentFrameRoot");)v++;if(p===ee.length||v===he.length)for(p=ee.length-1,v=he.length-1;1<=p&&0<=v&&ee[p]!==he[v];)v--;for(;1<=p&&0<=v;p--,v--)if(ee[p]!==he[v]){if(p!==1||v!==1)do if(p--,v--,0>v||ee[p]!==he[v]){var Se=`
`+ee[p].replace(" at new "," at ");return s.displayName&&Se.includes("<anonymous>")&&(Se=Se.replace("<anonymous>",s.displayName)),Se}while(1<=p&&0<=v);break}}}finally{Lt=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?At(u):""}function Pt(s){switch(s.tag){case 26:case 27:case 5:return At(s.type);case 16:return At("Lazy");case 13:return At("Suspense");case 19:return At("SuspenseList");case 0:case 15:return fn(s.type,!1);case 11:return fn(s.type.render,!1);case 1:return fn(s.type,!0);case 31:return At("Activity");default:return""}}function qr(s){try{var o="";do o+=Pt(s),s=s.return;while(s);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function dn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ml(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function zi(s){var o=ml(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),p=""+s[o];if(!s.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var v=u.get,T=u.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return v.call(this)},set:function(A){p=""+A,T.call(this,A)}}),Object.defineProperty(s,o,{enumerable:u.enumerable}),{getValue:function(){return p},setValue:function(A){p=""+A},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function ps(s){s._valueTracker||(s._valueTracker=zi(s))}function qi(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var u=o.getValue(),p="";return s&&(p=ml(s)?s.checked?"true":"false":s.value),s=p,s!==u?(o.setValue(s),!0):!1}function ti(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var qt=/[\n"\\]/g;function _t(s){return s.replace(qt,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Rn(s,o,u,p,v,T,A,I){s.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.type=A:s.removeAttribute("type"),o!=null?A==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+dn(o)):s.value!==""+dn(o)&&(s.value=""+dn(o)):A!=="submit"&&A!=="reset"||s.removeAttribute("value"),o!=null?ca(s,A,dn(o)):u!=null?ca(s,A,dn(u)):p!=null&&s.removeAttribute("value"),v==null&&T!=null&&(s.defaultChecked=!!T),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+dn(I):s.removeAttribute("name")}function ni(s,o,u,p,v,T,A,I){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(s.type=T),o!=null||u!=null){if(!(T!=="submit"&&T!=="reset"||o!=null))return;u=u!=null?""+dn(u):"",o=o!=null?""+dn(o):u,I||o===s.value||(s.value=o),s.defaultValue=o}p=p??v,p=typeof p!="function"&&typeof p!="symbol"&&!!p,s.checked=I?s.checked:!!p,s.defaultChecked=!!p,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.name=A)}function ca(s,o,u){o==="number"&&ti(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Nr(s,o,u,p){if(s=s.options,o){o={};for(var v=0;v<u.length;v++)o["$"+u[v]]=!0;for(u=0;u<s.length;u++)v=o.hasOwnProperty("$"+s[u].value),s[u].selected!==v&&(s[u].selected=v),v&&p&&(s[u].defaultSelected=!0)}else{for(u=""+dn(u),o=null,v=0;v<s.length;v++){if(s[v].value===u){s[v].selected=!0,p&&(s[v].defaultSelected=!0);return}o!==null||s[v].disabled||(o=s[v])}o!==null&&(o.selected=!0)}}function cu(s,o,u){if(o!=null&&(o=""+dn(o),o!==s.value&&(s.value=o),u==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=u!=null?""+dn(u):""}function Np(s,o,u,p){if(o==null){if(p!=null){if(u!=null)throw Error(r(92));if(Te(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),o=u}u=dn(o),s.defaultValue=u,p=s.textContent,p===u&&p!==""&&p!==null&&(s.value=p)}function Yi(s,o){if(o){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=o;return}}s.textContent=o}var OE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rp(s,o,u){var p=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":p?s.setProperty(o,u):typeof u!="number"||u===0||OE.has(o)?o==="float"?s.cssFloat=u:s[o]=(""+u).trim():s[o]=u+"px"}function Dp(s,o,u){if(o!=null&&typeof o!="object")throw Error(r(62));if(s=s.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?s.setProperty(p,""):p==="float"?s.cssFloat="":s[p]="");for(var v in o)p=o[v],o.hasOwnProperty(v)&&u[v]!==p&&Rp(s,v,p)}else for(var T in o)o.hasOwnProperty(T)&&Rp(s,T,o[T])}function Td(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var LE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),PE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function uu(s){return PE.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var wd=null;function Ed(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Wi=null,Ji=null;function Mp(s){var o=q(s);if(o&&(s=o.stateNode)){var u=s[bt]||null;e:switch(s=o.stateNode,o.type){case"input":if(Rn(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+_t(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var p=u[o];if(p!==s&&p.form===s.form){var v=p[bt]||null;if(!v)throw Error(r(90));Rn(p,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(o=0;o<u.length;o++)p=u[o],p.form===s.form&&qi(p)}break e;case"textarea":cu(s,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Nr(s,!!u.multiple,o,!1)}}}var Sd=!1;function Ip(s,o,u){if(Sd)return s(o,u);Sd=!0;try{var p=s(o);return p}finally{if(Sd=!1,(Wi!==null||Ji!==null)&&(Ju(),Wi&&(o=Wi,s=Ji,Ji=Wi=null,Mp(o),s)))for(o=0;o<s.length;o++)Mp(s[o])}}function pl(s,o){var u=s.stateNode;if(u===null)return null;var p=u[bt]||null;if(p===null)return null;u=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(s=s.type,p=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!p;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var Ha=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cd=!1;if(Ha)try{var gl={};Object.defineProperty(gl,"passive",{get:function(){Cd=!0}}),window.addEventListener("test",gl,gl),window.removeEventListener("test",gl,gl)}catch{Cd=!1}var gs=null,bd=null,fu=null;function Fp(){if(fu)return fu;var s,o=bd,u=o.length,p,v="value"in gs?gs.value:gs.textContent,T=v.length;for(s=0;s<u&&o[s]===v[s];s++);var A=u-s;for(p=1;p<=A&&o[u-p]===v[T-p];p++);return fu=v.slice(s,1<p?1-p:void 0)}function du(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function hu(){return!0}function Op(){return!1}function _r(s){function o(u,p,v,T,A){this._reactName=u,this._targetInst=v,this.type=p,this.nativeEvent=T,this.target=A,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(u=s[I],this[I]=u?u(T):T[I]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?hu:Op,this.isPropagationStopped=Op,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=hu)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=hu)},persist:function(){},isPersistent:hu}),o}var ri={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mu=_r(ri),xl=g({},ri,{view:0,detail:0}),UE=_r(xl),Ad,kd,vl,pu=g({},xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==vl&&(vl&&s.type==="mousemove"?(Ad=s.screenX-vl.screenX,kd=s.screenY-vl.screenY):kd=Ad=0,vl=s),Ad)},movementY:function(s){return"movementY"in s?s.movementY:kd}}),Lp=_r(pu),BE=g({},pu,{dataTransfer:0}),jE=_r(BE),VE=g({},xl,{relatedTarget:0}),Nd=_r(VE),HE=g({},ri,{animationName:0,elapsedTime:0,pseudoElement:0}),GE=_r(HE),$E=g({},ri,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),zE=_r($E),qE=g({},ri,{data:0}),Pp=_r(qE),YE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},WE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},JE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KE(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=JE[s])?!!o[s]:!1}function Rd(){return KE}var XE=g({},xl,{key:function(s){if(s.key){var o=YE[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=du(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?WE[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rd,charCode:function(s){return s.type==="keypress"?du(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?du(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ZE=_r(XE),QE=g({},pu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Up=_r(QE),eS=g({},xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rd}),tS=_r(eS),nS=g({},ri,{propertyName:0,elapsedTime:0,pseudoElement:0}),rS=_r(nS),aS=g({},pu,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),sS=_r(aS),iS=g({},ri,{newState:0,oldState:0}),oS=_r(iS),lS=[9,13,27,32],Dd=Ha&&"CompositionEvent"in window,yl=null;Ha&&"documentMode"in document&&(yl=document.documentMode);var cS=Ha&&"TextEvent"in window&&!yl,Bp=Ha&&(!Dd||yl&&8<yl&&11>=yl),jp=" ",Vp=!1;function Hp(s,o){switch(s){case"keyup":return lS.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gp(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ki=!1;function uS(s,o){switch(s){case"compositionend":return Gp(o);case"keypress":return o.which!==32?null:(Vp=!0,jp);case"textInput":return s=o.data,s===jp&&Vp?null:s;default:return null}}function fS(s,o){if(Ki)return s==="compositionend"||!Dd&&Hp(s,o)?(s=Fp(),fu=bd=gs=null,Ki=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Bp&&o.locale!=="ko"?null:o.data;default:return null}}var dS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $p(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!dS[s.type]:o==="textarea"}function zp(s,o,u,p){Wi?Ji?Ji.push(p):Ji=[p]:Wi=p,o=tf(o,"onChange"),0<o.length&&(u=new mu("onChange","change",null,u,p),s.push({event:u,listeners:o}))}var _l=null,Tl=null;function hS(s){Cv(s,0)}function gu(s){var o=de(s);if(qi(o))return s}function qp(s,o){if(s==="change")return o}var Yp=!1;if(Ha){var Md;if(Ha){var Id="oninput"in document;if(!Id){var Wp=document.createElement("div");Wp.setAttribute("oninput","return;"),Id=typeof Wp.oninput=="function"}Md=Id}else Md=!1;Yp=Md&&(!document.documentMode||9<document.documentMode)}function Jp(){_l&&(_l.detachEvent("onpropertychange",Kp),Tl=_l=null)}function Kp(s){if(s.propertyName==="value"&&gu(Tl)){var o=[];zp(o,Tl,s,Ed(s)),Ip(hS,o)}}function mS(s,o,u){s==="focusin"?(Jp(),_l=o,Tl=u,_l.attachEvent("onpropertychange",Kp)):s==="focusout"&&Jp()}function pS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return gu(Tl)}function gS(s,o){if(s==="click")return gu(o)}function xS(s,o){if(s==="input"||s==="change")return gu(o)}function vS(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Rr=typeof Object.is=="function"?Object.is:vS;function wl(s,o){if(Rr(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var u=Object.keys(s),p=Object.keys(o);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var v=u[p];if(!J.call(o,v)||!Rr(s[v],o[v]))return!1}return!0}function Xp(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Zp(s,o){var u=Xp(s);s=0;for(var p;u;){if(u.nodeType===3){if(p=s+u.textContent.length,s<=o&&p>=o)return{node:u,offset:o-s};s=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Xp(u)}}function Qp(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Qp(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function eg(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=ti(s.document);o instanceof s.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)s=o.contentWindow;else break;o=ti(s.document)}return o}function Fd(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var yS=Ha&&"documentMode"in document&&11>=document.documentMode,Xi=null,Od=null,El=null,Ld=!1;function tg(s,o,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Ld||Xi==null||Xi!==ti(p)||(p=Xi,"selectionStart"in p&&Fd(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),El&&wl(El,p)||(El=p,p=tf(Od,"onSelect"),0<p.length&&(o=new mu("onSelect","select",null,o,u),s.push({event:o,listeners:p}),o.target=Xi)))}function ai(s,o){var u={};return u[s.toLowerCase()]=o.toLowerCase(),u["Webkit"+s]="webkit"+o,u["Moz"+s]="moz"+o,u}var Zi={animationend:ai("Animation","AnimationEnd"),animationiteration:ai("Animation","AnimationIteration"),animationstart:ai("Animation","AnimationStart"),transitionrun:ai("Transition","TransitionRun"),transitionstart:ai("Transition","TransitionStart"),transitioncancel:ai("Transition","TransitionCancel"),transitionend:ai("Transition","TransitionEnd")},Pd={},ng={};Ha&&(ng=document.createElement("div").style,"AnimationEvent"in window||(delete Zi.animationend.animation,delete Zi.animationiteration.animation,delete Zi.animationstart.animation),"TransitionEvent"in window||delete Zi.transitionend.transition);function si(s){if(Pd[s])return Pd[s];if(!Zi[s])return s;var o=Zi[s],u;for(u in o)if(o.hasOwnProperty(u)&&u in ng)return Pd[s]=o[u];return s}var rg=si("animationend"),ag=si("animationiteration"),sg=si("animationstart"),_S=si("transitionrun"),TS=si("transitionstart"),wS=si("transitioncancel"),ig=si("transitionend"),og=new Map,Ud="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ud.push("scrollEnd");function ua(s,o){og.set(s,o),Ne(o,[s])}var lg=new WeakMap;function Yr(s,o){if(typeof s=="object"&&s!==null){var u=lg.get(s);return u!==void 0?u:(o={value:s,source:o,stack:qr(o)},lg.set(s,o),o)}return{value:s,source:o,stack:qr(o)}}var Wr=[],Qi=0,Bd=0;function xu(){for(var s=Qi,o=Bd=Qi=0;o<s;){var u=Wr[o];Wr[o++]=null;var p=Wr[o];Wr[o++]=null;var v=Wr[o];Wr[o++]=null;var T=Wr[o];if(Wr[o++]=null,p!==null&&v!==null){var A=p.pending;A===null?v.next=v:(v.next=A.next,A.next=v),p.pending=v}T!==0&&cg(u,v,T)}}function vu(s,o,u,p){Wr[Qi++]=s,Wr[Qi++]=o,Wr[Qi++]=u,Wr[Qi++]=p,Bd|=p,s.lanes|=p,s=s.alternate,s!==null&&(s.lanes|=p)}function jd(s,o,u,p){return vu(s,o,u,p),yu(s)}function eo(s,o){return vu(s,null,null,o),yu(s)}function cg(s,o,u){s.lanes|=u;var p=s.alternate;p!==null&&(p.lanes|=u);for(var v=!1,T=s.return;T!==null;)T.childLanes|=u,p=T.alternate,p!==null&&(p.childLanes|=u),T.tag===22&&(s=T.stateNode,s===null||s._visibility&1||(v=!0)),s=T,T=T.return;return s.tag===3?(T=s.stateNode,v&&o!==null&&(v=31-Ie(u),s=T.hiddenUpdates,p=s[v],p===null?s[v]=[o]:p.push(o),o.lane=u|536870912),T):null}function yu(s){if(50<Wl)throw Wl=0,q0=null,Error(r(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var to={};function ES(s,o,u,p){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(s,o,u,p){return new ES(s,o,u,p)}function Vd(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ga(s,o){var u=s.alternate;return u===null?(u=Dr(s.tag,o,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=o,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,o=s.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function ug(s,o){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,o=u.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function _u(s,o,u,p,v,T){var A=0;if(p=s,typeof s=="function")Vd(s)&&(A=1);else if(typeof s=="string")A=CC(s,u,Y.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case P:return s=Dr(31,u,o,v),s.elementType=P,s.lanes=T,s;case E:return ii(u.children,v,T,o);case S:A=8,v|=24;break;case C:return s=Dr(12,u,o,v|2),s.elementType=C,s.lanes=T,s;case U:return s=Dr(13,u,o,v),s.elementType=U,s.lanes=T,s;case j:return s=Dr(19,u,o,v),s.elementType=j,s.lanes=T,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case R:case b:A=10;break e;case k:A=9;break e;case O:A=11;break e;case F:A=14;break e;case K:A=16,p=null;break e}A=29,u=Error(r(130,s===null?"null":typeof s,"")),p=null}return o=Dr(A,u,o,v),o.elementType=s,o.type=p,o.lanes=T,o}function ii(s,o,u,p){return s=Dr(7,s,p,o),s.lanes=u,s}function Hd(s,o,u){return s=Dr(6,s,null,o),s.lanes=u,s}function Gd(s,o,u){return o=Dr(4,s.children!==null?s.children:[],s.key,o),o.lanes=u,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var no=[],ro=0,Tu=null,wu=0,Jr=[],Kr=0,oi=null,$a=1,za="";function li(s,o){no[ro++]=wu,no[ro++]=Tu,Tu=s,wu=o}function fg(s,o,u){Jr[Kr++]=$a,Jr[Kr++]=za,Jr[Kr++]=oi,oi=s;var p=$a;s=za;var v=32-Ie(p)-1;p&=~(1<<v),u+=1;var T=32-Ie(o)+v;if(30<T){var A=v-v%5;T=(p&(1<<A)-1).toString(32),p>>=A,v-=A,$a=1<<32-Ie(o)+v|u<<v|p,za=T+s}else $a=1<<T|u<<v|p,za=s}function $d(s){s.return!==null&&(li(s,1),fg(s,1,0))}function zd(s){for(;s===Tu;)Tu=no[--ro],no[ro]=null,wu=no[--ro],no[ro]=null;for(;s===oi;)oi=Jr[--Kr],Jr[Kr]=null,za=Jr[--Kr],Jr[Kr]=null,$a=Jr[--Kr],Jr[Kr]=null}var ur=null,hn=null,Vt=!1,ci=null,Ca=!1,qd=Error(r(519));function ui(s){var o=Error(r(418,""));throw bl(Yr(o,s)),qd}function dg(s){var o=s.stateNode,u=s.type,p=s.memoizedProps;switch(o[Ze]=s,o[bt]=p,u){case"dialog":wt("cancel",o),wt("close",o);break;case"iframe":case"object":case"embed":wt("load",o);break;case"video":case"audio":for(u=0;u<Kl.length;u++)wt(Kl[u],o);break;case"source":wt("error",o);break;case"img":case"image":case"link":wt("error",o),wt("load",o);break;case"details":wt("toggle",o);break;case"input":wt("invalid",o),ni(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),ps(o);break;case"select":wt("invalid",o);break;case"textarea":wt("invalid",o),Np(o,p.value,p.defaultValue,p.children),ps(o)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||p.suppressHydrationWarning===!0||Nv(o.textContent,u)?(p.popover!=null&&(wt("beforetoggle",o),wt("toggle",o)),p.onScroll!=null&&wt("scroll",o),p.onScrollEnd!=null&&wt("scrollend",o),p.onClick!=null&&(o.onclick=nf),o=!0):o=!1,o||ui(s)}function hg(s){for(ur=s.return;ur;)switch(ur.tag){case 5:case 13:Ca=!1;return;case 27:case 3:Ca=!0;return;default:ur=ur.return}}function Sl(s){if(s!==ur)return!1;if(!Vt)return hg(s),Vt=!0,!1;var o=s.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||lh(s.type,s.memoizedProps)),u=!u),u&&hn&&ui(s),hg(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(o===0){hn=da(s.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;s=s.nextSibling}hn=null}}else o===27?(o=hn,Ms(s.type)?(s=dh,dh=null,hn=s):hn=o):hn=ur?da(s.stateNode.nextSibling):null;return!0}function Cl(){hn=ur=null,Vt=!1}function mg(){var s=ci;return s!==null&&(Er===null?Er=s:Er.push.apply(Er,s),ci=null),s}function bl(s){ci===null?ci=[s]:ci.push(s)}var Yd=Z(null),fi=null,qa=null;function xs(s,o,u){V(Yd,o._currentValue),o._currentValue=u}function Ya(s){s._currentValue=Yd.current,M(Yd)}function Wd(s,o,u){for(;s!==null;){var p=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),s===u)break;s=s.return}}function Jd(s,o,u,p){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var T=v.dependencies;if(T!==null){var A=v.child;T=T.firstContext;e:for(;T!==null;){var I=T;T=v;for(var ee=0;ee<o.length;ee++)if(I.context===o[ee]){T.lanes|=u,I=T.alternate,I!==null&&(I.lanes|=u),Wd(T.return,u,s),p||(A=null);break e}T=I.next}}else if(v.tag===18){if(A=v.return,A===null)throw Error(r(341));A.lanes|=u,T=A.alternate,T!==null&&(T.lanes|=u),Wd(A,u,s),A=null}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===s){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}}function Al(s,o,u,p){s=null;for(var v=o,T=!1;v!==null;){if(!T){if((v.flags&524288)!==0)T=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var A=v.alternate;if(A===null)throw Error(r(387));if(A=A.memoizedProps,A!==null){var I=v.type;Rr(v.pendingProps.value,A.value)||(s!==null?s.push(I):s=[I])}}else if(v===ye.current){if(A=v.alternate,A===null)throw Error(r(387));A.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(nc):s=[nc])}v=v.return}s!==null&&Jd(o,s,u,p),o.flags|=262144}function Eu(s){for(s=s.firstContext;s!==null;){if(!Rr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function di(s){fi=s,qa=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Xn(s){return pg(fi,s)}function Su(s,o){return fi===null&&di(s),pg(s,o)}function pg(s,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},qa===null){if(s===null)throw Error(r(308));qa=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else qa=qa.next=o;return u}var SS=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(u,p){s.push(p)}};this.abort=function(){o.aborted=!0,s.forEach(function(u){return u()})}},CS=t.unstable_scheduleCallback,bS=t.unstable_NormalPriority,Dn={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kd(){return{controller:new SS,data:new Map,refCount:0}}function kl(s){s.refCount--,s.refCount===0&&CS(bS,function(){s.controller.abort()})}var Nl=null,Xd=0,ao=0,so=null;function AS(s,o){if(Nl===null){var u=Nl=[];Xd=0,ao=Q0(),so={status:"pending",value:void 0,then:function(p){u.push(p)}}}return Xd++,o.then(gg,gg),o}function gg(){if(--Xd===0&&Nl!==null){so!==null&&(so.status="fulfilled");var s=Nl;Nl=null,ao=0,so=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function kS(s,o){var u=[],p={status:"pending",value:null,reason:null,then:function(v){u.push(v)}};return s.then(function(){p.status="fulfilled",p.value=o;for(var v=0;v<u.length;v++)(0,u[v])(o)},function(v){for(p.status="rejected",p.reason=v,v=0;v<u.length;v++)(0,u[v])(void 0)}),p}var xg=ae.S;ae.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&AS(s,o),xg!==null&&xg(s,o)};var hi=Z(null);function Zd(){var s=hi.current;return s!==null?s:Zt.pooledCache}function Cu(s,o){o===null?V(hi,hi.current):V(hi,o.pool)}function vg(){var s=Zd();return s===null?null:{parent:Dn._currentValue,pool:s}}var Rl=Error(r(460)),yg=Error(r(474)),bu=Error(r(542)),Qd={then:function(){}};function _g(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Au(){}function Tg(s,o,u){switch(u=s[u],u===void 0?s.push(o):u!==o&&(o.then(Au,Au),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Eg(s),s;default:if(typeof o.status=="string")o.then(Au,Au);else{if(s=Zt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=o,s.status="pending",s.then(function(p){if(o.status==="pending"){var v=o;v.status="fulfilled",v.value=p}},function(p){if(o.status==="pending"){var v=o;v.status="rejected",v.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Eg(s),s}throw Dl=o,Rl}}var Dl=null;function wg(){if(Dl===null)throw Error(r(459));var s=Dl;return Dl=null,s}function Eg(s){if(s===Rl||s===bu)throw Error(r(483))}var vs=!1;function e0(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function t0(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ys(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function _s(s,o,u){var p=s.updateQueue;if(p===null)return null;if(p=p.shared,(Ht&2)!==0){var v=p.pending;return v===null?o.next=o:(o.next=v.next,v.next=o),p.pending=o,o=yu(s),cg(s,null,u),o}return vu(s,p,o,u),yu(s)}function Ml(s,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var p=o.lanes;p&=s.pendingLanes,u|=p,o.lanes=u,cr(s,u)}}function n0(s,o){var u=s.updateQueue,p=s.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var v=null,T=null;if(u=u.firstBaseUpdate,u!==null){do{var A={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};T===null?v=T=A:T=T.next=A,u=u.next}while(u!==null);T===null?v=T=o:T=T.next=o}else v=T=o;u={baseState:p.baseState,firstBaseUpdate:v,lastBaseUpdate:T,shared:p.shared,callbacks:p.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=o:s.next=o,u.lastBaseUpdate=o}var r0=!1;function Il(){if(r0){var s=so;if(s!==null)throw s}}function Fl(s,o,u,p){r0=!1;var v=s.updateQueue;vs=!1;var T=v.firstBaseUpdate,A=v.lastBaseUpdate,I=v.shared.pending;if(I!==null){v.shared.pending=null;var ee=I,he=ee.next;ee.next=null,A===null?T=he:A.next=he,A=ee;var Se=s.alternate;Se!==null&&(Se=Se.updateQueue,I=Se.lastBaseUpdate,I!==A&&(I===null?Se.firstBaseUpdate=he:I.next=he,Se.lastBaseUpdate=ee))}if(T!==null){var ke=v.baseState;A=0,Se=he=ee=null,I=T;do{var ge=I.lane&-536870913,xe=ge!==I.lane;if(xe?(Rt&ge)===ge:(p&ge)===ge){ge!==0&&ge===ao&&(r0=!0),Se!==null&&(Se=Se.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var nt=s,Qe=I;ge=o;var Jt=u;switch(Qe.tag){case 1:if(nt=Qe.payload,typeof nt=="function"){ke=nt.call(Jt,ke,ge);break e}ke=nt;break e;case 3:nt.flags=nt.flags&-65537|128;case 0:if(nt=Qe.payload,ge=typeof nt=="function"?nt.call(Jt,ke,ge):nt,ge==null)break e;ke=g({},ke,ge);break e;case 2:vs=!0}}ge=I.callback,ge!==null&&(s.flags|=64,xe&&(s.flags|=8192),xe=v.callbacks,xe===null?v.callbacks=[ge]:xe.push(ge))}else xe={lane:ge,tag:I.tag,payload:I.payload,callback:I.callback,next:null},Se===null?(he=Se=xe,ee=ke):Se=Se.next=xe,A|=ge;if(I=I.next,I===null){if(I=v.shared.pending,I===null)break;xe=I,I=xe.next,xe.next=null,v.lastBaseUpdate=xe,v.shared.pending=null}}while(!0);Se===null&&(ee=ke),v.baseState=ee,v.firstBaseUpdate=he,v.lastBaseUpdate=Se,T===null&&(v.shared.lanes=0),ks|=A,s.lanes=A,s.memoizedState=ke}}function Sg(s,o){if(typeof s!="function")throw Error(r(191,s));s.call(o)}function Cg(s,o){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)Sg(u[s],o)}var io=Z(null),ku=Z(0);function bg(s,o){s=es,V(ku,s),V(io,o),es=s|o.baseLanes}function a0(){V(ku,es),V(io,io.current)}function s0(){es=ku.current,M(io),M(ku)}var Ts=0,gt=null,Yt=null,En=null,Nu=!1,oo=!1,mi=!1,Ru=0,Ol=0,lo=null,NS=0;function _n(){throw Error(r(321))}function i0(s,o){if(o===null)return!1;for(var u=0;u<o.length&&u<s.length;u++)if(!Rr(s[u],o[u]))return!1;return!0}function o0(s,o,u,p,v,T){return Ts=T,gt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ae.H=s===null||s.memoizedState===null?cx:ux,mi=!1,T=u(p,v),mi=!1,oo&&(T=kg(o,u,p,v)),Ag(s),T}function Ag(s){ae.H=Lu;var o=Yt!==null&&Yt.next!==null;if(Ts=0,En=Yt=gt=null,Nu=!1,Ol=0,lo=null,o)throw Error(r(300));s===null||Ln||(s=s.dependencies,s!==null&&Eu(s)&&(Ln=!0))}function kg(s,o,u,p){gt=s;var v=0;do{if(oo&&(lo=null),Ol=0,oo=!1,25<=v)throw Error(r(301));if(v+=1,En=Yt=null,s.updateQueue!=null){var T=s.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}ae.H=LS,T=o(u,p)}while(oo);return T}function RS(){var s=ae.H,o=s.useState()[0];return o=typeof o.then=="function"?Ll(o):o,s=s.useState()[0],(Yt!==null?Yt.memoizedState:null)!==s&&(gt.flags|=1024),o}function l0(){var s=Ru!==0;return Ru=0,s}function c0(s,o,u){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~u}function u0(s){if(Nu){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Nu=!1}Ts=0,En=Yt=gt=null,oo=!1,Ol=Ru=0,lo=null}function Tr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?gt.memoizedState=En=s:En=En.next=s,En}function Sn(){if(Yt===null){var s=gt.alternate;s=s!==null?s.memoizedState:null}else s=Yt.next;var o=En===null?gt.memoizedState:En.next;if(o!==null)En=o,Yt=s;else{if(s===null)throw gt.alternate===null?Error(r(467)):Error(r(310));Yt=s,s={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},En===null?gt.memoizedState=En=s:En=En.next=s}return En}function f0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ll(s){var o=Ol;return Ol+=1,lo===null&&(lo=[]),s=Tg(lo,s,o),o=gt,(En===null?o.memoizedState:En.next)===null&&(o=o.alternate,ae.H=o===null||o.memoizedState===null?cx:ux),s}function Du(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ll(s);if(s.$$typeof===b)return Xn(s)}throw Error(r(438,String(s)))}function d0(s){var o=null,u=gt.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var p=gt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(v){return v.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=f0(),gt.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(s),p=0;p<s;p++)u[p]=ne;return o.index++,u}function Wa(s,o){return typeof o=="function"?o(s):o}function Mu(s){var o=Sn();return h0(o,Yt,s)}function h0(s,o,u){var p=s.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=u;var v=s.baseQueue,T=p.pending;if(T!==null){if(v!==null){var A=v.next;v.next=T.next,T.next=A}o.baseQueue=v=T,p.pending=null}if(T=s.baseState,v===null)s.memoizedState=T;else{o=v.next;var I=A=null,ee=null,he=o,Se=!1;do{var ke=he.lane&-536870913;if(ke!==he.lane?(Rt&ke)===ke:(Ts&ke)===ke){var ge=he.revertLane;if(ge===0)ee!==null&&(ee=ee.next={lane:0,revertLane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),ke===ao&&(Se=!0);else if((Ts&ge)===ge){he=he.next,ge===ao&&(Se=!0);continue}else ke={lane:0,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},ee===null?(I=ee=ke,A=T):ee=ee.next=ke,gt.lanes|=ge,ks|=ge;ke=he.action,mi&&u(T,ke),T=he.hasEagerState?he.eagerState:u(T,ke)}else ge={lane:ke,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},ee===null?(I=ee=ge,A=T):ee=ee.next=ge,gt.lanes|=ke,ks|=ke;he=he.next}while(he!==null&&he!==o);if(ee===null?A=T:ee.next=I,!Rr(T,s.memoizedState)&&(Ln=!0,Se&&(u=so,u!==null)))throw u;s.memoizedState=T,s.baseState=A,s.baseQueue=ee,p.lastRenderedState=T}return v===null&&(p.lanes=0),[s.memoizedState,p.dispatch]}function m0(s){var o=Sn(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=s;var p=u.dispatch,v=u.pending,T=o.memoizedState;if(v!==null){u.pending=null;var A=v=v.next;do T=s(T,A.action),A=A.next;while(A!==v);Rr(T,o.memoizedState)||(Ln=!0),o.memoizedState=T,o.baseQueue===null&&(o.baseState=T),u.lastRenderedState=T}return[T,p]}function Ng(s,o,u){var p=gt,v=Sn(),T=Vt;if(T){if(u===void 0)throw Error(r(407));u=u()}else u=o();var A=!Rr((Yt||v).memoizedState,u);A&&(v.memoizedState=u,Ln=!0),v=v.queue;var I=Mg.bind(null,p,v,s);if(Pl(2048,8,I,[s]),v.getSnapshot!==o||A||En!==null&&En.memoizedState.tag&1){if(p.flags|=2048,co(9,Iu(),Dg.bind(null,p,v,u,o),null),Zt===null)throw Error(r(349));T||(Ts&124)!==0||Rg(p,o,u)}return u}function Rg(s,o,u){s.flags|=16384,s={getSnapshot:o,value:u},o=gt.updateQueue,o===null?(o=f0(),gt.updateQueue=o,o.stores=[s]):(u=o.stores,u===null?o.stores=[s]:u.push(s))}function Dg(s,o,u,p){o.value=u,o.getSnapshot=p,Ig(o)&&Fg(s)}function Mg(s,o,u){return u(function(){Ig(o)&&Fg(s)})}function Ig(s){var o=s.getSnapshot;s=s.value;try{var u=o();return!Rr(s,u)}catch{return!0}}function Fg(s){var o=eo(s,2);o!==null&&Lr(o,s,2)}function p0(s){var o=Tr();if(typeof s=="function"){var u=s;if(s=u(),mi){De(!0);try{u()}finally{De(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wa,lastRenderedState:s},o}function Og(s,o,u,p){return s.baseState=u,h0(s,Yt,typeof p=="function"?p:Wa)}function DS(s,o,u,p,v){if(Ou(s))throw Error(r(485));if(s=o.action,s!==null){var T={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){T.listeners.push(A)}};ae.T!==null?u(!0):T.isTransition=!1,p(T),u=o.pending,u===null?(T.next=o.pending=T,Lg(o,T)):(T.next=u.next,o.pending=u.next=T)}}function Lg(s,o){var u=o.action,p=o.payload,v=s.state;if(o.isTransition){var T=ae.T,A={};ae.T=A;try{var I=u(v,p),ee=ae.S;ee!==null&&ee(A,I),Pg(s,o,I)}catch(he){g0(s,o,he)}finally{ae.T=T}}else try{T=u(v,p),Pg(s,o,T)}catch(he){g0(s,o,he)}}function Pg(s,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){Ug(s,o,p)},function(p){return g0(s,o,p)}):Ug(s,o,u)}function Ug(s,o,u){o.status="fulfilled",o.value=u,Bg(o),s.state=u,o=s.pending,o!==null&&(u=o.next,u===o?s.pending=null:(u=u.next,o.next=u,Lg(s,u)))}function g0(s,o,u){var p=s.pending;if(s.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=u,Bg(o),o=o.next;while(o!==p)}s.action=null}function Bg(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function jg(s,o){return o}function Vg(s,o){if(Vt){var u=Zt.formState;if(u!==null){e:{var p=gt;if(Vt){if(hn){t:{for(var v=hn,T=Ca;v.nodeType!==8;){if(!T){v=null;break t}if(v=da(v.nextSibling),v===null){v=null;break t}}T=v.data,v=T==="F!"||T==="F"?v:null}if(v){hn=da(v.nextSibling),p=v.data==="F!";break e}}ui(p)}p=!1}p&&(o=u[0])}}return u=Tr(),u.memoizedState=u.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jg,lastRenderedState:o},u.queue=p,u=ix.bind(null,gt,p),p.dispatch=u,p=p0(!1),T=T0.bind(null,gt,!1,p.queue),p=Tr(),v={state:o,dispatch:null,action:s,pending:null},p.queue=v,u=DS.bind(null,gt,v,T,u),v.dispatch=u,p.memoizedState=s,[o,u,!1]}function Hg(s){var o=Sn();return Gg(o,Yt,s)}function Gg(s,o,u){if(o=h0(s,o,jg)[0],s=Mu(Wa)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=Ll(o)}catch(A){throw A===Rl?bu:A}else p=o;o=Sn();var v=o.queue,T=v.dispatch;return u!==o.memoizedState&&(gt.flags|=2048,co(9,Iu(),MS.bind(null,v,u),null)),[p,T,s]}function MS(s,o){s.action=o}function $g(s){var o=Sn(),u=Yt;if(u!==null)return Gg(o,u,s);Sn(),o=o.memoizedState,u=Sn();var p=u.queue.dispatch;return u.memoizedState=s,[o,p,!1]}function co(s,o,u,p){return s={tag:s,create:u,deps:p,inst:o,next:null},o=gt.updateQueue,o===null&&(o=f0(),gt.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=s.next=s:(p=u.next,u.next=s,s.next=p,o.lastEffect=s),s}function Iu(){return{destroy:void 0,resource:void 0}}function zg(){return Sn().memoizedState}function Fu(s,o,u,p){var v=Tr();p=p===void 0?null:p,gt.flags|=s,v.memoizedState=co(1|o,Iu(),u,p)}function Pl(s,o,u,p){var v=Sn();p=p===void 0?null:p;var T=v.memoizedState.inst;Yt!==null&&p!==null&&i0(p,Yt.memoizedState.deps)?v.memoizedState=co(o,T,u,p):(gt.flags|=s,v.memoizedState=co(1|o,T,u,p))}function qg(s,o){Fu(8390656,8,s,o)}function Yg(s,o){Pl(2048,8,s,o)}function Wg(s,o){return Pl(4,2,s,o)}function Jg(s,o){return Pl(4,4,s,o)}function Kg(s,o){if(typeof o=="function"){s=s();var u=o(s);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function Xg(s,o,u){u=u!=null?u.concat([s]):null,Pl(4,4,Kg.bind(null,o,s),u)}function x0(){}function Zg(s,o){var u=Sn();o=o===void 0?null:o;var p=u.memoizedState;return o!==null&&i0(o,p[1])?p[0]:(u.memoizedState=[s,o],s)}function Qg(s,o){var u=Sn();o=o===void 0?null:o;var p=u.memoizedState;if(o!==null&&i0(o,p[1]))return p[0];if(p=s(),mi){De(!0);try{s()}finally{De(!1)}}return u.memoizedState=[p,o],p}function v0(s,o,u){return u===void 0||(Ts&1073741824)!==0?s.memoizedState=o:(s.memoizedState=u,s=nv(),gt.lanes|=s,ks|=s,u)}function ex(s,o,u,p){return Rr(u,o)?u:io.current!==null?(s=v0(s,u,p),Rr(s,o)||(Ln=!0),s):(Ts&42)===0?(Ln=!0,s.memoizedState=u):(s=nv(),gt.lanes|=s,ks|=s,o)}function tx(s,o,u,p,v){var T=ue.p;ue.p=T!==0&&8>T?T:8;var A=ae.T,I={};ae.T=I,T0(s,!1,o,u);try{var ee=v(),he=ae.S;if(he!==null&&he(I,ee),ee!==null&&typeof ee=="object"&&typeof ee.then=="function"){var Se=kS(ee,p);Ul(s,o,Se,Or(s))}else Ul(s,o,p,Or(s))}catch(ke){Ul(s,o,{then:function(){},status:"rejected",reason:ke},Or())}finally{ue.p=T,ae.T=A}}function IS(){}function y0(s,o,u,p){if(s.tag!==5)throw Error(r(476));var v=nx(s).queue;tx(s,v,o,re,u===null?IS:function(){return rx(s),u(p)})}function nx(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wa,lastRenderedState:re},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wa,lastRenderedState:u},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function rx(s){var o=nx(s).next.queue;Ul(s,o,{},Or())}function _0(){return Xn(nc)}function ax(){return Sn().memoizedState}function sx(){return Sn().memoizedState}function FS(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var u=Or();s=ys(u);var p=_s(o,s,u);p!==null&&(Lr(p,o,u),Ml(p,o,u)),o={cache:Kd()},s.payload=o;return}o=o.return}}function OS(s,o,u){var p=Or();u={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Ou(s)?ox(o,u):(u=jd(s,o,u,p),u!==null&&(Lr(u,s,p),lx(u,o,p)))}function ix(s,o,u){var p=Or();Ul(s,o,u,p)}function Ul(s,o,u,p){var v={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Ou(s))ox(o,v);else{var T=s.alternate;if(s.lanes===0&&(T===null||T.lanes===0)&&(T=o.lastRenderedReducer,T!==null))try{var A=o.lastRenderedState,I=T(A,u);if(v.hasEagerState=!0,v.eagerState=I,Rr(I,A))return vu(s,o,v,0),Zt===null&&xu(),!1}catch{}finally{}if(u=jd(s,o,v,p),u!==null)return Lr(u,s,p),lx(u,o,p),!0}return!1}function T0(s,o,u,p){if(p={lane:2,revertLane:Q0(),action:p,hasEagerState:!1,eagerState:null,next:null},Ou(s)){if(o)throw Error(r(479))}else o=jd(s,u,p,2),o!==null&&Lr(o,s,2)}function Ou(s){var o=s.alternate;return s===gt||o!==null&&o===gt}function ox(s,o){oo=Nu=!0;var u=s.pending;u===null?o.next=o:(o.next=u.next,u.next=o),s.pending=o}function lx(s,o,u){if((u&4194048)!==0){var p=o.lanes;p&=s.pendingLanes,u|=p,o.lanes=u,cr(s,u)}}var Lu={readContext:Xn,use:Du,useCallback:_n,useContext:_n,useEffect:_n,useImperativeHandle:_n,useLayoutEffect:_n,useInsertionEffect:_n,useMemo:_n,useReducer:_n,useRef:_n,useState:_n,useDebugValue:_n,useDeferredValue:_n,useTransition:_n,useSyncExternalStore:_n,useId:_n,useHostTransitionStatus:_n,useFormState:_n,useActionState:_n,useOptimistic:_n,useMemoCache:_n,useCacheRefresh:_n},cx={readContext:Xn,use:Du,useCallback:function(s,o){return Tr().memoizedState=[s,o===void 0?null:o],s},useContext:Xn,useEffect:qg,useImperativeHandle:function(s,o,u){u=u!=null?u.concat([s]):null,Fu(4194308,4,Kg.bind(null,o,s),u)},useLayoutEffect:function(s,o){return Fu(4194308,4,s,o)},useInsertionEffect:function(s,o){Fu(4,2,s,o)},useMemo:function(s,o){var u=Tr();o=o===void 0?null:o;var p=s();if(mi){De(!0);try{s()}finally{De(!1)}}return u.memoizedState=[p,o],p},useReducer:function(s,o,u){var p=Tr();if(u!==void 0){var v=u(o);if(mi){De(!0);try{u(o)}finally{De(!1)}}}else v=o;return p.memoizedState=p.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},p.queue=s,s=s.dispatch=OS.bind(null,gt,s),[p.memoizedState,s]},useRef:function(s){var o=Tr();return s={current:s},o.memoizedState=s},useState:function(s){s=p0(s);var o=s.queue,u=ix.bind(null,gt,o);return o.dispatch=u,[s.memoizedState,u]},useDebugValue:x0,useDeferredValue:function(s,o){var u=Tr();return v0(u,s,o)},useTransition:function(){var s=p0(!1);return s=tx.bind(null,gt,s.queue,!0,!1),Tr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,u){var p=gt,v=Tr();if(Vt){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),Zt===null)throw Error(r(349));(Rt&124)!==0||Rg(p,o,u)}v.memoizedState=u;var T={value:u,getSnapshot:o};return v.queue=T,qg(Mg.bind(null,p,T,s),[s]),p.flags|=2048,co(9,Iu(),Dg.bind(null,p,T,u,o),null),u},useId:function(){var s=Tr(),o=Zt.identifierPrefix;if(Vt){var u=za,p=$a;u=(p&~(1<<32-Ie(p)-1)).toString(32)+u,o="«"+o+"R"+u,u=Ru++,0<u&&(o+="H"+u.toString(32)),o+="»"}else u=NS++,o="«"+o+"r"+u.toString(32)+"»";return s.memoizedState=o},useHostTransitionStatus:_0,useFormState:Vg,useActionState:Vg,useOptimistic:function(s){var o=Tr();o.memoizedState=o.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=T0.bind(null,gt,!0,u),u.dispatch=o,[s,o]},useMemoCache:d0,useCacheRefresh:function(){return Tr().memoizedState=FS.bind(null,gt)}},ux={readContext:Xn,use:Du,useCallback:Zg,useContext:Xn,useEffect:Yg,useImperativeHandle:Xg,useInsertionEffect:Wg,useLayoutEffect:Jg,useMemo:Qg,useReducer:Mu,useRef:zg,useState:function(){return Mu(Wa)},useDebugValue:x0,useDeferredValue:function(s,o){var u=Sn();return ex(u,Yt.memoizedState,s,o)},useTransition:function(){var s=Mu(Wa)[0],o=Sn().memoizedState;return[typeof s=="boolean"?s:Ll(s),o]},useSyncExternalStore:Ng,useId:ax,useHostTransitionStatus:_0,useFormState:Hg,useActionState:Hg,useOptimistic:function(s,o){var u=Sn();return Og(u,Yt,s,o)},useMemoCache:d0,useCacheRefresh:sx},LS={readContext:Xn,use:Du,useCallback:Zg,useContext:Xn,useEffect:Yg,useImperativeHandle:Xg,useInsertionEffect:Wg,useLayoutEffect:Jg,useMemo:Qg,useReducer:m0,useRef:zg,useState:function(){return m0(Wa)},useDebugValue:x0,useDeferredValue:function(s,o){var u=Sn();return Yt===null?v0(u,s,o):ex(u,Yt.memoizedState,s,o)},useTransition:function(){var s=m0(Wa)[0],o=Sn().memoizedState;return[typeof s=="boolean"?s:Ll(s),o]},useSyncExternalStore:Ng,useId:ax,useHostTransitionStatus:_0,useFormState:$g,useActionState:$g,useOptimistic:function(s,o){var u=Sn();return Yt!==null?Og(u,Yt,s,o):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:d0,useCacheRefresh:sx},uo=null,Bl=0;function Pu(s){var o=Bl;return Bl+=1,uo===null&&(uo=[]),Tg(uo,s,o)}function jl(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Uu(s,o){throw o.$$typeof===y?Error(r(525)):(s=Object.prototype.toString.call(o),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function fx(s){var o=s._init;return o(s._payload)}function dx(s){function o(oe,se){if(s){var fe=oe.deletions;fe===null?(oe.deletions=[se],oe.flags|=16):fe.push(se)}}function u(oe,se){if(!s)return null;for(;se!==null;)o(oe,se),se=se.sibling;return null}function p(oe){for(var se=new Map;oe!==null;)oe.key!==null?se.set(oe.key,oe):se.set(oe.index,oe),oe=oe.sibling;return se}function v(oe,se){return oe=Ga(oe,se),oe.index=0,oe.sibling=null,oe}function T(oe,se,fe){return oe.index=fe,s?(fe=oe.alternate,fe!==null?(fe=fe.index,fe<se?(oe.flags|=67108866,se):fe):(oe.flags|=67108866,se)):(oe.flags|=1048576,se)}function A(oe){return s&&oe.alternate===null&&(oe.flags|=67108866),oe}function I(oe,se,fe,be){return se===null||se.tag!==6?(se=Hd(fe,oe.mode,be),se.return=oe,se):(se=v(se,fe),se.return=oe,se)}function ee(oe,se,fe,be){var ze=fe.type;return ze===E?Se(oe,se,fe.props.children,be,fe.key):se!==null&&(se.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===K&&fx(ze)===se.type)?(se=v(se,fe.props),jl(se,fe),se.return=oe,se):(se=_u(fe.type,fe.key,fe.props,null,oe.mode,be),jl(se,fe),se.return=oe,se)}function he(oe,se,fe,be){return se===null||se.tag!==4||se.stateNode.containerInfo!==fe.containerInfo||se.stateNode.implementation!==fe.implementation?(se=Gd(fe,oe.mode,be),se.return=oe,se):(se=v(se,fe.children||[]),se.return=oe,se)}function Se(oe,se,fe,be,ze){return se===null||se.tag!==7?(se=ii(fe,oe.mode,be,ze),se.return=oe,se):(se=v(se,fe),se.return=oe,se)}function ke(oe,se,fe){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=Hd(""+se,oe.mode,fe),se.return=oe,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case _:return fe=_u(se.type,se.key,se.props,null,oe.mode,fe),jl(fe,se),fe.return=oe,fe;case w:return se=Gd(se,oe.mode,fe),se.return=oe,se;case K:var be=se._init;return se=be(se._payload),ke(oe,se,fe)}if(Te(se)||te(se))return se=ii(se,oe.mode,fe,null),se.return=oe,se;if(typeof se.then=="function")return ke(oe,Pu(se),fe);if(se.$$typeof===b)return ke(oe,Su(oe,se),fe);Uu(oe,se)}return null}function ge(oe,se,fe,be){var ze=se!==null?se.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return ze!==null?null:I(oe,se,""+fe,be);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case _:return fe.key===ze?ee(oe,se,fe,be):null;case w:return fe.key===ze?he(oe,se,fe,be):null;case K:return ze=fe._init,fe=ze(fe._payload),ge(oe,se,fe,be)}if(Te(fe)||te(fe))return ze!==null?null:Se(oe,se,fe,be,null);if(typeof fe.then=="function")return ge(oe,se,Pu(fe),be);if(fe.$$typeof===b)return ge(oe,se,Su(oe,fe),be);Uu(oe,fe)}return null}function xe(oe,se,fe,be,ze){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return oe=oe.get(fe)||null,I(se,oe,""+be,ze);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case _:return oe=oe.get(be.key===null?fe:be.key)||null,ee(se,oe,be,ze);case w:return oe=oe.get(be.key===null?fe:be.key)||null,he(se,oe,be,ze);case K:var yt=be._init;return be=yt(be._payload),xe(oe,se,fe,be,ze)}if(Te(be)||te(be))return oe=oe.get(fe)||null,Se(se,oe,be,ze,null);if(typeof be.then=="function")return xe(oe,se,fe,Pu(be),ze);if(be.$$typeof===b)return xe(oe,se,fe,Su(se,be),ze);Uu(se,be)}return null}function nt(oe,se,fe,be){for(var ze=null,yt=null,Je=se,tt=se=0,Un=null;Je!==null&&tt<fe.length;tt++){Je.index>tt?(Un=Je,Je=null):Un=Je.sibling;var Ut=ge(oe,Je,fe[tt],be);if(Ut===null){Je===null&&(Je=Un);break}s&&Je&&Ut.alternate===null&&o(oe,Je),se=T(Ut,se,tt),yt===null?ze=Ut:yt.sibling=Ut,yt=Ut,Je=Un}if(tt===fe.length)return u(oe,Je),Vt&&li(oe,tt),ze;if(Je===null){for(;tt<fe.length;tt++)Je=ke(oe,fe[tt],be),Je!==null&&(se=T(Je,se,tt),yt===null?ze=Je:yt.sibling=Je,yt=Je);return Vt&&li(oe,tt),ze}for(Je=p(Je);tt<fe.length;tt++)Un=xe(Je,oe,tt,fe[tt],be),Un!==null&&(s&&Un.alternate!==null&&Je.delete(Un.key===null?tt:Un.key),se=T(Un,se,tt),yt===null?ze=Un:yt.sibling=Un,yt=Un);return s&&Je.forEach(function(Ps){return o(oe,Ps)}),Vt&&li(oe,tt),ze}function Qe(oe,se,fe,be){if(fe==null)throw Error(r(151));for(var ze=null,yt=null,Je=se,tt=se=0,Un=null,Ut=fe.next();Je!==null&&!Ut.done;tt++,Ut=fe.next()){Je.index>tt?(Un=Je,Je=null):Un=Je.sibling;var Ps=ge(oe,Je,Ut.value,be);if(Ps===null){Je===null&&(Je=Un);break}s&&Je&&Ps.alternate===null&&o(oe,Je),se=T(Ps,se,tt),yt===null?ze=Ps:yt.sibling=Ps,yt=Ps,Je=Un}if(Ut.done)return u(oe,Je),Vt&&li(oe,tt),ze;if(Je===null){for(;!Ut.done;tt++,Ut=fe.next())Ut=ke(oe,Ut.value,be),Ut!==null&&(se=T(Ut,se,tt),yt===null?ze=Ut:yt.sibling=Ut,yt=Ut);return Vt&&li(oe,tt),ze}for(Je=p(Je);!Ut.done;tt++,Ut=fe.next())Ut=xe(Je,oe,tt,Ut.value,be),Ut!==null&&(s&&Ut.alternate!==null&&Je.delete(Ut.key===null?tt:Ut.key),se=T(Ut,se,tt),yt===null?ze=Ut:yt.sibling=Ut,yt=Ut);return s&&Je.forEach(function(PC){return o(oe,PC)}),Vt&&li(oe,tt),ze}function Jt(oe,se,fe,be){if(typeof fe=="object"&&fe!==null&&fe.type===E&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case _:e:{for(var ze=fe.key;se!==null;){if(se.key===ze){if(ze=fe.type,ze===E){if(se.tag===7){u(oe,se.sibling),be=v(se,fe.props.children),be.return=oe,oe=be;break e}}else if(se.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===K&&fx(ze)===se.type){u(oe,se.sibling),be=v(se,fe.props),jl(be,fe),be.return=oe,oe=be;break e}u(oe,se);break}else o(oe,se);se=se.sibling}fe.type===E?(be=ii(fe.props.children,oe.mode,be,fe.key),be.return=oe,oe=be):(be=_u(fe.type,fe.key,fe.props,null,oe.mode,be),jl(be,fe),be.return=oe,oe=be)}return A(oe);case w:e:{for(ze=fe.key;se!==null;){if(se.key===ze)if(se.tag===4&&se.stateNode.containerInfo===fe.containerInfo&&se.stateNode.implementation===fe.implementation){u(oe,se.sibling),be=v(se,fe.children||[]),be.return=oe,oe=be;break e}else{u(oe,se);break}else o(oe,se);se=se.sibling}be=Gd(fe,oe.mode,be),be.return=oe,oe=be}return A(oe);case K:return ze=fe._init,fe=ze(fe._payload),Jt(oe,se,fe,be)}if(Te(fe))return nt(oe,se,fe,be);if(te(fe)){if(ze=te(fe),typeof ze!="function")throw Error(r(150));return fe=ze.call(fe),Qe(oe,se,fe,be)}if(typeof fe.then=="function")return Jt(oe,se,Pu(fe),be);if(fe.$$typeof===b)return Jt(oe,se,Su(oe,fe),be);Uu(oe,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,se!==null&&se.tag===6?(u(oe,se.sibling),be=v(se,fe),be.return=oe,oe=be):(u(oe,se),be=Hd(fe,oe.mode,be),be.return=oe,oe=be),A(oe)):u(oe,se)}return function(oe,se,fe,be){try{Bl=0;var ze=Jt(oe,se,fe,be);return uo=null,ze}catch(Je){if(Je===Rl||Je===bu)throw Je;var yt=Dr(29,Je,null,oe.mode);return yt.lanes=be,yt.return=oe,yt}finally{}}}var fo=dx(!0),hx=dx(!1),Xr=Z(null),ba=null;function ws(s){var o=s.alternate;V(Mn,Mn.current&1),V(Xr,s),ba===null&&(o===null||io.current!==null||o.memoizedState!==null)&&(ba=s)}function mx(s){if(s.tag===22){if(V(Mn,Mn.current),V(Xr,s),ba===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(ba=s)}}else Es()}function Es(){V(Mn,Mn.current),V(Xr,Xr.current)}function Ja(s){M(Xr),ba===s&&(ba=null),M(Mn)}var Mn=Z(0);function Bu(s){for(var o=s;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||fh(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function w0(s,o,u,p){o=s.memoizedState,u=u(p,o),u=u==null?o:g({},o,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var E0={enqueueSetState:function(s,o,u){s=s._reactInternals;var p=Or(),v=ys(p);v.payload=o,u!=null&&(v.callback=u),o=_s(s,v,p),o!==null&&(Lr(o,s,p),Ml(o,s,p))},enqueueReplaceState:function(s,o,u){s=s._reactInternals;var p=Or(),v=ys(p);v.tag=1,v.payload=o,u!=null&&(v.callback=u),o=_s(s,v,p),o!==null&&(Lr(o,s,p),Ml(o,s,p))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var u=Or(),p=ys(u);p.tag=2,o!=null&&(p.callback=o),o=_s(s,p,u),o!==null&&(Lr(o,s,u),Ml(o,s,u))}};function px(s,o,u,p,v,T,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(p,T,A):o.prototype&&o.prototype.isPureReactComponent?!wl(u,p)||!wl(v,T):!0}function gx(s,o,u,p){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,p),o.state!==s&&E0.enqueueReplaceState(o,o.state,null)}function pi(s,o){var u=o;if("ref"in o){u={};for(var p in o)p!=="ref"&&(u[p]=o[p])}if(s=s.defaultProps){u===o&&(u=g({},u));for(var v in s)u[v]===void 0&&(u[v]=s[v])}return u}var ju=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function xx(s){ju(s)}function vx(s){console.error(s)}function yx(s){ju(s)}function Vu(s,o){try{var u=s.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function _x(s,o,u){try{var p=s.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function S0(s,o,u){return u=ys(u),u.tag=3,u.payload={element:null},u.callback=function(){Vu(s,o)},u}function Tx(s){return s=ys(s),s.tag=3,s}function wx(s,o,u,p){var v=u.type.getDerivedStateFromError;if(typeof v=="function"){var T=p.value;s.payload=function(){return v(T)},s.callback=function(){_x(o,u,p)}}var A=u.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(s.callback=function(){_x(o,u,p),typeof v!="function"&&(Ns===null?Ns=new Set([this]):Ns.add(this));var I=p.stack;this.componentDidCatch(p.value,{componentStack:I!==null?I:""})})}function PS(s,o,u,p,v){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=u.alternate,o!==null&&Al(o,u,v,!0),u=Xr.current,u!==null){switch(u.tag){case 13:return ba===null?W0():u.alternate===null&&mn===0&&(mn=3),u.flags&=-257,u.flags|=65536,u.lanes=v,p===Qd?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([p]):o.add(p),K0(s,p,v)),!1;case 22:return u.flags|=65536,p===Qd?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([p]):u.add(p)),K0(s,p,v)),!1}throw Error(r(435,u.tag))}return K0(s,p,v),W0(),!1}if(Vt)return o=Xr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=v,p!==qd&&(s=Error(r(422),{cause:p}),bl(Yr(s,u)))):(p!==qd&&(o=Error(r(423),{cause:p}),bl(Yr(o,u))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,p=Yr(p,u),v=S0(s.stateNode,p,v),n0(s,v),mn!==4&&(mn=2)),!1;var T=Error(r(520),{cause:p});if(T=Yr(T,u),Yl===null?Yl=[T]:Yl.push(T),mn!==4&&(mn=2),o===null)return!0;p=Yr(p,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,s=v&-v,u.lanes|=s,s=S0(u.stateNode,p,s),n0(u,s),!1;case 1:if(o=u.type,T=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Ns===null||!Ns.has(T))))return u.flags|=65536,v&=-v,u.lanes|=v,v=Tx(v),wx(v,s,u,p),n0(u,v),!1}u=u.return}while(u!==null);return!1}var Ex=Error(r(461)),Ln=!1;function zn(s,o,u,p){o.child=s===null?hx(o,null,u,p):fo(o,s.child,u,p)}function Sx(s,o,u,p,v){u=u.render;var T=o.ref;if("ref"in p){var A={};for(var I in p)I!=="ref"&&(A[I]=p[I])}else A=p;return di(o),p=o0(s,o,u,A,T,v),I=l0(),s!==null&&!Ln?(c0(s,o,v),Ka(s,o,v)):(Vt&&I&&$d(o),o.flags|=1,zn(s,o,p,v),o.child)}function Cx(s,o,u,p,v){if(s===null){var T=u.type;return typeof T=="function"&&!Vd(T)&&T.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=T,bx(s,o,T,p,v)):(s=_u(u.type,null,p,o,o.mode,v),s.ref=o.ref,s.return=o,o.child=s)}if(T=s.child,!M0(s,v)){var A=T.memoizedProps;if(u=u.compare,u=u!==null?u:wl,u(A,p)&&s.ref===o.ref)return Ka(s,o,v)}return o.flags|=1,s=Ga(T,p),s.ref=o.ref,s.return=o,o.child=s}function bx(s,o,u,p,v){if(s!==null){var T=s.memoizedProps;if(wl(T,p)&&s.ref===o.ref)if(Ln=!1,o.pendingProps=p=T,M0(s,v))(s.flags&131072)!==0&&(Ln=!0);else return o.lanes=s.lanes,Ka(s,o,v)}return C0(s,o,u,p,v)}function Ax(s,o,u){var p=o.pendingProps,v=p.children,T=s!==null?s.memoizedState:null;if(p.mode==="hidden"){if((o.flags&128)!==0){if(p=T!==null?T.baseLanes|u:u,s!==null){for(v=o.child=s.child,T=0;v!==null;)T=T|v.lanes|v.childLanes,v=v.sibling;o.childLanes=T&~p}else o.childLanes=0,o.child=null;return kx(s,o,p,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&Cu(o,T!==null?T.cachePool:null),T!==null?bg(o,T):a0(),mx(o);else return o.lanes=o.childLanes=536870912,kx(s,o,T!==null?T.baseLanes|u:u,u)}else T!==null?(Cu(o,T.cachePool),bg(o,T),Es(),o.memoizedState=null):(s!==null&&Cu(o,null),a0(),Es());return zn(s,o,v,u),o.child}function kx(s,o,u,p){var v=Zd();return v=v===null?null:{parent:Dn._currentValue,pool:v},o.memoizedState={baseLanes:u,cachePool:v},s!==null&&Cu(o,null),a0(),mx(o),s!==null&&Al(s,o,p,!0),null}function Hu(s,o){var u=o.ref;if(u===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(s===null||s.ref!==u)&&(o.flags|=4194816)}}function C0(s,o,u,p,v){return di(o),u=o0(s,o,u,p,void 0,v),p=l0(),s!==null&&!Ln?(c0(s,o,v),Ka(s,o,v)):(Vt&&p&&$d(o),o.flags|=1,zn(s,o,u,v),o.child)}function Nx(s,o,u,p,v,T){return di(o),o.updateQueue=null,u=kg(o,p,u,v),Ag(s),p=l0(),s!==null&&!Ln?(c0(s,o,T),Ka(s,o,T)):(Vt&&p&&$d(o),o.flags|=1,zn(s,o,u,T),o.child)}function Rx(s,o,u,p,v){if(di(o),o.stateNode===null){var T=to,A=u.contextType;typeof A=="object"&&A!==null&&(T=Xn(A)),T=new u(p,T),o.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=E0,o.stateNode=T,T._reactInternals=o,T=o.stateNode,T.props=p,T.state=o.memoizedState,T.refs={},e0(o),A=u.contextType,T.context=typeof A=="object"&&A!==null?Xn(A):to,T.state=o.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(w0(o,u,A,p),T.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(A=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),A!==T.state&&E0.enqueueReplaceState(T,T.state,null),Fl(o,p,T,v),Il(),T.state=o.memoizedState),typeof T.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(s===null){T=o.stateNode;var I=o.memoizedProps,ee=pi(u,I);T.props=ee;var he=T.context,Se=u.contextType;A=to,typeof Se=="object"&&Se!==null&&(A=Xn(Se));var ke=u.getDerivedStateFromProps;Se=typeof ke=="function"||typeof T.getSnapshotBeforeUpdate=="function",I=o.pendingProps!==I,Se||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(I||he!==A)&&gx(o,T,p,A),vs=!1;var ge=o.memoizedState;T.state=ge,Fl(o,p,T,v),Il(),he=o.memoizedState,I||ge!==he||vs?(typeof ke=="function"&&(w0(o,u,ke,p),he=o.memoizedState),(ee=vs||px(o,u,ee,p,ge,he,A))?(Se||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(o.flags|=4194308)):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=he),T.props=p,T.state=he,T.context=A,p=ee):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{T=o.stateNode,t0(s,o),A=o.memoizedProps,Se=pi(u,A),T.props=Se,ke=o.pendingProps,ge=T.context,he=u.contextType,ee=to,typeof he=="object"&&he!==null&&(ee=Xn(he)),I=u.getDerivedStateFromProps,(he=typeof I=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(A!==ke||ge!==ee)&&gx(o,T,p,ee),vs=!1,ge=o.memoizedState,T.state=ge,Fl(o,p,T,v),Il();var xe=o.memoizedState;A!==ke||ge!==xe||vs||s!==null&&s.dependencies!==null&&Eu(s.dependencies)?(typeof I=="function"&&(w0(o,u,I,p),xe=o.memoizedState),(Se=vs||px(o,u,Se,p,ge,xe,ee)||s!==null&&s.dependencies!==null&&Eu(s.dependencies))?(he||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(p,xe,ee),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(p,xe,ee)),typeof T.componentDidUpdate=="function"&&(o.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof T.componentDidUpdate!="function"||A===s.memoizedProps&&ge===s.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&ge===s.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=xe),T.props=p,T.state=xe,T.context=ee,p=Se):(typeof T.componentDidUpdate!="function"||A===s.memoizedProps&&ge===s.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&ge===s.memoizedState||(o.flags|=1024),p=!1)}return T=p,Hu(s,o),p=(o.flags&128)!==0,T||p?(T=o.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:T.render(),o.flags|=1,s!==null&&p?(o.child=fo(o,s.child,null,v),o.child=fo(o,null,u,v)):zn(s,o,u,v),o.memoizedState=T.state,s=o.child):s=Ka(s,o,v),s}function Dx(s,o,u,p){return Cl(),o.flags|=256,zn(s,o,u,p),o.child}var b0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function A0(s){return{baseLanes:s,cachePool:vg()}}function k0(s,o,u){return s=s!==null?s.childLanes&~u:0,o&&(s|=Zr),s}function Mx(s,o,u){var p=o.pendingProps,v=!1,T=(o.flags&128)!==0,A;if((A=T)||(A=s!==null&&s.memoizedState===null?!1:(Mn.current&2)!==0),A&&(v=!0,o.flags&=-129),A=(o.flags&32)!==0,o.flags&=-33,s===null){if(Vt){if(v?ws(o):Es(),Vt){var I=hn,ee;if(ee=I){e:{for(ee=I,I=Ca;ee.nodeType!==8;){if(!I){I=null;break e}if(ee=da(ee.nextSibling),ee===null){I=null;break e}}I=ee}I!==null?(o.memoizedState={dehydrated:I,treeContext:oi!==null?{id:$a,overflow:za}:null,retryLane:536870912,hydrationErrors:null},ee=Dr(18,null,null,0),ee.stateNode=I,ee.return=o,o.child=ee,ur=o,hn=null,ee=!0):ee=!1}ee||ui(o)}if(I=o.memoizedState,I!==null&&(I=I.dehydrated,I!==null))return fh(I)?o.lanes=32:o.lanes=536870912,null;Ja(o)}return I=p.children,p=p.fallback,v?(Es(),v=o.mode,I=Gu({mode:"hidden",children:I},v),p=ii(p,v,u,null),I.return=o,p.return=o,I.sibling=p,o.child=I,v=o.child,v.memoizedState=A0(u),v.childLanes=k0(s,A,u),o.memoizedState=b0,p):(ws(o),N0(o,I))}if(ee=s.memoizedState,ee!==null&&(I=ee.dehydrated,I!==null)){if(T)o.flags&256?(ws(o),o.flags&=-257,o=R0(s,o,u)):o.memoizedState!==null?(Es(),o.child=s.child,o.flags|=128,o=null):(Es(),v=p.fallback,I=o.mode,p=Gu({mode:"visible",children:p.children},I),v=ii(v,I,u,null),v.flags|=2,p.return=o,v.return=o,p.sibling=v,o.child=p,fo(o,s.child,null,u),p=o.child,p.memoizedState=A0(u),p.childLanes=k0(s,A,u),o.memoizedState=b0,o=v);else if(ws(o),fh(I)){if(A=I.nextSibling&&I.nextSibling.dataset,A)var he=A.dgst;A=he,p=Error(r(419)),p.stack="",p.digest=A,bl({value:p,source:null,stack:null}),o=R0(s,o,u)}else if(Ln||Al(s,o,u,!1),A=(u&s.childLanes)!==0,Ln||A){if(A=Zt,A!==null&&(p=u&-u,p=(p&42)!==0?1:oa(p),p=(p&(A.suspendedLanes|u))!==0?0:p,p!==0&&p!==ee.retryLane))throw ee.retryLane=p,eo(s,p),Lr(A,s,p),Ex;I.data==="$?"||W0(),o=R0(s,o,u)}else I.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=ee.treeContext,hn=da(I.nextSibling),ur=o,Vt=!0,ci=null,Ca=!1,s!==null&&(Jr[Kr++]=$a,Jr[Kr++]=za,Jr[Kr++]=oi,$a=s.id,za=s.overflow,oi=o),o=N0(o,p.children),o.flags|=4096);return o}return v?(Es(),v=p.fallback,I=o.mode,ee=s.child,he=ee.sibling,p=Ga(ee,{mode:"hidden",children:p.children}),p.subtreeFlags=ee.subtreeFlags&65011712,he!==null?v=Ga(he,v):(v=ii(v,I,u,null),v.flags|=2),v.return=o,p.return=o,p.sibling=v,o.child=p,p=v,v=o.child,I=s.child.memoizedState,I===null?I=A0(u):(ee=I.cachePool,ee!==null?(he=Dn._currentValue,ee=ee.parent!==he?{parent:he,pool:he}:ee):ee=vg(),I={baseLanes:I.baseLanes|u,cachePool:ee}),v.memoizedState=I,v.childLanes=k0(s,A,u),o.memoizedState=b0,p):(ws(o),u=s.child,s=u.sibling,u=Ga(u,{mode:"visible",children:p.children}),u.return=o,u.sibling=null,s!==null&&(A=o.deletions,A===null?(o.deletions=[s],o.flags|=16):A.push(s)),o.child=u,o.memoizedState=null,u)}function N0(s,o){return o=Gu({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Gu(s,o){return s=Dr(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function R0(s,o,u){return fo(o,s.child,null,u),s=N0(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function Ix(s,o,u){s.lanes|=o;var p=s.alternate;p!==null&&(p.lanes|=o),Wd(s.return,o,u)}function D0(s,o,u,p,v){var T=s.memoizedState;T===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:v}:(T.isBackwards=o,T.rendering=null,T.renderingStartTime=0,T.last=p,T.tail=u,T.tailMode=v)}function Fx(s,o,u){var p=o.pendingProps,v=p.revealOrder,T=p.tail;if(zn(s,o,p.children,u),p=Mn.current,(p&2)!==0)p=p&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Ix(s,u,o);else if(s.tag===19)Ix(s,u,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}p&=1}switch(V(Mn,p),v){case"forwards":for(u=o.child,v=null;u!==null;)s=u.alternate,s!==null&&Bu(s)===null&&(v=u),u=u.sibling;u=v,u===null?(v=o.child,o.child=null):(v=u.sibling,u.sibling=null),D0(o,!1,v,u,T);break;case"backwards":for(u=null,v=o.child,o.child=null;v!==null;){if(s=v.alternate,s!==null&&Bu(s)===null){o.child=v;break}s=v.sibling,v.sibling=u,u=v,v=s}D0(o,!0,u,null,T);break;case"together":D0(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Ka(s,o,u){if(s!==null&&(o.dependencies=s.dependencies),ks|=o.lanes,(u&o.childLanes)===0)if(s!==null){if(Al(s,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(r(153));if(o.child!==null){for(s=o.child,u=Ga(s,s.pendingProps),o.child=u,u.return=o;s.sibling!==null;)s=s.sibling,u=u.sibling=Ga(s,s.pendingProps),u.return=o;u.sibling=null}return o.child}function M0(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Eu(s)))}function US(s,o,u){switch(o.tag){case 3:Ce(o,o.stateNode.containerInfo),xs(o,Dn,s.memoizedState.cache),Cl();break;case 27:case 5:Ee(o);break;case 4:Ce(o,o.stateNode.containerInfo);break;case 10:xs(o,o.type,o.memoizedProps.value);break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(ws(o),o.flags|=128,null):(u&o.child.childLanes)!==0?Mx(s,o,u):(ws(o),s=Ka(s,o,u),s!==null?s.sibling:null);ws(o);break;case 19:var v=(s.flags&128)!==0;if(p=(u&o.childLanes)!==0,p||(Al(s,o,u,!1),p=(u&o.childLanes)!==0),v){if(p)return Fx(s,o,u);o.flags|=128}if(v=o.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),V(Mn,Mn.current),p)break;return null;case 22:case 23:return o.lanes=0,Ax(s,o,u);case 24:xs(o,Dn,s.memoizedState.cache)}return Ka(s,o,u)}function Ox(s,o,u){if(s!==null)if(s.memoizedProps!==o.pendingProps)Ln=!0;else{if(!M0(s,u)&&(o.flags&128)===0)return Ln=!1,US(s,o,u);Ln=(s.flags&131072)!==0}else Ln=!1,Vt&&(o.flags&1048576)!==0&&fg(o,wu,o.index);switch(o.lanes=0,o.tag){case 16:e:{s=o.pendingProps;var p=o.elementType,v=p._init;if(p=v(p._payload),o.type=p,typeof p=="function")Vd(p)?(s=pi(p,s),o.tag=1,o=Rx(null,o,p,s,u)):(o.tag=0,o=C0(null,o,p,s,u));else{if(p!=null){if(v=p.$$typeof,v===O){o.tag=11,o=Sx(null,o,p,s,u);break e}else if(v===F){o.tag=14,o=Cx(null,o,p,s,u);break e}}throw o=Le(p)||p,Error(r(306,o,""))}}return o;case 0:return C0(s,o,o.type,o.pendingProps,u);case 1:return p=o.type,v=pi(p,o.pendingProps),Rx(s,o,p,v,u);case 3:e:{if(Ce(o,o.stateNode.containerInfo),s===null)throw Error(r(387));p=o.pendingProps;var T=o.memoizedState;v=T.element,t0(s,o),Fl(o,p,null,u);var A=o.memoizedState;if(p=A.cache,xs(o,Dn,p),p!==T.cache&&Jd(o,[Dn],u,!0),Il(),p=A.element,T.isDehydrated)if(T={element:p,isDehydrated:!1,cache:A.cache},o.updateQueue.baseState=T,o.memoizedState=T,o.flags&256){o=Dx(s,o,p,u);break e}else if(p!==v){v=Yr(Error(r(424)),o),bl(v),o=Dx(s,o,p,u);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(hn=da(s.firstChild),ur=o,Vt=!0,ci=null,Ca=!0,u=hx(o,null,p,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Cl(),p===v){o=Ka(s,o,u);break e}zn(s,o,p,u)}o=o.child}return o;case 26:return Hu(s,o),s===null?(u=Bv(o.type,null,o.pendingProps,null))?o.memoizedState=u:Vt||(u=o.type,s=o.pendingProps,p=rf(ie.current).createElement(u),p[Ze]=o,p[bt]=s,Yn(p,u,s),le(p),o.stateNode=p):o.memoizedState=Bv(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Ee(o),s===null&&Vt&&(p=o.stateNode=Lv(o.type,o.pendingProps,ie.current),ur=o,Ca=!0,v=hn,Ms(o.type)?(dh=v,hn=da(p.firstChild)):hn=v),zn(s,o,o.pendingProps.children,u),Hu(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&Vt&&((v=p=hn)&&(p=dC(p,o.type,o.pendingProps,Ca),p!==null?(o.stateNode=p,ur=o,hn=da(p.firstChild),Ca=!1,v=!0):v=!1),v||ui(o)),Ee(o),v=o.type,T=o.pendingProps,A=s!==null?s.memoizedProps:null,p=T.children,lh(v,T)?p=null:A!==null&&lh(v,A)&&(o.flags|=32),o.memoizedState!==null&&(v=o0(s,o,RS,null,null,u),nc._currentValue=v),Hu(s,o),zn(s,o,p,u),o.child;case 6:return s===null&&Vt&&((s=u=hn)&&(u=hC(u,o.pendingProps,Ca),u!==null?(o.stateNode=u,ur=o,hn=null,s=!0):s=!1),s||ui(o)),null;case 13:return Mx(s,o,u);case 4:return Ce(o,o.stateNode.containerInfo),p=o.pendingProps,s===null?o.child=fo(o,null,p,u):zn(s,o,p,u),o.child;case 11:return Sx(s,o,o.type,o.pendingProps,u);case 7:return zn(s,o,o.pendingProps,u),o.child;case 8:return zn(s,o,o.pendingProps.children,u),o.child;case 12:return zn(s,o,o.pendingProps.children,u),o.child;case 10:return p=o.pendingProps,xs(o,o.type,p.value),zn(s,o,p.children,u),o.child;case 9:return v=o.type._context,p=o.pendingProps.children,di(o),v=Xn(v),p=p(v),o.flags|=1,zn(s,o,p,u),o.child;case 14:return Cx(s,o,o.type,o.pendingProps,u);case 15:return bx(s,o,o.type,o.pendingProps,u);case 19:return Fx(s,o,u);case 31:return p=o.pendingProps,u=o.mode,p={mode:p.mode,children:p.children},s===null?(u=Gu(p,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=Ga(s.child,p),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return Ax(s,o,u);case 24:return di(o),p=Xn(Dn),s===null?(v=Zd(),v===null&&(v=Zt,T=Kd(),v.pooledCache=T,T.refCount++,T!==null&&(v.pooledCacheLanes|=u),v=T),o.memoizedState={parent:p,cache:v},e0(o),xs(o,Dn,v)):((s.lanes&u)!==0&&(t0(s,o),Fl(o,null,null,u),Il()),v=s.memoizedState,T=o.memoizedState,v.parent!==p?(v={parent:p,cache:p},o.memoizedState=v,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=v),xs(o,Dn,p)):(p=T.cache,xs(o,Dn,p),p!==v.cache&&Jd(o,[Dn],u,!0))),zn(s,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function Xa(s){s.flags|=4}function Lx(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!$v(o)){if(o=Xr.current,o!==null&&((Rt&4194048)===Rt?ba!==null:(Rt&62914560)!==Rt&&(Rt&536870912)===0||o!==ba))throw Dl=Qd,yg;s.flags|=8192}}function $u(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?Gr():536870912,s.lanes|=o,go|=o)}function Vl(s,o){if(!Vt)switch(s.tailMode){case"hidden":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:p.sibling=null}}function ln(s){var o=s.alternate!==null&&s.alternate.child===s.child,u=0,p=0;if(o)for(var v=s.child;v!==null;)u|=v.lanes|v.childLanes,p|=v.subtreeFlags&65011712,p|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)u|=v.lanes|v.childLanes,p|=v.subtreeFlags,p|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=p,s.childLanes=u,o}function BS(s,o,u){var p=o.pendingProps;switch(zd(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(o),null;case 1:return ln(o),null;case 3:return u=o.stateNode,p=null,s!==null&&(p=s.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),Ya(Dn),Re(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Sl(o)?Xa(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,mg())),ln(o),null;case 26:return u=o.memoizedState,s===null?(Xa(o),u!==null?(ln(o),Lx(o,u)):(ln(o),o.flags&=-16777217)):u?u!==s.memoizedState?(Xa(o),ln(o),Lx(o,u)):(ln(o),o.flags&=-16777217):(s.memoizedProps!==p&&Xa(o),ln(o),o.flags&=-16777217),null;case 27:Ke(o),u=ie.current;var v=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==p&&Xa(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return ln(o),null}s=Y.current,Sl(o)?dg(o):(s=Lv(v,p,u),o.stateNode=s,Xa(o))}return ln(o),null;case 5:if(Ke(o),u=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==p&&Xa(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return ln(o),null}if(s=Y.current,Sl(o))dg(o);else{switch(v=rf(ie.current),s){case 1:s=v.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=v.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=v.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=v.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=v.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof p.is=="string"?v.createElement("select",{is:p.is}):v.createElement("select"),p.multiple?s.multiple=!0:p.size&&(s.size=p.size);break;default:s=typeof p.is=="string"?v.createElement(u,{is:p.is}):v.createElement(u)}}s[Ze]=o,s[bt]=p;e:for(v=o.child;v!==null;){if(v.tag===5||v.tag===6)s.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===o)break e;for(;v.sibling===null;){if(v.return===null||v.return===o)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}o.stateNode=s;e:switch(Yn(s,u,p),u){case"button":case"input":case"select":case"textarea":s=!!p.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Xa(o)}}return ln(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==p&&Xa(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(r(166));if(s=ie.current,Sl(o)){if(s=o.stateNode,u=o.memoizedProps,p=null,v=ur,v!==null)switch(v.tag){case 27:case 5:p=v.memoizedProps}s[Ze]=o,s=!!(s.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||Nv(s.nodeValue,u)),s||ui(o)}else s=rf(s).createTextNode(p),s[Ze]=o,o.stateNode=s}return ln(o),null;case 13:if(p=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=Sl(o),p!==null&&p.dehydrated!==null){if(s===null){if(!v)throw Error(r(318));if(v=o.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(r(317));v[Ze]=o}else Cl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ln(o),v=!1}else v=mg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return o.flags&256?(Ja(o),o):(Ja(o),null)}if(Ja(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=p!==null,s=s!==null&&s.memoizedState!==null,u){p=o.child,v=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(v=p.alternate.memoizedState.cachePool.pool);var T=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(T=p.memoizedState.cachePool.pool),T!==v&&(p.flags|=2048)}return u!==s&&u&&(o.child.flags|=8192),$u(o,o.updateQueue),ln(o),null;case 4:return Re(),s===null&&rh(o.stateNode.containerInfo),ln(o),null;case 10:return Ya(o.type),ln(o),null;case 19:if(M(Mn),v=o.memoizedState,v===null)return ln(o),null;if(p=(o.flags&128)!==0,T=v.rendering,T===null)if(p)Vl(v,!1);else{if(mn!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(T=Bu(s),T!==null){for(o.flags|=128,Vl(v,!1),s=T.updateQueue,o.updateQueue=s,$u(o,s),o.subtreeFlags=0,s=u,u=o.child;u!==null;)ug(u,s),u=u.sibling;return V(Mn,Mn.current&1|2),o.child}s=s.sibling}v.tail!==null&&Me()>Yu&&(o.flags|=128,p=!0,Vl(v,!1),o.lanes=4194304)}else{if(!p)if(s=Bu(T),s!==null){if(o.flags|=128,p=!0,s=s.updateQueue,o.updateQueue=s,$u(o,s),Vl(v,!0),v.tail===null&&v.tailMode==="hidden"&&!T.alternate&&!Vt)return ln(o),null}else 2*Me()-v.renderingStartTime>Yu&&u!==536870912&&(o.flags|=128,p=!0,Vl(v,!1),o.lanes=4194304);v.isBackwards?(T.sibling=o.child,o.child=T):(s=v.last,s!==null?s.sibling=T:o.child=T,v.last=T)}return v.tail!==null?(o=v.tail,v.rendering=o,v.tail=o.sibling,v.renderingStartTime=Me(),o.sibling=null,s=Mn.current,V(Mn,p?s&1|2:s&1),o):(ln(o),null);case 22:case 23:return Ja(o),s0(),p=o.memoizedState!==null,s!==null?s.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(u&536870912)!==0&&(o.flags&128)===0&&(ln(o),o.subtreeFlags&6&&(o.flags|=8192)):ln(o),u=o.updateQueue,u!==null&&$u(o,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==u&&(o.flags|=2048),s!==null&&M(hi),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Ya(Dn),ln(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function jS(s,o){switch(zd(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Ya(Dn),Re(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return Ke(o),null;case 13:if(Ja(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Cl()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return M(Mn),null;case 4:return Re(),null;case 10:return Ya(o.type),null;case 22:case 23:return Ja(o),s0(),s!==null&&M(hi),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return Ya(Dn),null;case 25:return null;default:return null}}function Px(s,o){switch(zd(o),o.tag){case 3:Ya(Dn),Re();break;case 26:case 27:case 5:Ke(o);break;case 4:Re();break;case 13:Ja(o);break;case 19:M(Mn);break;case 10:Ya(o.type);break;case 22:case 23:Ja(o),s0(),s!==null&&M(hi);break;case 24:Ya(Dn)}}function Hl(s,o){try{var u=o.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var v=p.next;u=v;do{if((u.tag&s)===s){p=void 0;var T=u.create,A=u.inst;p=T(),A.destroy=p}u=u.next}while(u!==v)}}catch(I){Kt(o,o.return,I)}}function Ss(s,o,u){try{var p=o.updateQueue,v=p!==null?p.lastEffect:null;if(v!==null){var T=v.next;p=T;do{if((p.tag&s)===s){var A=p.inst,I=A.destroy;if(I!==void 0){A.destroy=void 0,v=o;var ee=u,he=I;try{he()}catch(Se){Kt(v,ee,Se)}}}p=p.next}while(p!==T)}}catch(Se){Kt(o,o.return,Se)}}function Ux(s){var o=s.updateQueue;if(o!==null){var u=s.stateNode;try{Cg(o,u)}catch(p){Kt(s,s.return,p)}}}function Bx(s,o,u){u.props=pi(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(p){Kt(s,o,p)}}function Gl(s,o){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var p=s.stateNode;break;case 30:p=s.stateNode;break;default:p=s.stateNode}typeof u=="function"?s.refCleanup=u(p):u.current=p}}catch(v){Kt(s,o,v)}}function Aa(s,o){var u=s.ref,p=s.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(v){Kt(s,o,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(v){Kt(s,o,v)}else u.current=null}function jx(s){var o=s.type,u=s.memoizedProps,p=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(v){Kt(s,s.return,v)}}function I0(s,o,u){try{var p=s.stateNode;oC(p,s.type,u,o),p[bt]=o}catch(v){Kt(s,s.return,v)}}function Vx(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Ms(s.type)||s.tag===4}function F0(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Vx(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Ms(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function O0(s,o,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(s),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=nf));else if(p!==4&&(p===27&&Ms(s.type)&&(u=s.stateNode,o=null),s=s.child,s!==null))for(O0(s,o,u),s=s.sibling;s!==null;)O0(s,o,u),s=s.sibling}function zu(s,o,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,o?u.insertBefore(s,o):u.appendChild(s);else if(p!==4&&(p===27&&Ms(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(zu(s,o,u),s=s.sibling;s!==null;)zu(s,o,u),s=s.sibling}function Hx(s){var o=s.stateNode,u=s.memoizedProps;try{for(var p=s.type,v=o.attributes;v.length;)o.removeAttributeNode(v[0]);Yn(o,p,u),o[Ze]=s,o[bt]=u}catch(T){Kt(s,s.return,T)}}var Za=!1,Tn=!1,L0=!1,Gx=typeof WeakSet=="function"?WeakSet:Set,Pn=null;function VS(s,o){if(s=s.containerInfo,ih=uf,s=eg(s),Fd(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var v=p.anchorOffset,T=p.focusNode;p=p.focusOffset;try{u.nodeType,T.nodeType}catch{u=null;break e}var A=0,I=-1,ee=-1,he=0,Se=0,ke=s,ge=null;t:for(;;){for(var xe;ke!==u||v!==0&&ke.nodeType!==3||(I=A+v),ke!==T||p!==0&&ke.nodeType!==3||(ee=A+p),ke.nodeType===3&&(A+=ke.nodeValue.length),(xe=ke.firstChild)!==null;)ge=ke,ke=xe;for(;;){if(ke===s)break t;if(ge===u&&++he===v&&(I=A),ge===T&&++Se===p&&(ee=A),(xe=ke.nextSibling)!==null)break;ke=ge,ge=ke.parentNode}ke=xe}u=I===-1||ee===-1?null:{start:I,end:ee}}else u=null}u=u||{start:0,end:0}}else u=null;for(oh={focusedElem:s,selectionRange:u},uf=!1,Pn=o;Pn!==null;)if(o=Pn,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,Pn=s;else for(;Pn!==null;){switch(o=Pn,T=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&T!==null){s=void 0,u=o,v=T.memoizedProps,T=T.memoizedState,p=u.stateNode;try{var nt=pi(u.type,v,u.elementType===u.type);s=p.getSnapshotBeforeUpdate(nt,T),p.__reactInternalSnapshotBeforeUpdate=s}catch(Qe){Kt(u,u.return,Qe)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,u=s.nodeType,u===9)uh(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":uh(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=o.sibling,s!==null){s.return=o.return,Pn=s;break}Pn=o.return}}function $x(s,o,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:Cs(s,u),p&4&&Hl(5,u);break;case 1:if(Cs(s,u),p&4)if(s=u.stateNode,o===null)try{s.componentDidMount()}catch(A){Kt(u,u.return,A)}else{var v=pi(u.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(v,o,s.__reactInternalSnapshotBeforeUpdate)}catch(A){Kt(u,u.return,A)}}p&64&&Ux(u),p&512&&Gl(u,u.return);break;case 3:if(Cs(s,u),p&64&&(s=u.updateQueue,s!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{Cg(s,o)}catch(A){Kt(u,u.return,A)}}break;case 27:o===null&&p&4&&Hx(u);case 26:case 5:Cs(s,u),o===null&&p&4&&jx(u),p&512&&Gl(u,u.return);break;case 12:Cs(s,u);break;case 13:Cs(s,u),p&4&&Yx(s,u),p&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=KS.bind(null,u),mC(s,u))));break;case 22:if(p=u.memoizedState!==null||Za,!p){o=o!==null&&o.memoizedState!==null||Tn,v=Za;var T=Tn;Za=p,(Tn=o)&&!T?bs(s,u,(u.subtreeFlags&8772)!==0):Cs(s,u),Za=v,Tn=T}break;case 30:break;default:Cs(s,u)}}function zx(s){var o=s.alternate;o!==null&&(s.alternate=null,zx(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&B(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var an=null,wr=!1;function Qa(s,o,u){for(u=u.child;u!==null;)qx(s,o,u),u=u.sibling}function qx(s,o,u){if(zt&&typeof zt.onCommitFiberUnmount=="function")try{zt.onCommitFiberUnmount(Xt,u)}catch{}switch(u.tag){case 26:Tn||Aa(u,o),Qa(s,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Tn||Aa(u,o);var p=an,v=wr;Ms(u.type)&&(an=u.stateNode,wr=!1),Qa(s,o,u),Zl(u.stateNode),an=p,wr=v;break;case 5:Tn||Aa(u,o);case 6:if(p=an,v=wr,an=null,Qa(s,o,u),an=p,wr=v,an!==null)if(wr)try{(an.nodeType===9?an.body:an.nodeName==="HTML"?an.ownerDocument.body:an).removeChild(u.stateNode)}catch(T){Kt(u,o,T)}else try{an.removeChild(u.stateNode)}catch(T){Kt(u,o,T)}break;case 18:an!==null&&(wr?(s=an,Fv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),ic(s)):Fv(an,u.stateNode));break;case 4:p=an,v=wr,an=u.stateNode.containerInfo,wr=!0,Qa(s,o,u),an=p,wr=v;break;case 0:case 11:case 14:case 15:Tn||Ss(2,u,o),Tn||Ss(4,u,o),Qa(s,o,u);break;case 1:Tn||(Aa(u,o),p=u.stateNode,typeof p.componentWillUnmount=="function"&&Bx(u,o,p)),Qa(s,o,u);break;case 21:Qa(s,o,u);break;case 22:Tn=(p=Tn)||u.memoizedState!==null,Qa(s,o,u),Tn=p;break;default:Qa(s,o,u)}}function Yx(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{ic(s)}catch(u){Kt(o,o.return,u)}}function HS(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new Gx),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new Gx),o;default:throw Error(r(435,s.tag))}}function P0(s,o){var u=HS(s);o.forEach(function(p){var v=XS.bind(null,s,p);u.has(p)||(u.add(p),p.then(v,v))})}function Mr(s,o){var u=o.deletions;if(u!==null)for(var p=0;p<u.length;p++){var v=u[p],T=s,A=o,I=A;e:for(;I!==null;){switch(I.tag){case 27:if(Ms(I.type)){an=I.stateNode,wr=!1;break e}break;case 5:an=I.stateNode,wr=!1;break e;case 3:case 4:an=I.stateNode.containerInfo,wr=!0;break e}I=I.return}if(an===null)throw Error(r(160));qx(T,A,v),an=null,wr=!1,T=v.alternate,T!==null&&(T.return=null),v.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)Wx(o,s),o=o.sibling}var fa=null;function Wx(s,o){var u=s.alternate,p=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Mr(o,s),Ir(s),p&4&&(Ss(3,s,s.return),Hl(3,s),Ss(5,s,s.return));break;case 1:Mr(o,s),Ir(s),p&512&&(Tn||u===null||Aa(u,u.return)),p&64&&Za&&(s=s.updateQueue,s!==null&&(p=s.callbacks,p!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var v=fa;if(Mr(o,s),Ir(s),p&512&&(Tn||u===null||Aa(u,u.return)),p&4){var T=u!==null?u.memoizedState:null;if(p=s.memoizedState,u===null)if(p===null)if(s.stateNode===null){e:{p=s.type,u=s.memoizedProps,v=v.ownerDocument||v;t:switch(p){case"title":T=v.getElementsByTagName("title")[0],(!T||T[L]||T[Ze]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=v.createElement(p),v.head.insertBefore(T,v.querySelector("head > title"))),Yn(T,p,u),T[Ze]=s,le(T),p=T;break e;case"link":var A=Hv("link","href",v).get(p+(u.href||""));if(A){for(var I=0;I<A.length;I++)if(T=A[I],T.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&T.getAttribute("rel")===(u.rel==null?null:u.rel)&&T.getAttribute("title")===(u.title==null?null:u.title)&&T.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){A.splice(I,1);break t}}T=v.createElement(p),Yn(T,p,u),v.head.appendChild(T);break;case"meta":if(A=Hv("meta","content",v).get(p+(u.content||""))){for(I=0;I<A.length;I++)if(T=A[I],T.getAttribute("content")===(u.content==null?null:""+u.content)&&T.getAttribute("name")===(u.name==null?null:u.name)&&T.getAttribute("property")===(u.property==null?null:u.property)&&T.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&T.getAttribute("charset")===(u.charSet==null?null:u.charSet)){A.splice(I,1);break t}}T=v.createElement(p),Yn(T,p,u),v.head.appendChild(T);break;default:throw Error(r(468,p))}T[Ze]=s,le(T),p=T}s.stateNode=p}else Gv(v,s.type,s.stateNode);else s.stateNode=Vv(v,p,s.memoizedProps);else T!==p?(T===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):T.count--,p===null?Gv(v,s.type,s.stateNode):Vv(v,p,s.memoizedProps)):p===null&&s.stateNode!==null&&I0(s,s.memoizedProps,u.memoizedProps)}break;case 27:Mr(o,s),Ir(s),p&512&&(Tn||u===null||Aa(u,u.return)),u!==null&&p&4&&I0(s,s.memoizedProps,u.memoizedProps);break;case 5:if(Mr(o,s),Ir(s),p&512&&(Tn||u===null||Aa(u,u.return)),s.flags&32){v=s.stateNode;try{Yi(v,"")}catch(xe){Kt(s,s.return,xe)}}p&4&&s.stateNode!=null&&(v=s.memoizedProps,I0(s,v,u!==null?u.memoizedProps:v)),p&1024&&(L0=!0);break;case 6:if(Mr(o,s),Ir(s),p&4){if(s.stateNode===null)throw Error(r(162));p=s.memoizedProps,u=s.stateNode;try{u.nodeValue=p}catch(xe){Kt(s,s.return,xe)}}break;case 3:if(of=null,v=fa,fa=af(o.containerInfo),Mr(o,s),fa=v,Ir(s),p&4&&u!==null&&u.memoizedState.isDehydrated)try{ic(o.containerInfo)}catch(xe){Kt(s,s.return,xe)}L0&&(L0=!1,Jx(s));break;case 4:p=fa,fa=af(s.stateNode.containerInfo),Mr(o,s),Ir(s),fa=p;break;case 12:Mr(o,s),Ir(s);break;case 13:Mr(o,s),Ir(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(G0=Me()),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,P0(s,p)));break;case 22:v=s.memoizedState!==null;var ee=u!==null&&u.memoizedState!==null,he=Za,Se=Tn;if(Za=he||v,Tn=Se||ee,Mr(o,s),Tn=Se,Za=he,Ir(s),p&8192)e:for(o=s.stateNode,o._visibility=v?o._visibility&-2:o._visibility|1,v&&(u===null||ee||Za||Tn||gi(s)),u=null,o=s;;){if(o.tag===5||o.tag===26){if(u===null){ee=u=o;try{if(T=ee.stateNode,v)A=T.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{I=ee.stateNode;var ke=ee.memoizedProps.style,ge=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;I.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(xe){Kt(ee,ee.return,xe)}}}else if(o.tag===6){if(u===null){ee=o;try{ee.stateNode.nodeValue=v?"":ee.memoizedProps}catch(xe){Kt(ee,ee.return,xe)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=s.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,P0(s,u))));break;case 19:Mr(o,s),Ir(s),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,P0(s,p)));break;case 30:break;case 21:break;default:Mr(o,s),Ir(s)}}function Ir(s){var o=s.flags;if(o&2){try{for(var u,p=s.return;p!==null;){if(Vx(p)){u=p;break}p=p.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var v=u.stateNode,T=F0(s);zu(s,T,v);break;case 5:var A=u.stateNode;u.flags&32&&(Yi(A,""),u.flags&=-33);var I=F0(s);zu(s,I,A);break;case 3:case 4:var ee=u.stateNode.containerInfo,he=F0(s);O0(s,he,ee);break;default:throw Error(r(161))}}catch(Se){Kt(s,s.return,Se)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function Jx(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;Jx(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Cs(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)$x(s,o.alternate,o),o=o.sibling}function gi(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Ss(4,o,o.return),gi(o);break;case 1:Aa(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&Bx(o,o.return,u),gi(o);break;case 27:Zl(o.stateNode);case 26:case 5:Aa(o,o.return),gi(o);break;case 22:o.memoizedState===null&&gi(o);break;case 30:gi(o);break;default:gi(o)}s=s.sibling}}function bs(s,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,v=s,T=o,A=T.flags;switch(T.tag){case 0:case 11:case 15:bs(v,T,u),Hl(4,T);break;case 1:if(bs(v,T,u),p=T,v=p.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(he){Kt(p,p.return,he)}if(p=T,v=p.updateQueue,v!==null){var I=p.stateNode;try{var ee=v.shared.hiddenCallbacks;if(ee!==null)for(v.shared.hiddenCallbacks=null,v=0;v<ee.length;v++)Sg(ee[v],I)}catch(he){Kt(p,p.return,he)}}u&&A&64&&Ux(T),Gl(T,T.return);break;case 27:Hx(T);case 26:case 5:bs(v,T,u),u&&p===null&&A&4&&jx(T),Gl(T,T.return);break;case 12:bs(v,T,u);break;case 13:bs(v,T,u),u&&A&4&&Yx(v,T);break;case 22:T.memoizedState===null&&bs(v,T,u),Gl(T,T.return);break;case 30:break;default:bs(v,T,u)}o=o.sibling}}function U0(s,o){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&kl(u))}function B0(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&kl(s))}function ka(s,o,u,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Kx(s,o,u,p),o=o.sibling}function Kx(s,o,u,p){var v=o.flags;switch(o.tag){case 0:case 11:case 15:ka(s,o,u,p),v&2048&&Hl(9,o);break;case 1:ka(s,o,u,p);break;case 3:ka(s,o,u,p),v&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&kl(s)));break;case 12:if(v&2048){ka(s,o,u,p),s=o.stateNode;try{var T=o.memoizedProps,A=T.id,I=T.onPostCommit;typeof I=="function"&&I(A,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ee){Kt(o,o.return,ee)}}else ka(s,o,u,p);break;case 13:ka(s,o,u,p);break;case 23:break;case 22:T=o.stateNode,A=o.alternate,o.memoizedState!==null?T._visibility&2?ka(s,o,u,p):$l(s,o):T._visibility&2?ka(s,o,u,p):(T._visibility|=2,ho(s,o,u,p,(o.subtreeFlags&10256)!==0)),v&2048&&U0(A,o);break;case 24:ka(s,o,u,p),v&2048&&B0(o.alternate,o);break;default:ka(s,o,u,p)}}function ho(s,o,u,p,v){for(v=v&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var T=s,A=o,I=u,ee=p,he=A.flags;switch(A.tag){case 0:case 11:case 15:ho(T,A,I,ee,v),Hl(8,A);break;case 23:break;case 22:var Se=A.stateNode;A.memoizedState!==null?Se._visibility&2?ho(T,A,I,ee,v):$l(T,A):(Se._visibility|=2,ho(T,A,I,ee,v)),v&&he&2048&&U0(A.alternate,A);break;case 24:ho(T,A,I,ee,v),v&&he&2048&&B0(A.alternate,A);break;default:ho(T,A,I,ee,v)}o=o.sibling}}function $l(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=s,p=o,v=p.flags;switch(p.tag){case 22:$l(u,p),v&2048&&U0(p.alternate,p);break;case 24:$l(u,p),v&2048&&B0(p.alternate,p);break;default:$l(u,p)}o=o.sibling}}var zl=8192;function mo(s){if(s.subtreeFlags&zl)for(s=s.child;s!==null;)Xx(s),s=s.sibling}function Xx(s){switch(s.tag){case 26:mo(s),s.flags&zl&&s.memoizedState!==null&&AC(fa,s.memoizedState,s.memoizedProps);break;case 5:mo(s);break;case 3:case 4:var o=fa;fa=af(s.stateNode.containerInfo),mo(s),fa=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=zl,zl=16777216,mo(s),zl=o):mo(s));break;default:mo(s)}}function Zx(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function ql(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Pn=p,ev(p,s)}Zx(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Qx(s),s=s.sibling}function Qx(s){switch(s.tag){case 0:case 11:case 15:ql(s),s.flags&2048&&Ss(9,s,s.return);break;case 3:ql(s);break;case 12:ql(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,qu(s)):ql(s);break;default:ql(s)}}function qu(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Pn=p,ev(p,s)}Zx(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Ss(8,o,o.return),qu(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,qu(o));break;default:qu(o)}s=s.sibling}}function ev(s,o){for(;Pn!==null;){var u=Pn;switch(u.tag){case 0:case 11:case 15:Ss(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:kl(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Pn=p;else e:for(u=s;Pn!==null;){p=Pn;var v=p.sibling,T=p.return;if(zx(p),p===u){Pn=null;break e}if(v!==null){v.return=T,Pn=v;break e}Pn=T}}}var GS={getCacheForType:function(s){var o=Xn(Dn),u=o.data.get(s);return u===void 0&&(u=s(),o.data.set(s,u)),u}},$S=typeof WeakMap=="function"?WeakMap:Map,Ht=0,Zt=null,Tt=null,Rt=0,Gt=0,Fr=null,As=!1,po=!1,j0=!1,es=0,mn=0,ks=0,xi=0,V0=0,Zr=0,go=0,Yl=null,Er=null,H0=!1,G0=0,Yu=1/0,Wu=null,Ns=null,qn=0,Rs=null,xo=null,vo=0,$0=0,z0=null,tv=null,Wl=0,q0=null;function Or(){if((Ht&2)!==0&&Rt!==0)return Rt&-Rt;if(ae.T!==null){var s=ao;return s!==0?s:Q0()}return ms()}function nv(){Zr===0&&(Zr=(Rt&536870912)===0||Vt?Hr():536870912);var s=Xr.current;return s!==null&&(s.flags|=32),Zr}function Lr(s,o,u){(s===Zt&&(Gt===2||Gt===9)||s.cancelPendingCommit!==null)&&(yo(s,0),Ds(s,Rt,Zr,!1)),vt(s,u),((Ht&2)===0||s!==Zt)&&(s===Zt&&((Ht&2)===0&&(xi|=u),mn===4&&Ds(s,Rt,Zr,!1)),Na(s))}function rv(s,o,u){if((Ht&6)!==0)throw Error(r(327));var p=!u&&(o&124)===0&&(o&s.expiredLanes)===0||yr(s,o),v=p?YS(s,o):J0(s,o,!0),T=p;do{if(v===0){po&&!p&&Ds(s,o,0,!1);break}else{if(u=s.current.alternate,T&&!zS(u)){v=J0(s,o,!1),T=!1;continue}if(v===2){if(T=o,s.errorRecoveryDisabledLanes&T)var A=0;else A=s.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){o=A;e:{var I=s;v=Yl;var ee=I.current.memoizedState.isDehydrated;if(ee&&(yo(I,A).flags|=256),A=J0(I,A,!1),A!==2){if(j0&&!ee){I.errorRecoveryDisabledLanes|=T,xi|=T,v=4;break e}T=Er,Er=v,T!==null&&(Er===null?Er=T:Er.push.apply(Er,T))}v=A}if(T=!1,v!==2)continue}}if(v===1){yo(s,0),Ds(s,o,0,!0);break}e:{switch(p=s,T=v,T){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:Ds(p,o,Zr,!As);break e;case 2:Er=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(v=G0+300-Me(),10<v)){if(Ds(p,o,Zr,!As),vr(p,0,!0)!==0)break e;p.timeoutHandle=Mv(av.bind(null,p,u,Er,Wu,H0,o,Zr,xi,go,As,T,2,-0,0),v);break e}av(p,u,Er,Wu,H0,o,Zr,xi,go,As,T,0,-0,0)}}break}while(!0);Na(s)}function av(s,o,u,p,v,T,A,I,ee,he,Se,ke,ge,xe){if(s.timeoutHandle=-1,ke=o.subtreeFlags,(ke&8192||(ke&16785408)===16785408)&&(tc={stylesheets:null,count:0,unsuspend:bC},Xx(o),ke=kC(),ke!==null)){s.cancelPendingCommit=ke(fv.bind(null,s,o,T,u,p,v,A,I,ee,Se,1,ge,xe)),Ds(s,T,A,!he);return}fv(s,o,T,u,p,v,A,I,ee)}function zS(s){for(var o=s;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var v=u[p],T=v.getSnapshot;v=v.value;try{if(!Rr(T(),v))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ds(s,o,u,p){o&=~V0,o&=~xi,s.suspendedLanes|=o,s.pingedLanes&=~o,p&&(s.warmLanes|=o),p=s.expirationTimes;for(var v=o;0<v;){var T=31-Ie(v),A=1<<T;p[T]=-1,v&=~A}u!==0&&$n(s,u,o)}function Ju(){return(Ht&6)===0?(Jl(0),!1):!0}function Y0(){if(Tt!==null){if(Gt===0)var s=Tt.return;else s=Tt,qa=fi=null,u0(s),uo=null,Bl=0,s=Tt;for(;s!==null;)Px(s.alternate,s),s=s.return;Tt=null}}function yo(s,o){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,cC(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),Y0(),Zt=s,Tt=u=Ga(s.current,null),Rt=o,Gt=0,Fr=null,As=!1,po=yr(s,o),j0=!1,go=Zr=V0=xi=ks=mn=0,Er=Yl=null,H0=!1,(o&8)!==0&&(o|=o&32);var p=s.entangledLanes;if(p!==0)for(s=s.entanglements,p&=o;0<p;){var v=31-Ie(p),T=1<<v;o|=s[v],p&=~T}return es=o,xu(),u}function sv(s,o){gt=null,ae.H=Lu,o===Rl||o===bu?(o=wg(),Gt=3):o===yg?(o=wg(),Gt=4):Gt=o===Ex?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Fr=o,Tt===null&&(mn=1,Vu(s,Yr(o,s.current)))}function iv(){var s=ae.H;return ae.H=Lu,s===null?Lu:s}function ov(){var s=ae.A;return ae.A=GS,s}function W0(){mn=4,As||(Rt&4194048)!==Rt&&Xr.current!==null||(po=!0),(ks&134217727)===0&&(xi&134217727)===0||Zt===null||Ds(Zt,Rt,Zr,!1)}function J0(s,o,u){var p=Ht;Ht|=2;var v=iv(),T=ov();(Zt!==s||Rt!==o)&&(Wu=null,yo(s,o)),o=!1;var A=mn;e:do try{if(Gt!==0&&Tt!==null){var I=Tt,ee=Fr;switch(Gt){case 8:Y0(),A=6;break e;case 3:case 2:case 9:case 6:Xr.current===null&&(o=!0);var he=Gt;if(Gt=0,Fr=null,_o(s,I,ee,he),u&&po){A=0;break e}break;default:he=Gt,Gt=0,Fr=null,_o(s,I,ee,he)}}qS(),A=mn;break}catch(Se){sv(s,Se)}while(!0);return o&&s.shellSuspendCounter++,qa=fi=null,Ht=p,ae.H=v,ae.A=T,Tt===null&&(Zt=null,Rt=0,xu()),A}function qS(){for(;Tt!==null;)lv(Tt)}function YS(s,o){var u=Ht;Ht|=2;var p=iv(),v=ov();Zt!==s||Rt!==o?(Wu=null,Yu=Me()+500,yo(s,o)):po=yr(s,o);e:do try{if(Gt!==0&&Tt!==null){o=Tt;var T=Fr;t:switch(Gt){case 1:Gt=0,Fr=null,_o(s,o,T,1);break;case 2:case 9:if(_g(T)){Gt=0,Fr=null,cv(o);break}o=function(){Gt!==2&&Gt!==9||Zt!==s||(Gt=7),Na(s)},T.then(o,o);break e;case 3:Gt=7;break e;case 4:Gt=5;break e;case 7:_g(T)?(Gt=0,Fr=null,cv(o)):(Gt=0,Fr=null,_o(s,o,T,7));break;case 5:var A=null;switch(Tt.tag){case 26:A=Tt.memoizedState;case 5:case 27:var I=Tt;if(!A||$v(A)){Gt=0,Fr=null;var ee=I.sibling;if(ee!==null)Tt=ee;else{var he=I.return;he!==null?(Tt=he,Ku(he)):Tt=null}break t}}Gt=0,Fr=null,_o(s,o,T,5);break;case 6:Gt=0,Fr=null,_o(s,o,T,6);break;case 8:Y0(),mn=6;break e;default:throw Error(r(462))}}WS();break}catch(Se){sv(s,Se)}while(!0);return qa=fi=null,ae.H=p,ae.A=v,Ht=u,Tt!==null?0:(Zt=null,Rt=0,xu(),mn)}function WS(){for(;Tt!==null&&!St();)lv(Tt)}function lv(s){var o=Ox(s.alternate,s,es);s.memoizedProps=s.pendingProps,o===null?Ku(s):Tt=o}function cv(s){var o=s,u=o.alternate;switch(o.tag){case 15:case 0:o=Nx(u,o,o.pendingProps,o.type,void 0,Rt);break;case 11:o=Nx(u,o,o.pendingProps,o.type.render,o.ref,Rt);break;case 5:u0(o);default:Px(u,o),o=Tt=ug(o,es),o=Ox(u,o,es)}s.memoizedProps=s.pendingProps,o===null?Ku(s):Tt=o}function _o(s,o,u,p){qa=fi=null,u0(o),uo=null,Bl=0;var v=o.return;try{if(PS(s,v,o,u,Rt)){mn=1,Vu(s,Yr(u,s.current)),Tt=null;return}}catch(T){if(v!==null)throw Tt=v,T;mn=1,Vu(s,Yr(u,s.current)),Tt=null;return}o.flags&32768?(Vt||p===1?s=!0:po||(Rt&536870912)!==0?s=!1:(As=s=!0,(p===2||p===9||p===3||p===6)&&(p=Xr.current,p!==null&&p.tag===13&&(p.flags|=16384))),uv(o,s)):Ku(o)}function Ku(s){var o=s;do{if((o.flags&32768)!==0){uv(o,As);return}s=o.return;var u=BS(o.alternate,o,es);if(u!==null){Tt=u;return}if(o=o.sibling,o!==null){Tt=o;return}Tt=o=s}while(o!==null);mn===0&&(mn=5)}function uv(s,o){do{var u=jS(s.alternate,s);if(u!==null){u.flags&=32767,Tt=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(s=s.sibling,s!==null)){Tt=s;return}Tt=s=u}while(s!==null);mn=6,Tt=null}function fv(s,o,u,p,v,T,A,I,ee){s.cancelPendingCommit=null;do Xu();while(qn!==0);if((Ht&6)!==0)throw Error(r(327));if(o!==null){if(o===s.current)throw Error(r(177));if(T=o.lanes|o.childLanes,T|=Bd,un(s,u,T,A,I,ee),s===Zt&&(Tt=Zt=null,Rt=0),xo=o,Rs=s,vo=u,$0=T,z0=v,tv=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,ZS(on,function(){return gv(),null})):(s.callbackNode=null,s.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=ae.T,ae.T=null,v=ue.p,ue.p=2,A=Ht,Ht|=4;try{VS(s,o,u)}finally{Ht=A,ue.p=v,ae.T=p}}qn=1,dv(),hv(),mv()}}function dv(){if(qn===1){qn=0;var s=Rs,o=xo,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=ae.T,ae.T=null;var p=ue.p;ue.p=2;var v=Ht;Ht|=4;try{Wx(o,s);var T=oh,A=eg(s.containerInfo),I=T.focusedElem,ee=T.selectionRange;if(A!==I&&I&&I.ownerDocument&&Qp(I.ownerDocument.documentElement,I)){if(ee!==null&&Fd(I)){var he=ee.start,Se=ee.end;if(Se===void 0&&(Se=he),"selectionStart"in I)I.selectionStart=he,I.selectionEnd=Math.min(Se,I.value.length);else{var ke=I.ownerDocument||document,ge=ke&&ke.defaultView||window;if(ge.getSelection){var xe=ge.getSelection(),nt=I.textContent.length,Qe=Math.min(ee.start,nt),Jt=ee.end===void 0?Qe:Math.min(ee.end,nt);!xe.extend&&Qe>Jt&&(A=Jt,Jt=Qe,Qe=A);var oe=Zp(I,Qe),se=Zp(I,Jt);if(oe&&se&&(xe.rangeCount!==1||xe.anchorNode!==oe.node||xe.anchorOffset!==oe.offset||xe.focusNode!==se.node||xe.focusOffset!==se.offset)){var fe=ke.createRange();fe.setStart(oe.node,oe.offset),xe.removeAllRanges(),Qe>Jt?(xe.addRange(fe),xe.extend(se.node,se.offset)):(fe.setEnd(se.node,se.offset),xe.addRange(fe))}}}}for(ke=[],xe=I;xe=xe.parentNode;)xe.nodeType===1&&ke.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<ke.length;I++){var be=ke[I];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}uf=!!ih,oh=ih=null}finally{Ht=v,ue.p=p,ae.T=u}}s.current=o,qn=2}}function hv(){if(qn===2){qn=0;var s=Rs,o=xo,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=ae.T,ae.T=null;var p=ue.p;ue.p=2;var v=Ht;Ht|=4;try{$x(s,o.alternate,o)}finally{Ht=v,ue.p=p,ae.T=u}}qn=3}}function mv(){if(qn===4||qn===3){qn=0,st();var s=Rs,o=xo,u=vo,p=tv;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?qn=5:(qn=0,xo=Rs=null,pv(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(Ns=null),la(u),o=o.stateNode,zt&&typeof zt.onCommitFiberRoot=="function")try{zt.onCommitFiberRoot(Xt,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=ae.T,v=ue.p,ue.p=2,ae.T=null;try{for(var T=s.onRecoverableError,A=0;A<p.length;A++){var I=p[A];T(I.value,{componentStack:I.stack})}}finally{ae.T=o,ue.p=v}}(vo&3)!==0&&Xu(),Na(s),v=s.pendingLanes,(u&4194090)!==0&&(v&42)!==0?s===q0?Wl++:(Wl=0,q0=s):Wl=0,Jl(0)}}function pv(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,kl(o)))}function Xu(s){return dv(),hv(),mv(),gv()}function gv(){if(qn!==5)return!1;var s=Rs,o=$0;$0=0;var u=la(vo),p=ae.T,v=ue.p;try{ue.p=32>u?32:u,ae.T=null,u=z0,z0=null;var T=Rs,A=vo;if(qn=0,xo=Rs=null,vo=0,(Ht&6)!==0)throw Error(r(331));var I=Ht;if(Ht|=4,Qx(T.current),Kx(T,T.current,A,u),Ht=I,Jl(0,!1),zt&&typeof zt.onPostCommitFiberRoot=="function")try{zt.onPostCommitFiberRoot(Xt,T)}catch{}return!0}finally{ue.p=v,ae.T=p,pv(s,o)}}function xv(s,o,u){o=Yr(u,o),o=S0(s.stateNode,o,2),s=_s(s,o,2),s!==null&&(vt(s,2),Na(s))}function Kt(s,o,u){if(s.tag===3)xv(s,s,u);else for(;o!==null;){if(o.tag===3){xv(o,s,u);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Ns===null||!Ns.has(p))){s=Yr(u,s),u=Tx(2),p=_s(o,u,2),p!==null&&(wx(u,p,o,s),vt(p,2),Na(p));break}}o=o.return}}function K0(s,o,u){var p=s.pingCache;if(p===null){p=s.pingCache=new $S;var v=new Set;p.set(o,v)}else v=p.get(o),v===void 0&&(v=new Set,p.set(o,v));v.has(u)||(j0=!0,v.add(u),s=JS.bind(null,s,o,u),o.then(s,s))}function JS(s,o,u){var p=s.pingCache;p!==null&&p.delete(o),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Zt===s&&(Rt&u)===u&&(mn===4||mn===3&&(Rt&62914560)===Rt&&300>Me()-G0?(Ht&2)===0&&yo(s,0):V0|=u,go===Rt&&(go=0)),Na(s)}function vv(s,o){o===0&&(o=Gr()),s=eo(s,o),s!==null&&(vt(s,o),Na(s))}function KS(s){var o=s.memoizedState,u=0;o!==null&&(u=o.retryLane),vv(s,u)}function XS(s,o){var u=0;switch(s.tag){case 13:var p=s.stateNode,v=s.memoizedState;v!==null&&(u=v.retryLane);break;case 19:p=s.stateNode;break;case 22:p=s.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(o),vv(s,u)}function ZS(s,o){return xt(s,o)}var Zu=null,To=null,X0=!1,Qu=!1,Z0=!1,vi=0;function Na(s){s!==To&&s.next===null&&(To===null?Zu=To=s:To=To.next=s),Qu=!0,X0||(X0=!0,eC())}function Jl(s,o){if(!Z0&&Qu){Z0=!0;do for(var u=!1,p=Zu;p!==null;){if(s!==0){var v=p.pendingLanes;if(v===0)var T=0;else{var A=p.suspendedLanes,I=p.pingedLanes;T=(1<<31-Ie(42|s)+1)-1,T&=v&~(A&~I),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(u=!0,wv(p,T))}else T=Rt,T=vr(p,p===Zt?T:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(T&3)===0||yr(p,T)||(u=!0,wv(p,T));p=p.next}while(u);Z0=!1}}function QS(){yv()}function yv(){Qu=X0=!1;var s=0;vi!==0&&(lC()&&(s=vi),vi=0);for(var o=Me(),u=null,p=Zu;p!==null;){var v=p.next,T=_v(p,o);T===0?(p.next=null,u===null?Zu=v:u.next=v,v===null&&(To=u)):(u=p,(s!==0||(T&3)!==0)&&(Qu=!0)),p=v}Jl(s)}function _v(s,o){for(var u=s.suspendedLanes,p=s.pingedLanes,v=s.expirationTimes,T=s.pendingLanes&-62914561;0<T;){var A=31-Ie(T),I=1<<A,ee=v[A];ee===-1?((I&u)===0||(I&p)!==0)&&(v[A]=Sa(I,o)):ee<=o&&(s.expiredLanes|=I),T&=~I}if(o=Zt,u=Rt,u=vr(s,s===o?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p=s.callbackNode,u===0||s===o&&(Gt===2||Gt===9)||s.cancelPendingCommit!==null)return p!==null&&p!==null&&et(p),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||yr(s,u)){if(o=u&-u,o===s.callbackPriority)return o;switch(p!==null&&et(p),la(u)){case 2:case 8:u=xn;break;case 32:u=on;break;case 268435456:u=Ct;break;default:u=on}return p=Tv.bind(null,s),u=xt(u,p),s.callbackPriority=o,s.callbackNode=u,o}return p!==null&&p!==null&&et(p),s.callbackPriority=2,s.callbackNode=null,2}function Tv(s,o){if(qn!==0&&qn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(Xu()&&s.callbackNode!==u)return null;var p=Rt;return p=vr(s,s===Zt?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p===0?null:(rv(s,p,o),_v(s,Me()),s.callbackNode!=null&&s.callbackNode===u?Tv.bind(null,s):null)}function wv(s,o){if(Xu())return null;rv(s,o,!0)}function eC(){uC(function(){(Ht&6)!==0?xt(nn,QS):yv()})}function Q0(){return vi===0&&(vi=Hr()),vi}function Ev(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:uu(""+s)}function Sv(s,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,s.id&&u.setAttribute("form",s.id),o.parentNode.insertBefore(u,o),s=new FormData(s),u.parentNode.removeChild(u),s}function tC(s,o,u,p,v){if(o==="submit"&&u&&u.stateNode===v){var T=Ev((v[bt]||null).action),A=p.submitter;A&&(o=(o=A[bt]||null)?Ev(o.formAction):A.getAttribute("formAction"),o!==null&&(T=o,A=null));var I=new mu("action","action",null,p,v);s.push({event:I,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(vi!==0){var ee=A?Sv(v,A):new FormData(v);y0(u,{pending:!0,data:ee,method:v.method,action:T},null,ee)}}else typeof T=="function"&&(I.preventDefault(),ee=A?Sv(v,A):new FormData(v),y0(u,{pending:!0,data:ee,method:v.method,action:T},T,ee))},currentTarget:v}]})}}for(var eh=0;eh<Ud.length;eh++){var th=Ud[eh],nC=th.toLowerCase(),rC=th[0].toUpperCase()+th.slice(1);ua(nC,"on"+rC)}ua(rg,"onAnimationEnd"),ua(ag,"onAnimationIteration"),ua(sg,"onAnimationStart"),ua("dblclick","onDoubleClick"),ua("focusin","onFocus"),ua("focusout","onBlur"),ua(_S,"onTransitionRun"),ua(TS,"onTransitionStart"),ua(wS,"onTransitionCancel"),ua(ig,"onTransitionEnd"),Pe("onMouseEnter",["mouseout","mouseover"]),Pe("onMouseLeave",["mouseout","mouseover"]),Pe("onPointerEnter",["pointerout","pointerover"]),Pe("onPointerLeave",["pointerout","pointerover"]),Ne("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ne("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ne("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ne("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ne("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ne("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kl));function Cv(s,o){o=(o&4)!==0;for(var u=0;u<s.length;u++){var p=s[u],v=p.event;p=p.listeners;e:{var T=void 0;if(o)for(var A=p.length-1;0<=A;A--){var I=p[A],ee=I.instance,he=I.currentTarget;if(I=I.listener,ee!==T&&v.isPropagationStopped())break e;T=I,v.currentTarget=he;try{T(v)}catch(Se){ju(Se)}v.currentTarget=null,T=ee}else for(A=0;A<p.length;A++){if(I=p[A],ee=I.instance,he=I.currentTarget,I=I.listener,ee!==T&&v.isPropagationStopped())break e;T=I,v.currentTarget=he;try{T(v)}catch(Se){ju(Se)}v.currentTarget=null,T=ee}}}}function wt(s,o){var u=o[dt];u===void 0&&(u=o[dt]=new Set);var p=s+"__bubble";u.has(p)||(bv(o,s,2,!1),u.add(p))}function nh(s,o,u){var p=0;o&&(p|=4),bv(u,s,p,o)}var ef="_reactListening"+Math.random().toString(36).slice(2);function rh(s){if(!s[ef]){s[ef]=!0,me.forEach(function(u){u!=="selectionchange"&&(aC.has(u)||nh(u,!1,s),nh(u,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[ef]||(o[ef]=!0,nh("selectionchange",!1,o))}}function bv(s,o,u,p){switch(Kv(o)){case 2:var v=DC;break;case 8:v=MC;break;default:v=xh}u=v.bind(null,o,u,s),v=void 0,!Cd||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(v=!0),p?v!==void 0?s.addEventListener(o,u,{capture:!0,passive:v}):s.addEventListener(o,u,!0):v!==void 0?s.addEventListener(o,u,{passive:v}):s.addEventListener(o,u,!1)}function ah(s,o,u,p,v){var T=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var A=p.tag;if(A===3||A===4){var I=p.stateNode.containerInfo;if(I===v)break;if(A===4)for(A=p.return;A!==null;){var ee=A.tag;if((ee===3||ee===4)&&A.stateNode.containerInfo===v)return;A=A.return}for(;I!==null;){if(A=G(I),A===null)return;if(ee=A.tag,ee===5||ee===6||ee===26||ee===27){p=T=A;continue e}I=I.parentNode}}p=p.return}Ip(function(){var he=T,Se=Ed(u),ke=[];e:{var ge=og.get(s);if(ge!==void 0){var xe=mu,nt=s;switch(s){case"keypress":if(du(u)===0)break e;case"keydown":case"keyup":xe=ZE;break;case"focusin":nt="focus",xe=Nd;break;case"focusout":nt="blur",xe=Nd;break;case"beforeblur":case"afterblur":xe=Nd;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=Lp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=jE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=tS;break;case rg:case ag:case sg:xe=GE;break;case ig:xe=rS;break;case"scroll":case"scrollend":xe=UE;break;case"wheel":xe=sS;break;case"copy":case"cut":case"paste":xe=zE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=Up;break;case"toggle":case"beforetoggle":xe=oS}var Qe=(o&4)!==0,Jt=!Qe&&(s==="scroll"||s==="scrollend"),oe=Qe?ge!==null?ge+"Capture":null:ge;Qe=[];for(var se=he,fe;se!==null;){var be=se;if(fe=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||fe===null||oe===null||(be=pl(se,oe),be!=null&&Qe.push(Xl(se,be,fe))),Jt)break;se=se.return}0<Qe.length&&(ge=new xe(ge,nt,null,u,Se),ke.push({event:ge,listeners:Qe}))}}if((o&7)===0){e:{if(ge=s==="mouseover"||s==="pointerover",xe=s==="mouseout"||s==="pointerout",ge&&u!==wd&&(nt=u.relatedTarget||u.fromElement)&&(G(nt)||nt[yn]))break e;if((xe||ge)&&(ge=Se.window===Se?Se:(ge=Se.ownerDocument)?ge.defaultView||ge.parentWindow:window,xe?(nt=u.relatedTarget||u.toElement,xe=he,nt=nt?G(nt):null,nt!==null&&(Jt=i(nt),Qe=nt.tag,nt!==Jt||Qe!==5&&Qe!==27&&Qe!==6)&&(nt=null)):(xe=null,nt=he),xe!==nt)){if(Qe=Lp,be="onMouseLeave",oe="onMouseEnter",se="mouse",(s==="pointerout"||s==="pointerover")&&(Qe=Up,be="onPointerLeave",oe="onPointerEnter",se="pointer"),Jt=xe==null?ge:de(xe),fe=nt==null?ge:de(nt),ge=new Qe(be,se+"leave",xe,u,Se),ge.target=Jt,ge.relatedTarget=fe,be=null,G(Se)===he&&(Qe=new Qe(oe,se+"enter",nt,u,Se),Qe.target=fe,Qe.relatedTarget=Jt,be=Qe),Jt=be,xe&&nt)t:{for(Qe=xe,oe=nt,se=0,fe=Qe;fe;fe=wo(fe))se++;for(fe=0,be=oe;be;be=wo(be))fe++;for(;0<se-fe;)Qe=wo(Qe),se--;for(;0<fe-se;)oe=wo(oe),fe--;for(;se--;){if(Qe===oe||oe!==null&&Qe===oe.alternate)break t;Qe=wo(Qe),oe=wo(oe)}Qe=null}else Qe=null;xe!==null&&Av(ke,ge,xe,Qe,!1),nt!==null&&Jt!==null&&Av(ke,Jt,nt,Qe,!0)}}e:{if(ge=he?de(he):window,xe=ge.nodeName&&ge.nodeName.toLowerCase(),xe==="select"||xe==="input"&&ge.type==="file")var ze=qp;else if($p(ge))if(Yp)ze=xS;else{ze=pS;var yt=mS}else xe=ge.nodeName,!xe||xe.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?he&&Td(he.elementType)&&(ze=qp):ze=gS;if(ze&&(ze=ze(s,he))){zp(ke,ze,u,Se);break e}yt&&yt(s,ge,he),s==="focusout"&&he&&ge.type==="number"&&he.memoizedProps.value!=null&&ca(ge,"number",ge.value)}switch(yt=he?de(he):window,s){case"focusin":($p(yt)||yt.contentEditable==="true")&&(Xi=yt,Od=he,El=null);break;case"focusout":El=Od=Xi=null;break;case"mousedown":Ld=!0;break;case"contextmenu":case"mouseup":case"dragend":Ld=!1,tg(ke,u,Se);break;case"selectionchange":if(yS)break;case"keydown":case"keyup":tg(ke,u,Se)}var Je;if(Dd)e:{switch(s){case"compositionstart":var tt="onCompositionStart";break e;case"compositionend":tt="onCompositionEnd";break e;case"compositionupdate":tt="onCompositionUpdate";break e}tt=void 0}else Ki?Hp(s,u)&&(tt="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(tt="onCompositionStart");tt&&(Bp&&u.locale!=="ko"&&(Ki||tt!=="onCompositionStart"?tt==="onCompositionEnd"&&Ki&&(Je=Fp()):(gs=Se,bd="value"in gs?gs.value:gs.textContent,Ki=!0)),yt=tf(he,tt),0<yt.length&&(tt=new Pp(tt,s,null,u,Se),ke.push({event:tt,listeners:yt}),Je?tt.data=Je:(Je=Gp(u),Je!==null&&(tt.data=Je)))),(Je=cS?uS(s,u):fS(s,u))&&(tt=tf(he,"onBeforeInput"),0<tt.length&&(yt=new Pp("onBeforeInput","beforeinput",null,u,Se),ke.push({event:yt,listeners:tt}),yt.data=Je)),tC(ke,s,he,u,Se)}Cv(ke,o)})}function Xl(s,o,u){return{instance:s,listener:o,currentTarget:u}}function tf(s,o){for(var u=o+"Capture",p=[];s!==null;){var v=s,T=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||T===null||(v=pl(s,u),v!=null&&p.unshift(Xl(s,v,T)),v=pl(s,o),v!=null&&p.push(Xl(s,v,T))),s.tag===3)return p;s=s.return}return[]}function wo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Av(s,o,u,p,v){for(var T=o._reactName,A=[];u!==null&&u!==p;){var I=u,ee=I.alternate,he=I.stateNode;if(I=I.tag,ee!==null&&ee===p)break;I!==5&&I!==26&&I!==27||he===null||(ee=he,v?(he=pl(u,T),he!=null&&A.unshift(Xl(u,he,ee))):v||(he=pl(u,T),he!=null&&A.push(Xl(u,he,ee)))),u=u.return}A.length!==0&&s.push({event:o,listeners:A})}var sC=/\r\n?/g,iC=/\u0000|\uFFFD/g;function kv(s){return(typeof s=="string"?s:""+s).replace(sC,`
`).replace(iC,"")}function Nv(s,o){return o=kv(o),kv(s)===o}function nf(){}function Wt(s,o,u,p,v,T){switch(u){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||Yi(s,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&Yi(s,""+p);break;case"className":Ve(s,"class",p);break;case"tabIndex":Ve(s,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Ve(s,u,p);break;case"style":Dp(s,p,T);break;case"data":if(o!=="object"){Ve(s,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||u!=="href")){s.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=uu(""+p),s.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(u==="formAction"?(o!=="input"&&Wt(s,o,"name",v.name,v,null),Wt(s,o,"formEncType",v.formEncType,v,null),Wt(s,o,"formMethod",v.formMethod,v,null),Wt(s,o,"formTarget",v.formTarget,v,null)):(Wt(s,o,"encType",v.encType,v,null),Wt(s,o,"method",v.method,v,null),Wt(s,o,"target",v.target,v,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=uu(""+p),s.setAttribute(u,p);break;case"onClick":p!=null&&(s.onclick=nf);break;case"onScroll":p!=null&&wt("scroll",s);break;case"onScrollEnd":p!=null&&wt("scrollend",s);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(v.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"multiple":s.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":s.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){s.removeAttribute("xlink:href");break}u=uu(""+p),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""+p):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":p===!0?s.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,p):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?s.setAttribute(u,p):s.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?s.removeAttribute(u):s.setAttribute(u,p);break;case"popover":wt("beforetoggle",s),wt("toggle",s),Ae(s,"popover",p);break;case"xlinkActuate":$e(s,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":$e(s,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":$e(s,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":$e(s,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":$e(s,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":$e(s,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":$e(s,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":$e(s,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":$e(s,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Ae(s,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=LE.get(u)||u,Ae(s,u,p))}}function sh(s,o,u,p,v,T){switch(u){case"style":Dp(s,p,T);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(v.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"children":typeof p=="string"?Yi(s,p):(typeof p=="number"||typeof p=="bigint")&&Yi(s,""+p);break;case"onScroll":p!=null&&wt("scroll",s);break;case"onScrollEnd":p!=null&&wt("scrollend",s);break;case"onClick":p!=null&&(s.onclick=nf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!pe.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(v=u.endsWith("Capture"),o=u.slice(2,v?u.length-7:void 0),T=s[bt]||null,T=T!=null?T[u]:null,typeof T=="function"&&s.removeEventListener(o,T,v),typeof p=="function")){typeof T!="function"&&T!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(o,p,v);break e}u in s?s[u]=p:p===!0?s.setAttribute(u,""):Ae(s,u,p)}}}function Yn(s,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wt("error",s),wt("load",s);var p=!1,v=!1,T;for(T in u)if(u.hasOwnProperty(T)){var A=u[T];if(A!=null)switch(T){case"src":p=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Wt(s,o,T,A,u,null)}}v&&Wt(s,o,"srcSet",u.srcSet,u,null),p&&Wt(s,o,"src",u.src,u,null);return;case"input":wt("invalid",s);var I=T=A=v=null,ee=null,he=null;for(p in u)if(u.hasOwnProperty(p)){var Se=u[p];if(Se!=null)switch(p){case"name":v=Se;break;case"type":A=Se;break;case"checked":ee=Se;break;case"defaultChecked":he=Se;break;case"value":T=Se;break;case"defaultValue":I=Se;break;case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(r(137,o));break;default:Wt(s,o,p,Se,u,null)}}ni(s,T,I,ee,he,A,v,!1),ps(s);return;case"select":wt("invalid",s),p=A=T=null;for(v in u)if(u.hasOwnProperty(v)&&(I=u[v],I!=null))switch(v){case"value":T=I;break;case"defaultValue":A=I;break;case"multiple":p=I;default:Wt(s,o,v,I,u,null)}o=T,u=A,s.multiple=!!p,o!=null?Nr(s,!!p,o,!1):u!=null&&Nr(s,!!p,u,!0);return;case"textarea":wt("invalid",s),T=v=p=null;for(A in u)if(u.hasOwnProperty(A)&&(I=u[A],I!=null))switch(A){case"value":p=I;break;case"defaultValue":v=I;break;case"children":T=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(r(91));break;default:Wt(s,o,A,I,u,null)}Np(s,p,v,T),ps(s);return;case"option":for(ee in u)if(u.hasOwnProperty(ee)&&(p=u[ee],p!=null))switch(ee){case"selected":s.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Wt(s,o,ee,p,u,null)}return;case"dialog":wt("beforetoggle",s),wt("toggle",s),wt("cancel",s),wt("close",s);break;case"iframe":case"object":wt("load",s);break;case"video":case"audio":for(p=0;p<Kl.length;p++)wt(Kl[p],s);break;case"image":wt("error",s),wt("load",s);break;case"details":wt("toggle",s);break;case"embed":case"source":case"link":wt("error",s),wt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(he in u)if(u.hasOwnProperty(he)&&(p=u[he],p!=null))switch(he){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Wt(s,o,he,p,u,null)}return;default:if(Td(o)){for(Se in u)u.hasOwnProperty(Se)&&(p=u[Se],p!==void 0&&sh(s,o,Se,p,u,void 0));return}}for(I in u)u.hasOwnProperty(I)&&(p=u[I],p!=null&&Wt(s,o,I,p,u,null))}function oC(s,o,u,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,T=null,A=null,I=null,ee=null,he=null,Se=null;for(xe in u){var ke=u[xe];if(u.hasOwnProperty(xe)&&ke!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":ee=ke;default:p.hasOwnProperty(xe)||Wt(s,o,xe,null,p,ke)}}for(var ge in p){var xe=p[ge];if(ke=u[ge],p.hasOwnProperty(ge)&&(xe!=null||ke!=null))switch(ge){case"type":T=xe;break;case"name":v=xe;break;case"checked":he=xe;break;case"defaultChecked":Se=xe;break;case"value":A=xe;break;case"defaultValue":I=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(r(137,o));break;default:xe!==ke&&Wt(s,o,ge,xe,p,ke)}}Rn(s,A,I,ee,he,Se,T,v);return;case"select":xe=A=I=ge=null;for(T in u)if(ee=u[T],u.hasOwnProperty(T)&&ee!=null)switch(T){case"value":break;case"multiple":xe=ee;default:p.hasOwnProperty(T)||Wt(s,o,T,null,p,ee)}for(v in p)if(T=p[v],ee=u[v],p.hasOwnProperty(v)&&(T!=null||ee!=null))switch(v){case"value":ge=T;break;case"defaultValue":I=T;break;case"multiple":A=T;default:T!==ee&&Wt(s,o,v,T,p,ee)}o=I,u=A,p=xe,ge!=null?Nr(s,!!u,ge,!1):!!p!=!!u&&(o!=null?Nr(s,!!u,o,!0):Nr(s,!!u,u?[]:"",!1));return;case"textarea":xe=ge=null;for(I in u)if(v=u[I],u.hasOwnProperty(I)&&v!=null&&!p.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:Wt(s,o,I,null,p,v)}for(A in p)if(v=p[A],T=u[A],p.hasOwnProperty(A)&&(v!=null||T!=null))switch(A){case"value":ge=v;break;case"defaultValue":xe=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(r(91));break;default:v!==T&&Wt(s,o,A,v,p,T)}cu(s,ge,xe);return;case"option":for(var nt in u)if(ge=u[nt],u.hasOwnProperty(nt)&&ge!=null&&!p.hasOwnProperty(nt))switch(nt){case"selected":s.selected=!1;break;default:Wt(s,o,nt,null,p,ge)}for(ee in p)if(ge=p[ee],xe=u[ee],p.hasOwnProperty(ee)&&ge!==xe&&(ge!=null||xe!=null))switch(ee){case"selected":s.selected=ge&&typeof ge!="function"&&typeof ge!="symbol";break;default:Wt(s,o,ee,ge,p,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qe in u)ge=u[Qe],u.hasOwnProperty(Qe)&&ge!=null&&!p.hasOwnProperty(Qe)&&Wt(s,o,Qe,null,p,ge);for(he in p)if(ge=p[he],xe=u[he],p.hasOwnProperty(he)&&ge!==xe&&(ge!=null||xe!=null))switch(he){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,o));break;default:Wt(s,o,he,ge,p,xe)}return;default:if(Td(o)){for(var Jt in u)ge=u[Jt],u.hasOwnProperty(Jt)&&ge!==void 0&&!p.hasOwnProperty(Jt)&&sh(s,o,Jt,void 0,p,ge);for(Se in p)ge=p[Se],xe=u[Se],!p.hasOwnProperty(Se)||ge===xe||ge===void 0&&xe===void 0||sh(s,o,Se,ge,p,xe);return}}for(var oe in u)ge=u[oe],u.hasOwnProperty(oe)&&ge!=null&&!p.hasOwnProperty(oe)&&Wt(s,o,oe,null,p,ge);for(ke in p)ge=p[ke],xe=u[ke],!p.hasOwnProperty(ke)||ge===xe||ge==null&&xe==null||Wt(s,o,ke,ge,p,xe)}var ih=null,oh=null;function rf(s){return s.nodeType===9?s:s.ownerDocument}function Rv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Dv(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function lh(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var ch=null;function lC(){var s=window.event;return s&&s.type==="popstate"?s===ch?!1:(ch=s,!0):(ch=null,!1)}var Mv=typeof setTimeout=="function"?setTimeout:void 0,cC=typeof clearTimeout=="function"?clearTimeout:void 0,Iv=typeof Promise=="function"?Promise:void 0,uC=typeof queueMicrotask=="function"?queueMicrotask:typeof Iv<"u"?function(s){return Iv.resolve(null).then(s).catch(fC)}:Mv;function fC(s){setTimeout(function(){throw s})}function Ms(s){return s==="head"}function Fv(s,o){var u=o,p=0,v=0;do{var T=u.nextSibling;if(s.removeChild(u),T&&T.nodeType===8)if(u=T.data,u==="/$"){if(0<p&&8>p){u=p;var A=s.ownerDocument;if(u&1&&Zl(A.documentElement),u&2&&Zl(A.body),u&4)for(u=A.head,Zl(u),A=u.firstChild;A;){var I=A.nextSibling,ee=A.nodeName;A[L]||ee==="SCRIPT"||ee==="STYLE"||ee==="LINK"&&A.rel.toLowerCase()==="stylesheet"||u.removeChild(A),A=I}}if(v===0){s.removeChild(T),ic(o);return}v--}else u==="$"||u==="$?"||u==="$!"?v++:p=u.charCodeAt(0)-48;else p=0;u=T}while(u);ic(o)}function uh(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":uh(u),B(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function dC(s,o,u,p){for(;s.nodeType===1;){var v=u;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(p){if(!s[L])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(T=s.getAttribute("rel"),T==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(T!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(T=s.getAttribute("src"),(T!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&T&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var T=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===T)return s}else return s;if(s=da(s.nextSibling),s===null)break}return null}function hC(s,o,u){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=da(s.nextSibling),s===null))return null;return s}function fh(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function mC(s,o){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")o();else{var p=function(){o(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),s._reactRetry=p}}function da(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var dh=null;function Ov(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return s;o--}else u==="/$"&&o++}s=s.previousSibling}return null}function Lv(s,o,u){switch(o=rf(u),s){case"html":if(s=o.documentElement,!s)throw Error(r(452));return s;case"head":if(s=o.head,!s)throw Error(r(453));return s;case"body":if(s=o.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Zl(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);B(s)}var Qr=new Map,Pv=new Set;function af(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ts=ue.d;ue.d={f:pC,r:gC,D:xC,C:vC,L:yC,m:_C,X:wC,S:TC,M:EC};function pC(){var s=ts.f(),o=Ju();return s||o}function gC(s){var o=q(s);o!==null&&o.tag===5&&o.type==="form"?rx(o):ts.r(s)}var Eo=typeof document>"u"?null:document;function Uv(s,o,u){var p=Eo;if(p&&typeof o=="string"&&o){var v=_t(o);v='link[rel="'+s+'"][href="'+v+'"]',typeof u=="string"&&(v+='[crossorigin="'+u+'"]'),Pv.has(v)||(Pv.add(v),s={rel:s,crossOrigin:u,href:o},p.querySelector(v)===null&&(o=p.createElement("link"),Yn(o,"link",s),le(o),p.head.appendChild(o)))}}function xC(s){ts.D(s),Uv("dns-prefetch",s,null)}function vC(s,o){ts.C(s,o),Uv("preconnect",s,o)}function yC(s,o,u){ts.L(s,o,u);var p=Eo;if(p&&s&&o){var v='link[rel="preload"][as="'+_t(o)+'"]';o==="image"&&u&&u.imageSrcSet?(v+='[imagesrcset="'+_t(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(v+='[imagesizes="'+_t(u.imageSizes)+'"]')):v+='[href="'+_t(s)+'"]';var T=v;switch(o){case"style":T=So(s);break;case"script":T=Co(s)}Qr.has(T)||(s=g({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:s,as:o},u),Qr.set(T,s),p.querySelector(v)!==null||o==="style"&&p.querySelector(Ql(T))||o==="script"&&p.querySelector(ec(T))||(o=p.createElement("link"),Yn(o,"link",s),le(o),p.head.appendChild(o)))}}function _C(s,o){ts.m(s,o);var u=Eo;if(u&&s){var p=o&&typeof o.as=="string"?o.as:"script",v='link[rel="modulepreload"][as="'+_t(p)+'"][href="'+_t(s)+'"]',T=v;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Co(s)}if(!Qr.has(T)&&(s=g({rel:"modulepreload",href:s},o),Qr.set(T,s),u.querySelector(v)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(ec(T)))return}p=u.createElement("link"),Yn(p,"link",s),le(p),u.head.appendChild(p)}}}function TC(s,o,u){ts.S(s,o,u);var p=Eo;if(p&&s){var v=ve(p).hoistableStyles,T=So(s);o=o||"default";var A=v.get(T);if(!A){var I={loading:0,preload:null};if(A=p.querySelector(Ql(T)))I.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":o},u),(u=Qr.get(T))&&hh(s,u);var ee=A=p.createElement("link");le(ee),Yn(ee,"link",s),ee._p=new Promise(function(he,Se){ee.onload=he,ee.onerror=Se}),ee.addEventListener("load",function(){I.loading|=1}),ee.addEventListener("error",function(){I.loading|=2}),I.loading|=4,sf(A,o,p)}A={type:"stylesheet",instance:A,count:1,state:I},v.set(T,A)}}}function wC(s,o){ts.X(s,o);var u=Eo;if(u&&s){var p=ve(u).hoistableScripts,v=Co(s),T=p.get(v);T||(T=u.querySelector(ec(v)),T||(s=g({src:s,async:!0},o),(o=Qr.get(v))&&mh(s,o),T=u.createElement("script"),le(T),Yn(T,"link",s),u.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},p.set(v,T))}}function EC(s,o){ts.M(s,o);var u=Eo;if(u&&s){var p=ve(u).hoistableScripts,v=Co(s),T=p.get(v);T||(T=u.querySelector(ec(v)),T||(s=g({src:s,async:!0,type:"module"},o),(o=Qr.get(v))&&mh(s,o),T=u.createElement("script"),le(T),Yn(T,"link",s),u.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},p.set(v,T))}}function Bv(s,o,u,p){var v=(v=ie.current)?af(v):null;if(!v)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=So(u.href),u=ve(v).hoistableStyles,p=u.get(o),p||(p={type:"style",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=So(u.href);var T=ve(v).hoistableStyles,A=T.get(s);if(A||(v=v.ownerDocument||v,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(s,A),(T=v.querySelector(Ql(s)))&&!T._p&&(A.instance=T,A.state.loading=5),Qr.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Qr.set(s,u),T||SC(v,s,u,A.state))),o&&p===null)throw Error(r(528,""));return A}if(o&&p!==null)throw Error(r(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Co(u),u=ve(v).hoistableScripts,p=u.get(o),p||(p={type:"script",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function So(s){return'href="'+_t(s)+'"'}function Ql(s){return'link[rel="stylesheet"]['+s+"]"}function jv(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function SC(s,o,u,p){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=s.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),Yn(o,"link",u),le(o),s.head.appendChild(o))}function Co(s){return'[src="'+_t(s)+'"]'}function ec(s){return"script[async]"+s}function Vv(s,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var p=s.querySelector('style[data-href~="'+_t(u.href)+'"]');if(p)return o.instance=p,le(p),p;var v=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(s.ownerDocument||s).createElement("style"),le(p),Yn(p,"style",v),sf(p,u.precedence,s),o.instance=p;case"stylesheet":v=So(u.href);var T=s.querySelector(Ql(v));if(T)return o.state.loading|=4,o.instance=T,le(T),T;p=jv(u),(v=Qr.get(v))&&hh(p,v),T=(s.ownerDocument||s).createElement("link"),le(T);var A=T;return A._p=new Promise(function(I,ee){A.onload=I,A.onerror=ee}),Yn(T,"link",p),o.state.loading|=4,sf(T,u.precedence,s),o.instance=T;case"script":return T=Co(u.src),(v=s.querySelector(ec(T)))?(o.instance=v,le(v),v):(p=u,(v=Qr.get(T))&&(p=g({},u),mh(p,v)),s=s.ownerDocument||s,v=s.createElement("script"),le(v),Yn(v,"link",p),s.head.appendChild(v),o.instance=v);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,sf(p,u.precedence,s));return o.instance}function sf(s,o,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=p.length?p[p.length-1]:null,T=v,A=0;A<p.length;A++){var I=p[A];if(I.dataset.precedence===o)T=I;else if(T!==v)break}T?T.parentNode.insertBefore(s,T.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(s,o.firstChild))}function hh(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function mh(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var of=null;function Hv(s,o,u){if(of===null){var p=new Map,v=of=new Map;v.set(u,p)}else v=of,p=v.get(u),p||(p=new Map,v.set(u,p));if(p.has(s))return p;for(p.set(s,null),u=u.getElementsByTagName(s),v=0;v<u.length;v++){var T=u[v];if(!(T[L]||T[Ze]||s==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var A=T.getAttribute(o)||"";A=s+A;var I=p.get(A);I?I.push(T):p.set(A,[T])}}return p}function Gv(s,o,u){s=s.ownerDocument||s,s.head.insertBefore(u,o==="title"?s.querySelector("head > title"):null)}function CC(s,o,u){if(u===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function $v(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var tc=null;function bC(){}function AC(s,o,u){if(tc===null)throw Error(r(475));var p=tc;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var v=So(u.href),T=s.querySelector(Ql(v));if(T){s=T._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(p.count++,p=lf.bind(p),s.then(p,p)),o.state.loading|=4,o.instance=T,le(T);return}T=s.ownerDocument||s,u=jv(u),(v=Qr.get(v))&&hh(u,v),T=T.createElement("link"),le(T);var A=T;A._p=new Promise(function(I,ee){A.onload=I,A.onerror=ee}),Yn(T,"link",u),o.instance=T}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(p.count++,o=lf.bind(p),s.addEventListener("load",o),s.addEventListener("error",o))}}function kC(){if(tc===null)throw Error(r(475));var s=tc;return s.stylesheets&&s.count===0&&ph(s,s.stylesheets),0<s.count?function(o){var u=setTimeout(function(){if(s.stylesheets&&ph(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u)}}:null}function lf(){if(this.count--,this.count===0){if(this.stylesheets)ph(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var cf=null;function ph(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,cf=new Map,o.forEach(NC,s),cf=null,lf.call(s))}function NC(s,o){if(!(o.state.loading&4)){var u=cf.get(s);if(u)var p=u.get(null);else{u=new Map,cf.set(s,u);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<v.length;T++){var A=v[T];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(u.set(A.dataset.precedence,A),p=A)}p&&u.set(null,p)}v=o.instance,A=v.getAttribute("data-precedence"),T=u.get(A)||p,T===p&&u.set(null,v),u.set(A,v),this.count++,p=lf.bind(this),v.addEventListener("load",p),v.addEventListener("error",p),T?T.parentNode.insertBefore(v,T.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),o.state.loading|=4}}var nc={$$typeof:b,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function RC(s,o,u,p,v,T,A,I){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$r(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$r(0),this.hiddenUpdates=$r(null),this.identifierPrefix=p,this.onUncaughtError=v,this.onCaughtError=T,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=I,this.incompleteTransitions=new Map}function zv(s,o,u,p,v,T,A,I,ee,he,Se,ke){return s=new RC(s,o,u,A,I,ee,he,ke),o=1,T===!0&&(o|=24),T=Dr(3,null,null,o),s.current=T,T.stateNode=s,o=Kd(),o.refCount++,s.pooledCache=o,o.refCount++,T.memoizedState={element:p,isDehydrated:u,cache:o},e0(T),s}function qv(s){return s?(s=to,s):to}function Yv(s,o,u,p,v,T){v=qv(v),p.context===null?p.context=v:p.pendingContext=v,p=ys(o),p.payload={element:u},T=T===void 0?null:T,T!==null&&(p.callback=T),u=_s(s,p,o),u!==null&&(Lr(u,s,o),Ml(u,s,o))}function Wv(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<o?u:o}}function gh(s,o){Wv(s,o),(s=s.alternate)&&Wv(s,o)}function Jv(s){if(s.tag===13){var o=eo(s,67108864);o!==null&&Lr(o,s,67108864),gh(s,67108864)}}var uf=!0;function DC(s,o,u,p){var v=ae.T;ae.T=null;var T=ue.p;try{ue.p=2,xh(s,o,u,p)}finally{ue.p=T,ae.T=v}}function MC(s,o,u,p){var v=ae.T;ae.T=null;var T=ue.p;try{ue.p=8,xh(s,o,u,p)}finally{ue.p=T,ae.T=v}}function xh(s,o,u,p){if(uf){var v=vh(p);if(v===null)ah(s,o,p,ff,u),Xv(s,p);else if(FC(v,s,o,u,p))p.stopPropagation();else if(Xv(s,p),o&4&&-1<IC.indexOf(s)){for(;v!==null;){var T=q(v);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var A=Gn(T.pendingLanes);if(A!==0){var I=T;for(I.pendingLanes|=2,I.entangledLanes|=2;A;){var ee=1<<31-Ie(A);I.entanglements[1]|=ee,A&=~ee}Na(T),(Ht&6)===0&&(Yu=Me()+500,Jl(0))}}break;case 13:I=eo(T,2),I!==null&&Lr(I,T,2),Ju(),gh(T,2)}if(T=vh(p),T===null&&ah(s,o,p,ff,u),T===v)break;v=T}v!==null&&p.stopPropagation()}else ah(s,o,p,null,u)}}function vh(s){return s=Ed(s),yh(s)}var ff=null;function yh(s){if(ff=null,s=G(s),s!==null){var o=i(s);if(o===null)s=null;else{var u=o.tag;if(u===13){if(s=l(o),s!==null)return s;s=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return ff=s,null}function Kv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(jt()){case nn:return 2;case xn:return 8;case on:case lr:return 32;case Ct:return 268435456;default:return 32}default:return 32}}var _h=!1,Is=null,Fs=null,Os=null,rc=new Map,ac=new Map,Ls=[],IC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Xv(s,o){switch(s){case"focusin":case"focusout":Is=null;break;case"dragenter":case"dragleave":Fs=null;break;case"mouseover":case"mouseout":Os=null;break;case"pointerover":case"pointerout":rc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ac.delete(o.pointerId)}}function sc(s,o,u,p,v,T){return s===null||s.nativeEvent!==T?(s={blockedOn:o,domEventName:u,eventSystemFlags:p,nativeEvent:T,targetContainers:[v]},o!==null&&(o=q(o),o!==null&&Jv(o)),s):(s.eventSystemFlags|=p,o=s.targetContainers,v!==null&&o.indexOf(v)===-1&&o.push(v),s)}function FC(s,o,u,p,v){switch(o){case"focusin":return Is=sc(Is,s,o,u,p,v),!0;case"dragenter":return Fs=sc(Fs,s,o,u,p,v),!0;case"mouseover":return Os=sc(Os,s,o,u,p,v),!0;case"pointerover":var T=v.pointerId;return rc.set(T,sc(rc.get(T)||null,s,o,u,p,v)),!0;case"gotpointercapture":return T=v.pointerId,ac.set(T,sc(ac.get(T)||null,s,o,u,p,v)),!0}return!1}function Zv(s){var o=G(s.target);if(o!==null){var u=i(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){s.blockedOn=o,Be(s.priority,function(){if(u.tag===13){var p=Or();p=oa(p);var v=eo(u,p);v!==null&&Lr(v,u,p),gh(u,p)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function df(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var u=vh(s.nativeEvent);if(u===null){u=s.nativeEvent;var p=new u.constructor(u.type,u);wd=p,u.target.dispatchEvent(p),wd=null}else return o=q(u),o!==null&&Jv(o),s.blockedOn=u,!1;o.shift()}return!0}function Qv(s,o,u){df(s)&&u.delete(o)}function OC(){_h=!1,Is!==null&&df(Is)&&(Is=null),Fs!==null&&df(Fs)&&(Fs=null),Os!==null&&df(Os)&&(Os=null),rc.forEach(Qv),ac.forEach(Qv)}function hf(s,o){s.blockedOn===o&&(s.blockedOn=null,_h||(_h=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,OC)))}var mf=null;function e1(s){mf!==s&&(mf=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){mf===s&&(mf=null);for(var o=0;o<s.length;o+=3){var u=s[o],p=s[o+1],v=s[o+2];if(typeof p!="function"){if(yh(p||u)===null)continue;break}var T=q(u);T!==null&&(s.splice(o,3),o-=3,y0(T,{pending:!0,data:v,method:u.method,action:p},p,v))}}))}function ic(s){function o(ee){return hf(ee,s)}Is!==null&&hf(Is,s),Fs!==null&&hf(Fs,s),Os!==null&&hf(Os,s),rc.forEach(o),ac.forEach(o);for(var u=0;u<Ls.length;u++){var p=Ls[u];p.blockedOn===s&&(p.blockedOn=null)}for(;0<Ls.length&&(u=Ls[0],u.blockedOn===null);)Zv(u),u.blockedOn===null&&Ls.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var v=u[p],T=u[p+1],A=v[bt]||null;if(typeof T=="function")A||e1(u);else if(A){var I=null;if(T&&T.hasAttribute("formAction")){if(v=T,A=T[bt]||null)I=A.formAction;else if(yh(v)!==null)continue}else I=A.action;typeof I=="function"?u[p+1]=I:(u.splice(p,3),p-=3),e1(u)}}}function Th(s){this._internalRoot=s}pf.prototype.render=Th.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(r(409));var u=o.current,p=Or();Yv(u,p,s,o,null,null)},pf.prototype.unmount=Th.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;Yv(s.current,2,null,s,null,null),Ju(),o[yn]=null}};function pf(s){this._internalRoot=s}pf.prototype.unstable_scheduleHydration=function(s){if(s){var o=ms();s={blockedOn:null,target:s,priority:o};for(var u=0;u<Ls.length&&o!==0&&o<Ls[u].priority;u++);Ls.splice(u,0,s),u===0&&Zv(s)}};var t1=e.version;if(t1!=="19.1.0")throw Error(r(527,t1,"19.1.0"));ue.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(o),s=s!==null?f(s):null,s=s===null?null:s.stateNode,s};var LC={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ae,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gf.isDisabled&&gf.supportsFiber)try{Xt=gf.inject(LC),zt=gf}catch{}}return lc.createRoot=function(s,o){if(!a(s))throw Error(r(299));var u=!1,p="",v=xx,T=vx,A=yx,I=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(v=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(A=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(I=o.unstable_transitionCallbacks)),o=zv(s,1,!1,null,null,u,p,v,T,A,I,null),s[yn]=o.current,rh(s),new Th(o)},lc.hydrateRoot=function(s,o,u){if(!a(s))throw Error(r(299));var p=!1,v="",T=xx,A=vx,I=yx,ee=null,he=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onUncaughtError!==void 0&&(T=u.onUncaughtError),u.onCaughtError!==void 0&&(A=u.onCaughtError),u.onRecoverableError!==void 0&&(I=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(ee=u.unstable_transitionCallbacks),u.formState!==void 0&&(he=u.formState)),o=zv(s,1,!0,o,u??null,p,v,T,A,I,ee,he),o.context=qv(null),u=o.current,p=Or(),p=oa(p),v=ys(p),v.callback=null,_s(u,v,p),u=p,o.current.lanes=u,vt(o,u),Na(o),s[yn]=o.current,rh(s),new pf(o)},lc.version="19.1.0",lc}var f1;function YC(){if(f1)return Sh.exports;f1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Sh.exports=qC(),Sh.exports}var WC=YC();const JC=Om(WC);var fr=(t=>(t.NOT_STARTED="Not Started",t.IN_PROGRESS="In Progress",t.COMPLETED="Completed",t))(fr||{}),Kh=(t=>(t.PENDING="pending",t.ACHIEVED="achieved",t.MISSED="missed",t))(Kh||{}),Mt=(t=>(t.NOT_STARTED="Not Started",t.IN_PROGRESS="In Progress",t.COMPLETED="Completed",t.BLOCKED="Blocked",t))(Mt||{}),Cr=(t=>(t[t.INPUT_FORM=0]="INPUT_FORM",t[t.PROJECT_FLOW=1]="PROJECT_FLOW",t[t.TASK_DETAIL=2]="TASK_DETAIL",t))(Cr||{}),Bt;(function(t){t.assertEqual=a=>{};function e(a){}t.assertIs=e;function n(a){throw new Error}t.assertNever=n,t.arrayToEnum=a=>{const i={};for(const l of a)i[l]=l;return i},t.getValidEnumValues=a=>{const i=t.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),l={};for(const c of i)l[c]=a[c];return t.objectValues(l)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&i.push(l);return i},t.find=(a,i)=>{for(const l of a)if(i(l))return l},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,i=" | "){return a.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Bt||(Bt={}));var d1;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(d1||(d1={}));const qe=Bt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),js=t=>{switch(typeof t){case"undefined":return qe.undefined;case"string":return qe.string;case"number":return Number.isNaN(t)?qe.nan:qe.number;case"boolean":return qe.boolean;case"function":return qe.function;case"bigint":return qe.bigint;case"symbol":return qe.symbol;case"object":return Array.isArray(t)?qe.array:t===null?qe.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?qe.promise:typeof Map<"u"&&t instanceof Map?qe.map:typeof Set<"u"&&t instanceof Set?qe.set:typeof Date<"u"&&t instanceof Date?qe.date:qe.object;default:return qe.unknown}},Ue=Bt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class cs extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(i){return i.message},r={_errors:[]},a=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(a);else if(l.code==="invalid_return_type")a(l.returnTypeError);else if(l.code==="invalid_arguments")a(l.argumentsError);else if(l.path.length===0)r._errors.push(n(l));else{let c=r,d=0;for(;d<l.path.length;){const f=l.path[d];d===l.path.length-1?(c[f]=c[f]||{_errors:[]},c[f]._errors.push(n(l))):c[f]=c[f]||{_errors:[]},c=c[f],d++}}};return a(this),r}static assert(e){if(!(e instanceof cs))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Bt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const a of this.issues)if(a.path.length>0){const i=a.path[0];n[i]=n[i]||[],n[i].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}cs.create=t=>new cs(t);const Xh=(t,e)=>{let n;switch(t.code){case Ue.invalid_type:t.received===qe.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Ue.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Bt.jsonStringifyReplacer)}`;break;case Ue.unrecognized_keys:n=`Unrecognized key(s) in object: ${Bt.joinValues(t.keys,", ")}`;break;case Ue.invalid_union:n="Invalid input";break;case Ue.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Bt.joinValues(t.options)}`;break;case Ue.invalid_enum_value:n=`Invalid enum value. Expected ${Bt.joinValues(t.options)}, received '${t.received}'`;break;case Ue.invalid_arguments:n="Invalid function arguments";break;case Ue.invalid_return_type:n="Invalid function return type";break;case Ue.invalid_date:n="Invalid date";break;case Ue.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Bt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Ue.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Ue.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Ue.custom:n="Invalid input";break;case Ue.invalid_intersection_types:n="Intersection results could not be merged";break;case Ue.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Ue.not_finite:n="Number must be finite";break;default:n=e.defaultError,Bt.assertNever(t)}return{message:n}};let KC=Xh;function XC(){return KC}const ZC=t=>{const{data:e,path:n,errorMaps:r,issueData:a}=t,i=[...n,...a.path||[]],l={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let c="";const d=r.filter(f=>!!f).slice().reverse();for(const f of d)c=f(l,{data:e,defaultError:c}).message;return{...a,path:i,message:c}};function Ge(t,e){const n=XC(),r=ZC({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Xh?void 0:Xh].filter(a=>!!a)});t.common.issues.push(r)}class gr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const a of n){if(a.status==="aborted")return it;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const a of n){const i=await a.key,l=await a.value;r.push({key:i,value:l})}return gr.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const a of n){const{key:i,value:l}=a;if(i.status==="aborted"||l.status==="aborted")return it;i.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||a.alwaysSet)&&(r[i.value]=l.value)}return{status:e.value,value:r}}}const it=Object.freeze({status:"aborted"}),dc=t=>({status:"dirty",value:t}),sa=t=>({status:"valid",value:t}),h1=t=>t.status==="aborted",m1=t=>t.status==="dirty",Jo=t=>t.status==="valid",Uf=t=>typeof Promise<"u"&&t instanceof Promise;var Ye;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Ye||(Ye={}));class La{constructor(e,n,r,a){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const p1=(t,e)=>{if(Jo(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new cs(t.common.issues);return this._error=n,this._error}}};function pt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:a}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(l,c)=>{const{message:d}=t;return l.code==="invalid_enum_value"?{message:d??c.defaultError}:typeof c.data>"u"?{message:d??r??c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:d??n??c.defaultError}},description:a}}class Nt{get description(){return this._def.description}_getType(e){return js(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:js(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new gr,ctx:{common:e.parent.common,data:e.data,parsedType:js(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Uf(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:js(e)},a=this._parseSync({data:e,path:r.path,parent:r});return p1(r,a)}"~validate"(e){var r,a;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:js(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:n});return Jo(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(a=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(i=>Jo(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:js(e)},a=this._parse({data:e,path:r.path,parent:r}),i=await(Uf(a)?a:Promise.resolve(a));return p1(r,i)}refine(e,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,i)=>{const l=e(a),c=()=>i.addIssue({code:Ue.custom,...r(a)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,n){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(e){return new Zo({schema:this,typeName:at.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return qs.create(this,this._def)}nullable(){return Qo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Oa.create(this)}promise(){return Gf.create(this,this._def)}or(e){return jf.create([this,e],this._def)}and(e){return Vf.create(this,e,this._def)}transform(e){return new Zo({...pt(this._def),schema:this,typeName:at.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new tm({...pt(this._def),innerType:this,defaultValue:n,typeName:at.ZodDefault})}brand(){return new Tb({typeName:at.ZodBranded,type:this,...pt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new nm({...pt(this._def),innerType:this,catchValue:n,typeName:at.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Pm.create(this,e)}readonly(){return rm.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const QC=/^c[^\s-]{8,}$/i,eb=/^[0-9a-z]+$/,tb=/^[0-9A-HJKMNP-TV-Z]{26}$/i,nb=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,rb=/^[a-z0-9_-]{21}$/i,ab=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,sb=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ib=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ob="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let kh;const lb=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,cb=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ub=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,fb=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,db=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,hb=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,LT="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",mb=new RegExp(`^${LT}$`);function PT(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function pb(t){return new RegExp(`^${PT(t)}$`)}function gb(t){let e=`${LT}T${PT(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function xb(t,e){return!!((e==="v4"||!e)&&lb.test(t)||(e==="v6"||!e)&&ub.test(t))}function vb(t,e){if(!ab.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function yb(t,e){return!!((e==="v4"||!e)&&cb.test(t)||(e==="v6"||!e)&&fb.test(t))}class Ia extends Nt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==qe.string){const i=this._getOrReturnCtx(e);return Ge(i,{code:Ue.invalid_type,expected:qe.string,received:i.parsedType}),it}const r=new gr;let a;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),Ge(a,{code:Ue.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),Ge(a,{code:Ue.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const l=e.data.length>i.value,c=e.data.length<i.value;(l||c)&&(a=this._getOrReturnCtx(e,a),l?Ge(a,{code:Ue.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&Ge(a,{code:Ue.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")ib.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"email",code:Ue.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")kh||(kh=new RegExp(ob,"u")),kh.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"emoji",code:Ue.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")nb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"uuid",code:Ue.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")rb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"nanoid",code:Ue.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")QC.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"cuid",code:Ue.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")eb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"cuid2",code:Ue.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")tb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"ulid",code:Ue.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),Ge(a,{validation:"url",code:Ue.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"regex",code:Ue.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Ue.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Ue.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Ue.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?gb(i).test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Ue.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?mb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Ue.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?pb(i).test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{code:Ue.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?sb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"duration",code:Ue.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?xb(e.data,i.version)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"ip",code:Ue.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?vb(e.data,i.alg)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"jwt",code:Ue.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?yb(e.data,i.version)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"cidr",code:Ue.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?db.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"base64",code:Ue.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?hb.test(e.data)||(a=this._getOrReturnCtx(e,a),Ge(a,{validation:"base64url",code:Ue.invalid_string,message:i.message}),r.dirty()):Bt.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(a=>e.test(a),{validation:n,code:Ue.invalid_string,...Ye.errToObj(r)})}_addCheck(e){return new Ia({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Ye.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Ye.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Ye.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Ye.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Ye.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Ye.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Ye.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Ye.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Ye.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Ye.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Ye.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Ye.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Ye.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...Ye.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Ye.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Ye.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Ye.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Ye.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Ye.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Ye.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Ye.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Ye.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Ye.errToObj(n)})}nonempty(e){return this.min(1,Ye.errToObj(e))}trim(){return new Ia({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ia({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ia({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ia.create=t=>new Ia({checks:[],typeName:at.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...pt(t)});function _b(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=n>r?n:r,i=Number.parseInt(t.toFixed(a).replace(".","")),l=Number.parseInt(e.toFixed(a).replace(".",""));return i%l/10**a}class Ai extends Nt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==qe.number){const i=this._getOrReturnCtx(e);return Ge(i,{code:Ue.invalid_type,expected:qe.number,received:i.parsedType}),it}let r;const a=new gr;for(const i of this._def.checks)i.kind==="int"?Bt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{code:Ue.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Ue.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Ue.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?_b(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Ue.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{code:Ue.not_finite,message:i.message}),a.dirty()):Bt.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Ye.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Ye.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Ye.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ye.toString(n))}setLimit(e,n,r,a){return new Ai({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Ye.toString(a)}]})}_addCheck(e){return new Ai({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Ye.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ye.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ye.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ye.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ye.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ye.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Ye.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ye.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ye.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Bt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Ai.create=t=>new Ai({checks:[],typeName:at.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...pt(t)});class ki extends Nt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==qe.bigint)return this._getInvalidInput(e);let r;const a=new gr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Ue.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Ue.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Ue.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Bt.assertNever(i);return{status:a.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return Ge(n,{code:Ue.invalid_type,expected:qe.bigint,received:n.parsedType}),it}gte(e,n){return this.setLimit("min",e,!0,Ye.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Ye.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Ye.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ye.toString(n))}setLimit(e,n,r,a){return new ki({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Ye.toString(a)}]})}_addCheck(e){return new ki({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ye.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ye.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ye.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ye.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ye.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ki.create=t=>new ki({checks:[],typeName:at.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...pt(t)});class Bf extends Nt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==qe.boolean){const r=this._getOrReturnCtx(e);return Ge(r,{code:Ue.invalid_type,expected:qe.boolean,received:r.parsedType}),it}return sa(e.data)}}Bf.create=t=>new Bf({typeName:at.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...pt(t)});class Ko extends Nt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==qe.date){const i=this._getOrReturnCtx(e);return Ge(i,{code:Ue.invalid_type,expected:qe.date,received:i.parsedType}),it}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Ge(i,{code:Ue.invalid_date}),it}const r=new gr;let a;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(a=this._getOrReturnCtx(e,a),Ge(a,{code:Ue.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(a=this._getOrReturnCtx(e,a),Ge(a,{code:Ue.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Bt.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ko({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Ye.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Ye.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Ko.create=t=>new Ko({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:at.ZodDate,...pt(t)});class g1 extends Nt{_parse(e){if(this._getType(e)!==qe.symbol){const r=this._getOrReturnCtx(e);return Ge(r,{code:Ue.invalid_type,expected:qe.symbol,received:r.parsedType}),it}return sa(e.data)}}g1.create=t=>new g1({typeName:at.ZodSymbol,...pt(t)});class x1 extends Nt{_parse(e){if(this._getType(e)!==qe.undefined){const r=this._getOrReturnCtx(e);return Ge(r,{code:Ue.invalid_type,expected:qe.undefined,received:r.parsedType}),it}return sa(e.data)}}x1.create=t=>new x1({typeName:at.ZodUndefined,...pt(t)});class v1 extends Nt{_parse(e){if(this._getType(e)!==qe.null){const r=this._getOrReturnCtx(e);return Ge(r,{code:Ue.invalid_type,expected:qe.null,received:r.parsedType}),it}return sa(e.data)}}v1.create=t=>new v1({typeName:at.ZodNull,...pt(t)});class y1 extends Nt{constructor(){super(...arguments),this._any=!0}_parse(e){return sa(e.data)}}y1.create=t=>new y1({typeName:at.ZodAny,...pt(t)});class Zh extends Nt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return sa(e.data)}}Zh.create=t=>new Zh({typeName:at.ZodUnknown,...pt(t)});class Ks extends Nt{_parse(e){const n=this._getOrReturnCtx(e);return Ge(n,{code:Ue.invalid_type,expected:qe.never,received:n.parsedType}),it}}Ks.create=t=>new Ks({typeName:at.ZodNever,...pt(t)});class _1 extends Nt{_parse(e){if(this._getType(e)!==qe.undefined){const r=this._getOrReturnCtx(e);return Ge(r,{code:Ue.invalid_type,expected:qe.void,received:r.parsedType}),it}return sa(e.data)}}_1.create=t=>new _1({typeName:at.ZodVoid,...pt(t)});class Oa extends Nt{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),a=this._def;if(n.parsedType!==qe.array)return Ge(n,{code:Ue.invalid_type,expected:qe.array,received:n.parsedType}),it;if(a.exactLength!==null){const l=n.data.length>a.exactLength.value,c=n.data.length<a.exactLength.value;(l||c)&&(Ge(n,{code:l?Ue.too_big:Ue.too_small,minimum:c?a.exactLength.value:void 0,maximum:l?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Ge(n,{code:Ue.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Ge(n,{code:Ue.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((l,c)=>a.type._parseAsync(new La(n,l,n.path,c)))).then(l=>gr.mergeArray(r,l));const i=[...n.data].map((l,c)=>a.type._parseSync(new La(n,l,n.path,c)));return gr.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new Oa({...this._def,minLength:{value:e,message:Ye.toString(n)}})}max(e,n){return new Oa({...this._def,maxLength:{value:e,message:Ye.toString(n)}})}length(e,n){return new Oa({...this._def,exactLength:{value:e,message:Ye.toString(n)}})}nonempty(e){return this.min(1,e)}}Oa.create=(t,e)=>new Oa({type:t,minLength:null,maxLength:null,exactLength:null,typeName:at.ZodArray,...pt(e)});function Bo(t){if(t instanceof kn){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=qs.create(Bo(r))}return new kn({...t._def,shape:()=>e})}else return t instanceof Oa?new Oa({...t._def,type:Bo(t.element)}):t instanceof qs?qs.create(Bo(t.unwrap())):t instanceof Qo?Qo.create(Bo(t.unwrap())):t instanceof Ni?Ni.create(t.items.map(e=>Bo(e))):t}class kn extends Nt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Bt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==qe.object){const f=this._getOrReturnCtx(e);return Ge(f,{code:Ue.invalid_type,expected:qe.object,received:f.parsedType}),it}const{status:r,ctx:a}=this._processInputParams(e),{shape:i,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof Ks&&this._def.unknownKeys==="strip"))for(const f in a.data)l.includes(f)||c.push(f);const d=[];for(const f of l){const g=i[f],y=a.data[f];d.push({key:{status:"valid",value:f},value:g._parse(new La(a,y,a.path,f)),alwaysSet:f in a.data})}if(this._def.catchall instanceof Ks){const f=this._def.unknownKeys;if(f==="passthrough")for(const g of c)d.push({key:{status:"valid",value:g},value:{status:"valid",value:a.data[g]}});else if(f==="strict")c.length>0&&(Ge(a,{code:Ue.unrecognized_keys,keys:c}),r.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const g of c){const y=a.data[g];d.push({key:{status:"valid",value:g},value:f._parse(new La(a,y,a.path,g)),alwaysSet:g in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const f=[];for(const g of d){const y=await g.key,_=await g.value;f.push({key:y,value:_,alwaysSet:g.alwaysSet})}return f}).then(f=>gr.mergeObjectSync(r,f)):gr.mergeObjectSync(r,d)}get shape(){return this._def.shape()}strict(e){return Ye.errToObj,new kn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var i,l;const a=((l=(i=this._def).errorMap)==null?void 0:l.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:Ye.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new kn({...this._def,unknownKeys:"strip"})}passthrough(){return new kn({...this._def,unknownKeys:"passthrough"})}extend(e){return new kn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new kn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:at.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new kn({...this._def,catchall:e})}pick(e){const n={};for(const r of Bt.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new kn({...this._def,shape:()=>n})}omit(e){const n={};for(const r of Bt.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new kn({...this._def,shape:()=>n})}deepPartial(){return Bo(this)}partial(e){const n={};for(const r of Bt.objectKeys(this.shape)){const a=this.shape[r];e&&!e[r]?n[r]=a:n[r]=a.optional()}return new kn({...this._def,shape:()=>n})}required(e){const n={};for(const r of Bt.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof qs;)i=i._def.innerType;n[r]=i}return new kn({...this._def,shape:()=>n})}keyof(){return UT(Bt.objectKeys(this.shape))}}kn.create=(t,e)=>new kn({shape:()=>t,unknownKeys:"strip",catchall:Ks.create(),typeName:at.ZodObject,...pt(e)});kn.strictCreate=(t,e)=>new kn({shape:()=>t,unknownKeys:"strict",catchall:Ks.create(),typeName:at.ZodObject,...pt(e)});kn.lazycreate=(t,e)=>new kn({shape:t,unknownKeys:"strip",catchall:Ks.create(),typeName:at.ZodObject,...pt(e)});class jf extends Nt{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function a(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return n.common.issues.push(...c.ctx.common.issues),c.result;const l=i.map(c=>new cs(c.ctx.common.issues));return Ge(n,{code:Ue.invalid_union,unionErrors:l}),it}if(n.common.async)return Promise.all(r.map(async i=>{const l={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:l}),ctx:l}})).then(a);{let i;const l=[];for(const d of r){const f={...n,common:{...n.common,issues:[]},parent:null},g=d._parseSync({data:n.data,path:n.path,parent:f});if(g.status==="valid")return g;g.status==="dirty"&&!i&&(i={result:g,ctx:f}),f.common.issues.length&&l.push(f.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const c=l.map(d=>new cs(d));return Ge(n,{code:Ue.invalid_union,unionErrors:c}),it}}get options(){return this._def.options}}jf.create=(t,e)=>new jf({options:t,typeName:at.ZodUnion,...pt(e)});function Qh(t,e){const n=js(t),r=js(e);if(t===e)return{valid:!0,data:t};if(n===qe.object&&r===qe.object){const a=Bt.objectKeys(e),i=Bt.objectKeys(t).filter(c=>a.indexOf(c)!==-1),l={...t,...e};for(const c of i){const d=Qh(t[c],e[c]);if(!d.valid)return{valid:!1};l[c]=d.data}return{valid:!0,data:l}}else if(n===qe.array&&r===qe.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let i=0;i<t.length;i++){const l=t[i],c=e[i],d=Qh(l,c);if(!d.valid)return{valid:!1};a.push(d.data)}return{valid:!0,data:a}}else return n===qe.date&&r===qe.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Vf extends Nt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=(i,l)=>{if(h1(i)||h1(l))return it;const c=Qh(i.value,l.value);return c.valid?((m1(i)||m1(l))&&n.dirty(),{status:n.value,value:c.data}):(Ge(r,{code:Ue.invalid_intersection_types}),it)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,l])=>a(i,l)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Vf.create=(t,e,n)=>new Vf({left:t,right:e,typeName:at.ZodIntersection,...pt(n)});class Ni extends Nt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==qe.array)return Ge(r,{code:Ue.invalid_type,expected:qe.array,received:r.parsedType}),it;if(r.data.length<this._def.items.length)return Ge(r,{code:Ue.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),it;!this._def.rest&&r.data.length>this._def.items.length&&(Ge(r,{code:Ue.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((l,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new La(r,l,r.path,c)):null}).filter(l=>!!l);return r.common.async?Promise.all(i).then(l=>gr.mergeArray(n,l)):gr.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Ni({...this._def,rest:e})}}Ni.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ni({items:t,typeName:at.ZodTuple,rest:null,...pt(e)})};class Hf extends Nt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==qe.object)return Ge(r,{code:Ue.invalid_type,expected:qe.object,received:r.parsedType}),it;const a=[],i=this._def.keyType,l=this._def.valueType;for(const c in r.data)a.push({key:i._parse(new La(r,c,r.path,c)),value:l._parse(new La(r,r.data[c],r.path,c)),alwaysSet:c in r.data});return r.common.async?gr.mergeObjectAsync(n,a):gr.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof Nt?new Hf({keyType:e,valueType:n,typeName:at.ZodRecord,...pt(r)}):new Hf({keyType:Ia.create(),valueType:e,typeName:at.ZodRecord,...pt(n)})}}class T1 extends Nt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==qe.map)return Ge(r,{code:Ue.invalid_type,expected:qe.map,received:r.parsedType}),it;const a=this._def.keyType,i=this._def.valueType,l=[...r.data.entries()].map(([c,d],f)=>({key:a._parse(new La(r,c,r.path,[f,"key"])),value:i._parse(new La(r,d,r.path,[f,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of l){const f=await d.key,g=await d.value;if(f.status==="aborted"||g.status==="aborted")return it;(f.status==="dirty"||g.status==="dirty")&&n.dirty(),c.set(f.value,g.value)}return{status:n.value,value:c}})}else{const c=new Map;for(const d of l){const f=d.key,g=d.value;if(f.status==="aborted"||g.status==="aborted")return it;(f.status==="dirty"||g.status==="dirty")&&n.dirty(),c.set(f.value,g.value)}return{status:n.value,value:c}}}}T1.create=(t,e,n)=>new T1({valueType:e,keyType:t,typeName:at.ZodMap,...pt(n)});class Oc extends Nt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==qe.set)return Ge(r,{code:Ue.invalid_type,expected:qe.set,received:r.parsedType}),it;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(Ge(r,{code:Ue.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(Ge(r,{code:Ue.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const i=this._def.valueType;function l(d){const f=new Set;for(const g of d){if(g.status==="aborted")return it;g.status==="dirty"&&n.dirty(),f.add(g.value)}return{status:n.value,value:f}}const c=[...r.data.values()].map((d,f)=>i._parse(new La(r,d,r.path,f)));return r.common.async?Promise.all(c).then(d=>l(d)):l(c)}min(e,n){return new Oc({...this._def,minSize:{value:e,message:Ye.toString(n)}})}max(e,n){return new Oc({...this._def,maxSize:{value:e,message:Ye.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Oc.create=(t,e)=>new Oc({valueType:t,minSize:null,maxSize:null,typeName:at.ZodSet,...pt(e)});class em extends Nt{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}em.create=(t,e)=>new em({getter:t,typeName:at.ZodLazy,...pt(e)});class w1 extends Nt{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Ge(n,{received:n.data,code:Ue.invalid_literal,expected:this._def.value}),it}return{status:"valid",value:e.data}}get value(){return this._def.value}}w1.create=(t,e)=>new w1({value:t,typeName:at.ZodLiteral,...pt(e)});function UT(t,e){return new Xo({values:t,typeName:at.ZodEnum,...pt(e)})}class Xo extends Nt{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Ge(n,{expected:Bt.joinValues(r),received:n.parsedType,code:Ue.invalid_type}),it}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return Ge(n,{received:n.data,code:Ue.invalid_enum_value,options:r}),it}return sa(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Xo.create(e,{...this._def,...n})}exclude(e,n=this._def){return Xo.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}Xo.create=UT;class E1 extends Nt{_parse(e){const n=Bt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==qe.string&&r.parsedType!==qe.number){const a=Bt.objectValues(n);return Ge(r,{expected:Bt.joinValues(a),received:r.parsedType,code:Ue.invalid_type}),it}if(this._cache||(this._cache=new Set(Bt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const a=Bt.objectValues(n);return Ge(r,{received:r.data,code:Ue.invalid_enum_value,options:a}),it}return sa(e.data)}get enum(){return this._def.values}}E1.create=(t,e)=>new E1({values:t,typeName:at.ZodNativeEnum,...pt(e)});class Gf extends Nt{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==qe.promise&&n.common.async===!1)return Ge(n,{code:Ue.invalid_type,expected:qe.promise,received:n.parsedType}),it;const r=n.parsedType===qe.promise?n.data:Promise.resolve(n.data);return sa(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Gf.create=(t,e)=>new Gf({type:t,typeName:at.ZodPromise,...pt(e)});class Zo extends Nt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===at.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:l=>{Ge(r,l),l.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const l=a.transform(r.data,i);if(r.common.async)return Promise.resolve(l).then(async c=>{if(n.value==="aborted")return it;const d=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return d.status==="aborted"?it:d.status==="dirty"||n.value==="dirty"?dc(d.value):d});{if(n.value==="aborted")return it;const c=this._def.schema._parseSync({data:l,path:r.path,parent:r});return c.status==="aborted"?it:c.status==="dirty"||n.value==="dirty"?dc(c.value):c}}if(a.type==="refinement"){const l=c=>{const d=a.refinement(c,i);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?it:(c.status==="dirty"&&n.dirty(),l(c.value),{status:n.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?it:(c.status==="dirty"&&n.dirty(),l(c.value).then(()=>({status:n.value,value:c.value}))))}if(a.type==="transform")if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Jo(l))return it;const c=a.transform(l.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>Jo(l)?Promise.resolve(a.transform(l.value,i)).then(c=>({status:n.value,value:c})):it);Bt.assertNever(a)}}Zo.create=(t,e,n)=>new Zo({schema:t,typeName:at.ZodEffects,effect:e,...pt(n)});Zo.createWithPreprocess=(t,e,n)=>new Zo({schema:e,effect:{type:"preprocess",transform:t},typeName:at.ZodEffects,...pt(n)});class qs extends Nt{_parse(e){return this._getType(e)===qe.undefined?sa(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}qs.create=(t,e)=>new qs({innerType:t,typeName:at.ZodOptional,...pt(e)});class Qo extends Nt{_parse(e){return this._getType(e)===qe.null?sa(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Qo.create=(t,e)=>new Qo({innerType:t,typeName:at.ZodNullable,...pt(e)});class tm extends Nt{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===qe.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}tm.create=(t,e)=>new tm({innerType:t,typeName:at.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...pt(e)});class nm extends Nt{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Uf(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new cs(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new cs(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}nm.create=(t,e)=>new nm({innerType:t,typeName:at.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...pt(e)});class S1 extends Nt{_parse(e){if(this._getType(e)!==qe.nan){const r=this._getOrReturnCtx(e);return Ge(r,{code:Ue.invalid_type,expected:qe.nan,received:r.parsedType}),it}return{status:"valid",value:e.data}}}S1.create=t=>new S1({typeName:at.ZodNaN,...pt(t)});class Tb extends Nt{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Pm extends Nt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?it:i.status==="dirty"?(n.dirty(),dc(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?it:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,n){return new Pm({in:e,out:n,typeName:at.ZodPipeline})}}class rm extends Nt{_parse(e){const n=this._def.innerType._parse(e),r=a=>(Jo(a)&&(a.value=Object.freeze(a.value)),a);return Uf(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}rm.create=(t,e)=>new rm({innerType:t,typeName:at.ZodReadonly,...pt(e)});var at;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(at||(at={}));const yi=Ia.create,C1=Ai.create;ki.create;const wb=Bf.create;Ko.create;const b1=Zh.create;Ks.create;const hc=Oa.create,Eb=kn.create,Sb=jf.create;Vf.create;Ni.create;const Cb=Hf.create,bb=em.create,Ab=Xo.create;Gf.create;qs.create;Qo.create;const bo={string:t=>Ia.create({...t,coerce:!0}),number:t=>Ai.create({...t,coerce:!0}),boolean:t=>Bf.create({...t,coerce:!0}),bigint:t=>ki.create({...t,coerce:!0}),date:t=>Ko.create({...t,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let kb,Nb;function Rb(){return{geminiUrl:kb,vertexUrl:Nb}}function Db(t,e,n){var r,a,i;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=Rb();return t.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:e:(i=l.geminiUrl)!==null&&i!==void 0?i:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Li{}function We(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,a)=>{if(Object.prototype.hasOwnProperty.call(e,a)){const i=e[a];return i!=null?String(i):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function m(t,e,n){for(let i=0;i<e.length-1;i++){const l=e[i];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in t))if(Array.isArray(n))t[c]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(t[c])){const d=t[c];if(Array.isArray(n))for(let f=0;f<d.length;f++){const g=d[f];m(g,e.slice(i+1),n[f])}else for(const f of d)m(f,e.slice(i+1),n)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in t||(t[c]=[{}]);const d=t[c];m(d[0],e.slice(i+1),n);return}(!t[l]||typeof t[l]!="object")&&(t[l]={}),t=t[l]}const r=e[e.length-1],a=t[r];if(a!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===a)return;if(typeof a=="object"&&typeof n=="object"&&a!==null&&n!==null)Object.assign(a,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function h(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in t){const i=t[a];return Array.isArray(i)?i.map(l=>h(l,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var A1;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(A1||(A1={}));var k1;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(k1||(k1={}));var Fa;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Fa||(Fa={}));var N1;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(N1||(N1={}));var R1;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(R1||(R1={}));var D1;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(D1||(D1={}));var M1;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(M1||(M1={}));var I1;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(I1||(I1={}));var F1;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(F1||(F1={}));var O1;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(O1||(O1={}));var L1;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(L1||(L1={}));var P1;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(P1||(P1={}));var U1;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(U1||(U1={}));var B1;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(B1||(B1={}));var j1;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(j1||(j1={}));var V1;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(V1||(V1={}));var $f;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})($f||($f={}));var H1;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(H1||(H1={}));var am;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(am||(am={}));var G1;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(G1||(G1={}));var $1;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})($1||($1={}));var z1;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(z1||(z1={}));var q1;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(q1||(q1={}));var Y1;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(Y1||(Y1={}));var W1;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(W1||(W1={}));var J1;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(J1||(J1={}));var K1;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(K1||(K1={}));var X1;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(X1||(X1={}));var Z1;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Z1||(Z1={}));var Q1;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Q1||(Q1={}));var ey;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(ey||(ey={}));var ty;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(ty||(ty={}));var ny;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(ny||(ny={}));var ry;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(ry||(ry={}));var ay;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(ay||(ay={}));var sy;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(sy||(sy={}));var iy;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(iy||(iy={}));var oy;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(oy||(oy={}));var ly;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ly||(ly={}));var cy;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(cy||(cy={}));var uy;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(uy||(uy={}));var Ho;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Ho||(Ho={}));class sm{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class cc{get text(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",g=!1;const y=[];for(const _ of(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[w,E]of Object.entries(_))w!=="text"&&w!=="thought"&&(E!==null||E!==void 0)&&y.push(w);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;g=!0,f+=_.text}}return y.length>0&&console.warn(`there are non-text parts ${y} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?f:void 0}get data(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const g=[];for(const y of(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[_,w]of Object.entries(y))_!=="inlineData"&&(w!==null||w!==void 0)&&g.push(_);y.inlineData&&typeof y.inlineData.data=="string"&&(f+=atob(y.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var e,n,r,a,i,l,c,d,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(y=>y.executableCode).map(y=>y.executableCode).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,n,r,a,i,l,c,d,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(y=>y.codeExecutionResult).map(y=>y.codeExecutionResult).filter(y=>y!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.output}}class fy{}class dy{}class Mb{}class Ib{}class hy{}class my{}class py{}class Fb{}class gy{}class xy{}class vy{}class Ob{}class Lb{}class Pb{}class yy{}class Ub{get text(){var e,n,r;let a="",i=!1;const l=[];for(const c of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(c))d!=="text"&&d!=="thought"&&f!==null&&l.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;i=!0,a+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?a:void 0}get data(){var e,n,r;let a="";const i=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(l))c!=="inlineData"&&d!==null&&i.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class Bb{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $t(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function BT(t,e){const n=$t(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function jT(t){return Array.isArray(t)?t.map(e=>zf(e)):[zf(t)]}function zf(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function VT(t){const e=zf(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function HT(t){const e=zf(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function _y(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function GT(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>_y(e)):[_y(t)]}function im(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Ty(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function wy(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function rr(t){if(t==null)throw new Error("ContentUnion is required");return im(t)?t:{role:"user",parts:GT(t)}}function $T(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=rr(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=rr(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>rr(n)):[rr(e)]}function ra(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Ty(t)||wy(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[rr(t)]}const e=[],n=[],r=im(t[0]);for(const a of t){const i=im(a);if(i!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(i)e.push(a);else{if(Ty(a)||wy(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||e.push({role:"user",parts:GT(n)}),e}const jb=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),Ey=Ab(["string","number","integer","object","array","boolean","null"]),Vb=Sb([Ey,hc(Ey)]);function Hb(t=!0){const e=bb(()=>{const n=Eb({type:Vb.optional(),format:yi().optional(),title:yi().optional(),description:yi().optional(),default:b1().optional(),items:e.optional(),minItems:bo.string().optional(),maxItems:bo.string().optional(),enum:hc(b1()).optional(),properties:Cb(yi(),e).optional(),required:hc(yi()).optional(),minProperties:bo.string().optional(),maxProperties:bo.string().optional(),propertyOrdering:hc(yi()).optional(),minimum:C1().optional(),maximum:C1().optional(),minLength:bo.string().optional(),maxLength:bo.string().optional(),pattern:yi().optional(),anyOf:hc(e).optional(),additionalProperties:wb().optional()});return t?n.strict():n});return e}function Gb(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Fa).includes(n[0].toUpperCase())?n[0].toUpperCase():Fa.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Fa).includes(r.toUpperCase())?r.toUpperCase():Fa.TYPE_UNSPECIFIED})}}function $o(t){const e={},n=["items"],r=["anyOf"],a=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const i=t.anyOf;i!=null&&i.length==2&&(i[0].type==="null"?(e.nullable=!0,t=i[1]):i[1].type==="null"&&(e.nullable=!0,t=i[0])),t.type instanceof Array&&Gb(t.type,e);for(const[l,c]of Object.entries(t))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(Fa).includes(c.toUpperCase())?c.toUpperCase():Fa.TYPE_UNSPECIFIED}else if(n.includes(l))e[l]=$o(c);else if(r.includes(l)){const d=[];for(const f of c){if(f.type=="null"){e.nullable=!0;continue}d.push($o(f))}e[l]=d}else if(a.includes(l)){const d={};for(const[f,g]of Object.entries(c))d[f]=$o(g);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=c}return e}function Lc(t){if(Object.keys(t).includes("$schema")){delete t.$schema;const e=Hb().parse(t);return $o(e)}else return $o(t)}function Um(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Bm(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function sl(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(e.parameters=Lc(e.parameters)),e.response&&(e.response=Lc(e.response));return t}function il(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function $b(t,e,n,r=1){const a=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:a?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:a?`${n}/${e}`:e}function fs(t,e){if(typeof e!="string")throw new Error("name must be a string");return $b(t,e,"cachedContents")}function zT(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function ds(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function zb(t){return t!=null&&typeof t=="object"&&"name"in t}function qb(t){return t!=null&&typeof t=="object"&&"video"in t}function Yb(t){return t!=null&&typeof t=="object"&&"uri"in t}function qT(t){var e;let n;if(zb(t)&&(n=t.name),!(Yb(t)&&(n=t.uri,n===void 0))&&!(qb(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function YT(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function WT(t){for(const e of["models","tunedModels","publisherModels"])if(Wb(t,e))return t[e];return[]}function Wb(t,e){return t!==null&&typeof t=="object"&&e in t}function Jb(t,e={}){const n=t,r={name:n.name,description:n.description,parameters:$o(od(n.inputSchema))};return e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function Kb(t,e={}){const n=[],r=new Set;for(const a of t){const i=a.name;if(r.has(i))throw new Error(`Duplicate function name ${i} found in MCP tools. Please ensure function names are unique.`);r.add(i);const l=Jb(a,e);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function Xb(t){const e=[];for(const n of t)e.push(od(n));return e}function Zb(t){const e={};for(const[n,r]of Object.entries(t)){const a=r;e[n]=od(a)}return e}function od(t){const e=new Set(["items"]),n=new Set(["anyOf"]),r=new Set(["properties"]),a={};for(const[i,l]of Object.entries(t))if(e.has(i))a[i]=od(l);else if(n.has(i))a[i]=Xb(l);else if(r.has(i))a[i]=Zb(l);else if(i==="type"){const c=l.toUpperCase();a[i]=Object.values(Fa).includes(c)?c:Fa.TYPE_UNSPECIFIED}else jb.has(i)&&(a[i]=l);return a}function JT(t,e){if(typeof e!="string"&&!Array.isArray(e)){if(t&&t.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function Qb(t){const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function ol(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function KT(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eA(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function tA(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function nA(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function rA(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],eA(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],tA(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],nA(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function XT(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>rA(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function aA(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const y=h(t,["maxProperties"]);y!=null&&m(e,["maxProperties"],y);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const w=h(t,["minItems"]);w!=null&&m(e,["minItems"],w);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const C=h(t,["minimum"]);C!=null&&m(e,["minimum"],C);const R=h(t,["nullable"]);R!=null&&m(e,["nullable"],R);const k=h(t,["pattern"]);k!=null&&m(e,["pattern"],k);const b=h(t,["properties"]);b!=null&&m(e,["properties"],b);const O=h(t,["propertyOrdering"]);O!=null&&m(e,["propertyOrdering"],O);const U=h(t,["required"]);U!=null&&m(e,["required"],U);const j=h(t,["title"]);j!=null&&m(e,["title"],j);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function sA(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function iA(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function oA(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function lA(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],oA(n)),e}function cA(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function uA(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],cA(n)),e}function fA(){return{}}function dA(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>iA(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],lA(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],uA(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],fA());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function hA(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function mA(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function pA(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],mA(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function gA(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],hA(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],pA(r)),e}function xA(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function ZT(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],xA(n)),e}function vA(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],ZT(r)),e}function yA(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>vA(a))),m(e,["speakerVoiceConfigs"],r)}return e}function _A(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],ZT(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],yA(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function TA(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function wA(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],XT(rr(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const y=h(e,["responseLogprobs"]);y!=null&&m(r,["responseLogprobs"],y);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const w=h(e,["presencePenalty"]);w!=null&&m(r,["presencePenalty"],w);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&m(r,["responseMimeType"],C);const R=h(e,["responseSchema"]);R!=null&&m(r,["responseSchema"],aA(Lc(R)));const k=h(e,["responseJsonSchema"]);if(k!=null&&m(r,["responseJsonSchema"],k),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=h(e,["safetySettings"]);if(n!==void 0&&b!=null){let Q=b;Array.isArray(Q)&&(Q=Q.map(te=>sA(te))),m(n,["safetySettings"],Q)}const O=h(e,["tools"]);if(n!==void 0&&O!=null){let Q=il(O);Array.isArray(Q)&&(Q=Q.map(te=>dA(sl(te)))),m(n,["tools"],Q)}const U=h(e,["toolConfig"]);if(n!==void 0&&U!=null&&m(n,["toolConfig"],gA(U)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const j=h(e,["cachedContent"]);n!==void 0&&j!=null&&m(n,["cachedContent"],fs(t,j));const F=h(e,["responseModalities"]);F!=null&&m(r,["responseModalities"],F);const K=h(e,["mediaResolution"]);K!=null&&m(r,["mediaResolution"],K);const P=h(e,["speechConfig"]);if(P!=null&&m(r,["speechConfig"],_A(Um(P))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ne=h(e,["thinkingConfig"]);return ne!=null&&m(r,["thinkingConfig"],TA(ne)),r}function EA(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["request","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=ra(a);Array.isArray(l)&&(l=l.map(c=>XT(c))),m(n,["request","contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["request","generationConfig"],wA(t,i,n)),n}function SA(t,e){const n={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=h(e,["fileName"]);r!=null&&m(n,["fileName"],r);const a=h(e,["inlinedRequests"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>EA(t,l))),m(n,["requests","requests"],i)}return n}function CA(t,e){const n={},r=h(t,["displayName"]);if(e!==void 0&&r!=null&&m(e,["batch","displayName"],r),h(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function bA(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["src"]);a!=null&&m(n,["batch","inputConfig"],SA(t,JT(t,a)));const i=h(e,["config"]);return i!=null&&m(n,["config"],CA(i,n)),n}function AA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ol(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function kA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ol(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function NA(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);if(e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),h(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function RA(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],NA(n,e)),e}function DA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ol(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function MA(t){const e={},n=h(t,["format"]);n!=null&&m(e,["instancesFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsSource","uris"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigquerySource","inputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function IA(t){const e={},n=h(t,["format"]);n!=null&&m(e,["predictionsFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsDestination","outputUriPrefix"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigqueryDestination","outputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function FA(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["dest"]);return e!==void 0&&a!=null&&m(e,["outputConfig"],IA(Qb(a))),n}function OA(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],$t(t,r));const a=h(e,["src"]);a!=null&&m(n,["inputConfig"],MA(JT(t,a)));const i=h(e,["config"]);return i!=null&&m(n,["config"],FA(i,n)),n}function LA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ol(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function PA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ol(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function UA(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function BA(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],UA(n,e)),e}function jA(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],ol(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function QT(){return{}}function VA(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function HA(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function GA(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function $A(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],VA(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],HA(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],GA(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function zA(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>$A(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function qA(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function YA(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function WA(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>YA(a))),m(e,["urlMetadata"],r)}return e}function JA(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],zA(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],qA(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],WA(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const y=h(t,["safetyRatings"]);return y!=null&&m(e,["safetyRatings"],y),e}function KA(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>JA(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const i=h(t,["usageMetadata"]);return i!=null&&m(e,["usageMetadata"],i),e}function XA(t){const e={},n=h(t,["response"]);return n!=null&&m(e,["response"],KA(n)),h(t,["error"])!=null&&m(e,["error"],QT()),e}function ZA(t){const e={},n=h(t,["responsesFile"]);n!=null&&m(e,["fileName"],n);const r=h(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>XA(i))),m(e,["inlinedResponses"],a)}return e}function om(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata","displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["metadata","state"]);a!=null&&m(e,["state"],KT(a));const i=h(t,["metadata","createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["metadata","endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["metadata","updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["metadata","model"]);d!=null&&m(e,["model"],d);const f=h(t,["metadata","output"]);return f!=null&&m(e,["dest"],ZA(f)),e}function QA(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>om(i))),m(e,["batchJobs"],a)}return e}function ek(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);return r!=null&&m(e,["done"],r),h(t,["error"])!=null&&m(e,["error"],QT()),e}function e2(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["code"]);r!=null&&m(e,["code"],r);const a=h(t,["message"]);return a!=null&&m(e,["message"],a),e}function tk(t){const e={},n=h(t,["instancesFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsSource","uris"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigquerySource","inputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function nk(t){const e={},n=h(t,["predictionsFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsDestination","outputUriPrefix"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigqueryDestination","outputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function lm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["state"]);a!=null&&m(e,["state"],KT(a));const i=h(t,["error"]);i!=null&&m(e,["error"],e2(i));const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["startTime"]);c!=null&&m(e,["startTime"],c);const d=h(t,["endTime"]);d!=null&&m(e,["endTime"],d);const f=h(t,["updateTime"]);f!=null&&m(e,["updateTime"],f);const g=h(t,["model"]);g!=null&&m(e,["model"],g);const y=h(t,["inputConfig"]);y!=null&&m(e,["src"],tk(y));const _=h(t,["outputConfig"]);return _!=null&&m(e,["dest"],nk(_)),e}function rk(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>lm(i))),m(e,["batchJobs"],a)}return e}function ak(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);r!=null&&m(e,["done"],r);const a=h(t,["error"]);return a!=null&&m(e,["error"],e2(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ri;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Ri||(Ri={}));class Xc{constructor(e,n,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,a)}init(e,n,r){var a,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(i=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sk extends Li{constructor(e){super(),this.apiClient=e,this.create=async n=>{if(this.apiClient.isVertexAI()){const a=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${a}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new Xc(Ri.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=OA(this.apiClient,e);return c=We("batchPredictionJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>lm(g))}else{const f=bA(this.apiClient,e);return c=We("{model}:batchGenerateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>om(g))}}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=LA(this.apiClient,e);return c=We("batchPredictionJobs/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>lm(g))}else{const f=AA(this.apiClient,e);return c=We("batches/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>om(g))}}async cancel(e){var n,r,a,i;let l="",c={};if(this.apiClient.isVertexAI()){const d=PA(this.apiClient,e);l=We("batchPredictionJobs/{name}:cancel",d._url),c=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const d=kA(this.apiClient,e);l=We("batches/{name}:cancel",d._url),c=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=BA(e);return c=We("batchPredictionJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=rk(g),_=new yy;return Object.assign(_,y),_})}else{const f=RA(e);return c=We("batches",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=QA(g),_=new yy;return Object.assign(_,y),_})}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=jA(this.apiClient,e);return c=We("batchPredictionJobs/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>ak(g))}else{const f=DA(this.apiClient,e);return c=We("batches/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>ek(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ik(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function ok(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function lk(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function ck(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],ik(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],ok(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],lk(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function Sy(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>ck(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function uk(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function fk(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function dk(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],fk(n)),e}function hk(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function mk(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],hk(n)),e}function pk(){return{}}function gk(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>uk(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],dk(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],mk(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],pk());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function xk(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function vk(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function yk(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],vk(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function _k(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],xk(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],yk(r)),e}function Tk(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const i=h(t,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let g=ra(l);Array.isArray(g)&&(g=g.map(y=>Sy(y))),m(e,["contents"],g)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],Sy(rr(c)));const d=h(t,["tools"]);if(e!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(y=>gk(y))),m(e,["tools"],g)}const f=h(t,["toolConfig"]);if(e!==void 0&&f!=null&&m(e,["toolConfig"],_k(f)),h(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function wk(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],BT(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],Tk(a,n)),n}function Ek(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],fs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function Sk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],fs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function Ck(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function bk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],fs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],Ck(a,n)),n}function Ak(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function kk(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],Ak(n,e)),e}function Nk(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function Rk(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function Dk(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function Mk(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],Nk(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],Rk(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],Dk(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function Cy(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>Mk(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function Ik(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function Fk(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function Ok(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],Fk(n)),e}function Lk(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function Pk(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],Lk(n)),e}function Uk(){return{}}function Bk(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function jk(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],Bk(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function Vk(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],jk(n)),e}function Hk(){return{}}function Gk(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>Ik(_))),m(e,["functionDeclarations"],y)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],Ok(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],Pk(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],Uk());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],Vk(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],Hk());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function $k(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function zk(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function qk(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],zk(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function Yk(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],$k(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],qk(r)),e}function Wk(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const i=h(t,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let y=ra(l);Array.isArray(y)&&(y=y.map(_=>Cy(_))),m(e,["contents"],y)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],Cy(rr(c)));const d=h(t,["tools"]);if(e!==void 0&&d!=null){let y=d;Array.isArray(y)&&(y=y.map(_=>Gk(_))),m(e,["tools"],y)}const f=h(t,["toolConfig"]);e!==void 0&&f!=null&&m(e,["toolConfig"],Yk(f));const g=h(t,["kmsKeyName"]);return e!==void 0&&g!=null&&m(e,["encryption_spec","kmsKeyName"],g),n}function Jk(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],BT(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],Wk(a,n)),n}function Kk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],fs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function Xk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],fs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function Zk(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function Qk(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],fs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],Zk(a,n)),n}function e4(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function t4(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],e4(n,e)),e}function Of(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const i=h(t,["createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const d=h(t,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function n4(){return{}}function r4(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Of(i))),m(e,["cachedContents"],a)}return e}function Lf(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const i=h(t,["createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const d=h(t,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function a4(){return{}}function s4(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Lf(i))),m(e,["cachedContents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class i4 extends Li{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Xc(Ri.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=Jk(this.apiClient,e);return c=We("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Lf(g))}else{const f=wk(this.apiClient,e);return c=We("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Of(g))}}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=Kk(this.apiClient,e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Lf(g))}else{const f=Ek(this.apiClient,e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Of(g))}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=Xk(this.apiClient,e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=a4(),y=new xy;return Object.assign(y,g),y})}else{const f=Sk(this.apiClient,e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=n4(),y=new xy;return Object.assign(y,g),y})}}async update(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=Qk(this.apiClient,e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Lf(g))}else{const f=bk(this.apiClient,e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Of(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=t4(e);return c=We("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=s4(g),_=new vy;return Object.assign(_,y),_})}else{const f=kk(e);return c=We("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=r4(g),_=new vy;return Object.assign(_,y),_})}}}function by(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function rn(t){return this instanceof rn?(this.v=t,this):new rn(t)}function zo(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),a,i=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(w){return function(E){return Promise.resolve(E).then(w,y)}}function c(w,E){r[w]&&(a[w]=function(S){return new Promise(function(C,R){i.push([w,S,C,R])>1||d(w,S)})},E&&(a[w]=E(a[w])))}function d(w,E){try{f(r[w](E))}catch(S){_(i[0][3],S)}}function f(w){w.value instanceof rn?Promise.resolve(w.value.v).then(g,y):_(i[0][2],w)}function g(w){d("next",w)}function y(w){d("throw",w)}function _(w,E){w(E),i.shift(),i.length&&d(i[0][0],i[0][1])}}function _c(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof by=="function"?by(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(l){return new Promise(function(c,d){l=t[i](l),a(c,d,l.done,l.value)})}}function a(i,l,c,d){Promise.resolve(d).then(function(f){i({value:f,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function o4(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:t2(n)}function t2(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function l4(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Ay(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const a=[];let i=!0;for(;r<n&&t[r].role==="model";)a.push(t[r]),i&&!t2(t[r])&&(i=!1),r++;i?e.push(...a):e.pop()}return e}class c4{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new u4(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class u4{constructor(e,n,r,a={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=a,this.history=i,this.sendPromise=Promise.resolve(),l4(i)}async sendMessage(e){var n;await this.sendPromise;const r=rr(e.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,l,c;const d=await a,f=(l=(i=d.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content,g=d.automaticFunctionCallingHistory,y=this.getHistory(!0).length;let _=[];g!=null&&(_=(c=g.slice(y))!==null&&c!==void 0?c:[]);const w=f?[f]:[];this.recordHistory(r,w,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(e){var n;await this.sendPromise;const r=rr(e.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const i=await a;return this.processStreamResponse(i,r)}getHistory(e=!1){const n=e?Ay(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,a;return zo(this,arguments,function*(){var l,c,d,f;const g=[];try{for(var y=!0,_=_c(e),w;w=yield rn(_.next()),l=w.done,!l;y=!0){f=w.value,y=!1;const E=f;if(o4(E)){const S=(a=(r=E.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;S!==void 0&&g.push(S)}yield yield rn(E)}}catch(E){c={error:E}}finally{try{!y&&!l&&(d=_.return)&&(yield rn(d.call(_)))}finally{if(c)throw c.error}}this.recordHistory(n,g)})}recordHistory(e,n,r){let a=[];n.length>0&&n.every(i=>i.role!==void 0)?a=n:a.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...Ay(r)):this.history.push(e),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ld extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,ld.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f4(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function d4(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],f4(n,e)),e}function h4(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function m4(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const i=h(t,["sizeBytes"]);i!=null&&m(e,["sizeBytes"],i);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const d=h(t,["updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(t,["sha256Hash"]);f!=null&&m(e,["sha256Hash"],f);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const y=h(t,["downloadUri"]);y!=null&&m(e,["downloadUri"],y);const _=h(t,["state"]);_!=null&&m(e,["state"],_);const w=h(t,["source"]);w!=null&&m(e,["source"],w);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],h4(S)),e}function p4(t){const e={},n=h(t,["file"]);n!=null&&m(e,["file"],m4(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function g4(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],qT(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function x4(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],qT(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function v4(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function cm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const i=h(t,["sizeBytes"]);i!=null&&m(e,["sizeBytes"],i);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const d=h(t,["updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(t,["sha256Hash"]);f!=null&&m(e,["sha256Hash"],f);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const y=h(t,["downloadUri"]);y!=null&&m(e,["downloadUri"],y);const _=h(t,["state"]);_!=null&&m(e,["state"],_);const w=h(t,["source"]);w!=null&&m(e,["source"],w);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],v4(S)),e}function y4(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>cm(i))),m(e,["files"],a)}return e}function _4(){return{}}function T4(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class w4 extends Li{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Xc(Ri.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>cm(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=d4(e);return i=We("files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=y4(d),g=new Ob;return Object.assign(g,f),g})}}async createInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=p4(e);return i=We("upload/v1beta/files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=_4(),f=new Lb;return Object.assign(f,d),f})}}async get(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=g4(e);return i=We("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>cm(d))}}async delete(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=x4(e);return i=We("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=T4(),f=new Pb;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function E4(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function S4(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function n2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],E4(n)),e}function C4(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],S4(n)),e}function b4(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],n2(r)),e}function A4(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>b4(a))),m(e,["speakerVoiceConfigs"],r)}return e}function k4(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],n2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],A4(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function N4(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],C4(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function R4(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function D4(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function M4(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function I4(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function F4(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function O4(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function L4(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],R4(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],M4(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],F4(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function P4(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],D4(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],I4(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],O4(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function U4(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>L4(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function B4(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>P4(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function j4(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function V4(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function H4(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function G4(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function $4(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],H4(n)),e}function z4(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],G4(n)),e}function q4(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function Y4(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function W4(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],q4(n)),e}function J4(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],Y4(n)),e}function K4(){return{}}function X4(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function Z4(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],X4(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function Q4(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],Z4(n)),e}function eN(){return{}}function tN(){return{}}function nN(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>j4(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],$4(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],W4(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],eN());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function rN(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>V4(_))),m(e,["functionDeclarations"],y)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],z4(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],J4(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],K4());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],Q4(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],tN());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function aN(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function sN(t){const e={},n=h(t,["handle"]);n!=null&&m(e,["handle"],n);const r=h(t,["transparent"]);return r!=null&&m(e,["transparent"],r),e}function ky(){return{}}function Ny(){return{}}function iN(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function oN(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function lN(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],iN(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function cN(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],oN(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function uN(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function fN(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function dN(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],uN(r)),e}function hN(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],fN(r)),e}function mN(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function pN(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function gN(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const y=h(t,["speechConfig"]);e!==void 0&&y!=null&&m(e,["setup","generationConfig","speechConfig"],k4(Bm(y)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const w=h(t,["systemInstruction"]);e!==void 0&&w!=null&&m(e,["setup","systemInstruction"],U4(rr(w)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let U=il(E);Array.isArray(U)&&(U=U.map(j=>nN(sl(j)))),m(e,["setup","tools"],U)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],aN(S));const C=h(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&m(e,["setup","inputAudioTranscription"],ky());const R=h(t,["outputAudioTranscription"]);e!==void 0&&R!=null&&m(e,["setup","outputAudioTranscription"],ky());const k=h(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&m(e,["setup","realtimeInputConfig"],lN(k));const b=h(t,["contextWindowCompression"]);e!==void 0&&b!=null&&m(e,["setup","contextWindowCompression"],dN(b));const O=h(t,["proactivity"]);return e!==void 0&&O!=null&&m(e,["setup","proactivity"],mN(O)),n}function xN(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const y=h(t,["speechConfig"]);e!==void 0&&y!=null&&m(e,["setup","generationConfig","speechConfig"],N4(Bm(y)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const w=h(t,["systemInstruction"]);e!==void 0&&w!=null&&m(e,["setup","systemInstruction"],B4(rr(w)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let U=il(E);Array.isArray(U)&&(U=U.map(j=>rN(sl(j)))),m(e,["setup","tools"],U)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],sN(S));const C=h(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&m(e,["setup","inputAudioTranscription"],Ny());const R=h(t,["outputAudioTranscription"]);e!==void 0&&R!=null&&m(e,["setup","outputAudioTranscription"],Ny());const k=h(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&m(e,["setup","realtimeInputConfig"],cN(k));const b=h(t,["contextWindowCompression"]);e!==void 0&&b!=null&&m(e,["setup","contextWindowCompression"],hN(b));const O=h(t,["proactivity"]);return e!==void 0&&O!=null&&m(e,["setup","proactivity"],pN(O)),n}function vN(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],gN(a,n)),n}function yN(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],xN(a,n)),n}function _N(){return{}}function TN(){return{}}function wN(){return{}}function EN(){return{}}function SN(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],jT(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],HT(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const i=h(t,["video"]);i!=null&&m(e,["video"],VT(i));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],_N()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],wN()),e}function CN(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],jT(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],HT(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const i=h(t,["video"]);i!=null&&m(e,["video"],VT(i));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],TN()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],EN()),e}function r2(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function bN(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>r2(a))),m(e,["weightedPrompts"],r)}return e}function a2(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const i=h(t,["guidance"]);i!=null&&m(e,["guidance"],i);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const d=h(t,["brightness"]);d!=null&&m(e,["brightness"],d);const f=h(t,["scale"]);f!=null&&m(e,["scale"],f);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const y=h(t,["muteDrums"]);y!=null&&m(e,["muteDrums"],y);const _=h(t,["onlyBassAndDrums"]);return _!=null&&m(e,["onlyBassAndDrums"],_),e}function AN(t){const e={},n=h(t,["musicGenerationConfig"]);return n!=null&&m(e,["musicGenerationConfig"],a2(n)),e}function s2(t){const e={},n=h(t,["model"]);return n!=null&&m(e,["model"],n),e}function i2(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>r2(a))),m(e,["weightedPrompts"],r)}return e}function um(t){const e={},n=h(t,["setup"]);n!=null&&m(e,["setup"],s2(n));const r=h(t,["clientContent"]);r!=null&&m(e,["clientContent"],i2(r));const a=h(t,["musicGenerationConfig"]);a!=null&&m(e,["musicGenerationConfig"],a2(a));const i=h(t,["playbackControl"]);return i!=null&&m(e,["playbackControl"],i),e}function kN(){return{}}function NN(t){const e={},n=h(t,["sessionId"]);return n!=null&&m(e,["sessionId"],n),e}function RN(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function DN(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function MN(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function IN(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function FN(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function ON(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function LN(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],RN(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],MN(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],FN(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function PN(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],DN(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],IN(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],ON(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function UN(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>LN(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function BN(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>PN(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function Ry(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function Dy(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function jN(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function VN(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>jN(a))),m(e,["urlMetadata"],r)}return e}function HN(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],UN(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const i=h(t,["groundingMetadata"]);i!=null&&m(e,["groundingMetadata"],i);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],Ry(c));const d=h(t,["outputTranscription"]);d!=null&&m(e,["outputTranscription"],Ry(d));const f=h(t,["urlContextMetadata"]);return f!=null&&m(e,["urlContextMetadata"],VN(f)),e}function GN(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],BN(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const i=h(t,["groundingMetadata"]);i!=null&&m(e,["groundingMetadata"],i);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],Dy(c));const d=h(t,["outputTranscription"]);return d!=null&&m(e,["outputTranscription"],Dy(d)),e}function $N(t){const e={},n=h(t,["id"]);n!=null&&m(e,["id"],n);const r=h(t,["args"]);r!=null&&m(e,["args"],r);const a=h(t,["name"]);return a!=null&&m(e,["name"],a),e}function zN(t){const e={},n=h(t,["args"]);n!=null&&m(e,["args"],n);const r=h(t,["name"]);return r!=null&&m(e,["name"],r),e}function qN(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>$N(a))),m(e,["functionCalls"],r)}return e}function YN(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>zN(a))),m(e,["functionCalls"],r)}return e}function WN(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function JN(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function xf(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function vf(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function KN(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["responseTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const i=h(t,["toolUsePromptTokenCount"]);i!=null&&m(e,["toolUsePromptTokenCount"],i);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const d=h(t,["promptTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(w=>xf(w))),m(e,["promptTokensDetails"],_)}const f=h(t,["cacheTokensDetails"]);if(f!=null){let _=f;Array.isArray(_)&&(_=_.map(w=>xf(w))),m(e,["cacheTokensDetails"],_)}const g=h(t,["responseTokensDetails"]);if(g!=null){let _=g;Array.isArray(_)&&(_=_.map(w=>xf(w))),m(e,["responseTokensDetails"],_)}const y=h(t,["toolUsePromptTokensDetails"]);if(y!=null){let _=y;Array.isArray(_)&&(_=_.map(w=>xf(w))),m(e,["toolUsePromptTokensDetails"],_)}return e}function XN(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["candidatesTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const i=h(t,["toolUsePromptTokenCount"]);i!=null&&m(e,["toolUsePromptTokenCount"],i);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const d=h(t,["promptTokensDetails"]);if(d!=null){let w=d;Array.isArray(w)&&(w=w.map(E=>vf(E))),m(e,["promptTokensDetails"],w)}const f=h(t,["cacheTokensDetails"]);if(f!=null){let w=f;Array.isArray(w)&&(w=w.map(E=>vf(E))),m(e,["cacheTokensDetails"],w)}const g=h(t,["candidatesTokensDetails"]);if(g!=null){let w=g;Array.isArray(w)&&(w=w.map(E=>vf(E))),m(e,["responseTokensDetails"],w)}const y=h(t,["toolUsePromptTokensDetails"]);if(y!=null){let w=y;Array.isArray(w)&&(w=w.map(E=>vf(E))),m(e,["toolUsePromptTokensDetails"],w)}const _=h(t,["trafficType"]);return _!=null&&m(e,["trafficType"],_),e}function ZN(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function QN(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function e3(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function t3(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function n3(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],kN());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],HN(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],qN(a));const i=h(t,["toolCallCancellation"]);i!=null&&m(e,["toolCallCancellation"],WN(i));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],KN(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],ZN(c));const d=h(t,["sessionResumptionUpdate"]);return d!=null&&m(e,["sessionResumptionUpdate"],e3(d)),e}function r3(t){const e={},n=h(t,["setupComplete"]);n!=null&&m(e,["setupComplete"],NN(n));const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],GN(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],YN(a));const i=h(t,["toolCallCancellation"]);i!=null&&m(e,["toolCallCancellation"],JN(i));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],XN(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],QN(c));const d=h(t,["sessionResumptionUpdate"]);return d!=null&&m(e,["sessionResumptionUpdate"],t3(d)),e}function a3(){return{}}function s3(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function i3(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>s3(a))),m(e,["weightedPrompts"],r)}return e}function o3(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const i=h(t,["guidance"]);i!=null&&m(e,["guidance"],i);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const d=h(t,["brightness"]);d!=null&&m(e,["brightness"],d);const f=h(t,["scale"]);f!=null&&m(e,["scale"],f);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const y=h(t,["muteDrums"]);y!=null&&m(e,["muteDrums"],y);const _=h(t,["onlyBassAndDrums"]);return _!=null&&m(e,["onlyBassAndDrums"],_),e}function l3(t){const e={},n=h(t,["clientContent"]);n!=null&&m(e,["clientContent"],i3(n));const r=h(t,["musicGenerationConfig"]);return r!=null&&m(e,["musicGenerationConfig"],o3(r)),e}function c3(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);r!=null&&m(e,["mimeType"],r);const a=h(t,["sourceMetadata"]);return a!=null&&m(e,["sourceMetadata"],l3(a)),e}function u3(t){const e={},n=h(t,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>c3(a))),m(e,["audioChunks"],r)}return e}function f3(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["filteredReason"]);return r!=null&&m(e,["filteredReason"],r),e}function d3(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],a3());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],u3(r));const a=h(t,["filteredPrompt"]);return a!=null&&m(e,["filteredPrompt"],f3(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function h3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function m3(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function p3(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function g3(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],h3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],m3(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],p3(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function cd(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>g3(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function x3(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const y=h(t,["maxProperties"]);y!=null&&m(e,["maxProperties"],y);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const w=h(t,["minItems"]);w!=null&&m(e,["minItems"],w);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const C=h(t,["minimum"]);C!=null&&m(e,["minimum"],C);const R=h(t,["nullable"]);R!=null&&m(e,["nullable"],R);const k=h(t,["pattern"]);k!=null&&m(e,["pattern"],k);const b=h(t,["properties"]);b!=null&&m(e,["properties"],b);const O=h(t,["propertyOrdering"]);O!=null&&m(e,["propertyOrdering"],O);const U=h(t,["required"]);U!=null&&m(e,["required"],U);const j=h(t,["title"]);j!=null&&m(e,["title"],j);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function v3(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function y3(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function _3(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function T3(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],_3(n)),e}function w3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function E3(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],w3(n)),e}function S3(){return{}}function C3(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>y3(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],T3(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],E3(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],S3());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function b3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function A3(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function k3(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],A3(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function N3(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],b3(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],k3(r)),e}function R3(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function o2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],R3(n)),e}function D3(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],o2(r)),e}function M3(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>D3(a))),m(e,["speakerVoiceConfigs"],r)}return e}function I3(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],o2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],M3(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function F3(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function O3(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],cd(rr(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const y=h(e,["responseLogprobs"]);y!=null&&m(r,["responseLogprobs"],y);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const w=h(e,["presencePenalty"]);w!=null&&m(r,["presencePenalty"],w);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&m(r,["responseMimeType"],C);const R=h(e,["responseSchema"]);R!=null&&m(r,["responseSchema"],x3(Lc(R)));const k=h(e,["responseJsonSchema"]);if(k!=null&&m(r,["responseJsonSchema"],k),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=h(e,["safetySettings"]);if(n!==void 0&&b!=null){let Q=b;Array.isArray(Q)&&(Q=Q.map(te=>v3(te))),m(n,["safetySettings"],Q)}const O=h(e,["tools"]);if(n!==void 0&&O!=null){let Q=il(O);Array.isArray(Q)&&(Q=Q.map(te=>C3(sl(te)))),m(n,["tools"],Q)}const U=h(e,["toolConfig"]);if(n!==void 0&&U!=null&&m(n,["toolConfig"],N3(U)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const j=h(e,["cachedContent"]);n!==void 0&&j!=null&&m(n,["cachedContent"],fs(t,j));const F=h(e,["responseModalities"]);F!=null&&m(r,["responseModalities"],F);const K=h(e,["mediaResolution"]);K!=null&&m(r,["mediaResolution"],K);const P=h(e,["speechConfig"]);if(P!=null&&m(r,["speechConfig"],I3(Um(P))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ne=h(e,["thinkingConfig"]);return ne!=null&&m(r,["thinkingConfig"],F3(ne)),r}function My(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=ra(a);Array.isArray(l)&&(l=l.map(c=>cd(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["generationConfig"],O3(t,i,n)),n}function L3(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["requests[]","taskType"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["requests[]","title"],a);const i=h(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&m(e,["requests[]","outputDimensionality"],i),h(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function P3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);a!=null&&m(n,["requests[]","content"],$T(t,a));const i=h(e,["config"]);i!=null&&m(n,["config"],L3(i,n));const l=h(e,["model"]);return l!==void 0&&m(n,["requests[]","model"],$t(t,l)),n}function U3(t,e){const n={};if(h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=h(t,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const i=h(t,["guidanceScale"]);if(e!==void 0&&i!=null&&m(e,["parameters","guidanceScale"],i),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&m(e,["parameters","safetySetting"],l);const c=h(t,["personGeneration"]);e!==void 0&&c!=null&&m(e,["parameters","personGeneration"],c);const d=h(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&m(e,["parameters","includeSafetyAttributes"],d);const f=h(t,["includeRaiReason"]);e!==void 0&&f!=null&&m(e,["parameters","includeRaiReason"],f);const g=h(t,["language"]);e!==void 0&&g!=null&&m(e,["parameters","language"],g);const y=h(t,["outputMimeType"]);e!==void 0&&y!=null&&m(e,["parameters","outputOptions","mimeType"],y);const _=h(t,["outputCompressionQuality"]);if(e!==void 0&&_!=null&&m(e,["parameters","outputOptions","compressionQuality"],_),h(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function B3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["config"]);return i!=null&&m(n,["config"],U3(i,n)),n}function j3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function V3(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const i=h(e,["pageToken"]);n!==void 0&&i!=null&&m(n,["_query","pageToken"],i);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],YT(t,c)),r}function H3(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],V3(t,r,n)),n}function G3(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const i=h(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&m(e,["defaultCheckpointId"],i),n}function $3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],G3(a,n)),n}function z3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function q3(t){const e={};if(h(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Y3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=ra(a);Array.isArray(l)&&(l=l.map(c=>cd(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],q3(i)),n}function W3(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=h(t,["imageBytes"]);n!=null&&m(e,["bytesBase64Encoded"],ds(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function J3(t,e){const n={},r=h(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r),h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=h(t,["durationSeconds"]);if(e!==void 0&&a!=null&&m(e,["parameters","durationSeconds"],a),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=h(t,["aspectRatio"]);if(e!==void 0&&i!=null&&m(e,["parameters","aspectRatio"],i),h(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=h(t,["personGeneration"]);if(e!==void 0&&l!=null&&m(e,["parameters","personGeneration"],l),h(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=h(t,["negativePrompt"]);e!==void 0&&c!=null&&m(e,["parameters","negativePrompt"],c);const d=h(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&m(e,["parameters","enhancePrompt"],d),h(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(h(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(h(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function K3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["image"]);if(i!=null&&m(n,["instances[0]","image"],W3(i)),h(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const l=h(e,["config"]);return l!=null&&m(n,["config"],J3(l,n)),n}function X3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function Z3(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function Q3(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function eR(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],X3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],Z3(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],Q3(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function ll(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>eR(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function tR(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const y=h(t,["maxProperties"]);y!=null&&m(e,["maxProperties"],y);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const w=h(t,["minItems"]);w!=null&&m(e,["minItems"],w);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const C=h(t,["minimum"]);C!=null&&m(e,["minimum"],C);const R=h(t,["nullable"]);R!=null&&m(e,["nullable"],R);const k=h(t,["pattern"]);k!=null&&m(e,["pattern"],k);const b=h(t,["properties"]);b!=null&&m(e,["properties"],b);const O=h(t,["propertyOrdering"]);O!=null&&m(e,["propertyOrdering"],O);const U=h(t,["required"]);U!=null&&m(e,["required"],U);const j=h(t,["title"]);j!=null&&m(e,["title"],j);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function nR(t){const e={},n=h(t,["featureSelectionPreference"]);return n!=null&&m(e,["featureSelectionPreference"],n),e}function rR(t){const e={},n=h(t,["method"]);n!=null&&m(e,["method"],n);const r=h(t,["category"]);r!=null&&m(e,["category"],r);const a=h(t,["threshold"]);return a!=null&&m(e,["threshold"],a),e}function aR(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function sR(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function iR(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],sR(n)),e}function oR(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function lR(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],oR(n)),e}function cR(){return{}}function uR(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function fR(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],uR(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function dR(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],fR(n)),e}function hR(){return{}}function l2(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let y=n;Array.isArray(y)&&(y=y.map(_=>aR(_))),m(e,["functionDeclarations"],y)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],iR(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],lR(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],cR());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],dR(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],hR());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function mR(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function pR(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function gR(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],pR(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function xR(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],mR(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],gR(r)),e}function vR(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function yR(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],vR(n)),e}function _R(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],yR(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function TR(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function wR(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],ll(rr(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const y=h(e,["responseLogprobs"]);y!=null&&m(r,["responseLogprobs"],y);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const w=h(e,["presencePenalty"]);w!=null&&m(r,["presencePenalty"],w);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const C=h(e,["responseMimeType"]);C!=null&&m(r,["responseMimeType"],C);const R=h(e,["responseSchema"]);R!=null&&m(r,["responseSchema"],tR(Lc(R)));const k=h(e,["responseJsonSchema"]);k!=null&&m(r,["responseJsonSchema"],k);const b=h(e,["routingConfig"]);b!=null&&m(r,["routingConfig"],b);const O=h(e,["modelSelectionConfig"]);O!=null&&m(r,["modelConfig"],nR(O));const U=h(e,["safetySettings"]);if(n!==void 0&&U!=null){let Te=U;Array.isArray(Te)&&(Te=Te.map(ae=>rR(ae))),m(n,["safetySettings"],Te)}const j=h(e,["tools"]);if(n!==void 0&&j!=null){let Te=il(j);Array.isArray(Te)&&(Te=Te.map(ae=>l2(sl(ae)))),m(n,["tools"],Te)}const F=h(e,["toolConfig"]);n!==void 0&&F!=null&&m(n,["toolConfig"],xR(F));const K=h(e,["labels"]);n!==void 0&&K!=null&&m(n,["labels"],K);const P=h(e,["cachedContent"]);n!==void 0&&P!=null&&m(n,["cachedContent"],fs(t,P));const ne=h(e,["responseModalities"]);ne!=null&&m(r,["responseModalities"],ne);const Q=h(e,["mediaResolution"]);Q!=null&&m(r,["mediaResolution"],Q);const te=h(e,["speechConfig"]);te!=null&&m(r,["speechConfig"],_R(Um(te)));const _e=h(e,["audioTimestamp"]);_e!=null&&m(r,["audioTimestamp"],_e);const Le=h(e,["thinkingConfig"]);return Le!=null&&m(r,["thinkingConfig"],TR(Le)),r}function Iy(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=ra(a);Array.isArray(l)&&(l=l.map(c=>ll(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["generationConfig"],wR(t,i,n)),n}function ER(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["instances[]","task_type"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["instances[]","title"],a);const i=h(t,["outputDimensionality"]);e!==void 0&&i!=null&&m(e,["parameters","outputDimensionality"],i);const l=h(t,["mimeType"]);e!==void 0&&l!=null&&m(e,["instances[]","mimeType"],l);const c=h(t,["autoTruncate"]);return e!==void 0&&c!=null&&m(e,["parameters","autoTruncate"],c),n}function SR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);a!=null&&m(n,["instances[]","content"],$T(t,a));const i=h(e,["config"]);return i!=null&&m(n,["config"],ER(i,n)),n}function CR(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const i=h(t,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const d=h(t,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&m(e,["parameters","safetySetting"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const y=h(t,["includeSafetyAttributes"]);e!==void 0&&y!=null&&m(e,["parameters","includeSafetyAttributes"],y);const _=h(t,["includeRaiReason"]);e!==void 0&&_!=null&&m(e,["parameters","includeRaiReason"],_);const w=h(t,["language"]);e!==void 0&&w!=null&&m(e,["parameters","language"],w);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const C=h(t,["addWatermark"]);e!==void 0&&C!=null&&m(e,["parameters","addWatermark"],C);const R=h(t,["enhancePrompt"]);return e!==void 0&&R!=null&&m(e,["parameters","enhancePrompt"],R),n}function bR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["config"]);return i!=null&&m(n,["config"],CR(i,n)),n}function ud(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["imageBytes"]);r!=null&&m(e,["bytesBase64Encoded"],ds(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function AR(t){const e={},n=h(t,["maskMode"]);n!=null&&m(e,["maskMode"],n);const r=h(t,["segmentationClasses"]);r!=null&&m(e,["maskClasses"],r);const a=h(t,["maskDilation"]);return a!=null&&m(e,["dilation"],a),e}function kR(t){const e={},n=h(t,["controlType"]);n!=null&&m(e,["controlType"],n);const r=h(t,["enableControlImageComputation"]);return r!=null&&m(e,["computeControl"],r),e}function NR(t){const e={},n=h(t,["styleDescription"]);return n!=null&&m(e,["styleDescription"],n),e}function RR(t){const e={},n=h(t,["subjectType"]);n!=null&&m(e,["subjectType"],n);const r=h(t,["subjectDescription"]);return r!=null&&m(e,["subjectDescription"],r),e}function DR(t){const e={},n=h(t,["referenceImage"]);n!=null&&m(e,["referenceImage"],ud(n));const r=h(t,["referenceId"]);r!=null&&m(e,["referenceId"],r);const a=h(t,["referenceType"]);a!=null&&m(e,["referenceType"],a);const i=h(t,["maskImageConfig"]);i!=null&&m(e,["maskImageConfig"],AR(i));const l=h(t,["controlImageConfig"]);l!=null&&m(e,["controlImageConfig"],kR(l));const c=h(t,["styleImageConfig"]);c!=null&&m(e,["styleImageConfig"],NR(c));const d=h(t,["subjectImageConfig"]);return d!=null&&m(e,["subjectImageConfig"],RR(d)),e}function MR(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const i=h(t,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const d=h(t,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&m(e,["parameters","safetySetting"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const y=h(t,["includeSafetyAttributes"]);e!==void 0&&y!=null&&m(e,["parameters","includeSafetyAttributes"],y);const _=h(t,["includeRaiReason"]);e!==void 0&&_!=null&&m(e,["parameters","includeRaiReason"],_);const w=h(t,["language"]);e!==void 0&&w!=null&&m(e,["parameters","language"],w);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const C=h(t,["editMode"]);e!==void 0&&C!=null&&m(e,["parameters","editMode"],C);const R=h(t,["baseSteps"]);return e!==void 0&&R!=null&&m(e,["parameters","editConfig","baseSteps"],R),n}function IR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["referenceImages"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>DR(d))),m(n,["instances[0]","referenceImages"],c)}const l=h(e,["config"]);return l!=null&&m(n,["config"],MR(l,n)),n}function FR(t,e){const n={},r=h(t,["includeRaiReason"]);e!==void 0&&r!=null&&m(e,["parameters","includeRaiReason"],r);const a=h(t,["outputMimeType"]);e!==void 0&&a!=null&&m(e,["parameters","outputOptions","mimeType"],a);const i=h(t,["outputCompressionQuality"]);e!==void 0&&i!=null&&m(e,["parameters","outputOptions","compressionQuality"],i);const l=h(t,["enhanceInputImage"]);e!==void 0&&l!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],l);const c=h(t,["imagePreservationFactor"]);e!==void 0&&c!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const d=h(t,["numberOfImages"]);e!==void 0&&d!=null&&m(e,["parameters","sampleCount"],d);const f=h(t,["mode"]);return e!==void 0&&f!=null&&m(e,["parameters","mode"],f),n}function OR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["image"]);a!=null&&m(n,["instances[0]","image"],ud(a));const i=h(e,["upscaleFactor"]);i!=null&&m(n,["parameters","upscaleConfig","upscaleFactor"],i);const l=h(e,["config"]);return l!=null&&m(n,["config"],FR(l,n)),n}function LR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function PR(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const i=h(e,["pageToken"]);n!==void 0&&i!=null&&m(n,["_query","pageToken"],i);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],YT(t,c)),r}function UR(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],PR(t,r,n)),n}function BR(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const i=h(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&m(e,["defaultCheckpointId"],i),n}function jR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],BR(a,n)),n}function VR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function HR(t,e){const n={},r=h(t,["systemInstruction"]);e!==void 0&&r!=null&&m(e,["systemInstruction"],ll(rr(r)));const a=h(t,["tools"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>l2(c))),m(e,["tools"],l)}const i=h(t,["generationConfig"]);return e!==void 0&&i!=null&&m(e,["generationConfig"],i),n}function GR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=ra(a);Array.isArray(l)&&(l=l.map(c=>ll(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],HR(i,n)),n}function $R(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=ra(a);Array.isArray(l)&&(l=l.map(c=>ll(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],i),n}function zR(t){const e={},n=h(t,["uri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["videoBytes"]);r!=null&&m(e,["bytesBase64Encoded"],ds(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function qR(t,e){const n={},r=h(t,["numberOfVideos"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["outputGcsUri"]);e!==void 0&&a!=null&&m(e,["parameters","storageUri"],a);const i=h(t,["fps"]);e!==void 0&&i!=null&&m(e,["parameters","fps"],i);const l=h(t,["durationSeconds"]);e!==void 0&&l!=null&&m(e,["parameters","durationSeconds"],l);const c=h(t,["seed"]);e!==void 0&&c!=null&&m(e,["parameters","seed"],c);const d=h(t,["aspectRatio"]);e!==void 0&&d!=null&&m(e,["parameters","aspectRatio"],d);const f=h(t,["resolution"]);e!==void 0&&f!=null&&m(e,["parameters","resolution"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const y=h(t,["pubsubTopic"]);e!==void 0&&y!=null&&m(e,["parameters","pubsubTopic"],y);const _=h(t,["negativePrompt"]);e!==void 0&&_!=null&&m(e,["parameters","negativePrompt"],_);const w=h(t,["enhancePrompt"]);e!==void 0&&w!=null&&m(e,["parameters","enhancePrompt"],w);const E=h(t,["generateAudio"]);e!==void 0&&E!=null&&m(e,["parameters","generateAudio"],E);const S=h(t,["lastFrame"]);e!==void 0&&S!=null&&m(e,["instances[0]","lastFrame"],ud(S));const C=h(t,["compressionQuality"]);return e!==void 0&&C!=null&&m(e,["parameters","compressionQuality"],C),n}function YR(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["image"]);i!=null&&m(n,["instances[0]","image"],ud(i));const l=h(e,["video"]);l!=null&&m(n,["instances[0]","video"],zR(l));const c=h(e,["config"]);return c!=null&&m(n,["config"],qR(c,n)),n}function WR(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function JR(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function KR(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function XR(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],WR(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],JR(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],KR(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function ZR(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>XR(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function QR(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function e5(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function t5(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>e5(a))),m(e,["urlMetadata"],r)}return e}function n5(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],ZR(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],QR(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],t5(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const y=h(t,["safetyRatings"]);return y!=null&&m(e,["safetyRatings"],y),e}function Fy(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>n5(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const i=h(t,["usageMetadata"]);return i!=null&&m(e,["usageMetadata"],i),e}function r5(t){const e={},n=h(t,["values"]);return n!=null&&m(e,["values"],n),e}function a5(){return{}}function s5(t){const e={},n=h(t,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>r5(i))),m(e,["embeddings"],a)}return h(t,["metadata"])!=null&&m(e,["metadata"],a5()),e}function i5(t){const e={},n=h(t,["bytesBase64Encoded"]);n!=null&&m(e,["imageBytes"],ds(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function c2(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function o5(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],i5(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);return a!=null&&m(e,["safetyAttributes"],c2(a)),e}function l5(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>o5(i))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],c2(r)),e}function c5(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function fm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["version"]);i!=null&&m(e,["version"],i);const l=h(t,["_self"]);l!=null&&m(e,["tunedModelInfo"],c5(l));const c=h(t,["inputTokenLimit"]);c!=null&&m(e,["inputTokenLimit"],c);const d=h(t,["outputTokenLimit"]);d!=null&&m(e,["outputTokenLimit"],d);const f=h(t,["supportedGenerationMethods"]);return f!=null&&m(e,["supportedActions"],f),e}function u5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=WT(r);Array.isArray(a)&&(a=a.map(i=>fm(i))),m(e,["models"],a)}return e}function f5(){return{}}function d5(t){const e={},n=h(t,["totalTokens"]);n!=null&&m(e,["totalTokens"],n);const r=h(t,["cachedContentTokenCount"]);return r!=null&&m(e,["cachedContentTokenCount"],r),e}function h5(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],ds(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function m5(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],h5(n)),e}function p5(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>m5(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function g5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],p5(l)),e}function x5(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function v5(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function y5(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function _5(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],x5(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],v5(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],y5(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function T5(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>_5(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function w5(t){const e={},n=h(t,["citations"]);return n!=null&&m(e,["citations"],n),e}function E5(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function S5(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>E5(a))),m(e,["urlMetadata"],r)}return e}function C5(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],T5(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],w5(r));const a=h(t,["finishMessage"]);a!=null&&m(e,["finishMessage"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],S5(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const y=h(t,["safetyRatings"]);return y!=null&&m(e,["safetyRatings"],y),e}function Oy(t){const e={},n=h(t,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>C5(f))),m(e,["candidates"],d)}const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["responseId"]);a!=null&&m(e,["responseId"],a);const i=h(t,["modelVersion"]);i!=null&&m(e,["modelVersion"],i);const l=h(t,["promptFeedback"]);l!=null&&m(e,["promptFeedback"],l);const c=h(t,["usageMetadata"]);return c!=null&&m(e,["usageMetadata"],c),e}function b5(t){const e={},n=h(t,["truncated"]);n!=null&&m(e,["truncated"],n);const r=h(t,["token_count"]);return r!=null&&m(e,["tokenCount"],r),e}function A5(t){const e={},n=h(t,["values"]);n!=null&&m(e,["values"],n);const r=h(t,["statistics"]);return r!=null&&m(e,["statistics"],b5(r)),e}function k5(t){const e={},n=h(t,["billableCharacterCount"]);return n!=null&&m(e,["billableCharacterCount"],n),e}function N5(t){const e={},n=h(t,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>A5(i))),m(e,["embeddings"],a)}const r=h(t,["metadata"]);return r!=null&&m(e,["metadata"],k5(r)),e}function R5(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["imageBytes"],ds(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function u2(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function jm(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],R5(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);a!=null&&m(e,["safetyAttributes"],u2(a));const i=h(t,["prompt"]);return i!=null&&m(e,["enhancedPrompt"],i),e}function D5(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>jm(i))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],u2(r)),e}function M5(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>jm(a))),m(e,["generatedImages"],r)}return e}function I5(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>jm(a))),m(e,["generatedImages"],r)}return e}function F5(t){const e={},n=h(t,["endpoint"]);n!=null&&m(e,["name"],n);const r=h(t,["deployedModelId"]);return r!=null&&m(e,["deployedModelId"],r),e}function O5(t){const e={},n=h(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function L5(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);return a!=null&&m(e,["step"],a),e}function dm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["versionId"]);i!=null&&m(e,["version"],i);const l=h(t,["deployedModels"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(_=>F5(_))),m(e,["endpoints"],y)}const c=h(t,["labels"]);c!=null&&m(e,["labels"],c);const d=h(t,["_self"]);d!=null&&m(e,["tunedModelInfo"],O5(d));const f=h(t,["defaultCheckpointId"]);f!=null&&m(e,["defaultCheckpointId"],f);const g=h(t,["checkpoints"]);if(g!=null){let y=g;Array.isArray(y)&&(y=y.map(_=>L5(_))),m(e,["checkpoints"],y)}return e}function P5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=WT(r);Array.isArray(a)&&(a=a.map(i=>dm(i))),m(e,["models"],a)}return e}function U5(){return{}}function B5(t){const e={},n=h(t,["totalTokens"]);return n!=null&&m(e,["totalTokens"],n),e}function j5(t){const e={},n=h(t,["tokensInfo"]);return n!=null&&m(e,["tokensInfo"],n),e}function V5(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],ds(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function H5(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],V5(n)),e}function G5(t){const e={},n=h(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>H5(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function $5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response"]);return l!=null&&m(e,["response"],G5(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const z5="Content-Type",q5="X-Server-Timeout",Y5="User-Agent",hm="x-goog-api-client",W5="1.8.0",J5=`google-genai-sdk/${W5}`,K5="v1beta1",X5="v1beta",Ly=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Z5{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:K5,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:X5,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const a=[this.getRequestUrlInternal(n)];return r&&a.push(this.getBaseResourcePath()),e!==""&&a.push(e),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))a.searchParams.append(l,String(c));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.unaryApiCall(a,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[a,i]of Object.entries(n))typeof i=="object"?r[a]=Object.assign(Object.assign({},r[a]),i):i!==void 0&&(r[a]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.streamApiCall(a,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const a=new AbortController,i=a.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>a.abort(),n.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),e.signal=i}return n&&n.extraBody!==null&&Q5(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await Py(a),new sm(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await Py(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(e){var n;return zo(this,arguments,function*(){const a=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:c,value:d}=yield rn(a.read());if(c){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const f=i.decode(d);try{const y=JSON.parse(f);if("error"in y){const _=JSON.parse(JSON.stringify(y.error)),w=_.status,E=_.code,S=`got status: ${w}. ${JSON.stringify(y)}`;if(E>=400&&E<600)throw new ld({message:S,status:E})}}catch(y){if(y.name==="ApiError")throw y}l+=f;let g=l.match(Ly);for(;g;){const y=g[1];try{const _=new Response(y,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield rn(new sm(_)),l=l.slice(g[0].length),g=l.match(Ly)}catch(_){throw new Error(`exception parsing stream chunk ${y}. ${_}`)}}}}finally{a.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=J5+" "+this.clientOptions.userAgentExtra;return e[Y5]=n,e[hm]=n,e[z5]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,a]of Object.entries(e.headers))n.append(r,a);e.timeout&&e.timeout>0&&n.append(q5,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const a={};n!=null&&(a.mimeType=n.mimeType,a.name=n.name,a.displayName=n.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const i=this.clientOptions.uploader,l=await i.stat(e);a.sizeBytes=String(l.size);const c=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=c;const d=await this.fetchUploadUrl(a,n);return i.upload(e,d,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let a={};n!=null&&n.httpOptions?a=n.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},l=await this.request({path:We("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function Py(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const a=JSON.stringify(r);throw n>=400&&n<600?new ld({message:a,status:n}):new Error(a)}}function Q5(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const i=JSON.parse(t.body);if(typeof i=="object"&&i!==null&&!Array.isArray(i))n=i;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(i,l){const c=Object.assign({},i);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const f=l[d],g=c[d];f&&typeof f=="object"&&!Array.isArray(f)&&g&&typeof g=="object"&&!Array.isArray(g)?c[d]=r(g,f):(g&&f&&typeof g!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof g}, New type: ${typeof f}. Overwriting.`),c[d]=f)}return c}const a=r(n,e);t.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eD="mcp_used/unknown";function f2(t){for(const e of t)if(Vm(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function d2(t){var e;const n=(e=t[hm])!==null&&e!==void 0?e:"";t[hm]=(n+` ${eD}`).trimStart()}function tD(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>Vm(a)))!==null&&r!==void 0?r:!1}function nD(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>!Vm(a)))!==null&&r!==void 0?r:!1}function Vm(t){return t!==null&&typeof t=="object"&&t instanceof Hm}function rD(t,e=100){return zo(this,arguments,function*(){let r,a=0;for(;a<e;){const i=yield rn(t.listTools({cursor:r}));for(const l of i.tools)yield yield rn(l),a++;if(!i.nextCursor)break;r=i.nextCursor}})}class Hm{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Hm(e,n)}async initialize(){var e,n,r,a;if(this.mcpTools.length>0)return;const i={},l=[];for(const g of this.mcpClients)try{for(var c=!0,d=(n=void 0,_c(rD(g))),f;f=await d.next(),e=f.done,!e;c=!0){a=f.value,c=!1;const y=a;l.push(y);const _=y.name;if(i[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);i[_]=g}}catch(y){n={error:y}}finally{try{!c&&!e&&(r=d.return)&&await r.call(d)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),Kb(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[r.name];let i;this.config.timeout&&(i={timeout:this.config.timeout});const l=await a.callTool({name:r.name,arguments:r.args},void 0,i);n.push({functionResponse:{name:r.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function aD(t,e,n){const r=new Bb;let a;n.data instanceof Blob?a=JSON.parse(await n.data.text()):a=JSON.parse(n.data);const i=d3(a);Object.assign(r,i),e(r)}class sD{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),l=lD(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),d=`${a}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${c}`;let f=()=>{};const g=new Promise(b=>{f=b}),y=e.callbacks,_=function(){f({})},w=this.apiClient,E={onopen:_,onmessage:b=>{aD(w,y.onmessage,b)},onerror:(n=y==null?void 0:y.onerror)!==null&&n!==void 0?n:function(b){},onclose:(r=y==null?void 0:y.onclose)!==null&&r!==void 0?r:function(b){}},S=this.webSocketFactory.create(d,oD(l),E);S.connect(),await g;const C=$t(this.apiClient,e.model),R=s2({model:C}),k=um({setup:R});return S.send(JSON.stringify(k)),new iD(S,this.apiClient)}}class iD{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=bN(e),r=i2(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=AN(e),r=um(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const n=um({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Ho.PLAY)}pause(){this.sendPlaybackControl(Ho.PAUSE)}stop(){this.sendPlaybackControl(Ho.STOP)}resetContext(){this.sendPlaybackControl(Ho.RESET_CONTEXT)}close(){this.conn.close()}}function oD(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function lD(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cD="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function uD(t,e,n){const r=new Ub;let a;n.data instanceof Blob?a=await n.data.text():n.data instanceof ArrayBuffer?a=new TextDecoder().decode(n.data):a=n.data;const i=JSON.parse(a);if(t.isVertexAI()){const l=r3(i);Object.assign(r,l)}else{const l=n3(i);Object.assign(r,l)}e(r)}class fD{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new sD(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,a,i,l,c;const d=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let g;const y=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&f2(e.config.tools)&&d2(y);const _=pD(y);if(this.apiClient.isVertexAI())g=`${d}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_);else{const P=this.apiClient.getApiKey();let ne="BidiGenerateContent",Q="key";P!=null&&P.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),ne="BidiGenerateContentConstrained",Q="access_token"),g=`${d}/ws/google.ai.generativelanguage.${f}.GenerativeService.${ne}?${Q}=${P}`}let w=()=>{};const E=new Promise(P=>{w=P}),S=e.callbacks,C=function(){var P;(P=S==null?void 0:S.onopen)===null||P===void 0||P.call(S),w({})},R=this.apiClient,k={onopen:C,onmessage:P=>{uD(R,S.onmessage,P)},onerror:(n=S==null?void 0:S.onerror)!==null&&n!==void 0?n:function(P){},onclose:(r=S==null?void 0:S.onclose)!==null&&r!==void 0?r:function(P){}},b=this.webSocketFactory.create(g,mD(_),k);b.connect(),await E;let O=$t(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&O.startsWith("publishers/")){const P=this.apiClient.getProject(),ne=this.apiClient.getLocation();O=`projects/${P}/locations/${ne}/`+O}let U={};this.apiClient.isVertexAI()&&((a=e.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[$f.AUDIO]}:e.config.responseModalities=[$f.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const j=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],F=[];for(const P of j)if(this.isCallableTool(P)){const ne=P;F.push(await ne.tool())}else F.push(P);F.length>0&&(e.config.tools=F);const K={model:O,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?U=yN(this.apiClient,K):U=vN(this.apiClient,K),delete U.config,b.send(JSON.stringify(U)),new hD(b,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const dD={turnComplete:!0};class hD{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=ra(n.turns),e.isVertexAI()?r=r.map(a=>ll(a)):r=r.map(a=>cd(a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(cD)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},dD),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:CN(e)}:n={realtimeInput:SN(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function mD(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function pD(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Uy=10;function By(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let a=!1;for(const l of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Pf(l)){a=!0;break}if(!a)return!0;const i=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return i&&(i<0||!Number.isInteger(i))||i==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",i),!0):!1}function Pf(t){return"callTool"in t&&typeof t.callTool=="function"}function jy(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gD extends Li{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,a,i,l,c;const d=await this.processParamsForMcpUsage(n);if(!tD(n)||By(n.config))return await this.generateContentInternal(d);if(nD(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let f,g;const y=ra(d.contents),_=(i=(a=(r=d.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&i!==void 0?i:Uy;let w=0;for(;w<_&&(f=await this.generateContentInternal(d),!(!f.functionCalls||f.functionCalls.length===0));){const E=f.candidates[0].content,S=[];for(const C of(c=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(Pf(C)){const k=await C.callTool(f.functionCalls);S.push(...k)}w++,g={role:"user",parts:S},d.contents=ra(d.contents),d.contents.push(E),d.contents.push(g),jy(d.config)&&(y.push(E),y.push(g))}return jy(d.config)&&(f.automaticFunctionCallingHistory=y),f},this.generateContentStream=async n=>{if(By(n.config)){const r=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var a;let i;const l=[];if(r!=null&&r.generatedImages)for(const d of r.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((a=d==null?void 0:d.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?i=d==null?void 0:d.safetyAttributes:l.push(d);let c;return i?c={generatedImages:l,positivePromptSafetyAttributes:i}:c={generatedImages:l},c}),this.list=async n=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Xc(Ri.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const a={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async processParamsForMcpUsage(e){var n,r,a;const i=(n=e.config)===null||n===void 0?void 0:n.tools;if(!i)return e;const l=await Promise.all(i.map(async d=>Pf(d)?await d.tool():d)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&f2(e.config.tools)){const d=(a=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&a!==void 0?a:{};let f=Object.assign({},d);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),d2(f),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return c}async initAfcToolsMap(e){var n,r,a;const i=new Map;for(const l of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Pf(l)){const c=l,d=await c.tool();for(const f of(a=d.functionDeclarations)!==null&&a!==void 0?a:[]){if(!f.name)throw new Error("Function declaration name is required.");if(i.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);i.set(f.name,c)}}return i}async processAfcStream(e){var n,r,a;const i=(a=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:Uy;let l=!1,c=0;const d=await this.initAfcToolsMap(e);return function(f,g,y){var _,w;return zo(this,arguments,function*(){for(var E,S,C,R;c<i;){l&&(c++,l=!1);const U=yield rn(f.processParamsForMcpUsage(y)),j=yield rn(f.generateContentStreamInternal(U)),F=[],K=[];try{for(var k=!0,b=(S=void 0,_c(j)),O;O=yield rn(b.next()),E=O.done,!E;k=!0){R=O.value,k=!1;const P=R;if(yield yield rn(P),P.candidates&&(!((_=P.candidates[0])===null||_===void 0)&&_.content)){K.push(P.candidates[0].content);for(const ne of(w=P.candidates[0].content.parts)!==null&&w!==void 0?w:[])if(c<i&&ne.functionCall){if(!ne.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(ne.functionCall.name)){const Q=yield rn(g.get(ne.functionCall.name).callTool([ne.functionCall]));F.push(...Q)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${ne.functionCall.name}`)}}}}catch(P){S={error:P}}finally{try{!k&&!E&&(C=b.return)&&(yield rn(C.call(b)))}finally{if(S)throw S.error}}if(F.length>0){l=!0;const P=new cc;P.candidates=[{content:{role:"user",parts:F}}],yield yield rn(P);const ne=[];ne.push(...K),ne.push({role:"user",parts:F});const Q=ra(y.contents).concat(ne);y.contents=Q}else break}})}(this,d,e)}async generateContentInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=Iy(this.apiClient,e);return c=We("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=Oy(g),_=new cc;return Object.assign(_,y),_})}else{const f=My(this.apiClient,e);return c=We("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=Fy(g),_=new cc;return Object.assign(_,y),_})}}async generateContentStreamInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=Iy(this.apiClient,e);return c=We("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(y){return zo(this,arguments,function*(){var _,w,E,S;try{for(var C=!0,R=_c(y),k;k=yield rn(R.next()),_=k.done,!_;C=!0){S=k.value,C=!1;const O=Oy(yield rn(S.json())),U=new cc;Object.assign(U,O),yield yield rn(U)}}catch(b){w={error:b}}finally{try{!C&&!_&&(E=R.return)&&(yield rn(E.call(R)))}finally{if(w)throw w.error}}})})}else{const f=My(this.apiClient,e);return c=We("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(y){return zo(this,arguments,function*(){var _,w,E,S;try{for(var C=!0,R=_c(y),k;k=yield rn(R.next()),_=k.done,!_;C=!0){S=k.value,C=!1;const O=Fy(yield rn(S.json())),U=new cc;Object.assign(U,O),yield yield rn(U)}}catch(b){w={error:b}}finally{try{!C&&!_&&(E=R.return)&&(yield rn(E.call(R)))}finally{if(w)throw w.error}}})})}}async embedContent(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=SR(this.apiClient,e);return c=We("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=N5(g),_=new fy;return Object.assign(_,y),_})}else{const f=P3(this.apiClient,e);return c=We("{model}:batchEmbedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=s5(g),_=new fy;return Object.assign(_,y),_})}}async generateImagesInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=bR(this.apiClient,e);return c=We("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=D5(g),_=new dy;return Object.assign(_,y),_})}else{const f=B3(this.apiClient,e);return c=We("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=l5(g),_=new dy;return Object.assign(_,y),_})}}async editImageInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=IR(this.apiClient,e);return i=We("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=M5(d),g=new Mb;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=OR(this.apiClient,e);return i=We("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=I5(d),g=new Ib;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=LR(this.apiClient,e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>dm(g))}else{const f=j3(this.apiClient,e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>fm(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=UR(this.apiClient,e);return c=We("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=P5(g),_=new hy;return Object.assign(_,y),_})}else{const f=H3(this.apiClient,e);return c=We("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=u5(g),_=new hy;return Object.assign(_,y),_})}}async update(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=jR(this.apiClient,e);return c=We("{model}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>dm(g))}else{const f=$3(this.apiClient,e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>fm(g))}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=VR(this.apiClient,e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=U5(),y=new my;return Object.assign(y,g),y})}else{const f=z3(this.apiClient,e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=f5(),y=new my;return Object.assign(y,g),y})}}async countTokens(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=GR(this.apiClient,e);return c=We("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=B5(g),_=new py;return Object.assign(_,y),_})}else{const f=Y3(this.apiClient,e);return c=We("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=d5(g),_=new py;return Object.assign(_,y),_})}}async computeTokens(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=$R(this.apiClient,e);return i=We("{model}:computeTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=j5(d),g=new Fb;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=YR(this.apiClient,e);return c=We("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>$5(g))}else{const f=K3(this.apiClient,e);return c=We("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>g5(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xD(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function vD(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function yD(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["operationName"],n);const r=h(t,["resourceName"]);r!=null&&m(e,["_url","resourceName"],r);const a=h(t,["config"]);return a!=null&&m(e,["config"],a),e}function _D(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],ds(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function TD(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],_D(n)),e}function wD(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>TD(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function ED(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],wD(l)),e}function SD(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],ds(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function CD(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],SD(n)),e}function bD(t){const e={},n=h(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>CD(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function Vy(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response"]);return l!=null&&m(e,["response"],bD(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AD extends Li{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let i;return r&&"httpOptions"in r&&(i=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=vD(e);return c=We("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Vy(g))}else{const f=xD(e);return c=We("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>ED(g))}}async fetchPredictVideosOperationInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=yD(e);return i=We("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>Vy(d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kD(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function h2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],kD(n)),e}function ND(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],h2(r)),e}function RD(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>ND(a))),m(e,["speakerVoiceConfigs"],r)}return e}function DD(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],h2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],RD(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function MD(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function ID(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function FD(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function OD(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],MD(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],ID(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],FD(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const y=h(t,["text"]);return y!=null&&m(e,["text"],y),e}function LD(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>OD(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function PD(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function UD(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function BD(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],UD(n)),e}function jD(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function VD(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],jD(n)),e}function HD(){return{}}function GD(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>PD(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],BD(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],VD(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],HD());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function $D(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Hy(){return{}}function zD(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function qD(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],zD(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function YD(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function WD(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],YD(r)),e}function JD(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function KD(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const y=h(t,["speechConfig"]);e!==void 0&&y!=null&&m(e,["setup","generationConfig","speechConfig"],DD(Bm(y)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const w=h(t,["systemInstruction"]);e!==void 0&&w!=null&&m(e,["setup","systemInstruction"],LD(rr(w)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let U=il(E);Array.isArray(U)&&(U=U.map(j=>GD(sl(j)))),m(e,["setup","tools"],U)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],$D(S));const C=h(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&m(e,["setup","inputAudioTranscription"],Hy());const R=h(t,["outputAudioTranscription"]);e!==void 0&&R!=null&&m(e,["setup","outputAudioTranscription"],Hy());const k=h(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&m(e,["setup","realtimeInputConfig"],qD(k));const b=h(t,["contextWindowCompression"]);e!==void 0&&b!=null&&m(e,["setup","contextWindowCompression"],WD(b));const O=h(t,["proactivity"]);return e!==void 0&&O!=null&&m(e,["setup","proactivity"],JD(O)),n}function XD(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],KD(a,n)),n}function ZD(t,e,n){const r={},a=h(e,["expireTime"]);n!==void 0&&a!=null&&m(n,["expireTime"],a);const i=h(e,["newSessionExpireTime"]);n!==void 0&&i!=null&&m(n,["newSessionExpireTime"],i);const l=h(e,["uses"]);n!==void 0&&l!=null&&m(n,["uses"],l);const c=h(e,["liveConnectConstraints"]);n!==void 0&&c!=null&&m(n,["bidiGenerateContentSetup"],XD(t,c));const d=h(e,["lockAdditionalFields"]);return n!==void 0&&d!=null&&m(n,["fieldMask"],d),r}function QD(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],ZD(t,r,n)),n}function eM(t){const e={},n=h(t,["name"]);return n!=null&&m(e,["name"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tM(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const a=Object.keys(r).map(i=>`${n}.${i}`);e.push(...a)}else e.push(n)}return e.join(",")}function nM(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const i=r.setup;typeof i=="object"&&i!==null?(t.bidiGenerateContentSetup=i,n=i):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const a=t.fieldMask;if(n){const i=tM(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)i?t.fieldMask=i:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];a.length>0&&(c=a.map(f=>l.includes(f)?`generationConfig.${f}`:f));const d=[];i&&d.push(i),c.length>0&&d.push(...c),d.length>0?t.fieldMask=d.join(","):delete t.fieldMask}else delete t.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?t.fieldMask=a.join(","):delete t.fieldMask;return t}class rM extends Li{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=QD(this.apiClient,e);i=We("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const d=nM(c,e.config);return a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>eM(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aM(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function sM(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function iM(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],sM(n,e)),e}function oM(t){const e={},n=h(t,["textInput"]);n!=null&&m(e,["textInput"],n);const r=h(t,["output"]);return r!=null&&m(e,["output"],r),e}function lM(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=h(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>oM(a))),m(e,["examples","examples"],r)}return e}function cM(t,e){const n={};if(h(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=h(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&m(e,["displayName"],r),h(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=h(t,["epochCount"]);e!==void 0&&a!=null&&m(e,["tuningTask","hyperparameters","epochCount"],a);const i=h(t,["learningRateMultiplier"]);if(i!=null&&m(n,["tuningTask","hyperparameters","learningRateMultiplier"],i),h(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=h(t,["batchSize"]);e!==void 0&&l!=null&&m(e,["tuningTask","hyperparameters","batchSize"],l);const c=h(t,["learningRate"]);return e!==void 0&&c!=null&&m(e,["tuningTask","hyperparameters","learningRate"],c),n}function uM(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["tuningTask","trainingData"],lM(r));const a=h(t,["config"]);return a!=null&&m(e,["config"],cM(a,e)),e}function fM(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function dM(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function hM(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],dM(n,e)),e}function mM(t,e){const n={},r=h(t,["gcsUri"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);if(e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),h(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function pM(t,e){const n={},r=h(t,["gcsUri"]);r!=null&&m(n,["validationDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);return e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),n}function gM(t,e){const n={},r=h(t,["validationDataset"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec"],pM(r,n));const a=h(t,["tunedModelDisplayName"]);e!==void 0&&a!=null&&m(e,["tunedModelDisplayName"],a);const i=h(t,["description"]);e!==void 0&&i!=null&&m(e,["description"],i);const l=h(t,["epochCount"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=h(t,["learningRateMultiplier"]);e!==void 0&&c!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=h(t,["exportLastCheckpointOnly"]);e!==void 0&&d!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const f=h(t,["adapterSize"]);if(e!==void 0&&f!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],f),h(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function xM(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],mM(r,e));const a=h(t,["config"]);return a!=null&&m(e,["config"],gM(a,e)),e}function vM(t){const e={},n=h(t,["name"]);n!=null&&m(e,["model"],n);const r=h(t,["name"]);return r!=null&&m(e,["endpoint"],r),e}function m2(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],zT(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const i=h(t,["tuningTask","startTime"]);i!=null&&m(e,["startTime"],i);const l=h(t,["tuningTask","completeTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["description"]);d!=null&&m(e,["description"],d);const f=h(t,["baseModel"]);f!=null&&m(e,["baseModel"],f);const g=h(t,["_self"]);g!=null&&m(e,["tunedModel"],vM(g));const y=h(t,["distillationSpec"]);y!=null&&m(e,["distillationSpec"],y);const _=h(t,["experiment"]);_!=null&&m(e,["experiment"],_);const w=h(t,["labels"]);w!=null&&m(e,["labels"],w);const E=h(t,["pipelineJob"]);E!=null&&m(e,["pipelineJob"],E);const S=h(t,["satisfiesPzi"]);S!=null&&m(e,["satisfiesPzi"],S);const C=h(t,["satisfiesPzs"]);C!=null&&m(e,["satisfiesPzs"],C);const R=h(t,["serviceAccount"]);R!=null&&m(e,["serviceAccount"],R);const k=h(t,["tunedModelDisplayName"]);return k!=null&&m(e,["tunedModelDisplayName"],k),e}function yM(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>m2(i))),m(e,["tuningJobs"],a)}return e}function _M(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);return i!=null&&m(e,["error"],i),e}function TM(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);a!=null&&m(e,["step"],a);const i=h(t,["endpoint"]);return i!=null&&m(e,["endpoint"],i),e}function wM(t){const e={},n=h(t,["model"]);n!=null&&m(e,["model"],n);const r=h(t,["endpoint"]);r!=null&&m(e,["endpoint"],r);const a=h(t,["checkpoints"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>TM(l))),m(e,["checkpoints"],i)}return e}function mm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],zT(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const i=h(t,["startTime"]);i!=null&&m(e,["startTime"],i);const l=h(t,["endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["error"]);d!=null&&m(e,["error"],d);const f=h(t,["description"]);f!=null&&m(e,["description"],f);const g=h(t,["baseModel"]);g!=null&&m(e,["baseModel"],g);const y=h(t,["tunedModel"]);y!=null&&m(e,["tunedModel"],wM(y));const _=h(t,["supervisedTuningSpec"]);_!=null&&m(e,["supervisedTuningSpec"],_);const w=h(t,["tuningDataStats"]);w!=null&&m(e,["tuningDataStats"],w);const E=h(t,["encryptionSpec"]);E!=null&&m(e,["encryptionSpec"],E);const S=h(t,["partnerModelTuningSpec"]);S!=null&&m(e,["partnerModelTuningSpec"],S);const C=h(t,["distillationSpec"]);C!=null&&m(e,["distillationSpec"],C);const R=h(t,["experiment"]);R!=null&&m(e,["experiment"],R);const k=h(t,["labels"]);k!=null&&m(e,["labels"],k);const b=h(t,["pipelineJob"]);b!=null&&m(e,["pipelineJob"],b);const O=h(t,["satisfiesPzi"]);O!=null&&m(e,["satisfiesPzi"],O);const U=h(t,["satisfiesPzs"]);U!=null&&m(e,["satisfiesPzs"],U);const j=h(t,["serviceAccount"]);j!=null&&m(e,["serviceAccount"],j);const F=h(t,["tunedModelDisplayName"]);return F!=null&&m(e,["tunedModelDisplayName"],F),e}function EM(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>mm(i))),m(e,["tuningJobs"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SM extends Li{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Xc(Ri.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:am.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=fM(e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>mm(g))}else{const f=aM(e);return c=We("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>m2(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=hM(e);return c=We("tuningJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const y=EM(g),_=new gy;return Object.assign(_,y),_})}else{const f=iM(e);return c=We("tunedModels",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const y=yM(g),_=new gy;return Object.assign(_,y),_})}}async tuneInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=xM(e);return i=We("tuningJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>mm(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=uM(e);return i=We("tunedModels",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>_M(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CM{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const bM=1024*1024*8,AM=3,kM=1e3,NM=2,Nh="x-goog-upload-status";async function RM(t,e,n){var r,a,i;let l=0,c=0,d=new sm(new Response),f="upload";for(l=t.size;c<l;){const y=Math.min(bM,l-c),_=t.slice(c,c+y);c+y>=l&&(f+=", finalize");let w=0,E=kM;for(;w<AM&&(d=await n.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(c),"Content-Length":String(y)}}}),!(!((r=d==null?void 0:d.headers)===null||r===void 0)&&r[Nh]));)w++,await MM(E),E=E*NM;if(c+=y,((a=d==null?void 0:d.headers)===null||a===void 0?void 0:a[Nh])!=="active")break;if(l<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const g=await(d==null?void 0:d.json());if(((i=d==null?void 0:d.headers)===null||i===void 0?void 0:i[Nh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return g.file}async function DM(t){return{size:t.size,type:t.type}}function MM(t){return new Promise(e=>setTimeout(e,t))}class IM{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await RM(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await DM(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FM{create(e,n,r){return new OM(e,n,r)}}class OM{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Gy="x-goog-api-key";class LM{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(Gy)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Gy,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const PM="gl-node/";class UM{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=Db(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const a=new LM(this.apiKey);this.apiClient=new Z5({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:PM+"web",uploader:new IM,downloader:new CM}),this.models=new gD(this.apiClient),this.live=new fD(this.apiClient,a,new FM),this.batches=new sk(this.apiClient),this.chats=new c4(this.models,this.apiClient),this.caches=new i4(this.apiClient),this.files=new w4(this.apiClient),this.operations=new AD(this.apiClient),this.authTokens=new rM(this.apiClient),this.tunings=new SM(this.apiClient)}}const wa="gemini-2.5-flash-preview-04-17";let tn=null;const $y=t=>{if(!t){tn=null;return}try{tn=new UM({apiKey:t})}catch(e){console.error("Failed to initialize Gemini AI:",e),tn=null}},Pi=t=>{const e=n=>{const{position:r,extendedDetails:a,...i}=n,l={...i};if(a){const{reportDeck:c,attachments:d,subSteps:f,decisions:g,...y}=a,_={...y};c&&c.slides.length>0&&(_.reportDeckExists=!0,_.reportDeckSlideCount=c.slides.length),d&&d.length>0&&(_.attachments=d.map(w=>({id:w.id,name:w.name,type:w.type}))),f&&f.length>0&&(_.subSteps=f.map(w=>{const{position:E,attachments:S,actionItems:C,...R}=w,k={...R};return S&&S.length>0&&(k.attachments=S.map(b=>({id:b.id,name:b.name,type:b.type}))),C&&C.length>0&&(k.actionItems=C.map(b=>{const{report:O,...U}=b,j={...U};if(O){const{attachments:F,...K}=O,P={...K};F&&F.length>0&&(P.attachments=F.map(ne=>({id:ne.id,name:ne.name,type:ne.type}))),j.report=P}return j})),k})),l.extendedDetails=_}return l};return Array.isArray(t)?t.map(e):e(t)},fd=t=>({...t,slides:t.slides.map(e=>{if(e.isLocked)return{id:e.id,isLocked:!0,summary:`Locked Slide: Contains ${e.elements.length} elements. Content is preserved and must not be changed.`,elements:[]};const{elements:n,...r}=e;return{...r,elements:n.map(a=>{var i;if(a.type==="flowchart"&&((i=a.data)!=null&&i.subSteps)){const l=a;return{...l,data:{subStepCount:l.data.subSteps.length,subSteps:`[Sub-step data omitted for brevity, count: ${l.data.subSteps.length}]`}}}return a})}})}),BM=t=>{const e=/"dependencies"\s*:\s*\[([\s\S]*?)\]/g;return t.replace(e,(n,r)=>{const a=r.match(/"[^"]*"/g);return`"dependencies": [${a?a.join(", "):""}]`})},Ba=t=>{let e=t.trim();const n=/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s,r=e.match(n);if(r&&r[1]&&(e=r[1].trim()),e=BM(e),e=e.replace(/"((?:\\.|[^"\\])*)"/g,(a,i)=>`"${i.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}"`),!r){const a=e.indexOf("{"),i=e.indexOf("[");if(a===-1&&i===-1)throw console.error("No JSON object or array found in the response string.",t),new Error(`AI response did not contain a valid JSON structure. Raw response: ${t.substring(0,500)}...`);const l=a===-1?i:i===-1?a:Math.min(a,i),c=e.lastIndexOf("}"),d=e.lastIndexOf("]"),f=Math.max(c,d);l>-1&&f>l&&(e=e.substring(l,f+1))}try{return JSON.parse(e)}catch(a){throw console.error("Failed to parse JSON response:",a,`
Original text:`,t,`
Processed string:`,e),new Error(`Failed to parse AI response as JSON. Raw response: ${t.substring(0,500)}...`)}},Ea=(t,e)=>{console.error(`Error in Gemini API call during ${e}:`,t);let n=`AIとの通信中に不明なエラーが発生しました (${e})。`;if(t instanceof Error){const r=t.message.toLowerCase();r.includes("api key not valid")||r.includes("api key is invalid")?n="APIキーが無効です。キーを確認して再度設定してください。(API key not valid. Please pass a valid API key.)":r.includes("quota")?n="API利用上限に達しました。Google AI Platformのプランと請求情報を確認してください。(You have exceeded your API quota.)":n=`AIとの通信に失敗しました (${e}): ${t.message}`}throw new Error(n)},jM=async(t,e)=>{if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
    You are an expert project planner. Your task is to break down a high-level project goal into a sequence of actionable tasks.
    CONTEXT:
    - Project Goal: "${t}"
    - Target Completion Date: "${e}"
    INSTRUCTIONS:
    1.  Generate a sequence of 3 to 7 high-level, actionable tasks.
    2.  Provide a concise title (max 10 words) and a brief description (1-2 sentences) for each.
    3.  Your response MUST be a single, valid JSON array of objects. Do NOT include any explanations or markdown fences.
    4.  The language of the output should match the language of the input goal.
    5.  Each object MUST have this structure: { "id": "unique_string_id", "title": "Task Title", "description": "Task Description" }
  `;try{const r=await tn.models.generateContent({model:wa,contents:n,config:{responseMimeType:"application/json"}}),a=Ba(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.id||!i.title||!i.description))throw new Error("AI returned an unexpected format for project tasks.");return a}catch(r){Ea(r,"project plan generation")}},VM=async t=>{var n;if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const e=`
    You are a project management expert. Analyze the given task and propose a list of concrete next steps to accomplish it.
    CONTEXT:
    - Task Title: "${t.title}"
    - Task Description: "${t.description}"
    - Required Resources: "${((n=t.extendedDetails)==null?void 0:n.resources)||"Not specified"}"
    INSTRUCTIONS:
    1.  Generate a list of 3 to 6 actionable proposals (sub-steps).
    2.  Each proposal must have a concise 'title' and a 'description'.
    3.  Focus on breaking down the main task into logical phases or components.
    4.  Your response MUST be a single, valid JSON array of objects. Do not include any explanations.
    5.  The language must match the input task language.
    6.  The JSON structure for each item must be: { "title": "...", "description": "..." }
  `;try{const r=await tn.models.generateContent({model:wa,contents:e,config:{responseMimeType:"application/json"}}),a=Ba(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.title||!i.description))throw new Error("AI returned an unexpected format for step proposals.");if(a.length===0)throw new Error("AI did not generate any proposals. The task might be too abstract.");return a}catch(r){Ea(r,"step proposal generation")}},HM=async(t,e)=>{if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
        You are a senior project analyst AI. Your task is to intelligently update a list of critical project decisions based on the latest task data. You will merge new findings with an existing list.

        CONTEXT:
        - Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Pi(t))}
        - Existing Decisions List: ${JSON.stringify(e)}
        - Today's Date: ${new Date().toISOString().split("T")[0]}

        INSTRUCTIONS:
        1.  **Analyze Task Data**: Holistically review the 'Full Task Data' to understand the current state, including sub-steps, action items, and notes.
        2.  **Review Existing Decisions**: Go through each item in the 'Existing Decisions List'.
        3.  **Merge and Update**:
            *   **For each existing decision**: Check if the latest task data provides new information.
                *   If an 'undecided' item now has a clear answer in the task data, update its 'status' to 'decided', fill in the 'decision' and 'reasoning', and set the 'date'.
                *   You may also refine the 'question' or 'reasoning' of existing items if the new data provides more clarity.
                *   Keep the original 'id' for all existing items.
            *   **Identify New Decisions**: Look for any *new* critical questions or decision points in the task data that are NOT present in the existing list.
            *   For each new decision you find, create a new decision object.
        4.  **Construct Final List**: Your output MUST be a single JSON array containing the complete, merged list of decisions. This list must include:
            *   All the original decisions, updated as necessary.
            *   All the newly identified decisions.
        5.  **JSON Structure**: Every object in the output array MUST strictly follow this structure. For new items, you MUST set the 'id' field to 'NEW'. For existing items, you MUST preserve their original 'id'.
            {
              "id": "string (original ID or 'NEW' for new items)",
              "question": "The question that needs a decision.",
              "decision": "The final outcome (string, or empty string for 'undecided').",
              "reasoning": "Justification for the decision, or explanation of importance for 'undecided'.",
              "date": "YYYY-MM-DD (string, or empty string for 'undecided').",
              "status": "'decided' or 'undecided'."
            }
        6.  **Language and Format**: The output language must match the input task language. The response must be only the JSON array, without any markdown or explanations.
    `;try{const r=await tn.models.generateContent({model:wa,contents:n,config:{responseMimeType:"application/json"}}),a=Ba(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.question||!i.status||!i.id))throw new Error("AI returned an unexpected format for decisions. Expected fields: id, question, status.");return a}catch(r){Ea(r,"decision generation")}},GM=async(t,e,n)=>{if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a presentation designer and project analyst. Your task is to update a project status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Updated Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Pi(e))}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(fd(t))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked), REGENERATE their content from scratch based on the 'updatedTaskData'.
      3.  This includes regenerating 'flowchart' slides to reflect the latest sub-step data.
      4.  **ACTION ITEM FOCUS**: When regenerating, pay close attention to the progress and reports within each sub-step's 'actionItems'.
      5.  The final output MUST be a single, valid JSON object representing the complete slide deck, with all slides (locked and regenerated) in their original order.
      6.  Follow the same JSON structure and rules as the initial generation.
    `;try{const a=await tn.models.generateContent({model:wa,contents:r,config:{responseMimeType:"application/json"}}),i=Ba(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the regenerated slide deck.");return i}catch(a){Ea(a,"slide deck regeneration")}},$M=async t=>{if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const e=`
        You are an expert presentation designer. The following JSON represents a slide deck.
        Analyze its content and structure. Your task is to improve the layout, wording, and visual hierarchy for maximum clarity and impact.
        You can rephrase text for conciseness, change element positions and sizes, and adjust font properties. Do not change element types or IDs.
        Return the updated slide deck as a valid JSON object with the exact same structure as the input. Do not use markdown.
        CRITICAL: Textbox elements use a "content" field, NOT a "text" field.
        
        Input Deck (pruned for brevity):
        ${JSON.stringify(fd(t))}
    `;try{const n=await tn.models.generateContent({model:wa,contents:e,config:{responseMimeType:"application/json"}}),r=Ba(n.text);if(!r||!Array.isArray(r.slides))throw new Error("AI returned an invalid format for the optimized slide deck.");return r}catch(n){Ea(n,"slide layout optimization")}},zM=async(t,e,n)=>{if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a senior project manager AI. Your task is to conduct a holistic health check of the entire project.
      CONTEXT:
      - Overall Project Goal: "${e}"
      - Final Target Date: "${n}"
      - Current Date: "${new Date().toISOString().split("T")[0]}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Pi(t),null,2)}

      INSTRUCTIONS:
      1.  **Holistic Analysis**: Review ALL provided data. Compare task/sub-step due dates with the current date. Analyze dependencies, blockers, and the completion rate of action items.
      2.  **Determine Overall Status**: Categorize the project's health as 'On Track', 'At Risk', or 'Off Track'.
      3.  **Identify Positives**: List 2-3 key accomplishments or areas that are progressing well.
      4.  **Identify Concerns**: List the most critical risks or issues. For each, explain WHY it's a concern (e.g., "Task 'X' is 2 weeks overdue and blocking 3 other tasks"). Note the related task IDs.
      5.  **Propose Solutions**: For each major concern, provide concrete, actionable suggestions for improvement. (e.g., "Re-allocate resources from Task Y to Task X", "Hold a risk mitigation meeting for Z").
      6.  **Summarize**: Write a concise, executive-level summary of the project's current state.
      7.  **JSON Output**: Your response MUST be a single, valid JSON object following the ProjectHealthReport structure. Do not include markdown or explanations.
      8.  **The output language MUST be Japanese.**

      JSON Structure to follow:
      {
        "overallStatus": "'On Track' | 'At Risk' | 'Off Track'",
        "summary": "string",
        "positivePoints": ["string"],
        "areasOfConcern": [{ "description": "string", "relatedTaskIds": ["string"] }],
        "suggestions": ["string"]
      }
    `;try{const a=await tn.models.generateContent({model:wa,contents:r,config:{responseMimeType:"application/json"}}),i=Ba(a.text);if(!i||!i.overallStatus||!i.summary)throw new Error("AI returned an invalid format for the project health report.");return i}catch(a){Ea(a,"project health report generation")}},qM=async(t,e,n)=>{if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
        You are a senior project analyst AI. Your task is to create a comprehensive slide deck summarizing the ENTIRE project status.
        CONTEXT:
        - Overall Project Goal: "${e}"
        - Final Target Date: "${n}"
        - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Pi(t),null,2)}
        INSTRUCTIONS:
        1.  Synthesize a comprehensive slide deck (6-10 slides) summarizing the entire project.
        2.  The response MUST be a single, valid JSON object following the SlideDeck structure. Do NOT use markdown.
        3.  The output language MUST be Japanese.
        4.  **CRITICAL SYNTHESIS**:
            - **Title & Overview**: Create a title slide and a project overview slide.
            - **Task Summary & Flowchart**: For each major task in the 'tasks' array, create one or two summary slides. One slide should show a \`flowchart\` of its sub-steps if they exist, following the structure \`{"type": "flowchart", "data": {"subSteps": [...]}}\`. You MUST copy the task's specific \`subSteps\` array from the input JSON into the \`data.subSteps\` field. Another slide can summarize the task's status and outcomes.
            - **Key Project Decisions**: Analyze the 'decisions' data from all tasks. Create a dedicated slide titled "主要なプロジェクト決定事項". List the top 3-5 most important 'decided' items and their outcomes. Separately, list any critical 'undecided' questions that pose a risk to the project timeline or goals.
            - **Key Achievements & Risks**: Create dedicated slides for significant achievements and project-level risks.
            - **Conclusion**: A final slide summarizing the project's outlook and next steps.
        5.  Use the standard JSON format for slides and elements. Remember "content" for textboxes.
    `;try{const a=await tn.models.generateContent({model:wa,contents:r,config:{responseMimeType:"application/json"}}),i=Ba(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the project slide deck.");return i}catch(a){Ea(a,"project report deck generation")}},YM=async(t,e,n,r)=>{if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const a=`
      You are a senior project analyst AI. Your task is to update a project-wide status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Final Target Date: "${r}"
      - Updated Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Pi(e),null,2)}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(fd(t))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked slides), REGENERATE their content from scratch based on the updated project data.
      3.  This includes regenerating any 'flowchart' elements on unlocked slides to show the latest sub-step data.
      4.  Synthesize information across all tasks to provide a holistic project view in the regenerated slides.
      5.  The final output MUST be a single, valid JSON object for the complete slide deck, in the original slide order.
      6.  The output language MUST be Japanese.
    `;try{const i=await tn.models.generateContent({model:wa,contents:a,config:{responseMimeType:"application/json"}}),l=Ba(i.text);if(!l||!Array.isArray(l.slides))throw new Error("AI returned an invalid format for the regenerated project slide deck.");return l}catch(i){Ea(i,"project report deck regeneration")}},WM=t=>{const e=t.match(/^data:(.+);base64,(.*)$/);return e?{mimeType:e[1],data:e[2]}:null},p2=t=>{if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const e=[];for(const n of t){if(e.push({text:`
--- START OF SOURCE: ${n.name} ---
`}),n.type==="image"&&typeof n.content=="string"){const r=WM(n.content);r?e.push({inlineData:{mimeType:r.mimeType,data:r.data}}):e.push({text:"[Image data was invalid or in wrong format]"})}else if(n.type==="json"){const r=n.content.slides?fd(n.content):Pi(n.content);e.push({text:`Type: JSON Data
Content: ${JSON.stringify(r,null,2)}`})}else e.push({text:`Type: Text
Content: ${n.content}`});e.push({text:`
--- END OF SOURCE: ${n.name} ---
`})}return e},g2=async(t,e)=>{if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are a professional presentation designer AI. Your task is to create a slide deck based on a user's objective and provided source materials.

        **USER OBJECTIVE**: "${e}"

        **CRITICAL INSTRUCTIONS**:
        1.  **Strict JSON Output**: Your entire response MUST be a single, valid JSON object. Do NOT include any text, explanations, or markdown fences (like \`\`\`json\`) outside of the JSON object. Your response should start with \`{\` and end with \`}\`.
        2.  **Schema Adherence**: The JSON object MUST strictly conform to the following TypeScript interfaces for \`SlideDeck\`, \`Slide\`, and \`SlideElement\`.
            \`\`\`typescript
            // The main container for the presentation
            interface SlideDeck {
              slides: Slide[];
              theme?: 'light' | 'dark' | 'business';
            }

            // Represents a single slide in the deck
            interface Slide {
              id: string; // A unique identifier for the slide
              layout: 'title_slide' | 'title_and_content' | 'section_header' | 'two_column' | 'blank';
              elements: SlideElement[];
              isLocked?: boolean; // Must be false for all generated slides
              notes?: string; // Optional speaker notes
            }

            // Union type for all possible elements on a slide
            type SlideElement = TextboxElement | ImageElement | TableElement | ChartElement | FlowchartElement;

            // Base interface for all elements
            interface BaseSlideElement {
              id: string; // A unique identifier for the element
              type: 'textbox' | 'image' | 'table' | 'chart' | 'flowchart';
              position: { x: number; y: number; width: number; height: number; }; // Position in percentages
            }

            // For displaying text
            interface TextboxElement extends BaseSlideElement {
              type: 'textbox';
              content: string; // IMPORTANT: The text content field MUST be named "content".
            }
            
            // For displaying an image from the source materials
            interface ImageElement extends BaseSlideElement {
              type: 'image';
              // You MUST find a relevant image from the source materials and reference its properties here.
              // These IDs must correspond to actual data in the sources provided.
              subStepId: string;
              actionItemId: string; 
              attachmentId: string;
            }

            // For displaying a flowchart of sub-steps
            interface FlowchartElement extends BaseSlideElement {
                type: 'flowchart';
                // You MUST copy the entire 'subSteps' array from the source task data into this field.
                data: {
                    subSteps: any[]; 
                };
            }
            \`\`\`
        3.  **Content Synthesis**:
            *   Analyze ALL provided source materials to create a coherent 4-7 slide presentation that directly addresses the user's objective.
            *   If image sources are provided, you MUST incorporate them into the slides using the 'image' element type.
            *   Do not just copy-paste. Interpret, summarize, and visualize the information effectively.
        4.  **Language**: The output language MUST be Japanese.
        5.  **IDs**: Generate unique string IDs for all 'id' fields in slides and elements.

        **SOURCE MATERIALS FOLLOW**:
    `},...p2(t)];r.push({text:`
Reminder: Create the slide deck now based on the objective and all the sources provided above. The response must be only the JSON object.`});try{const a=await tn.models.generateContent({model:wa,contents:{parts:r},config:{responseMimeType:"application/json"}}),i=Ba(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the custom slide deck.");return i}catch(a){Ea(a,"custom slide deck generation")}},JM=async(t,e)=>{if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are an expert project analyst. Your task is to write a text-based report based on a specific user objective and a collection of source materials.
        USER OBJECTIVE:
        "${e}"
        INSTRUCTIONS:
        1.  Synthesize the information from ALL provided source materials to create a coherent and insightful report that directly addresses the user's objective.
        2.  Do not simply copy-paste data. Interpret and summarize the information in a clear, professional manner.
        3.  Format the output using Markdown for readability (e.g., use headings, bullet points, bold text).
        4.  If image sources are provided, reference them by name in your report (e.g., "(see image: 'chart.png')"). Do not try to embed them.
        5.  The language of the output should be Japanese.
        6.  Your response MUST be only the text report. Do not include any other explanations.
        SOURCE MATERIALS FOLLOW:
    `},...p2(t)];r.push({text:`
Reminder: Write the report now based on the objective and all the sources provided above. The response must be only the text report.`});try{return(await tn.models.generateContent({model:wa,contents:{parts:r}})).text}catch(a){Ea(a,"custom text report generation")}},zy=async(t,e,n)=>{if(!tn)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a project management assistant AI. Your task is to convert a project structure into data for a Gantt chart.
      CONTEXT:
      - Project Goal: "${e}"
      - Project Start Date: "${new Date().toISOString().split("T")[0]}"
      - Project Target End Date: "${n}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Pi(t),null,2)}

      INSTRUCTIONS:
      1.  Create a flat list of items for the Gantt chart. Include every ProjectTask, every SubStep, and every ActionItem from all tasks.
      2.  For each item, generate a JSON object with this exact structure:
          { "id": "string", "name": "string", "start": "YYYY-MM-DD", "end": "YYYY-MM-DD", "progress": number, "dependencies": ["string"], "type": "'task' | 'substep' | 'actionitem'", "parentId": "string | null" }
      3.  **Date Estimation**:
          - The project must fit between the start and target dates.
          - Use an item's \`dueDate\` as its 'end' date if available for tasks and sub-steps.
          - Estimate 'start' and 'end' dates logically. An item must start after its dependencies end.
          - For 'actionitem', estimate a short duration (e.g., 1-2 days) within the parent sub-step's timeframe.
      4.  **Progress Calculation**:
          - For a 'task': 'Completed' is 100, 'Not Started' is 0. For 'In Progress' or 'Blocked', average the progress of its sub-steps. If no sub-steps, 'In Progress' is 50.
          - For a 'substep': Calculate progress from its \`actionItems\` (% of completed items). If no action items, use its \`status\`: 'Completed' is 100, 'In Progress' is 50, 'Not Started' is 0.
          - For an 'actionitem': 'completed: true' is 100, 'completed: false' is 0.
      5.  **Dependencies & Parent ID**:
          - **Rule**: The 'dependencies' array models the sequential workflow. A dependency can ONLY exist between items of the SAME \`type\` AND with the SAME \`parentId\`.
          - **Tasks**: A task's 'parentId' is ALWAYS null. Use \`nextTaskIds\` to establish dependencies between tasks.
          - **Sub-steps**: A sub-step's 'parentId' MUST BE the ID of its parent ProjectTask. Use \`nextSubStepIds\` to establish dependencies ONLY between sub-steps within the same task.
          - **Action Items**: An action item's 'parentId' MUST BE the ID of its parent SubStep. Create sequential dependencies ONLY between action items within the same sub-step (item 2 depends on item 1, etc.).
          - **CRITICAL**: Do NOT create dependencies across different parents (e.g., from a sub-step in Task A to one in Task B) or across different types (e.g., from a task to a sub-step).
      6.  Your response MUST be a single, valid JSON array of GanttItem objects. Do not use markdown.
    `;try{const a=await tn.models.generateContent({model:wa,contents:r,config:{responseMimeType:"application/json"}}),i=Ba(a.text);if(!i||!Array.isArray(i))throw new Error("AI returned an invalid format for the Gantt chart data.");return i}catch(a){Ea(a,"Gantt chart data generation")}},KM="modulepreload",XM=function(t){return"/"+t},qy={},Zc=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){let l=function(f){return Promise.all(f.map(g=>Promise.resolve(g).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=l(n.map(f=>{if(f=XM(f),f in qy)return;qy[f]=!0;const g=f.endsWith(".css"),y=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${y}`))return;const _=document.createElement("link");if(_.rel=g?"stylesheet":KM,g||(_.as="script"),_.crossOrigin="",_.href=f,d&&_.setAttribute("nonce",d),document.head.appendChild(_),g)return new Promise((w,E)=>{_.addEventListener("load",w),_.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},ZM=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Zc(async()=>{const{default:r}=await Promise.resolve().then(()=>cl);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Gm extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class QM extends Gm{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Yy extends Gm{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Wy extends Gm{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var pm;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(pm||(pm={}));var eI=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class tI{constructor(e,{headers:n={},customFetch:r,region:a=pm.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=ZM(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return eI(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:l}=n;let c={},{region:d}=n;d||(d=this.region);const f=new URL(`${this.url}/${e}`);d&&d!=="any"&&(c["x-region"]=d,f.searchParams.set("forceFunctionRegion",d));let g;l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",g=l):typeof l=="string"?(c["Content-Type"]="text/plain",g=l):typeof FormData<"u"&&l instanceof FormData?g=l:(c["Content-Type"]="application/json",g=JSON.stringify(l)));const y=yield this.fetch(f.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:g}).catch(S=>{throw new QM(S)}),_=y.headers.get("x-relay-error");if(_&&_==="true")throw new Yy(y);if(!y.ok)throw new Wy(y);let w=((r=y.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),E;return w==="application/json"?E=yield y.json():w==="application/octet-stream"?E=yield y.blob():w==="text/event-stream"?E=y:w==="multipart/form-data"?E=yield y.formData():E=yield y.text(),{data:E,error:null,response:y}}catch(a){return{data:null,error:a,response:a instanceof Wy||a instanceof Yy?a.context:void 0}}})}}var Bn={},Ao={},ko={},No={},Ro={},Do={},nI=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},el=nI();const rI=el.fetch,x2=el.fetch.bind(el),v2=el.Headers,aI=el.Request,sI=el.Response,cl=Object.freeze(Object.defineProperty({__proto__:null,Headers:v2,Request:aI,Response:sI,default:x2,fetch:rI},Symbol.toStringTag,{value:"Module"})),iI=UC(cl);var yf={},Jy;function y2(){if(Jy)return yf;Jy=1,Object.defineProperty(yf,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return yf.default=t,yf}var Ky;function _2(){if(Ky)return Do;Ky=1;var t=Do&&Do.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Do,"__esModule",{value:!0});const e=t(iI),n=t(y2());class r{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,l){return this.headers=Object.assign({},this.headers),this.headers[i]=l,this}then(i,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var g,y,_;let w=null,E=null,S=null,C=f.status,R=f.statusText;if(f.ok){if(this.method!=="HEAD"){const U=await f.text();U===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?E=U:E=JSON.parse(U))}const b=(g=this.headers.Prefer)===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),O=(y=f.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");b&&O&&O.length>1&&(S=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(w={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,S=null,C=406,R="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const b=await f.text();try{w=JSON.parse(b),Array.isArray(w)&&f.status===404&&(E=[],w=null,C=200,R="OK")}catch{f.status===404&&b===""?(C=204,R="No Content"):w={message:b}}if(w&&this.isMaybeSingle&&(!((_=w==null?void 0:w.details)===null||_===void 0)&&_.includes("0 rows"))&&(w=null,C=200,R="OK"),w&&this.shouldThrowOnError)throw new n.default(w)}return{error:w,data:E,count:S,status:C,statusText:R}});return this.shouldThrowOnError||(d=d.catch(f=>{var g,y,_;return{error:{message:`${(g=f==null?void 0:f.name)!==null&&g!==void 0?g:"FetchError"}: ${f==null?void 0:f.message}`,details:`${(y=f==null?void 0:f.stack)!==null&&y!==void 0?y:""}`,hint:"",code:`${(_=f==null?void 0:f.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),d.then(i,l)}returns(){return this}overrideTypes(){return this}}return Do.default=r,Do}var Xy;function T2(){if(Xy)return Ro;Xy=1;var t=Ro&&Ro.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ro,"__esModule",{value:!0});const e=t(_2());class n extends e.default{select(a){let i=!1;const l=(a??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",l),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(a,{ascending:i=!0,nullsFirst:l,foreignTable:c,referencedTable:d=c}={}){const f=d?`${d}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${a}.${i?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:i,referencedTable:l=i}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${a}`),this}range(a,i,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"offset":`${c}.offset`,f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this.url.searchParams.set(f,`${i-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:a=!1,verbose:i=!1,settings:l=!1,buffers:c=!1,wal:d=!1,format:f="text"}={}){var g;const y=[a?"analyze":null,i?"verbose":null,l?"settings":null,c?"buffers":null,d?"wal":null].filter(Boolean).join("|"),_=(g=this.headers.Accept)!==null&&g!==void 0?g:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${f}; for="${_}"; options=${y};`,f==="json"?this:this}rollback(){var a;return((a=this.headers.Prefer)!==null&&a!==void 0?a:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Ro.default=n,Ro}var Zy;function $m(){if(Zy)return No;Zy=1;var t=No&&No.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(No,"__esModule",{value:!0});const e=t(T2());class n extends e.default{eq(a,i){return this.url.searchParams.append(a,`eq.${i}`),this}neq(a,i){return this.url.searchParams.append(a,`neq.${i}`),this}gt(a,i){return this.url.searchParams.append(a,`gt.${i}`),this}gte(a,i){return this.url.searchParams.append(a,`gte.${i}`),this}lt(a,i){return this.url.searchParams.append(a,`lt.${i}`),this}lte(a,i){return this.url.searchParams.append(a,`lte.${i}`),this}like(a,i){return this.url.searchParams.append(a,`like.${i}`),this}likeAllOf(a,i){return this.url.searchParams.append(a,`like(all).{${i.join(",")}}`),this}likeAnyOf(a,i){return this.url.searchParams.append(a,`like(any).{${i.join(",")}}`),this}ilike(a,i){return this.url.searchParams.append(a,`ilike.${i}`),this}ilikeAllOf(a,i){return this.url.searchParams.append(a,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(a,i){return this.url.searchParams.append(a,`ilike(any).{${i.join(",")}}`),this}is(a,i){return this.url.searchParams.append(a,`is.${i}`),this}in(a,i){const l=Array.from(new Set(i)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cs.{${i.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(i)}`),this}containedBy(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cd.{${i.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(i)}`),this}rangeGt(a,i){return this.url.searchParams.append(a,`sr.${i}`),this}rangeGte(a,i){return this.url.searchParams.append(a,`nxl.${i}`),this}rangeLt(a,i){return this.url.searchParams.append(a,`sl.${i}`),this}rangeLte(a,i){return this.url.searchParams.append(a,`nxr.${i}`),this}rangeAdjacent(a,i){return this.url.searchParams.append(a,`adj.${i}`),this}overlaps(a,i){return typeof i=="string"?this.url.searchParams.append(a,`ov.${i}`):this.url.searchParams.append(a,`ov.{${i.join(",")}}`),this}textSearch(a,i,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const f=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${d}fts${f}.${i}`),this}match(a){return Object.entries(a).forEach(([i,l])=>{this.url.searchParams.append(i,`eq.${l}`)}),this}not(a,i,l){return this.url.searchParams.append(a,`not.${i}.${l}`),this}or(a,{foreignTable:i,referencedTable:l=i}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,i,l){return this.url.searchParams.append(a,`${i}.${l}`),this}}return No.default=n,No}var Qy;function w2(){if(Qy)return ko;Qy=1;var t=ko&&ko.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ko,"__esModule",{value:!0});const e=t($m());class n{constructor(a,{headers:i={},schema:l,fetch:c}){this.url=a,this.headers=i,this.schema=l,this.fetch=c}select(a,{head:i=!1,count:l}={}){const c=i?"HEAD":"GET";let d=!1;const f=(a??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",f),l&&(this.headers.Prefer=`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(a,{count:i,defaultToNull:l=!0}={}){const c="POST",d=[];if(this.headers.Prefer&&d.push(this.headers.Prefer),i&&d.push(`count=${i}`),l||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(a)){const f=a.reduce((g,y)=>g.concat(Object.keys(y)),[]);if(f.length>0){const g=[...new Set(f)].map(y=>`"${y}"`);this.url.searchParams.set("columns",g.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}upsert(a,{onConflict:i,ignoreDuplicates:l=!1,count:c,defaultToNull:d=!0}={}){const f="POST",g=[`resolution=${l?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&g.push(this.headers.Prefer),c&&g.push(`count=${c}`),d||g.push("missing=default"),this.headers.Prefer=g.join(","),Array.isArray(a)){const y=a.reduce((_,w)=>_.concat(Object.keys(w)),[]);if(y.length>0){const _=[...new Set(y)].map(w=>`"${w}"`);this.url.searchParams.set("columns",_.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}update(a,{count:i}={}){const l="PATCH",c=[];return this.headers.Prefer&&c.push(this.headers.Prefer),i&&c.push(`count=${i}`),this.headers.Prefer=c.join(","),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}delete({count:a}={}){const i="DELETE",l=[];return a&&l.push(`count=${a}`),this.headers.Prefer&&l.unshift(this.headers.Prefer),this.headers.Prefer=l.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return ko.default=n,ko}var uc={},fc={},e_;function oI(){return e_||(e_=1,Object.defineProperty(fc,"__esModule",{value:!0}),fc.version=void 0,fc.version="0.0.0-automated"),fc}var t_;function lI(){if(t_)return uc;t_=1,Object.defineProperty(uc,"__esModule",{value:!0}),uc.DEFAULT_HEADERS=void 0;const t=oI();return uc.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},uc}var n_;function cI(){if(n_)return Ao;n_=1;var t=Ao&&Ao.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ao,"__esModule",{value:!0});const e=t(w2()),n=t($m()),r=lI();class a{constructor(l,{headers:c={},schema:d,fetch:f}={}){this.url=l,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),c),this.schemaName=d,this.fetch=f}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new a(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:f=!1,count:g}={}){let y;const _=new URL(`${this.url}/rpc/${l}`);let w;d||f?(y=d?"HEAD":"GET",Object.entries(c).filter(([S,C])=>C!==void 0).map(([S,C])=>[S,Array.isArray(C)?`{${C.join(",")}}`:`${C}`]).forEach(([S,C])=>{_.searchParams.append(S,C)})):(y="POST",w=c);const E=Object.assign({},this.headers);return g&&(E.Prefer=`count=${g}`),new n.default({method:y,url:_,headers:E,schema:this.schemaName,body:w,fetch:this.fetch,allowEmpty:!1})}}return Ao.default=a,Ao}var r_;function uI(){if(r_)return Bn;r_=1;var t=Bn&&Bn.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.PostgrestError=Bn.PostgrestBuilder=Bn.PostgrestTransformBuilder=Bn.PostgrestFilterBuilder=Bn.PostgrestQueryBuilder=Bn.PostgrestClient=void 0;const e=t(cI());Bn.PostgrestClient=e.default;const n=t(w2());Bn.PostgrestQueryBuilder=n.default;const r=t($m());Bn.PostgrestFilterBuilder=r.default;const a=t(T2());Bn.PostgrestTransformBuilder=a.default;const i=t(_2());Bn.PostgrestBuilder=i.default;const l=t(y2());return Bn.PostgrestError=l.default,Bn.default={PostgrestClient:e.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:i.default,PostgrestError:l.default},Bn}var fI=uI();const dI=Om(fI),{PostgrestClient:hI,PostgrestQueryBuilder:$V,PostgrestFilterBuilder:zV,PostgrestTransformBuilder:qV,PostgrestBuilder:YV,PostgrestError:WV}=dI;function mI(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const pI=mI(),gI="2.11.15",xI=`realtime-js/${gI}`,vI="1.0.0",E2=1e4,yI=1e3;var Tc;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Tc||(Tc={}));var er;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(er||(er={}));var ga;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ga||(ga={}));var gm;(function(t){t.websocket="websocket"})(gm||(gm={}));var wi;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(wi||(wi={}));class _I{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const a=n.getUint8(1),i=n.getUint8(2);let l=this.HEADER_LENGTH+2;const c=r.decode(e.slice(l,l+a));l=l+a;const d=r.decode(e.slice(l,l+i));l=l+i;const f=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{ref:null,topic:c,event:d,payload:f}}}class S2{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Qt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Qt||(Qt={}));const a_=(t,e,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,l)=>(i[l]=TI(l,t,e,a),i),{})},TI=(t,e,n,r)=>{const a=e.find(c=>c.name===t),i=a==null?void 0:a.type,l=n[t];return i&&!r.includes(i)?C2(i,l):xm(l)},C2=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return CI(e,n)}switch(t){case Qt.bool:return wI(e);case Qt.float4:case Qt.float8:case Qt.int2:case Qt.int4:case Qt.int8:case Qt.numeric:case Qt.oid:return EI(e);case Qt.json:case Qt.jsonb:return SI(e);case Qt.timestamp:return bI(e);case Qt.abstime:case Qt.date:case Qt.daterange:case Qt.int4range:case Qt.int8range:case Qt.money:case Qt.reltime:case Qt.text:case Qt.time:case Qt.timestamptz:case Qt.timetz:case Qt.tsrange:case Qt.tstzrange:return xm(e);default:return xm(e)}},xm=t=>t,wI=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},EI=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},SI=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},CI=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const l=t.slice(1,n);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(c=>C2(e,c))}return t},bI=t=>typeof t=="string"?t.replace(" ","T"):t,b2=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Rh{constructor(e,n,r={},a=E2){this.channel=e,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var s_;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(s_||(s_={}));class wc{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=wc.syncState(this.state,a,i,l),this.pendingDiffs.forEach(d=>{this.state=wc.syncDiff(this.state,d,i,l)}),this.pendingDiffs=[],c()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=wc.syncDiff(this.state,a,i,l),c())}),this.onJoin((a,i,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:l})}),this.onLeave((a,i,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,a){const i=this.cloneDeep(e),l=this.transformState(n),c={},d={};return this.map(i,(f,g)=>{l[f]||(d[f]=g)}),this.map(l,(f,g)=>{const y=i[f];if(y){const _=g.map(C=>C.presence_ref),w=y.map(C=>C.presence_ref),E=g.filter(C=>w.indexOf(C.presence_ref)<0),S=y.filter(C=>_.indexOf(C.presence_ref)<0);E.length>0&&(c[f]=E),S.length>0&&(d[f]=S)}else c[f]=g}),this.syncDiff(i,{joins:c,leaves:d},r,a)}static syncDiff(e,n,r,a){const{joins:i,leaves:l}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(c,d)=>{var f;const g=(f=e[c])!==null&&f!==void 0?f:[];if(e[c]=this.cloneDeep(d),g.length>0){const y=e[c].map(w=>w.presence_ref),_=g.filter(w=>y.indexOf(w.presence_ref)<0);e[c].unshift(..._)}r(c,g,d)}),this.map(l,(c,d)=>{let f=e[c];if(!f)return;const g=d.map(y=>y.presence_ref);f=f.filter(y=>g.indexOf(y.presence_ref)<0),e[c]=f,a(c,f,d),f.length===0&&delete e[c]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const a=e[r];return"metas"in a?n[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var i_;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(i_||(i_={}));var o_;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(o_||(o_={}));var rs;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(rs||(rs={}));class zm{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=er.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Rh(this,ga.join,this.params,this.timeout),this.rejoinTimer=new S2(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=er.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=er.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=er.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=er.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ga.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new wc(this),this.broadcastEndpointURL=b2(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==er.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params;this._onError(g=>e==null?void 0:e(rs.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(rs.CLOSED));const d={},f={broadcast:i,presence:l,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&a!==void 0?a:[],private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var y;if(this.socket.setAuth(),g===void 0){e==null||e(rs.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,w=(y=_==null?void 0:_.length)!==null&&y!==void 0?y:0,E=[];for(let S=0;S<w;S++){const C=_[S],{filter:{event:R,schema:k,table:b,filter:O}}=C,U=g&&g[S];if(U&&U.event===R&&U.schema===k&&U.table===b&&U.filter===O)E.push(Object.assign(Object.assign({},C),{id:U.id}));else{this.unsubscribe(),this.state=er.errored,e==null||e(rs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,e&&e(rs.SUBSCRIBED);return}}).receive("error",g=>{this.state=er.errored,e==null||e(rs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(rs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:l}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,c,d;const f=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),f.receive("ok",()=>i("ok")),f.receive("error",()=>i("error")),f.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=er.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ga.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new Rh(this,ga.leave,{},e),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),l=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(i),l}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Rh(this,e,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var a,i;const l=e.toLocaleLowerCase(),{close:c,error:d,leave:f,join:g}=ga;if(r&&[c,d,f,g].indexOf(l)>=0&&r!==this._joinRef())return;let _=this._onMessage(l,n,r);if(n&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(w=>{var E,S,C;return((E=w.filter)===null||E===void 0?void 0:E.event)==="*"||((C=(S=w.filter)===null||S===void 0?void 0:S.event)===null||C===void 0?void 0:C.toLocaleLowerCase())===l}).map(w=>w.callback(_,r)):(i=this.bindings[l])===null||i===void 0||i.filter(w=>{var E,S,C,R,k,b;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in w){const O=w.id,U=(E=w.filter)===null||E===void 0?void 0:E.event;return O&&((S=n.ids)===null||S===void 0?void 0:S.includes(O))&&(U==="*"||(U==null?void 0:U.toLocaleLowerCase())===((C=n.data)===null||C===void 0?void 0:C.type.toLocaleLowerCase()))}else{const O=(k=(R=w==null?void 0:w.filter)===null||R===void 0?void 0:R.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return O==="*"||O===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return w.type.toLocaleLowerCase()===l}).map(w=>{if(typeof _=="object"&&"ids"in _){const E=_.data,{schema:S,table:C,commit_timestamp:R,type:k,errors:b}=E;_=Object.assign(Object.assign({},{schema:S,table:C,commit_timestamp:R,eventType:k,new:{},old:{},errors:b}),this._getPayloadRecords(E))}w.callback(_,r)})}_isClosed(){return this.state===er.closed}_isJoined(){return this.state===er.joined}_isJoining(){return this.state===er.joining}_isLeaving(){return this.state===er.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const a=e.toLocaleLowerCase(),i={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&zm.isEqual(a.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ga.close,{},e)}_onError(e){this._on(ga.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=er.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=a_(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=a_(e.columns,e.old_record)),n}}const l_=()=>{},AI=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class kI{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=E2,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=l_,this.ref=0,this.logger=l_,this.conn=null,this.sendBuffer=[],this.serializer=new _I,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let l;return i?l=i:typeof fetch>"u"?l=(...c)=>Zc(async()=>{const{default:d}=await Promise.resolve().then(()=>cl);return{default:d}},void 0).then(({default:d})=>d(...c)):l=fetch,(...c)=>l(...c)},this.endPoint=`${e}/${gm.websocket}`,this.httpEndpoint=b2(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(i,l)=>l(JSON.stringify(i)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new S2(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=pI),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:vI}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Tc.connecting:return wi.Connecting;case Tc.open:return wi.Open;case Tc.closing:return wi.Closing;default:return wi.Closed}}isConnected(){return this.connectionState()===wi.Open}channel(e,n={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new zm(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:a,ref:i}=e,l=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${n} ${r} (${i})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:xI};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(ga.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(yI,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:a,payload:i,ref:l}=n;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${a} ${l&&"("+l+")"||""}`,i),Array.from(this.channels).filter(c=>c._isMember(r)).forEach(c=>c._trigger(a,i,l)),this.stateChangeCallbacks.message.forEach(c=>c(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(ga.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${r}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([AI],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class qm extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function jn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class NI extends qm{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class vm extends qm{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var RI=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const A2=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Zc(async()=>{const{default:r}=await Promise.resolve().then(()=>cl);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},DI=()=>RI(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Zc(()=>Promise.resolve().then(()=>cl),void 0)).Response:Response}),ym=t=>{if(Array.isArray(t))return t.map(n=>ym(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=ym(r)}),e};var Ui=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const Dh=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),MI=(t,e,n)=>Ui(void 0,void 0,void 0,function*(){const r=yield DI();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{e(new NI(Dh(a),t.status||500))}).catch(a=>{e(new vm(Dh(a),a))}):e(new vm(Dh(t),t))}),II=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function Qc(t,e,n,r,a,i){return Ui(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(n,II(e,r,a,i)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>MI(d,c,r))})})}function qf(t,e,n,r){return Ui(this,void 0,void 0,function*(){return Qc(t,"GET",e,n,r)})}function Vs(t,e,n,r,a){return Ui(this,void 0,void 0,function*(){return Qc(t,"POST",e,r,a,n)})}function FI(t,e,n,r,a){return Ui(this,void 0,void 0,function*(){return Qc(t,"PUT",e,r,a,n)})}function OI(t,e,n,r){return Ui(this,void 0,void 0,function*(){return Qc(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function k2(t,e,n,r,a){return Ui(this,void 0,void 0,function*(){return Qc(t,"DELETE",e,r,a,n)})}var Sr=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const LI={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},c_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class PI{constructor(e,n={},r,a){this.url=e,this.headers=n,this.bucketId=r,this.fetch=A2(a)}uploadOrUpdate(e,n,r,a){return Sr(this,void 0,void 0,function*(){try{let i;const l=Object.assign(Object.assign({},c_),a);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),d&&i.append("metadata",this.encodeMetadata(d)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",l.cacheControl),d&&i.append("metadata",this.encodeMetadata(d))):(i=r,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const f=this._removeEmptyFolders(n),g=this._getFinalPath(f),y=yield this.fetch(`${this.url}/object/${g}`,Object.assign({method:e,body:i,headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{})),_=yield y.json();return y.ok?{data:{path:f,id:_.Id,fullPath:_.Key},error:null}:{data:null,error:_}}catch(i){if(jn(i))return{data:null,error:i};throw i}})}upload(e,n,r){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,a){return Sr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),l=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",n);try{let d;const f=Object.assign({upsert:c_.upsert},a),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",f.cacheControl)):(d=r,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType);const y=yield this.fetch(c.toString(),{method:"PUT",body:d,headers:g}),_=yield y.json();return y.ok?{data:{path:i,fullPath:_.Key},error:null}:{data:null,error:_}}catch(d){if(jn(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,n){return Sr(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const i=yield Vs(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),l=new URL(this.url+i.url),c=l.searchParams.get("token");if(!c)throw new qm("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(r){if(jn(r))return{data:null,error:r};throw r}})}update(e,n,r){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Sr(this,void 0,void 0,function*(){try{return{data:yield Vs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(jn(a))return{data:null,error:a};throw a}})}copy(e,n,r){return Sr(this,void 0,void 0,function*(){try{return{data:{path:(yield Vs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(jn(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,r){return Sr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield Vs(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(a){if(jn(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,r){return Sr(this,void 0,void 0,function*(){try{const a=yield Vs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${i}`):null})),error:null}}catch(a){if(jn(a))return{data:null,error:a};throw a}})}download(e,n){return Sr(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),l=i?`?${i}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield qf(this.fetch,`${this.url}/${a}/${c}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(jn(c))return{data:null,error:c};throw c}})}info(e){return Sr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield qf(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:ym(r),error:null}}catch(r){if(jn(r))return{data:null,error:r};throw r}})}exists(e){return Sr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield OI(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(jn(r)&&r instanceof vm){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),a=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&a.push(i);const c=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});d!==""&&a.push(d);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${f}`)}}}remove(e){return Sr(this,void 0,void 0,function*(){try{return{data:yield k2(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(jn(n))return{data:null,error:n};throw n}})}list(e,n,r){return Sr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},LI),n),{prefix:e||""});return{data:yield Vs(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(jn(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const UI="2.7.1",BI={"X-Client-Info":`storage-js/${UI}`};var Mo=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class jI{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},BI),n),this.fetch=A2(r)}listBuckets(){return Mo(this,void 0,void 0,function*(){try{return{data:yield qf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(jn(e))return{data:null,error:e};throw e}})}getBucket(e){return Mo(this,void 0,void 0,function*(){try{return{data:yield qf(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(jn(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Mo(this,void 0,void 0,function*(){try{return{data:yield Vs(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(jn(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return Mo(this,void 0,void 0,function*(){try{return{data:yield FI(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(jn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Mo(this,void 0,void 0,function*(){try{return{data:yield Vs(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(jn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Mo(this,void 0,void 0,function*(){try{return{data:yield k2(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(jn(n))return{data:null,error:n};throw n}})}}class VI extends jI{constructor(e,n={},r){super(e,n,r)}from(e){return new PI(this.url,this.headers,e,this.fetch)}}const HI="2.50.3";let mc="";typeof Deno<"u"?mc="deno":typeof document<"u"?mc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?mc="react-native":mc="node";const GI={"X-Client-Info":`supabase-js-${mc}/${HI}`},$I={headers:GI},zI={schema:"public"},qI={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},YI={};var WI=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const JI=t=>{let e;return t?e=t:typeof fetch>"u"?e=x2:e=fetch,(...n)=>e(...n)},KI=()=>typeof Headers>"u"?v2:Headers,XI=(t,e,n)=>{const r=JI(n),a=KI();return(i,l)=>WI(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:t;let f=new a(l==null?void 0:l.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),r(i,Object.assign(Object.assign({},l),{headers:f}))})};var ZI=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};function QI(t){return t.endsWith("/")?t:t+"/"}function e6(t,e){var n,r;const{db:a,auth:i,realtime:l,global:c}=t,{db:d,auth:f,realtime:g,global:y}=e,_={db:Object.assign(Object.assign({},d),a),auth:Object.assign(Object.assign({},f),i),realtime:Object.assign(Object.assign({},g),l),global:Object.assign(Object.assign(Object.assign({},y),c),{headers:Object.assign(Object.assign({},(n=y==null?void 0:y.headers)!==null&&n!==void 0?n:{}),(r=c==null?void 0:c.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>ZI(this,void 0,void 0,function*(){return""})};return t.accessToken?_.accessToken=t.accessToken:delete _.accessToken,_}const N2="2.70.0",jo=30*1e3,_m=3,Mh=_m*jo,t6="http://localhost:9999",n6="supabase.auth.token",r6={"X-Client-Info":`gotrue-js/${N2}`},Tm="X-Supabase-Api-Version",R2={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},a6=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,s6=6e5;class Ym extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function ct(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class i6 extends Ym{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function o6(t){return ct(t)&&t.name==="AuthApiError"}class D2 extends Ym{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Qs extends Ym{constructor(e,n,r,a){super(e,r,a),this.name=n,this.status=r}}class Bs extends Qs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function l6(t){return ct(t)&&t.name==="AuthSessionMissingError"}class _f extends Qs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Tf extends Qs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class wf extends Qs{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function c6(t){return ct(t)&&t.name==="AuthImplicitGrantRedirectError"}class u_ extends Qs{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wm extends Qs{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Ih(t){return ct(t)&&t.name==="AuthRetryableFetchError"}class f_ extends Qs{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Ec extends Qs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Yf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),d_=` 	
\r=`.split(""),u6=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<d_.length;e+=1)t[d_[e].charCodeAt(0)]=-2;for(let e=0;e<Yf.length;e+=1)t[Yf[e].charCodeAt(0)]=e;return t})();function h_(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Yf[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Yf[r]),e.queuedBits-=6}}function M2(t,e,n){const r=u6[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function m_(t){const e=[],n=l=>{e.push(String.fromCodePoint(l))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=l=>{h6(l,r,n)};for(let l=0;l<t.length;l+=1)M2(t.charCodeAt(l),a,i);return e.join("")}function f6(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function d6(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}f6(r,e)}}function h6(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if((t>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function m6(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)M2(t.charCodeAt(a),n,r);return new Uint8Array(e)}function p6(t){const e=[];return d6(t,n=>e.push(n)),new Uint8Array(e)}function g6(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};return t.forEach(a=>h_(a,n,r)),h_(null,n,r),e.join("")}function x6(t){return Math.round(Date.now()/1e3)+t}function v6(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const pa=()=>typeof window<"u"&&typeof document<"u",_i={tested:!1,writable:!1},Sc=()=>{if(!pa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(_i.tested)return _i.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),_i.tested=!0,_i.writable=!0}catch{_i.tested=!0,_i.writable=!1}return _i.writable};function y6(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return n.searchParams.forEach((r,a)=>{e[a]=r}),e}const I2=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Zc(async()=>{const{default:r}=await Promise.resolve().then(()=>cl);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},_6=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",F2=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Ef=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Sf=async(t,e)=>{await t.removeItem(e)};class dd{constructor(){this.promise=new dd.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}dd.promiseConstructor=Promise;function Fh(t){const e=t.split(".");if(e.length!==3)throw new Ec("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!a6.test(e[r]))throw new Ec("JWT not in base64url format");return{header:JSON.parse(m_(e[0])),payload:JSON.parse(m_(e[1])),signature:m6(e[2]),raw:{header:e[0],payload:e[1]}}}async function T6(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function w6(t,e){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await t(i);if(!e(i,null,l)){r(l);return}}catch(l){if(!e(i,l)){a(l);return}}})()})}function E6(t){return("0"+t.toString(16)).substr(-2)}function S6(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let i=0;i<56;i++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,E6).join("")}async function C6(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function b6(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await C6(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Io(t,e,n=!1){const r=S6();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await F2(t,`${e}-code-verifier`,a);const i=await b6(r);return[i,r===i?"plain":"s256"]}const A6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function k6(t){const e=t.headers.get(Tm);if(!e||!e.match(A6))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function N6(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function R6(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const D6=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Fo(t){if(!D6.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var M6=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const Ti=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),I6=[502,503,504];async function p_(t){var e;if(!_6(t))throw new wm(Ti(t),0);if(I6.includes(t.status))throw new wm(Ti(t),t.status);let n;try{n=await t.json()}catch(i){throw new D2(Ti(i),i)}let r;const a=k6(t);if(a&&a.getTime()>=R2["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new f_(Ti(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Bs}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new f_(Ti(n),t.status,n.weak_password.reasons);throw new i6(Ti(n),t.status||500,r)}const F6=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function Et(t,e,n,r){var a;const i=Object.assign({},r==null?void 0:r.headers);i[Tm]||(i[Tm]=R2["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const l=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(l.redirect_to=r.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await O6(t,e,n+c,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(d):{data:Object.assign({},d),error:null}}async function O6(t,e,n,r,a,i){const l=F6(e,r,a,i);let c;try{c=await t(n,Object.assign({},l))}catch(d){throw console.error(d),new wm(Ti(d),0)}if(c.ok||await p_(c),r!=null&&r.noResolveJson)return c;try{return await c.json()}catch(d){await p_(d)}}function ns(t){var e;let n=null;B6(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=x6(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function g_(t){const e=ns(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Hs(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function L6(t){return{data:t,error:null}}function P6(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i}=t,l=M6(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function U6(t){return t}function B6(t){return t.access_token&&t.refresh_token&&t.expires_in}const Oh=["global","local","others"];var j6=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};class V6{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=I2(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=Oh[0]){if(Oh.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Oh.join(", ")}`);try{return await Et(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ct(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await Et(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Hs})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=j6(e,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await Et(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:P6,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ct(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Et(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Hs})}catch(n){if(ct(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,a,i,l,c,d;try{const f={nextPage:null,lastPage:0,total:0},g=await Et(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:U6});if(g.error)throw g.error;const y=await g.json(),_=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,w=(d=(c=g.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return w.length>0&&(w.forEach(E=>{const S=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(E.split(";")[1].split("=")[1]);f[`${C}Page`]=S}),f.total=parseInt(_)),{data:Object.assign(Object.assign({},y),f),error:null}}catch(f){if(ct(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){Fo(e);try{return await Et(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Hs})}catch(n){if(ct(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Fo(e);try{return await Et(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Hs})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Fo(e);try{return await Et(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Hs})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Fo(e.userId);try{const{data:n,error:r}=await Et(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Fo(e.userId),Fo(e.id);try{return{data:await Et(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ct(n))return{data:null,error:n};throw n}}}const H6={getItem:t=>Sc()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Sc()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Sc()&&globalThis.localStorage.removeItem(t)}};function x_(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function G6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Oo={debug:!!(globalThis&&Sc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class O2 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class $6 extends O2{}async function z6(t,e,n){Oo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Oo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){Oo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{Oo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw Oo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new $6(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Oo.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}G6();const q6={url:t6,storageKey:n6,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:r6,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function v_(t,e,n){return await n()}class Pc{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Pc.nextInstanceID,Pc.nextInstanceID+=1,this.instanceID>0&&pa()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},q6),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new V6({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=I2(a.fetch),this.lock=a.lock||v_,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:pa()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=z6:this.lock=v_,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:Sc()?this.storage=H6:(this.memoryStorage={},this.storage=x_(this.memoryStorage)):(this.memoryStorage={},this.storage=x_(this.memoryStorage)),pa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${N2}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=y6(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),pa()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),c6(i)){const d=(e=i.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ct(n)?{error:n}:{error:new D2("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,a;try{const i=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:ns}),{data:l,error:c}=i;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(i){if(ct(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,r,a;try{let i;if("email"in e){const{email:g,password:y,options:_}=e;let w=null,E=null;this.flowType==="pkce"&&([w,E]=await Io(this.storage,this.storageKey)),i=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:g,password:y,data:(n=_==null?void 0:_.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:w,code_challenge_method:E},xform:ns})}else if("phone"in e){const{phone:g,password:y,options:_}=e;i=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:y,data:(r=_==null?void 0:_.data)!==null&&r!==void 0?r:{},channel:(a=_==null?void 0:_.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:ns})}else throw new Tf("You must provide either an email or phone number and a password");const{data:l,error:c}=i;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(i){if(ct(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:l,options:c}=e;n=await Et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:g_})}else if("phone"in e){const{phone:i,password:l,options:c}=e;n=await Et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:g_})}else throw new Tf("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new _f}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,a,i,l,c,d,f,g,y,_,w;let E,S;if("message"in e)E=e.message,S=e.signature;else{const{chain:C,wallet:R,statement:k,options:b}=e;let O;if(pa())if(typeof R=="object")O=R;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))O=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=R}const U=new URL((n=b==null?void 0:b.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in O&&O.signIn){const j=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:U.host,uri:U.href}),k?{statement:k}:null));let F;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")F=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)F=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)E=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),S=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");E=[`${U.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${U.href}`,`Issued At: ${(a=(r=b==null?void 0:b.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((f=b==null?void 0:b.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((y=(g=b==null?void 0:b.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||y===void 0)&&y.length?["Resources",...b.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const j=await O.signMessage(new TextEncoder().encode(E),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=j}}try{const{data:C,error:R}=await Et(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:E,signature:g6(S)},!((_=e.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(w=e.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:ns});if(R)throw R;return!C||!C.session||!C.user?{data:{user:null,session:null},error:new _f}:(C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),{data:Object.assign({},C),error:R})}catch(C){if(ct(C))return{data:{user:null,session:null},error:C};throw C}}async _exchangeCodeForSession(e){const n=await Ef(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:i,error:l}=await Et(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ns});if(await Sf(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new _f}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:l})}catch(i){if(ct(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:a,access_token:i,nonce:l}=e,c=await Et(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ns}),{data:d,error:f}=c;return f?{data:{user:null,session:null},error:f}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new _f}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:f})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,a,i,l;try{if("email"in e){const{email:c,options:d}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await Io(this.storage,this.storageKey));const{error:y}=await Et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(r=d==null?void 0:d.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:y}}if("phone"in e){const{phone:c,options:d}=e,{data:f,error:g}=await Et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:g}}throw new Tf("You must provide either an email or phone number.")}catch(c){if(ct(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var n,r;try{let a,i;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:l,error:c}=await Et(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:ns});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,f=l.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(ct(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,r,a;try{let i=null,l=null;return this.flowType==="pkce"&&([i,l]=await Io(this.storage,this.storageKey)),await Et(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:L6})}catch(i){if(ct(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Bs;const{error:a}=await Et(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(ct(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:i}=e,{error:l}=await Et(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in e){const{phone:r,type:a,options:i}=e,{data:l,error:c}=await Et(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c}}throw new Tf("You must provide either an email or phone number and a type")}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Ef(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Mh:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let l=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,f,g)=>(!l&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,f,g))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Hs}):await this._useSession(async n=>{var r,a,i;const{data:l,error:c}=n;if(c)throw c;return!(!((r=l.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Bs}:await Et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Hs})})}catch(n){if(ct(n))return l6(n)&&(await this._removeSession(),await Sf(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new Bs;const l=a.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await Io(this.storage,this.storageKey));const{data:f,error:g}=await Et(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:Hs});if(g)throw g;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Bs;const n=Date.now()/1e3;let r=n,a=!0,i=null;const{payload:l}=Fh(e.access_token);if(l.exp&&(r=l.exp,a=r<=n),a){const{session:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;i={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(ct(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:l,error:c}=n;if(c)throw c;e=(r=l.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Bs;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!pa())throw new wf("No browser detected.");if(e.error||e.error_description||e.error_code)throw new wf(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new u_("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wf("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new u_("No code detected.");const{data:k,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:l,expires_in:c,expires_at:d,token_type:f}=e;if(!i||!c||!l||!f)throw new wf("No session defined in URL");const g=Math.round(Date.now()/1e3),y=parseInt(c);let _=g+y;d&&(_=parseInt(d));const w=_-g;w*1e3<=jo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${w}s, should have been closer to ${y}s`);const E=_-y;g-E>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",E,_,g):g-E<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",E,_,g);const{data:S,error:C}=await this._getUser(i);if(C)throw C;const R={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:y,expires_at:_,refresh_token:l,token_type:f,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:R,redirectType:e.type},error:null}}catch(r){if(ct(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Ef(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{error:i};const l=(r=a.session)===null||r===void 0?void 0:r.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(o6(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await Sf(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=v6(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,a;try{const{data:{session:i},error:l}=n;if(l)throw l;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await Io(this.storage,this.storageKey,!0));try{return await Et(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(ct(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(ct(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:a}=await this._useSession(async i=>{var l,c,d,f,g;const{data:y,error:_}=i;if(_)throw _;const w=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Et(this.fetch,"GET",w,{headers:this.headers,jwt:(g=(f=y.session)===null||f===void 0?void 0:f.access_token)!==null&&g!==void 0?g:void 0})});if(a)throw a;return pa()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ct(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:l}=n;if(l)throw l;return await Et(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await w6(async a=>(a>0&&await T6(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Et(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ns})),(a,i)=>{const l=200*Math.pow(2,a);return i&&Ih(i)&&Date.now()+l-r<jo})}catch(r){if(this._debug(n,"error",r),ct(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),pa()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Ef(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const a=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Mh;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${Mh}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),Ih(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Bs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new dd;const{data:i,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!i.session)throw new Bs;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={session:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(a,"error",i),ct(i)){const l={session:null,error:i};return Ih(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(l),l}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,n)}catch(d){i.push(d)}});if(await Promise.all(l),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await F2(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Sf(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&pa()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),jo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/jo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${jo}ms, refresh threshold is ${_m} ticks`),a<=_m&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof O2)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pa()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,l]=await Io(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(c.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await Et(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:l}=n;if(l)return{data:null,error:l};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:f}=await Et(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(e.factorType==="totp"&&(!((a=d==null?void 0:d.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{data:null,error:i};const{data:l,error:c}=await Et(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(n){if(ct(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await Et(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ct(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],a=r.filter(l=>l.factor_type==="totp"&&l.status==="verified"),i=r.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:r,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Fh(a.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(y=>y.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const g=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:g},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r||(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+s6>Date.now()))return r;const{data:a,error:i}=await Et(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new Ec("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),r=a.keys.find(l=>l.kid===e),!r)throw new Ec("No matching signing key found in JWKS");return r}async getClaims(e,n={keys:[]}){try{let r=e;if(!r){const{data:w,error:E}=await this.getSession();if(E||!w.session)return{data:null,error:E};r=w.session.access_token}const{header:a,payload:i,signature:l,raw:{header:c,payload:d}}=Fh(r);if(N6(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:w}=await this.getUser(r);if(w)throw w;return{data:{claims:i,header:a,signature:l},error:null}}const f=R6(a.alg),g=await this.fetchJwk(a.kid,n),y=await crypto.subtle.importKey("jwk",g,f,!0,["verify"]);if(!await crypto.subtle.verify(f,y,l,p6(`${c}.${d}`)))throw new Ec("Invalid JWT signature");return{data:{claims:i,header:a,signature:l},error:null}}catch(r){if(ct(r))return{data:null,error:r};throw r}}}Pc.nextInstanceID=0;const Y6=Pc;class W6 extends Y6{constructor(e){super(e)}}var J6=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(y){l(y)}}function d(g){try{f(r.throw(g))}catch(y){l(y)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class K6{constructor(e,n,r){var a,i,l;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const c=QI(e),d=new URL(c);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const f=`sb-${d.hostname.split(".")[0]}-auth-token`,g={db:zI,realtime:YI,auth:Object.assign(Object.assign({},qI),{storageKey:f}),global:$I},y=e6(r??{},g);this.storageKey=(a=y.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=y.global.headers)!==null&&i!==void 0?i:{},y.accessToken?(this.accessToken=y.accessToken,this.auth=new Proxy({},{get:(_,w)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(w)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=y.auth)!==null&&l!==void 0?l:{},this.headers,y.global.fetch),this.fetch=XI(n,this._getAccessToken.bind(this),y.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},y.realtime)),this.rest=new hI(new URL("rest/v1",d).href,{headers:this.headers,schema:y.db.schema,fetch:this.fetch}),y.accessToken||this._listenForAuthEvents()}get functions(){return new tI(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new VI(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return J6(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:i,flowType:l,lock:c,debug:d},f,g){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new W6({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),f),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,flowType:l,lock:c,debug:d,fetch:g,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new kI(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const X6=(t,e,n)=>new K6(t,e,n),Z6="https://krdtgpohsouzbklrwbxo.supabase.co",Q6="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtyZHRncG9oc291emJrbHJ3YnhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE4NzE2NDgsImV4cCI6MjA2NzQ0NzY0OH0.dOz2cdF-by1qbzvfaQQ3nLAwPJu4qT16uFoYNTouiOA",xa=X6(Z6,Q6);class Uc{static async getProjects(){const{data:e,error:n}=await xa.from("projects").select("*").order("updated_at",{ascending:!1});if(n)throw new Error(`プロジェクトの取得に失敗しました: ${n.message}`);return e.map(r=>({id:r.id,title:r.title,goal:r.goal,targetDate:r.target_date,tasks:r.tasks_data||[],ganttData:r.gantt_data,createdAt:r.created_at,updatedAt:r.updated_at}))}static async createProject(e,n,r,a=[],i){const{data:{user:l}}=await xa.auth.getUser();if(!l)throw new Error("ログインが必要です");const{data:c,error:d}=await xa.from("projects").insert({user_id:l.id,title:e,goal:n,target_date:r,tasks_data:a,gantt_data:i}).select().single();if(d)throw new Error(`プロジェクトの作成に失敗しました: ${d.message}`);return{id:c.id,title:c.title,goal:c.goal,targetDate:c.target_date,tasks:c.tasks_data||[],ganttData:c.gantt_data,createdAt:c.created_at,updatedAt:c.updated_at}}static async updateProject(e,n){const r={};n.title!==void 0&&(r.title=n.title),n.goal!==void 0&&(r.goal=n.goal),n.targetDate!==void 0&&(r.target_date=n.targetDate),n.tasks!==void 0&&(r.tasks_data=n.tasks),n.ganttData!==void 0&&(r.gantt_data=n.ganttData);const{data:a,error:i}=await xa.from("projects").update(r).eq("id",e).select().single();if(i)throw new Error(`プロジェクトの更新に失敗しました: ${i.message}`);return{id:a.id,title:a.title,goal:a.goal,targetDate:a.target_date,tasks:a.tasks_data||[],ganttData:a.gantt_data,createdAt:a.created_at,updatedAt:a.updated_at}}static async deleteProject(e){const{error:n}=await xa.from("projects").delete().eq("id",e);if(n)throw new Error(`プロジェクトの削除に失敗しました: ${n.message}`)}static async getProject(e){const{data:n,error:r}=await xa.from("projects").select("*").eq("id",e).single();if(r)throw new Error(`プロジェクトの取得に失敗しました: ${r.message}`);return{id:n.id,title:n.title,goal:n.goal,targetDate:n.target_date,tasks:n.tasks_data||[],ganttData:n.gantt_data,createdAt:n.created_at,updatedAt:n.updated_at}}}const Ar=({size:t="md",color:e="border-blue-500",text:n})=>{const r={sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"};return x.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[x.jsx("div",{className:`animate-spin rounded-full border-4 ${e} border-t-transparent ${r[t]}`}),n&&x.jsx("p",{className:"text-slate-600 text-sm",children:n})]})},Wm=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-3.75h.008v.008H12v-.008ZM12 15h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5v-.008ZM9.75 18.75h.008v.008H9.75v-.008ZM7.5 18.75h.008v.008H7.5v-.008ZM14.25 15h.008v.008H14.25v-.008ZM16.5 15h.008v.008H16.5v-.008ZM14.25 18.75h.008v.008H14.25v-.008ZM16.5 18.75h.008v.008H16.5v-.008Z"})}),Jm=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m12 12 4.243 4.243"})]}),eF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),tF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),Vr=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),L2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),P2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),tl=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),Km=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Pa=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),hd=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Cc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),Xm=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.354a15.055 15.055 0 0 1-3 0M12.75 4.5v-.75a.75.75 0 0 0-.75-.75h-.75a.75.75 0 0 0-.75.75v.75m0 0A2.25 2.25 0 0 0 9.75 6.75h4.5A2.25 2.25 0 0 0 12.75 4.5M12 18.75h.008v.008H12v-.008Z"})}),nl=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),nF=({title:t,...e})=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[t&&x.jsx("title",{children:t}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75V12m0 0H9.75M12 12h2.25m-2.25 0V9.75M12 12v2.25m0 0H9.75M12 14.25h2.25M12 6.75a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Zm0 0V3m0 3.75h.008v.008H12V6.75Zm-5.25 0H3.75m0 0V3m0 3.75h.008v.008H3.75V6.75Zm10.5 0h2.25m0 0V3m0 3.75h.008v.008H16.5V6.75Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),eu=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75h16.5v16.5H3.75V3.75Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3 6-6"})]}),md=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25-2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"})}),rF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),pd=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),Zm=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),aF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),sF=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113A.375.375 0 0 1 9.75 15.113V8.887c0-.286.307-.466.557-.332l5.603 3.118Z"})]}),iF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),oF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),lF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125A3.375 3.375 0 005.625 4.5h12.75c1.72 0 3.125 1.119 3.375 2.625M9.75 10.5h4.5m-4.5 3h4.5M11.25 3v1.5m0 15V21m0-16.5a1.5 1.5 0 00-3 0V21a1.5 1.5 0 003 0V3.062A3.375 3.375 0 0112 2.25c.465 0 .91.095 1.312.281M14.25 9a3 3 0 10-6 0 3 3 0 006 0z"})}),U2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),B2=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3M3.75 21h16.5M16.5 3.75h.008v.008H16.5V3.75zm-3.75 0h.008v.008H12.75V3.75zm-3.75 0h.008v.008H9V3.75zm-3.75 0h.008v.008H5.25V3.75z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.5h18M9.75 16.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-3a.75.75 0 01-.75-.75v-4.5z"})]}),cF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),j2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"})}),V2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 15 6-6m0 0-6-6m6 6H3a6 6 0 0 0 0 12h3"})}),Ys=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.122 2.122l7.81-7.81"})}),tu=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m0 0H3.375c-.621 0-1.125-.504-1.125-1.125v-12.75c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v12.75c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m17.25 0v-12.75a1.125 1.125 0 0 0-1.125-1.125H3.375A1.125 1.125 0 0 0 2.25 4.5v12.75c0 .621.504 1.125 1.125 1.125M12 4.5v15m0 0H9m3 0h3"})}),uF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...t,children:x.jsx("path",{fillRule:"evenodd",d:"M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z",clipRule:"evenodd"})}),fF=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...t,children:x.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-1V7a5 5 0 00-5-5zm0 2.5a2.5 2.5 0 00-2.5 2.5V9h5V7a2.5 2.5 0 00-2.5-2.5z"})}),nu=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.5 17.25l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 13.5l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 17.25l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),H2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75c0-.231-.035-.454-.1-.664M6.75 7.5H18v2.25H6.75V7.5zM3 12h3v6.75a2.25 2.25 0 002.25 2.25h9.75a2.25 2.25 0 002.25-2.25V12h3m-3.498 6.75H15"})}),Lh=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75v4.5m0-4.5h-4.5m4.5 0L15 9m5.25 11.25v-4.5m0 4.5h-4.5m4.5 0L15 15"})}),Ph=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9V4.5M15 9h4.5M15 9l5.25-5.25M15 15v4.5M15 15h4.5M15 15l5.25 5.25"})}),G2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"})}),Di=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})}),Bc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...t,children:x.jsx("path",{d:"M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"})}),Mi=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...t,children:x.jsx("path",{d:"M7.247 11.14l-4.796-5.481c-.566-.647-.106-1.659.753-1.659h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})}),jc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25z"})}),dF=({onSubmit:t,isLoading:e,onImportProject:n,onLoadTemplate:r,initialGoal:a="",initialDate:i="",onOpenProjectList:l,onLogout:c,user:d})=>{const[f,g]=ce.useState(a),[y,_]=ce.useState(i),w=ce.useRef(null);ls.useEffect(()=>{g(a)},[a]),ls.useEffect(()=>{_(i)},[i]);const E=new Date().toISOString().split("T")[0],S=O=>{if(O.preventDefault(),!f.trim()||!y){alert("事業目的と目標日付を入力してください。");return}t(f,y)},C=()=>{var O;(O=w.current)==null||O.click()},R=O=>{var j;const U=(j=O.target.files)==null?void 0:j[0];U&&(n(U),O.target.value="")},k=O=>{if(!f.trim()||!y){alert("テンプレートから開始するには、まずプロジェクトの目的と目標の日付を入力してください。");return}r(O,f,y)},b=({template:O,title:U,description:j,disabled:F})=>x.jsxs("button",{type:"button",onClick:()=>k(O),disabled:F,className:"text-left p-4 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400 text-white rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105",children:[x.jsx("div",{className:"font-semibold text-md",children:U}),x.jsx("div",{className:"text-xs text-purple-200 mt-1",children:j})]});return x.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[x.jsxs("div",{className:"w-full max-w-2xl mb-4 flex justify-between items-center",children:[x.jsxs("div",{className:"text-white text-sm",children:["ログイン中: ",d==null?void 0:d.email]}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",children:[x.jsx(Di,{className:"w-5 h-5"}),"保存済みプロジェクト"]}),x.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:[x.jsx(jc,{className:"w-5 h-5"}),"ログアウト"]})]})]}),x.jsxs("div",{className:"w-full max-w-2xl bg-white shadow-2xl rounded-xl p-8 md:p-12",children:[x.jsxs("div",{className:"text-center mb-10",children:[x.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-3",children:"AIプロジェクトプランナー"}),x.jsx("p",{className:"text-slate-600 text-lg",children:"あなたの目標達成をAIがお手伝いします。"})]}),x.jsxs("form",{onSubmit:S,className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"projectGoal",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(Jm,{className:"w-5 h-5 mr-2 text-blue-600"}),"プロジェクトの目的 (最終形)"]}),x.jsx("textarea",{id:"projectGoal",value:f,onChange:O=>g(O.target.value),placeholder:"例: 新しいEコマースサイトを立ち上げ、初年度売上1000万円を目指す",rows:3,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100 placeholder-slate-400"})]}),x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"targetDate",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(Wm,{className:"w-5 h-5 mr-2 text-blue-600"}),"目標の日付"]}),x.jsx("input",{type:"date",id:"targetDate",value:y,onChange:O=>_(O.target.value),min:E,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100",style:{colorScheme:"dark"}})]}),x.jsx("p",{className:"text-sm text-slate-500 text-center",children:"目的と日付を入力して計画を作成するか、テンプレートまたは既存の計画から開始します。"}),x.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[x.jsx("button",{type:"submit",disabled:e,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:e?x.jsx(Ar,{size:"sm",color:"border-white"}):"AIで計画を作成"}),x.jsxs("button",{type:"button",onClick:C,disabled:e,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:[x.jsx(P2,{className:"w-5 h-5 mr-2"}),"計画をインポート (.json)"]}),x.jsx("input",{type:"file",ref:w,onChange:R,accept:".json",className:"hidden","aria-hidden":"true"})]}),x.jsxs("div",{className:"sm:col-span-2 pt-4",children:[x.jsx("p",{className:"text-center text-sm font-semibold text-slate-600 mb-3",children:"または、テンプレートから開始:"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[x.jsx(b,{template:"process-design",disabled:e,title:"工程設計 (APQP)",description:"新製品の工程をAPQPに基づき計画から量産まで設計します。"}),x.jsx(b,{template:"process-change",disabled:e,title:"工程変更 (ISO/IATF)",description:"既存工程の変更を影響分析、承認、検証を含めて管理します。"}),x.jsx(b,{template:"new-product-eval",disabled:e,title:"新製品の設備評価",description:"顧客要求に基づき、既存設備での実現可能性を評価・報告します。"}),x.jsx(b,{template:"improvement-project",disabled:e,title:"生産性・コスト改善",description:"DMAICフレームワークに基づき、既存プロセスの問題を解決し、改善します。"}),x.jsx(b,{template:"equipment-modification",disabled:e,title:"社内設備改造",description:"社内設備・治具の改造・改善を計画・実行・評価します。"})]})]})]})]}),x.jsx("footer",{className:"mt-12 text-center",children:x.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API & Supabase"})})]})},Cf=t=>{switch(t){case Mt.IN_PROGRESS:return{icon:x.jsx(sF,{className:"w-3.5 h-3.5"}),color:"text-blue-700",text:"進行中",bgColor:"bg-blue-100"};case Mt.COMPLETED:return{icon:x.jsx(hd,{className:"w-3.5 h-3.5"}),color:"text-green-700",text:"完了",bgColor:"bg-green-100"};case Mt.BLOCKED:return{icon:x.jsx(iF,{className:"w-3.5 h-3.5"}),color:"text-red-700",text:"停滞中",bgColor:"bg-red-100"};case Mt.NOT_STARTED:default:return{icon:x.jsx(aF,{className:"w-3.5 h-3.5"}),color:"text-slate-600",text:"未着手",bgColor:"bg-slate-100"}}},hF=({task:t,onSelectTask:e,onRemoveTask:n,onUpdateStatus:r,onDragCardStart:a,index:i,cardRef:l,onStartConnection:c,onEndConnection:d})=>{var j,F,K,P;const[f,g]=ce.useState(!1),y=ce.useRef(null);ce.useEffect(()=>{const ne=Q=>{y.current&&!y.current.contains(Q.target)&&g(!1)};return document.addEventListener("mousedown",ne),()=>{document.removeEventListener("mousedown",ne)}},[y]);const _=ne=>{r(t.id,ne),g(!1)},w=(j=t.extendedDetails)==null?void 0:j.numericalTarget;let E="text-slate-500";w&&(w.status===Kh.ACHIEVED?E="text-green-600":w.status===Kh.MISSED?E="text-red-600":E="text-yellow-600");const S=Cf(t.status),C=(F=t.extendedDetails)==null?void 0:F.dueDate,R=C?new Date(C+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"short",day:"numeric"}):null,k=t.status===Mt.IN_PROGRESS,b="task-card-in-flow bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 ease-in-out overflow-hidden flex-shrink-0 w-80 md:w-96 m-1 cursor-grab active:cursor-grabbing",O=k?"border-4 border-blue-500 ring-2 ring-blue-500 ring-offset-1":"border border-transparent",U=ne=>{ne.stopPropagation(),c(t.id,ne)};return x.jsxs("div",{ref:l,id:`taskcard-${t.id}`,draggable:"true",onDragStart:ne=>a(ne,t.id),onMouseUp:()=>d(t.id),className:`${b} ${O}`,style:{position:"absolute",left:((K=t.position)==null?void 0:K.x)||0,top:((P=t.position)==null?void 0:P.y)||0,touchAction:"none"},children:[x.jsxs("div",{className:"p-5 relative",children:[x.jsx("div",{onMouseDown:U,className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-4 h-4 bg-blue-500 border-2 border-white rounded-full cursor-crosshair hover:scale-125 transition-transform z-10",title:"ドラッグして接続"}),x.jsxs("div",{className:"flex items-start justify-between mb-2",children:[x.jsxs("div",{className:"flex items-center flex-grow min-w-0 mr-2",children:[x.jsx("span",{className:"bg-blue-600 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-xs mr-3 flex-shrink-0",children:i+1}),x.jsx("div",{className:"flex-grow min-w-0",children:x.jsx("div",{className:"text-lg font-bold text-slate-900 break-words","aria-label":`task title for ${t.title}`,children:t.title})})]}),x.jsxs("div",{className:"flex space-x-1 flex-shrink-0 items-center",children:[w&&x.jsx(nF,{className:`w-5 h-5 ${E}`,title:`数値目標: ${w.description} (${w.status})`}),x.jsx("button",{onClick:ne=>{ne.stopPropagation(),e(t)},className:"text-blue-600 hover:text-blue-800 transition-colors p-1 rounded-full hover:bg-blue-100",title:"詳細・計画編集","aria-label":`詳細・計画編集: ${t.title}`,children:x.jsx(tF,{className:"w-5 h-5"})}),x.jsx("button",{onClick:ne=>{ne.stopPropagation(),n(t.id)},className:"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-100",title:"タスクを削除","aria-label":`タスクを削除: ${t.title}`,children:x.jsx(Pa,{className:"w-5 h-5"})})]})]}),x.jsx("div",{className:"h-20 mb-3",children:x.jsx("p",{className:"text-slate-800 text-sm leading-relaxed line-clamp-4 overflow-hidden h-full",children:t.description})}),x.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2",children:[x.jsxs("div",{className:"relative",ref:y,children:[x.jsxs("button",{onClick:()=>g(ne=>!ne),className:`inline-flex items-center px-2 py-0.5 rounded-full cursor-pointer ${S.bgColor} ${S.color} hover:ring-2 hover:ring-offset-1 hover:ring-blue-400 transition-all`,title:"ステータスを変更",children:[ls.cloneElement(S.icon,{className:`w-3 h-3 mr-1 ${S.color}`}),S.text]}),f&&x.jsx("div",{className:"absolute bottom-full mb-1 w-36 bg-white border border-slate-200 rounded-md shadow-lg z-20 py-1",children:Object.values(Mt).map(ne=>x.jsxs("button",{onClick:()=>_(ne),className:"w-full text-left px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-100 flex items-center",children:[ls.cloneElement(Cf(ne).icon,{className:`w-3.5 h-3.5 mr-2 ${Cf(ne).color}`}),Cf(ne).text]},ne))})]}),R&&x.jsxs("div",{className:"flex items-center text-orange-600",children:[x.jsx(Zm,{className:"w-3.5 h-3.5 mr-1"}),"期日: ",R]})]})]}),x.jsx("button",{onClick:ne=>{ne.stopPropagation(),e(t)},className:"block w-full text-left bg-slate-100 hover:bg-slate-200 text-blue-700 font-medium py-3 px-5 transition-colors text-xs border-t border-slate-200",children:"詳細な計画・レポート・接続 →"})]})},mF=ce.memo(hF),Vc=({from:t,to:e,id:n,onDelete:r})=>{const l=t.x,c=e.x,d=(l+c)/2,f=(t.y+e.y)/2,g=`M${l},${t.y} C${l+50},${t.y} ${c-50},${e.y} ${c},${e.y}`;return x.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"},"aria-hidden":"true",children:[x.jsx("defs",{children:x.jsx("marker",{id:`arrowhead-${n}`,markerWidth:8,markerHeight:8*.7,refX:8,refY:8*.35,orient:"auto",markerUnits:"strokeWidth",children:x.jsx("path",{d:`M0,0 L8,${8*.35} L0,${8*.7} Z`,fill:"#64748b"})})}),x.jsxs("g",{style:{pointerEvents:r?"auto":"none"},children:[x.jsx("path",{d:g,stroke:"#64748b",strokeWidth:2,markerEnd:`url(#arrowhead-${n})`,fill:"none"}),x.jsx("path",{d:g,stroke:"transparent",strokeWidth:"16",fill:"none",className:r?"cursor-pointer group":"",onClick:r}),r&&x.jsxs("g",{transform:`translate(${d}, ${f})`,className:"opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:r,children:[x.jsx("circle",{cx:"0",cy:"0",r:"8",fill:"white",stroke:"#ef4444",strokeWidth:"1"}),x.jsx("path",{d:"M -3.5 -3.5 L 3.5 3.5 M -3.5 3.5 L 3.5 -3.5",stroke:"#ef4444",strokeWidth:"1.5",strokeLinecap:"round"})]})]})]})},pF=({tasks:t,onClose:e})=>{const[n,r]=ce.useState("all"),[a,i]=ce.useState(""),[l,c]=ce.useState(null),d=ce.useMemo(()=>{const E=[];return t.forEach(S=>{var C,R;(R=(C=S.extendedDetails)==null?void 0:C.subSteps)==null||R.forEach(k=>{var b;(b=k.actionItems)==null||b.forEach(O=>{E.push({actionItem:O,subStep:k,task:S})})})}),E},[t]),f=ce.useMemo(()=>d.filter(E=>n==="completed"?E.actionItem.completed:n==="pending"?!E.actionItem.completed:!0).filter(E=>{const S=a.toLowerCase();return E.actionItem.text.toLowerCase().includes(S)||E.subStep.text.toLowerCase().includes(S)||(E.subStep.responsible||"").toLowerCase().includes(S)||E.task.title.toLowerCase().includes(S)}),[d,n,a]),g=ce.useMemo(()=>{let E=[...f];return l!==null&&E.sort((S,C)=>{let R="",k="";switch(l.key){case"status":R=S.actionItem.completed,k=C.actionItem.completed;break;case"actionItem":R=S.actionItem.text.toLowerCase(),k=C.actionItem.text.toLowerCase();break;case"responsible":R=(S.subStep.responsible||"").toLowerCase(),k=(C.subStep.responsible||"").toLowerCase();break;case"subStep":R=S.subStep.text.toLowerCase(),k=C.subStep.text.toLowerCase();break;case"task":R=S.task.title.toLowerCase(),k=C.task.title.toLowerCase();break;case"dueDate":R=S.actionItem.dueDate||S.subStep.dueDate||"9999-12-31",k=C.actionItem.dueDate||C.subStep.dueDate||"9999-12-31";break}return R<k?l.direction==="ascending"?-1:1:R>k?l.direction==="ascending"?1:-1:0}),E},[f,l]),y=E=>{let S="ascending";l&&l.key===E&&l.direction==="ascending"&&(S="descending"),c({key:E,direction:S})},_=E=>!l||l.key!==E?x.jsx(Bc,{className:"w-3 h-3 ml-1 opacity-20"}):l.direction==="ascending"?x.jsx(Bc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Mi,{className:"w-3 h-3 ml-1 text-blue-600"}),w=({sortKey:E,label:S,className:C})=>x.jsx("th",{scope:"col",className:`px-6 py-3 ${C||""}`,children:x.jsxs("button",{onClick:()=>y(E),className:"flex items-center gap-1 hover:text-blue-600 transition-colors",children:[S,_(E)]})});return x.jsxs("div",{className:"fixed inset-0 bg-slate-100 z-[60] flex flex-col",children:[x.jsx("header",{className:"flex-shrink-0 bg-white shadow-md",children:x.jsxs("div",{className:"flex items-center justify-between p-4 border-b w-full max-w-7xl mx-auto",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"全アクションアイテム一覧"}),x.jsxs("button",{onClick:e,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",children:[x.jsx(L2,{className:"w-5 h-5"}),"フローに戻る"]})]})}),x.jsxs("main",{className:"flex-grow flex flex-col overflow-hidden p-4 w-full max-w-7xl mx-auto",children:[x.jsx("div",{className:"p-4 flex-shrink-0 bg-white rounded-t-lg border-x border-t",children:x.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[x.jsx("input",{type:"text",placeholder:"検索...",value:a,onChange:E=>i(E.target.value),className:"px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm w-full sm:w-auto flex-grow"}),x.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-slate-100 p-1",children:[x.jsx("button",{onClick:()=>r("all"),className:`px-3 py-1 text-sm rounded-md ${n==="all"?"bg-white shadow":"hover:bg-slate-200"}`,children:"全て"}),x.jsx("button",{onClick:()=>r("pending"),className:`px-3 py-1 text-sm rounded-md ${n==="pending"?"bg-white shadow":"hover:bg-slate-200"}`,children:"未完了"}),x.jsx("button",{onClick:()=>r("completed"),className:`px-3 py-1 text-sm rounded-md ${n==="completed"?"bg-white shadow":"hover:bg-slate-200"}`,children:"完了"})]})]})}),x.jsx("div",{className:"flex-grow overflow-y-auto bg-white rounded-b-lg border",children:x.jsxs("table",{className:"w-full text-sm text-left text-slate-600",children:[x.jsx("thead",{className:"text-xs text-slate-700 uppercase bg-slate-100 sticky top-0 z-10",children:x.jsxs("tr",{children:[x.jsx(w,{sortKey:"status",label:"状態",className:"w-24"}),x.jsx(w,{sortKey:"actionItem",label:"アクションアイテム"}),x.jsx(w,{sortKey:"responsible",label:"担当者"}),x.jsx(w,{sortKey:"subStep",label:"所属サブステップ"}),x.jsx(w,{sortKey:"task",label:"所属タスク"}),x.jsx(w,{sortKey:"dueDate",label:"期日"})]})}),x.jsxs("tbody",{className:"divide-y divide-slate-200",children:[g.map(({actionItem:E,subStep:S,task:C},R)=>x.jsxs("tr",{className:"hover:bg-slate-50",children:[x.jsx("td",{className:"px-6 py-3",children:E.completed?x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[x.jsx(eu,{className:"w-4 h-4 mr-1"}),"完了"]}):x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[x.jsx(md,{className:"w-4 h-4 mr-1"}),"未完了"]})}),x.jsx("td",{className:"px-6 py-3 font-medium text-slate-900",children:E.text}),x.jsx("td",{className:"px-6 py-3",children:S.responsible||"未設定"}),x.jsx("td",{className:"px-6 py-3",children:S.text}),x.jsx("td",{className:"px-6 py-3",children:C.title}),x.jsx("td",{className:"px-6 py-3",children:E.dueDate||S.dueDate?new Date((E.dueDate||S.dueDate)+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"未設定"})]},E.id+R)),g.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-500",children:"条件に一致するアイテムはありません。"})})]})]})})]})]})},y_={"On Track":{bgColor:"bg-green-100",textColor:"text-green-800",icon:x.jsx(hd,{className:"w-12 h-12 text-green-500"})},"At Risk":{bgColor:"bg-yellow-100",textColor:"text-yellow-800",icon:x.jsx(Cc,{className:"w-12 h-12 text-yellow-500"})},"Off Track":{bgColor:"bg-red-100",textColor:"text-red-800",icon:x.jsx(Cc,{className:"w-12 h-12 text-red-500"})},Unknown:{bgColor:"bg-slate-100",textColor:"text-slate-800",icon:x.jsx(Cc,{className:"w-12 h-12 text-slate-500"})}},gF=({report:t,onClose:e})=>{if(!t)return null;const n=y_[t.overallStatus]||y_.Unknown;return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200 flex-shrink-0",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AIプロジェクト診断レポート"}),x.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Vr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[x.jsxs("section",{className:`p-6 rounded-lg flex items-center gap-6 ${n.bgColor}`,children:[x.jsx("div",{className:"flex-shrink-0",children:n.icon}),x.jsxs("div",{children:[x.jsx("h4",{className:`text-2xl font-bold ${n.textColor}`,children:t.overallStatus}),x.jsx("p",{className:`mt-1 text-base ${n.textColor}`,children:t.summary})]})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(hd,{className:"w-5 h-5 mr-2 text-green-500"}),"うまくいっている点"]}),x.jsx("ul",{className:"list-disc list-inside space-y-2 text-slate-600 pl-2",children:t.positivePoints.map((r,a)=>x.jsx("li",{children:r},a))})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(Cc,{className:"w-5 h-5 mr-2 text-yellow-500"}),"懸念事項"]}),x.jsx("div",{className:"space-y-3",children:t.areasOfConcern.map((r,a)=>x.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg",children:[x.jsx("p",{className:"font-semibold text-yellow-800",children:r.description}),r.relatedTaskIds.length>0&&x.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["関連タスクID: ",r.relatedTaskIds.join(", ")]})]},a))})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(Xm,{className:"w-5 h-5 mr-2 text-blue-500"}),"AIからの提案"]}),x.jsx("div",{className:"space-y-3",children:t.suggestions.map((r,a)=>x.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:x.jsx("p",{className:"text-blue-800",children:r})},a))})]})]}),x.jsx("footer",{className:"p-4 bg-slate-50 border-t flex justify-end",children:x.jsx("button",{onClick:e,className:"px-5 py-2 text-sm font-medium text-white bg-slate-600 rounded-md hover:bg-slate-700",children:"閉じる"})})]})})},__=t=>{const e=Math.cos(2*Math.PI*t),n=Math.sin(2*Math.PI*t);return[e,n]},xF=({data:t,title:e})=>{const n=t.reduce((l,c)=>l+c.value,0);if(n===0)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data to display"});let r=0;const a=["#4a90e2","#50e3c2","#f5a623","#f8e71c","#7ed321","#9013fe"],i=t.map((l,c)=>{const d=l.value/n,[f,g]=__(r);r+=d;const[y,_]=__(r),w=d>.5?1:0;return{path:[`M ${f} ${g}`,`A 1 1 0 ${w} 1 ${y} ${_}`,"L 0 0"].join(" "),color:a[c%a.length],label:l.label}});return x.jsxs("div",{className:"w-full h-full flex flex-col bg-white p-2",children:[x.jsx("text",{x:"50%",y:"10",textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",className:"block text-center",children:e}),x.jsxs("div",{className:"flex-grow flex items-center",children:[x.jsx("svg",{viewBox:"-1 -1 2 2",className:"w-2/3 h-full",children:i.map((l,c)=>x.jsx("path",{d:l.path,fill:l.color},c))}),x.jsx("div",{className:"w-1/3 text-[8px] space-y-1",children:i.map((l,c)=>x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:l.color}}),x.jsx("span",{className:"truncate",children:l.label})]},c))})]})]})},vF=({data:t,title:e})=>{const n=Math.max(...t.map(f=>f.value),0),r=300,a=150,i={top:20,right:10,bottom:30,left:30},l=r-i.left-i.right,c=a-i.top-i.bottom,d=t.map((f,g)=>{const y=g/(t.length-1)*l,_=c-f.value/n*c;return`${y},${_}`}).join(" ");return x.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[x.jsx("text",{x:r/2,y:i.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:e}),x.jsxs("g",{transform:`translate(${i.left}, ${i.top})`,children:[x.jsx("line",{x1:"0",y1:"0",x2:"0",y2:c,stroke:"#ddd",strokeWidth:"0.5"}),x.jsx("line",{x1:"0",y1:c,x2:l,y2:c,stroke:"#ddd",strokeWidth:"0.5"}),x.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1.5",points:d}),t.map((f,g)=>{const y=g/(t.length-1)*l,_=c-f.value/n*c;return x.jsx("circle",{cx:y,cy:_,r:"2",fill:"#4a90e2"},g)})]})]})},yF=({data:t,title:e})=>{const n=Math.max(...t.map(f=>f.value),0),r=300,a=150,i={top:20,right:10,bottom:30,left:30},l=r-i.left-i.right,c=a-i.top-i.bottom,d=t.length>0?l/t.length*.8:0;return x.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[x.jsx("text",{x:r/2,y:i.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:e}),x.jsxs("g",{transform:`translate(${i.left}, ${i.top})`,children:[x.jsx("line",{x1:"0",y1:"0",x2:"0",y2:c,stroke:"#999",strokeWidth:"0.5"}),[0,n/2,n].map(f=>x.jsxs("g",{transform:`translate(0, ${c-f/n*c})`,children:[x.jsx("line",{x1:"-3",y1:"0",x2:"0",y2:"0",stroke:"#999",strokeWidth:"0.5"}),x.jsx("text",{x:"-5",y:"3",textAnchor:"end",fontSize:"6",fill:"#666",children:f.toFixed(0)})]},f)),t.map((f,g)=>x.jsxs("g",{transform:`translate(${g*l/t.length+l/t.length*.1}, 0)`,children:[x.jsx("rect",{x:"0",y:c-f.value/n*c,width:d,height:f.value/n*c,fill:"#4a90e2"}),x.jsx("text",{x:d/2,y:c+8,textAnchor:"middle",fontSize:"6",fill:"#666",transform:`rotate(-45, ${d/2}, ${c+8})`,children:f.label})]},f.label))]})]})},_F=({subStep:t,statusColor:e})=>{var n,r;return x.jsx("div",{style:{position:"absolute",left:((n=t.position)==null?void 0:n.x)||0,top:((r=t.position)==null?void 0:r.y)||0,width:192,minHeight:76,padding:"8px",borderRadius:"8px",backgroundColor:"white",borderLeft:`4px solid ${e}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",fontSize:"12px",fontFamily:"sans-serif",color:"#333",display:"flex",flexDirection:"column",justifyContent:"center"},children:x.jsx("p",{className:`font-bold break-words ${t.status===fr.COMPLETED?"line-through text-slate-500":""}`,children:t.text})})},TF=({subSteps:t})=>{if(!t||t.length===0)return x.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 text-slate-500 text-sm",children:"No sub-steps to display."});const e=l=>{switch(l){case fr.COMPLETED:return"#22c55e";case fr.IN_PROGRESS:return"#3b82f6";default:return"#94a3b8"}},n=192,r=76,a=ce.useMemo(()=>{const l=[];return(t||[]).forEach(c=>{var d;if((d=c==null?void 0:c.nextSubStepIds)!=null&&d.length&&c.position){const f={x:c.position.x+n,y:c.position.y+r/2};c.nextSubStepIds.forEach(g=>{const y=t.find(_=>_.id===g);if(y&&y.position){const _={x:y.position.x,y:y.position.y+r/2};l.push({id:`fc-render-${c.id}-${g}`,from:f,to:_,sourceId:c.id,targetId:g})}})}}),l},[t,n,r]),i=ce.useMemo(()=>{if(!t||t.length===0)return{minX:0,minY:0,width:400,height:300};let l=0,c=0;return t.forEach(d=>{d.position&&(l=Math.max(l,d.position.x+n),c=Math.max(c,d.position.y+r))}),{minX:0,minY:0,width:l+20,height:c+20}},[t,n,r]);return x.jsx("div",{className:"w-full h-full bg-slate-50 overflow-hidden",style:{fontFamily:"Inter, sans-serif"},children:x.jsxs("svg",{width:"100%",height:"100%",viewBox:`${i.minX} ${i.minY} ${i.width} ${i.height}`,children:[x.jsx("style",{children:`
                    .flowchart-card-container {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        font-family: Inter, sans-serif;
                    }
                    `}),x.jsx("foreignObject",{x:"0",y:"0",width:i.width,height:i.height,children:x.jsx("div",{className:"flowchart-card-container",children:(t||[]).map(l=>x.jsx(_F,{subStep:l,statusColor:e(l.status)},l.id))})}),a.map(l=>x.jsx(Vc,{from:l.from,to:l.to,id:l.id},l.id))]})})},wF=({el:t,onUpdate:e,children:n,isSelected:r,onClick:a})=>x.jsx("div",{onClick:i=>{i.stopPropagation(),a()},style:{position:"absolute",left:`${t.position.x}%`,top:`${t.position.y}%`,width:`${t.position.width}%`,height:`${t.position.height}%`,outline:r?"2px solid #3b82f6":"1px dashed transparent",cursor:"move"},className:"transition-all duration-150 hover:outline-dashed hover:outline-slate-400",children:n}),Qm=({tasks:t,initialDeck:e,onSave:n,onClose:r,generateUniqueId:a,projectGoal:i,targetDate:l,reportScope:c})=>{const[d,f]=ce.useState(e),[g,y]=ce.useState(0),[_,w]=ce.useState(null),[E,S]=ce.useState(!1),[C,R]=ce.useState(null),[k,b]=ce.useState(!1),O=ce.useRef(null),U=(re,W)=>{f(N=>({...N,slides:N.slides.map(Z=>Z.id===re?{...Z,...typeof W=="function"?W(Z):Z}:Z)}))},j=re=>{const W=d.slides[re];U(W.id,{isLocked:!W.isLocked})},F=(re,W,N)=>{U(re,Z=>({elements:Z.elements.map(M=>M.id===W?{...M,...N}:M)}))},K=async()=>{S(!0),R(null);try{const re={...d,slides:d.slides.map(Z=>Z.isLocked?Z:{...Z,isLocked:void 0})},W=await $M(re),N={...W,slides:W.slides.map((Z,M)=>({...Z,isLocked:d.slides[M].isLocked}))};f(N)}catch(re){R(re instanceof Error?re.message:"最適化に失敗しました。")}finally{S(!1)}},P=async()=>{S(!0),R(null);try{let re;c==="project"?re=await YM(d,t,i,l):re=await GM(d,t[0],i),f(re)}catch(re){R(re instanceof Error?re.message:"レポートの再生成に失敗しました。")}finally{S(!1)}},ne=(re,W)=>{var N,Z,M;for(const V of t){const Y=(Z=(N=V.extendedDetails)==null?void 0:N.subSteps)==null?void 0:Z.find(z=>z.id===re);if(Y){const z=(M=Y==null?void 0:Y.actionItems)==null?void 0:M.find(ie=>ie.id===W);if(z)return z}}},Q=re=>{var W,N,Z,M,V;switch(re.type){case"textbox":const Y=re;return x.jsx("textarea",{value:Y.content,onChange:z=>F(d.slides[g].id,re.id,{content:z.target.value}),className:"w-full h-full bg-transparent resize-none border-none outline-none p-2",style:{fontSize:Y.fontSize,fontWeight:Y.fontWeight,textAlign:Y.textAlign,color:"#333"}});case"image":{const z=re,ie=ne(z.subStepId,z.actionItemId),ye=(N=(W=ie==null?void 0:ie.report)==null?void 0:W.attachments)==null?void 0:N.find(Ce=>Ce.id===z.attachmentId);return ye?x.jsx("img",{src:ye.dataUrl,className:"w-full h-full object-contain",alt:ye.name}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"画像が見つかりません"})}case"table":{const z=re,ie=ne(z.subStepId,z.actionItemId),ye=(Z=ie==null?void 0:ie.report)==null?void 0:Z.matrixData;return ye?x.jsx("div",{className:"p-2 overflow-auto h-full",children:x.jsxs("table",{className:"w-full text-[8px] border-collapse bg-white",children:[x.jsx("thead",{children:x.jsx("tr",{className:"bg-slate-200",children:ye.headers.map((Ce,Re)=>x.jsx("th",{className:"border border-slate-300 p-1 font-semibold",children:Ce},Re))})}),x.jsx("tbody",{children:ye.rows.map((Ce,Re)=>x.jsx("tr",{children:Ce.map((Ee,Ke)=>x.jsx("td",{className:"border border-slate-300 p-1",children:Ee},`${Re}-${Ke}`))},Re))})]})}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"データなし"})}case"chart":{const z=re,ie=ne(z.subStepId,z.actionItemId),ye=(((V=(M=ie==null?void 0:ie.report)==null?void 0:M.matrixData)==null?void 0:V.rows)||[]).map(Ce=>({label:Ce[0],value:parseFloat(Ce[1])||0})).filter(Ce=>Ce.label&&!isNaN(Ce.value));if(ye.length===0)return x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"チャートデータなし"});switch(z.chartType){case"line":return x.jsx(vF,{data:ye,title:z.title});case"pie":return x.jsx(xF,{data:ye,title:z.title});case"bar":default:return x.jsx(yF,{data:ye,title:z.title})}}case"flowchart":{const z=re;return z.data&&z.data.subSteps?x.jsx(TF,{subSteps:z.data.subSteps}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"フローチャートのデータが見つかりません。"})}default:return null}},te=()=>window.print(),_e=(re,W)=>{const N=JSON.stringify(re,null,2),Z=new Blob([N],{type:"application/json"}),M=URL.createObjectURL(Z),V=document.createElement("a");V.href=M,V.download=W,document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(M)},Le=re=>{re==="pdf"?te():_e(d,"report-deck.json"),b(!1)},Te=()=>{n(d),r()},ae=d.slides[g],ue=c==="project"?`プロジェクト全体レポート: ${i}`:`タスクレポート: ${t[0].title}`;return x.jsxs(x.Fragment,{children:[x.jsx("style",{children:"@media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } .no-print { display: none !important; } .slide-print-page { page-break-after: always; width: 100vw; height: 56.25vw; /* 16:9 aspect ratio */ box-shadow: none !important; border: none; } }"}),x.jsxs("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-80 z-[100] flex flex-col p-4 no-print",onClick:()=>w(null),children:[x.jsxs("header",{className:"flex items-center justify-between pb-4 flex-shrink-0",children:[x.jsx("h2",{className:"text-xl font-bold text-white truncate pr-4",children:ue}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsxs("button",{onClick:P,disabled:E,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[x.jsx(pd,{className:"w-4 h-4"})," ",E?"処理中...":"レポート再生成"]}),x.jsxs("button",{onClick:K,disabled:E,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:bg-slate-400",children:[x.jsx(Xm,{className:"w-4 h-4"})," ",E?"処理中...":"AIでレイアウト最適化"]}),x.jsxs("div",{className:"relative",ref:O,children:[x.jsx("button",{onClick:()=>b(re=>!re),className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"ダウンロード",children:x.jsx(tl,{className:"w-5 h-5"})}),k&&x.jsxs("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg z-10",children:[x.jsx("button",{onClick:()=>Le("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"PDFとして保存"}),x.jsx("button",{onClick:()=>Le("json"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"JSONとして保存"})]})]}),x.jsxs("button",{onClick:r,className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"閉じる",children:[" ",x.jsx(Vr,{className:"w-5 h-5"})]}),x.jsx("button",{onClick:Te,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold text-sm",children:"保存して閉じる"})]})]}),C&&x.jsx("div",{className:"text-red-400 text-sm mb-2 bg-red-100 border border-red-400 p-2 rounded-md",children:C}),x.jsxs("div",{className:"flex-grow flex gap-4 min-h-0",children:[x.jsx("aside",{className:"w-40 bg-slate-800 rounded-lg p-2 flex flex-col gap-2 overflow-y-auto",children:d.slides.map((re,W)=>x.jsxs("div",{onClick:()=>y(W),className:`relative group aspect-video bg-white rounded cursor-pointer transition-all p-1 ${g===W?"ring-4 ring-blue-500":"hover:ring-2 ring-blue-400"}`,children:[x.jsx("div",{className:"absolute top-1 right-1 z-10 opacity-50 group-hover:opacity-100 transition-opacity",children:x.jsx("button",{onClick:N=>{N.stopPropagation(),j(W)},title:re.isLocked?"スライドのロック解除":"スライドをロック",className:`p-1 rounded-full ${re.isLocked?"bg-blue-600 text-white":"bg-slate-500 text-white"}`,children:re.isLocked?x.jsx(uF,{className:"w-3 h-3"}):x.jsx(fF,{className:"w-3 h-3"})})}),x.jsx("div",{className:"w-full h-full transform scale-[0.1] origin-top-left overflow-hidden relative",children:re.elements.map(N=>x.jsx("div",{style:{position:"absolute",left:`${N.position.x}%`,top:`${N.position.y}%`,width:`${N.position.width}%`,height:`${N.position.height}%`,backgroundColor:"#ccc"}},N.id))}),x.jsx("span",{className:"text-white text-xs block text-center -mt-2",children:W+1})]},re.id))}),x.jsx("main",{className:"flex-grow flex items-center justify-center",children:ae&&x.jsx("div",{className:"aspect-video w-full max-w-[100vh] bg-white shadow-2xl rounded-lg relative overflow-hidden",children:ae.elements.map(re=>x.jsx(wF,{el:re,onUpdate:()=>{},isSelected:_===re.id,onClick:()=>w(re.id),children:Q(re)},re.id))})}),x.jsxs("aside",{className:"w-64 bg-slate-800 rounded-lg p-3 text-white overflow-y-auto",children:[x.jsx("h3",{className:"font-bold border-b border-slate-600 pb-2 mb-3",children:"プロパティ"}),x.jsx("p",{className:"text-xs text-slate-400",children:"要素を選択してプロパティを編集します。"})]})]})]}),x.jsx("div",{className:"hidden print:block",children:d.slides.map((re,W)=>x.jsx("div",{className:"slide-print-page bg-white relative",children:x.jsx("div",{className:"w-full h-full relative",children:re.elements.map(N=>x.jsx("div",{style:{position:"absolute",left:`${N.position.x}%`,top:`${N.position.y}%`,width:`${N.position.width}%`,height:`${N.position.height}%`},children:Q(N)},N.id))})},re.id))})]})},EF=({onClose:t,onDownloadAndStartNew:e,onStartNewWithoutSaving:n})=>x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center",children:[x.jsx(Cc,{className:"w-6 h-6 mr-2 text-yellow-500"}),"確認"]}),x.jsx("button",{onClick:t,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"閉じる","aria-label":"確認モーダルを閉じる",children:x.jsx(Vr,{className:"w-5 h-5"})})]}),x.jsxs("div",{className:"p-6",children:[x.jsx("p",{className:"text-slate-700",children:"新しいプロジェクトを開始します。現在の作業内容は保存されませんが、よろしいですか？"}),x.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"現在のプロジェクトを保存したい場合は、JSON形式でダウンロードできます。"})]}),x.jsxs("footer",{className:"p-4 bg-slate-50 border-t border-slate-200 flex flex-col sm:flex-row justify-end gap-3 rounded-b-xl",children:[x.jsx("button",{type:"button",onClick:t,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"キャンセル"}),x.jsx("button",{type:"button",onClick:n,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-red-700 bg-red-100 border border-transparent rounded-md shadow-sm hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"保存せずに新規作成"}),x.jsxs("button",{type:"submit",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[x.jsx(tl,{className:"w-4 h-4"}),"ダウンロードして新規作成"]})]})]})});function SF(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),a=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(a),e&&(r.href=e),a.href=t,a.href}const CF=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function Ws(t){const e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n]);return e}let Lo=null;function $2(t={}){return Lo||(t.includeStyleProperties?(Lo=t.includeStyleProperties,Lo):(Lo=Ws(window.getComputedStyle(document.documentElement)),Lo))}function Wf(t,e){const r=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return r?parseFloat(r.replace("px","")):0}function bF(t){const e=Wf(t,"border-left-width"),n=Wf(t,"border-right-width");return t.clientWidth+e+n}function AF(t){const e=Wf(t,"border-top-width"),n=Wf(t,"border-bottom-width");return t.clientHeight+e+n}function z2(t,e={}){const n=e.width||bF(t),r=e.height||AF(t);return{width:n,height:r}}function kF(){let t,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(t=parseInt(n,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const Pr=16384;function NF(t){(t.width>Pr||t.height>Pr)&&(t.width>Pr&&t.height>Pr?t.width>t.height?(t.height*=Pr/t.width,t.width=Pr):(t.width*=Pr/t.height,t.height=Pr):t.width>Pr?(t.height*=Pr/t.width,t.width=Pr):(t.width*=Pr/t.height,t.height=Pr))}function Jf(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>e(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=t})}async function RF(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function DF(t,e,n){const r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),i=document.createElementNS(r,"foreignObject");return a.setAttribute("width",`${e}`),a.setAttribute("height",`${n}`),a.setAttribute("viewBox",`0 0 ${e} ${n}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),a.appendChild(i),i.appendChild(t),RF(a)}const kr=(t,e)=>{if(t instanceof e)return!0;const n=Object.getPrototypeOf(t);return n===null?!1:n.constructor.name===e.name||kr(n,e)};function MF(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function IF(t,e){return $2(e).map(n=>{const r=t.getPropertyValue(n),a=t.getPropertyPriority(n);return`${n}: ${r}${a?" !important":""};`}).join(" ")}function FF(t,e,n,r){const a=`.${t}:${e}`,i=n.cssText?MF(n):IF(n,r);return document.createTextNode(`${a}{${i}}`)}function T_(t,e,n,r){const a=window.getComputedStyle(t,n),i=a.getPropertyValue("content");if(i===""||i==="none")return;const l=CF();try{e.className=`${e.className} ${l}`}catch{return}const c=document.createElement("style");c.appendChild(FF(l,n,a,r)),e.appendChild(c)}function OF(t,e,n){T_(t,e,":before",n),T_(t,e,":after",n)}const w_="application/font-woff",E_="image/jpeg",LF={woff:w_,woff2:w_,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:E_,jpeg:E_,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function PF(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function ep(t){const e=PF(t).toLowerCase();return LF[e]||""}function UF(t){return t.split(/,/)[1]}function Em(t){return t.search(/^(data:)/)!==-1}function BF(t,e){return`data:${e};base64,${t}`}async function q2(t,e,n){const r=await fetch(t,e);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const a=await r.blob();return new Promise((i,l)=>{const c=new FileReader;c.onerror=l,c.onloadend=()=>{try{i(n({res:r,result:c.result}))}catch(d){l(d)}},c.readAsDataURL(a)})}const Uh={};function jF(t,e,n){let r=t.replace(/\?.*/,"");return n&&(r=t),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),e?`[${e}]${r}`:r}async function tp(t,e,n){const r=jF(t,e,n.includeQueryParams);if(Uh[r]!=null)return Uh[r];n.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let a;try{const i=await q2(t,n.fetchRequestInit,({res:l,result:c})=>(e||(e=l.headers.get("Content-Type")||""),UF(c)));a=BF(i,e)}catch(i){a=n.imagePlaceholder||"";let l=`Failed to fetch resource: ${t}`;i&&(l=typeof i=="string"?i:i.message),l&&console.warn(l)}return Uh[r]=a,a}async function VF(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):Jf(e)}async function HF(t,e){if(t.currentSrc){const i=document.createElement("canvas"),l=i.getContext("2d");i.width=t.clientWidth,i.height=t.clientHeight,l==null||l.drawImage(t,0,0,i.width,i.height);const c=i.toDataURL();return Jf(c)}const n=t.poster,r=ep(n),a=await tp(n,r,e);return Jf(a)}async function GF(t,e){var n;try{if(!((n=t==null?void 0:t.contentDocument)===null||n===void 0)&&n.body)return await gd(t.contentDocument.body,e,!0)}catch{}return t.cloneNode(!1)}async function $F(t,e){return kr(t,HTMLCanvasElement)?VF(t):kr(t,HTMLVideoElement)?HF(t,e):kr(t,HTMLIFrameElement)?GF(t,e):t.cloneNode(Y2(t))}const zF=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",Y2=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function qF(t,e,n){var r,a;if(Y2(e))return e;let i=[];return zF(t)&&t.assignedNodes?i=Ws(t.assignedNodes()):kr(t,HTMLIFrameElement)&&(!((r=t.contentDocument)===null||r===void 0)&&r.body)?i=Ws(t.contentDocument.body.childNodes):i=Ws(((a=t.shadowRoot)!==null&&a!==void 0?a:t).childNodes),i.length===0||kr(t,HTMLVideoElement)||await i.reduce((l,c)=>l.then(()=>gd(c,n)).then(d=>{d&&e.appendChild(d)}),Promise.resolve()),e}function YF(t,e,n){const r=e.style;if(!r)return;const a=window.getComputedStyle(t);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):$2(n).forEach(i=>{let l=a.getPropertyValue(i);i==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),kr(t,HTMLIFrameElement)&&i==="display"&&l==="inline"&&(l="block"),i==="d"&&e.getAttribute("d")&&(l=`path(${e.getAttribute("d")})`),r.setProperty(i,l,a.getPropertyPriority(i))})}function WF(t,e){kr(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),kr(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function JF(t,e){if(kr(t,HTMLSelectElement)){const n=e,r=Array.from(n.children).find(a=>t.value===a.getAttribute("value"));r&&r.setAttribute("selected","")}}function KF(t,e,n){return kr(e,Element)&&(YF(t,e,n),OF(t,e,n),WF(t,e),JF(t,e)),e}async function XF(t,e){const n=t.querySelectorAll?t.querySelectorAll("use"):[];if(n.length===0)return t;const r={};for(let i=0;i<n.length;i++){const c=n[i].getAttribute("xlink:href");if(c){const d=t.querySelector(c),f=document.querySelector(c);!d&&f&&!r[c]&&(r[c]=await gd(f,e,!0))}}const a=Object.values(r);if(a.length){const i="http://www.w3.org/1999/xhtml",l=document.createElementNS(i,"svg");l.setAttribute("xmlns",i),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const c=document.createElementNS(i,"defs");l.appendChild(c);for(let d=0;d<a.length;d++)c.appendChild(a[d]);t.appendChild(l)}return t}async function gd(t,e,n){return!n&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(r=>$F(r,e)).then(r=>qF(t,r,e)).then(r=>KF(t,r,e)).then(r=>XF(r,e))}const W2=/url\((['"]?)([^'"]+?)\1\)/g,ZF=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,QF=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function e8(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function t8(t){const e=[];return t.replace(W2,(n,r,a)=>(e.push(a),n)),e.filter(n=>!Em(n))}async function n8(t,e,n,r,a){try{const i=n?SF(e,n):e,l=ep(e);let c;return a||(c=await tp(i,l,r)),t.replace(e8(e),`$1${c}$3`)}catch{}return t}function r8(t,{preferredFontFormat:e}){return e?t.replace(QF,n=>{for(;;){const[r,,a]=ZF.exec(n)||[];if(!a)return"";if(a===e)return`src: ${r};`}}):t}function J2(t){return t.search(W2)!==-1}async function K2(t,e,n){if(!J2(t))return t;const r=r8(t,n);return t8(r).reduce((i,l)=>i.then(c=>n8(c,l,e,n)),Promise.resolve(r))}async function Po(t,e,n){var r;const a=(r=e.style)===null||r===void 0?void 0:r.getPropertyValue(t);if(a){const i=await K2(a,null,n);return e.style.setProperty(t,i,e.style.getPropertyPriority(t)),!0}return!1}async function a8(t,e){await Po("background",t,e)||await Po("background-image",t,e),await Po("mask",t,e)||await Po("-webkit-mask",t,e)||await Po("mask-image",t,e)||await Po("-webkit-mask-image",t,e)}async function s8(t,e){const n=kr(t,HTMLImageElement);if(!(n&&!Em(t.src))&&!(kr(t,SVGImageElement)&&!Em(t.href.baseVal)))return;const r=n?t.src:t.href.baseVal,a=await tp(r,ep(r),e);await new Promise((i,l)=>{t.onload=i,t.onerror=e.onImageErrorHandler?(...d)=>{try{i(e.onImageErrorHandler(...d))}catch(f){l(f)}}:l;const c=t;c.decode&&(c.decode=i),c.loading==="lazy"&&(c.loading="eager"),n?(t.srcset="",t.src=a):t.href.baseVal=a})}async function i8(t,e){const r=Ws(t.childNodes).map(a=>X2(a,e));await Promise.all(r).then(()=>t)}async function X2(t,e){kr(t,Element)&&(await a8(t,e),await s8(t,e),await i8(t,e))}function o8(t,e){const{style:n}=t;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const r=e.style;return r!=null&&Object.keys(r).forEach(a=>{n[a]=r[a]}),t}const S_={};async function C_(t){let e=S_[t];if(e!=null)return e;const r=await(await fetch(t)).text();return e={url:t,cssText:r},S_[t]=e,e}async function b_(t,e){let n=t.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,i=(n.match(/url\([^)]+\)/g)||[]).map(async l=>{let c=l.replace(r,"$1");return c.startsWith("https://")||(c=new URL(c,t.url).href),q2(c,e.fetchRequestInit,({result:d})=>(n=n.replace(l,`url(${d})`),[l,d]))});return Promise.all(i).then(()=>n)}function A_(t){if(t==null)return[];const e=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=t.replace(n,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=a.exec(r);if(d===null)break;e.push(d[0])}r=r.replace(a,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",c=new RegExp(l,"gi");for(;;){let d=i.exec(r);if(d===null){if(d=c.exec(r),d===null)break;i.lastIndex=c.lastIndex}else c.lastIndex=i.lastIndex;e.push(d[0])}return e}async function l8(t,e){const n=[],r=[];return t.forEach(a=>{if("cssRules"in a)try{Ws(a.cssRules||[]).forEach((i,l)=>{if(i.type===CSSRule.IMPORT_RULE){let c=l+1;const d=i.href,f=C_(d).then(g=>b_(g,e)).then(g=>A_(g).forEach(y=>{try{a.insertRule(y,y.startsWith("@import")?c+=1:a.cssRules.length)}catch(_){console.error("Error inserting rule from remote css",{rule:y,error:_})}})).catch(g=>{console.error("Error loading remote css",g.toString())});r.push(f)}})}catch(i){const l=t.find(c=>c.href==null)||document.styleSheets[0];a.href!=null&&r.push(C_(a.href).then(c=>b_(c,e)).then(c=>A_(c).forEach(d=>{l.insertRule(d,l.cssRules.length)})).catch(c=>{console.error("Error loading remote stylesheet",c)})),console.error("Error inlining remote css file",i)}}),Promise.all(r).then(()=>(t.forEach(a=>{if("cssRules"in a)try{Ws(a.cssRules||[]).forEach(i=>{n.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${a.href}`,i)}}),n))}function c8(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>J2(e.style.getPropertyValue("src")))}async function u8(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=Ws(t.ownerDocument.styleSheets),r=await l8(n,e);return c8(r)}function Z2(t){return t.trim().replace(/["']/g,"")}function f8(t){const e=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(i=>{e.add(Z2(i))}),Array.from(r.children).forEach(i=>{i instanceof HTMLElement&&n(i)})}return n(t),e}async function d8(t,e){const n=await u8(t,e),r=f8(t);return(await Promise.all(n.filter(i=>r.has(Z2(i.style.fontFamily))).map(i=>{const l=i.parentStyleSheet?i.parentStyleSheet.href:null;return K2(i.cssText,l,e)}))).join(`
`)}async function h8(t,e){const n=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await d8(t,e);if(n){const r=document.createElement("style"),a=document.createTextNode(n);r.appendChild(a),t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)}}async function m8(t,e={}){const{width:n,height:r}=z2(t,e),a=await gd(t,e,!0);return await h8(a,e),await X2(a,e),o8(a,e),await DF(a,n,r)}async function p8(t,e={}){const{width:n,height:r}=z2(t,e),a=await m8(t,e),i=await Jf(a),l=document.createElement("canvas"),c=l.getContext("2d"),d=e.pixelRatio||kF(),f=e.canvasWidth||n,g=e.canvasHeight||r;return l.width=f*d,l.height=g*d,e.skipAutoScale||NF(l),l.style.width=`${f}`,l.style.height=`${g}`,e.backgroundColor&&(c.fillStyle=e.backgroundColor,c.fillRect(0,0,l.width,l.height)),c.drawImage(i,0,0,l.width,l.height),l}async function g8(t,e={}){return(await p8(t,e)).toDataURL()}const pc=40,k_=64,N_=320,R_=["#3B82F6","#F59E0B","#10B981","#EF4444","#6B7280","#6366F1","#EC4899","#8B5CF6"],x8=({data:t,onClose:e,onItemClick:n,onRegenerate:r,isRegenerating:a})=>{const[i,l]=ce.useState(!0),[c,d]=ce.useState(new Set),[f,g]=ce.useState("all"),y=ce.useRef(null),[_,w]=ce.useState(!1),[E,S]=ce.useState("day"),[C,R]=ce.useState({start:"",end:""}),b={day:40,week:15,month:5}[E],O=ce.useMemo(()=>{const re=new Map;return t.filter(W=>W.type==="task").forEach((W,N)=>{re.set(W.id,R_[N%R_.length])}),re},[t]),U=ce.useCallback((re,W)=>{if(re.type==="task")return re.id;let N=re;for(;N.parentId;){const Z=W.get(N.parentId);if(!Z)return null;if(Z.type==="task")return Z.id;N=Z}return null},[]),j=ce.useMemo(()=>new Map(t.map(re=>[re.id,re])),[t]),F=ce.useCallback(re=>{const W=U(re,j);return W&&O.get(W)||"#9CA3AF"},[j,O,U]);ce.useEffect(()=>{const re=new Set(t.filter(W=>W.type==="task").map(W=>W.id));d(re)},[t]);const K=re=>{d(W=>{const N=new Set(W);return N.has(re)?N.delete(re):N.add(re),N})},P=ce.useMemo(()=>{const re=[];return t.filter(N=>N.type==="task").forEach(N=>{re.push(N),c.has(N.id)&&t.filter(M=>M.type==="substep"&&M.parentId===N.id).forEach(M=>{if(re.push(M),c.has(M.id)){const V=t.filter(Y=>{if(Y.type!=="actionitem"||Y.parentId!==M.id)return!1;if(f==="all")return!0;const z=Y.progress===100;return f==="completed"?z:f==="pending"?!z:!0});re.push(...V)}})}),re},[t,c,f]),{timelineStart:ne,totalDays:Q}=ce.useMemo(()=>{if(t.length===0)return{timelineStart:new Date,totalDays:30};const re=t.map(z=>new Date(z.start)).filter(z=>!isNaN(z.getTime())),W=t.map(z=>new Date(z.end)).filter(z=>!isNaN(z.getTime()));let N,Z;re.length===0||W.length===0?(N=new Date,Z=new Date,Z.setMonth(Z.getMonth()+1)):(N=new Date(Math.min(...re.map(z=>z.getTime()))),Z=new Date(Math.max(...W.map(z=>z.getTime()))));let M=C.start?new Date(C.start):N,V=C.end?new Date(C.end):Z;isNaN(M.getTime())&&(M=N),isNaN(V.getTime())&&(V=Z),V<M&&(V=M),M.setDate(M.getDate()-2),V.setDate(V.getDate()+5);const Y=(V.getTime()-M.getTime())/(1e3*3600*24);return{timelineStart:M,totalDays:Math.ceil(Y)}},[t,C]),te=ce.useMemo(()=>{const re=Z=>{Z=new Date(Date.UTC(Z.getFullYear(),Z.getMonth(),Z.getDate())),Z.setUTCDate(Z.getUTCDate()+4-(Z.getUTCDay()||7));const M=new Date(Date.UTC(Z.getUTCFullYear(),0,1));return Math.ceil(((Z.getTime()-M.getTime())/864e5+1)/7)},W=[];let N=new Date(ne);if(E==="day")for(let Z=0;Z<Q;Z++)W.push({secondaryLabel:N.toLocaleDateString("ja-JP",{weekday:"short"}),label:String(N.getDate()),width:b}),N.setDate(N.getDate()+1);else if(E==="week")for(let Z=0;Z<Q;Z++)(N.getDay()===1||W.length===0)&&W.push({label:`W${re(N)}`,secondaryLabel:N.toLocaleDateString("ja-JP",{month:"short"}),width:0}),W[W.length-1].width+=b,N.setDate(N.getDate()+1);else if(E==="month"){let Z=-1;for(let M=0;M<Q;M++){const V=N.getMonth();V!==Z&&(Z=V,W.push({label:N.toLocaleDateString("ja-JP",{month:"long",year:"numeric"}),width:0})),W[W.length-1].width+=b,N.setDate(N.getDate()+1)}}return W},[ne,Q,E,b]),_e=re=>{const W=new Date(re);return isNaN(W.getTime())?-1:(W.getTime()-ne.getTime())/(1e3*3600*24)},Le=re=>{switch(re){case"substep":return"pl-5";case"actionitem":return"pl-9";default:return"pl-1"}},Te=re=>t.some(W=>W.parentId===re),ae=ce.useCallback(()=>{if(y.current===null){alert("チャート要素が見つかりません。");return}w(!0),g8(y.current,{cacheBust:!0,backgroundColor:"#ffffff",width:y.current.scrollWidth,height:y.current.scrollHeight}).then(re=>{const W=document.createElement("a");W.download="gantt-chart.png",W.href=re,W.click()}).catch(re=>{console.error("ガントチャートのダウンロードに失敗しました。",re),alert("画像のダウンロードに失敗しました。コンソールログを確認してください。")}).finally(()=>{w(!1)})},[]),ue=ce.useMemo(()=>te.reduce((re,W)=>re+W.width,0),[te]);return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 z-[80]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex flex-wrap items-center justify-between p-4 border-b gap-4",children:[x.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"ガントチャート"}),x.jsxs("div",{className:"flex items-center flex-wrap gap-x-6 gap-y-2",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm font-medium text-slate-600",children:"表示単位:"}),x.jsx("div",{className:"flex items-center rounded-md bg-slate-100 p-1",children:["day","week","month"].map(re=>x.jsx("button",{onClick:()=>S(re),className:`px-3 py-1 text-xs capitalize rounded-md ${E===re?"bg-white shadow-sm font-semibold text-blue-600":""}`,children:re},re))})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm font-medium text-slate-600",children:"表示範囲:"}),x.jsx("input",{type:"date",value:C.start,onChange:re=>R(W=>({...W,start:re.target.value})),className:"p-1 border rounded-md text-sm"}),x.jsx("span",{children:"-"}),x.jsx("input",{type:"date",value:C.end,onChange:re=>R(W=>({...W,end:re.target.value})),className:"p-1 border rounded-md text-sm"}),x.jsx("button",{onClick:()=>R({start:"",end:""}),className:"text-xs px-2 py-1 bg-slate-200 rounded-md hover:bg-slate-300",children:"リセット"})]}),x.jsxs("button",{onClick:ae,disabled:_,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[_?x.jsx(Ar,{size:"sm",color:"border-white"}):x.jsx(tl,{className:"w-4 h-4"}),"PNG"]}),x.jsxs("button",{onClick:e,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-100 rounded-md hover:bg-slate-200",children:[x.jsx(Vr,{className:"w-5 h-5"}),"閉じる"]})]})]}),x.jsxs("div",{className:"flex-shrink-0 p-4 border-b flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-100 p-1",children:[x.jsx("button",{onClick:()=>g("all"),className:`px-3 py-1 text-xs rounded-full ${f==="all"?"bg-white shadow-sm":""}`,children:"すべて"}),x.jsx("button",{onClick:()=>g("pending"),className:`px-3 py-1 text-xs rounded-full ${f==="pending"?"bg-white shadow-sm":""}`,children:"未完了"}),x.jsx("button",{onClick:()=>g("completed"),className:`px-3 py-1 text-xs rounded-full ${f==="completed"?"bg-white shadow-sm":""}`,children:"完了"})]}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("button",{onClick:r,disabled:a,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[a?x.jsx(Ar,{size:"sm",color:"border-white"}):x.jsx(pd,{className:"w-4 h-4"}),"AIで再生成"]}),x.jsxs("label",{className:"flex items-center text-sm text-slate-600 cursor-pointer",children:[x.jsx("input",{type:"checkbox",checked:i,onChange:()=>l(re=>!re),className:"w-4 h-4 mr-2 accent-blue-600"}),"依存関係"]})]})]}),x.jsx("div",{className:"flex-grow overflow-auto relative",children:x.jsxs("div",{ref:y,className:"grid",style:{gridTemplateColumns:`${N_}px 1fr`,width:`${N_+ue}px`},children:[x.jsx("div",{className:"sticky top-0 left-0 z-30 flex items-center p-2 font-semibold text-sm border-b border-r bg-slate-100 text-slate-800",style:{gridColumn:1,gridRow:1,height:k_},children:"タスク / サブステップ"}),x.jsx("div",{className:"sticky top-0 z-20 border-b bg-slate-50",style:{gridColumn:2,gridRow:1,height:k_},children:x.jsx("div",{className:"flex h-full",children:te.map((re,W)=>x.jsxs("div",{className:"border-r text-center text-[10px] flex flex-col items-center justify-center",style:{width:re.width},children:[re.secondaryLabel&&x.jsx("span",{className:"font-semibold text-slate-600",children:re.secondaryLabel}),x.jsx("div",{className:`font-bold text-slate-800 ${E==="day"?"text-lg":"text-sm"}`,children:re.label})]},W))})}),x.jsx("div",{className:"pointer-events-none flex",style:{gridColumn:2,gridRow:`2 / span ${P.length}`},children:te.map((re,W)=>x.jsx("div",{className:"h-full border-r border-slate-200",style:{width:re.width}},W))}),P.map((re,W)=>{const N=F(re),Z=(()=>{const ye=P[W+1];return ye?U(re,j)!==U(ye,j):!0})(),M=_e(re.start),V=Math.max(.2,_e(re.end)-M+1),Y=M*b,z=V*b,ie={task:{height:"24px"},substep:{height:"20px"},actionitem:{height:"8px"}};return x.jsxs(ls.Fragment,{children:[x.jsxs("div",{className:"sticky left-0 z-10 flex items-center border-r bg-slate-50",style:{gridColumn:1,gridRow:W+2,height:pc,borderBottom:Z?`2px solid ${N}`:"1px solid #e5e7eb"},children:[x.jsx("div",{className:"w-1 h-full flex-shrink-0",style:{backgroundColor:N}}),x.jsxs("div",{className:`flex items-center w-full ${Le(re.type)}`,children:[(re.type==="task"||re.type==="substep")&&(Te(re.id)?x.jsx(cF,{onClick:()=>K(re.id),className:`w-4 h-4 mr-1 text-slate-500 cursor-pointer transition-transform ${c.has(re.id)?"rotate-0":"-rotate-90"}`}):x.jsx("div",{className:"w-4 h-4 mr-1"})),re.type==="actionitem"&&(re.progress===100?x.jsx(eu,{className:"w-3.5 h-3.5 text-green-600 mr-2 flex-shrink-0"}):x.jsx(md,{className:"w-3.5 h-3.5 text-slate-400 mr-2 flex-shrink-0"})),x.jsx("span",{onClick:()=>n==null?void 0:n(re),className:`truncate text-xs ${re.type==="task"?"font-semibold text-slate-800":"text-slate-600"} ${n?"cursor-pointer hover:text-blue-600":""}`,title:re.name,children:re.name})]})]}),x.jsx("div",{className:"relative",style:{gridColumn:2,gridRow:W+2,borderBottom:Z?`2px solid ${N}`:"1px solid #e5e7eb"},children:M>=0&&x.jsx("div",{title:`${re.name} (${re.progress}%)`,onClick:()=>n==null?void 0:n(re),className:"absolute h-full flex items-center group",style:{left:Y,width:z,cursor:n?"pointer":"default"},children:x.jsx("div",{className:"w-full rounded",style:{...ie[re.type],backgroundColor:N},children:x.jsx("div",{className:"bg-black bg-opacity-30 h-full rounded",style:{width:`${re.progress}%`}})})})})]},re.id)}),x.jsx("div",{style:{gridColumn:2,gridRow:`2 / span ${P.length}`,position:"relative",pointerEvents:"none"},children:i&&x.jsx(v8,{items:P,getDaysFromStart:_e,dayWidth:b})})]})})]})})},v8=({items:t,getDaysFromStart:e,dayWidth:n})=>{const r=ce.useMemo(()=>{const a=[],i=new Map(t.map((l,c)=>[l.id,c]));return t.forEach((l,c)=>{(l.dependencies||[]).forEach(d=>{const f=i.get(d),g=f!==void 0?t[f]:void 0;if(g&&f!==void 0){const y=e(g.end),_=e(l.start);if(y<0||_<0)return;const w=(y+1)*n,E=f*pc+pc/2,S=_*n,C=c*pc+pc/2,R=w+20,k=S-20,b=`M ${w} ${E} C ${R} ${E}, ${k} ${C}, ${S} ${C}`;a.push({key:`${d}-${l.id}`,d:b})}})}),a},[t,e,n]);return x.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",overflow:"visible",children:[x.jsx("defs",{children:x.jsx("marker",{id:"gantt_arrowhead",markerWidth:"5",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:x.jsx("polygon",{points:"0 0, 5 2, 0 4",fill:"#4b5563"})})}),r.map(a=>x.jsx("path",{d:a.d,stroke:"#4b5563",strokeWidth:"1",fill:"none",markerEnd:"url(#gantt_arrowhead)"},a.key))]})},ul=({message:t})=>t?x.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md relative",role:"alert",children:[x.jsx("strong",{className:"font-bold",children:"Error: "}),x.jsx("span",{className:"block sm:inline",children:t})]}):null,y8=({tasks:t,projectGoal:e,targetDate:n,ganttData:r,projectReportDeck:a,onClose:i,onReportGenerated:l,generateUniqueId:c})=>{const[d,f]=ce.useState("list"),[g,y]=ce.useState(new Set),[_,w]=ce.useState(""),[E,S]=ce.useState(!1),[C,R]=ce.useState(null),[k,b]=ce.useState({key:"taskName",direction:"ascending"}),[O,U]=ce.useState("slides"),[j,F]=ce.useState(null),K=ce.useMemo(()=>{const N=[];return r&&N.push({id:"gantt-chart-main",name:"プロジェクト ガントチャート",type:"Gantt Chart",taskName:"プロジェクト全体",subStepName:"",actionItemName:"",source:{name:"プロジェクト ガントチャート",type:"json",content:r}}),a&&N.push({id:"project-report-main",name:"プロジェクトレポート",type:"Project Report",taskName:"プロジェクト全体",subStepName:"",actionItemName:"",source:{name:"プロジェクトレポート",type:"json",content:a}}),t.forEach(Z=>{var M,V,Y,z,ie;(M=Z.extendedDetails)!=null&&M.reportDeck&&N.push({id:`task-report-${Z.id}`,name:`タスクレポート: ${Z.title}`,type:"Task Report",taskName:Z.title,subStepName:"",actionItemName:"",source:{name:`タスクレポート: ${Z.title}`,type:"json",content:Z.extendedDetails.reportDeck}}),(Y=(V=Z.extendedDetails)==null?void 0:V.attachments)==null||Y.forEach(ye=>{N.push({id:ye.id,name:ye.name,type:"Attachment",taskName:Z.title,subStepName:"",actionItemName:"",source:{name:ye.name,type:ye.type.startsWith("image/")?"image":"text",content:ye.dataUrl,dataUrl:ye.dataUrl}})}),(ie=(z=Z.extendedDetails)==null?void 0:z.subSteps)==null||ie.forEach(ye=>{var Ce,Re;(Ce=ye.attachments)==null||Ce.forEach(Ee=>{N.push({id:Ee.id,name:Ee.name,type:"Attachment",taskName:Z.title,subStepName:ye.text,actionItemName:"",source:{name:Ee.name,type:Ee.type.startsWith("image/")?"image":"text",content:Ee.dataUrl,dataUrl:Ee.dataUrl}})}),(Re=ye.actionItems)==null||Re.forEach(Ee=>{var Ke,J,xt;(J=(Ke=Ee.report)==null?void 0:Ke.attachments)==null||J.forEach(et=>{N.push({id:et.id,name:et.name,type:"Attachment",taskName:Z.title,subStepName:ye.text,actionItemName:Ee.text,source:{name:et.name,type:et.type.startsWith("image/")?"image":"text",content:et.dataUrl,dataUrl:et.dataUrl}})}),(xt=Ee.report)!=null&&xt.matrixData&&N.push({id:`matrix-${Ee.id}`,name:`データマトリクス: ${Ee.text}`,type:"Data Matrix",taskName:Z.title,subStepName:ye.text,actionItemName:Ee.text,source:{name:`データマトリクス: ${Ee.text}`,type:"json",content:Ee.report.matrixData}})})})}),N},[t,r,a]),P=ce.useMemo(()=>{let N=[...K];return k!==null&&N.sort((Z,M)=>{const V=(Z[k.key]||"").toLowerCase(),Y=(M[k.key]||"").toLowerCase();return V<Y?k.direction==="ascending"?-1:1:V>Y?k.direction==="ascending"?1:-1:0}),N},[K,k]),ne=N=>{let Z="ascending";k&&k.key===N&&k.direction==="ascending"&&(Z="descending"),b({key:N,direction:Z})},Q=N=>!k||k.key!==N?x.jsx(Mi,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):k.direction==="ascending"?x.jsx(Bc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Mi,{className:"w-3 h-3 ml-1 text-blue-600"}),te=N=>{y(Z=>{const M=new Set(Z);return M.has(N)?M.delete(N):M.add(N),M})},_e=()=>{g.size===K.length?y(new Set):y(new Set(K.map(N=>N.id)))},Le=async()=>{if(g.size===0){R("レポート生成には、少なくとも1つの資料を選択してください。");return}if(!_.trim()){R("レポートの目的をプロンプトに入力してください。");return}S(!0),R(null),F(null);const N=K.filter(Z=>g.has(Z.id)).map(Z=>Z.source);try{if(O==="slides"){const Z=await g2(N,_);l(Z)}else{const Z=await JM(N,_);F(Z)}}catch(Z){R(Z instanceof Error?Z.message:"カスタムレポートの生成に失敗しました。")}finally{S(!1)}},Te=N=>{switch(N){case"Gantt Chart":return x.jsx(G2,{className:"w-5 h-5 text-amber-600"});case"Project Report":case"Task Report":return x.jsx(B2,{className:"w-5 h-5 text-teal-600"});case"Attachment":return x.jsx(Ys,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return x.jsx(tu,{className:"w-5 h-5 text-purple-600"});default:return x.jsx(Di,{className:"w-5 h-5 text-slate-500"})}},ae=N=>{if(N.dataUrl)return N.dataUrl;if(N.type==="json")try{const Z=JSON.stringify(N.content,null,2),M=new Blob([Z],{type:"application/json"});return URL.createObjectURL(M)}catch{return}},ue=ce.useMemo(()=>K.filter(N=>g.has(N.id)),[g,K]),re=()=>x.jsxs(x.Fragment,{children:[x.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:x.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx("th",{className:"p-2 border border-slate-300 w-10 text-center",children:x.jsx("input",{type:"checkbox",checked:g.size===K.length&&K.length>0,onChange:_e,className:"w-4 h-4 accent-blue-600"})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ne("name"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"資料名"}),Q("name")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-40",children:x.jsxs("button",{onClick:()=>ne("type"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"種類"}),Q("type")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ne("taskName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"タスク"}),Q("taskName")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ne("subStepName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"サブステップ"}),Q("subStepName")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>ne("actionItemName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"アクション"}),Q("actionItemName")]})})]})}),x.jsx("tbody",{children:P.map(N=>{const Z=ae(N.source);return x.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"border border-slate-300 align-middle text-center p-2",children:x.jsx("input",{type:"checkbox",checked:g.has(N.id),onChange:()=>te(N.id),className:"w-4 h-4 accent-blue-600"})}),x.jsx("td",{className:"border border-slate-300 p-2 font-medium text-slate-800",children:Z?x.jsx("a",{href:Z,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:N.name}):x.jsx("span",{children:N.name})}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600",children:x.jsxs("div",{className:"flex items-center gap-2",children:[Te(N.type),x.jsx("span",{children:N.type})]})}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.taskName}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.subStepName}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:N.actionItemName})]},N.id)})})]})}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[x.jsxs("span",{className:"text-sm text-slate-600",children:[g.size," / ",K.length," 件の資料を選択中"]}),x.jsx("button",{onClick:()=>f("generate"),disabled:g.size===0,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed",children:"レポート生成へ"})]})]}),W=()=>x.jsxs(x.Fragment,{children:[x.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.jsxs("div",{children:[x.jsxs("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:["選択した資料 (",ue.length,"件)"]}),x.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-96 overflow-y-auto space-y-2",children:ue.map(N=>x.jsxs("div",{className:"text-sm text-slate-700 flex items-center gap-2",children:[Te(N.type),x.jsx("span",{className:"truncate",title:N.name,children:N.name})]},N.id))}),x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mt-6 mb-2",children:"レポート形式"}),x.jsxs("div",{className:"flex gap-4",children:[x.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[x.jsx("input",{type:"radio",name:"reportFormat",value:"slides",checked:O==="slides",onChange:()=>U("slides"),className:"w-4 h-4 accent-blue-600"}),"スライド形式"]}),x.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[x.jsx("input",{type:"radio",name:"reportFormat",value:"text",checked:O==="text",onChange:()=>U("text"),className:"w-4 h-4 accent-blue-600"}),"テキスト形式"]})]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:"レポート作成の目的"}),x.jsx("textarea",{value:_,onChange:N=>w(N.target.value),placeholder:"例：これらの資料からプロジェクトの進捗状況をまとめ、経営層向けの報告スライドを作成してください。",rows:6,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),C&&x.jsx("div",{className:"mt-2",children:x.jsx(ul,{message:C})}),j&&x.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-slate-50",children:[x.jsx("h5",{className:"font-semibold text-md text-slate-800 mb-2",children:"生成されたテキストレポート"}),x.jsx("pre",{className:"text-sm text-slate-700 bg-white p-3 rounded whitespace-pre-wrap max-h-60 overflow-y-auto",children:j}),x.jsx("button",{onClick:()=>navigator.clipboard.writeText(j),className:"text-xs mt-2 px-2 py-1 bg-slate-200 rounded",children:"クリップボードにコピー"})]})]})]}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[x.jsxs("button",{onClick:()=>{f("list"),F(null)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:[x.jsx(L2,{className:"w-4 h-4"}),"資料選択に戻る"]}),x.jsxs("button",{onClick:Le,disabled:E,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[E?x.jsx(Ar,{size:"sm",color:"border-white"}):x.jsx(nu,{className:"w-5 h-5"}),x.jsx("span",{children:E?"生成中...":"レポートを生成"})]})]})]});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[70]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-3",children:[x.jsx(Di,{className:"w-7 h-7 text-blue-600"}),x.jsx("span",{children:"資料センター"})]}),x.jsx("button",{onClick:i,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(Vr,{className:"w-6 h-6 text-slate-500"})})]}),d==="list"?re():W()]})})},_8=({tasks:t,projectGoal:e,targetDate:n,onSelectTask:r,onUpdateTaskExtendedDetails:a,onUpdateTaskPosition:i,onUpdateTaskStatus:l,onStartNewProject:c,onExportProject:d,onAddTask:f,onRemoveTask:g,onImportSingleTask:y,onAutoLayout:_,onUndo:w,canUndo:E,onRedo:S,canRedo:C,generateUniqueId:R,onUpdateTaskConnections:k,ganttData:b,setGanttData:O,onCustomReportGenerated:U,onClearApiKey:j,onOpenProjectList:F,onLogout:K,currentProjectId:P,onSaveProject:ne})=>{ce.useRef(null);const Q=ce.useRef(null),[te,_e]=ce.useState(new Map),[Le,Te]=ce.useState([]),ae=ce.useRef(null),ue=ce.useRef({x:0,y:0}),[re,W]=ce.useState(!1),[N,Z]=ce.useState(!1),[M,V]=ce.useState(null),[Y,z]=ce.useState(!1),[ie,ye]=ce.useState(null),[Ce,Re]=ce.useState(!1),[Ee,Ke]=ce.useState(null),[J,xt]=ce.useState(!1),[et,St]=ce.useState(null),[st,Me]=ce.useState(!1),[jt,nn]=ce.useState(!1),[xn,on]=ce.useState(null),[lr,Ct]=ce.useState(!1),[vn,Nn]=ce.useState(!1),[Xt,zt]=ce.useState(null),[De,Ie]=ce.useState({x:0,y:0}),[Fe,je]=ce.useState(!1);ce.useEffect(()=>{const Be=new Map;t.forEach(Xe=>{Be.set(Xe.id,te.get(Xe.id)||ce.createRef())}),_e(Be)},[t]);const ft=ce.useCallback(()=>{if(!Q.current||te.size===0){Te([]);return}const Be=[];t.forEach(Xe=>{var Ze,bt;if(Xe.nextTaskIds&&Xe.nextTaskIds.length>0){const yn=te.get(Xe.id),dt=yn==null?void 0:yn.current;if(!dt)return;const zr=((Ze=Xe.position)==null?void 0:Ze.x)||0,D=((bt=Xe.position)==null?void 0:bt.y)||0,H=dt.getBoundingClientRect(),L={x:zr+H.width,y:D+H.height/2};Xe.nextTaskIds.forEach(B=>{var Ne,Pe;const G=t.find(He=>He.id===B);if(!G)return;const q=te.get(B),de=q==null?void 0:q.current;if(!de)return;const ve=((Ne=G.position)==null?void 0:Ne.x)||0,le=((Pe=G.position)==null?void 0:Pe.y)||0,me=de.getBoundingClientRect(),pe={x:ve,y:le+me.height/2};Be.push({id:`conn-${Xe.id}-${B}`,from:L,to:pe,sourceId:Xe.id,targetId:B})})}}),Te(Be)},[t,te]);ce.useEffect(()=>{const Be=setTimeout(ft,50);return()=>clearTimeout(Be)},[ft,t]),ce.useEffect(()=>{window.addEventListener("resize",ft);const Be=new MutationObserver(ft);return Q.current&&Be.observe(Q.current,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.removeEventListener("resize",ft),Be.disconnect()}},[ft]);const lt=(Be,Xe)=>{var bt,yn;ae.current=Xe;const Ze=t.find(dt=>dt.id===Xe);if(Q.current){const dt=Q.current.getBoundingClientRect();ue.current.x=Be.clientX-dt.left-(((bt=Ze==null?void 0:Ze.position)==null?void 0:bt.x)||0),ue.current.y=Be.clientY-dt.top-(((yn=Ze==null?void 0:Ze.position)==null?void 0:yn.y)||0)}Be.dataTransfer.effectAllowed="move"},cn=Be=>{Be.preventDefault(),Be.dataTransfer.dropEffect="move"},Gn=Be=>{var L;if(Be.preventDefault(),!ae.current||!Q.current)return;const Xe=Q.current.getBoundingClientRect(),Ze=(L=te.get(ae.current))==null?void 0:L.current,bt=(Ze==null?void 0:Ze.offsetWidth)||380,yn=(Ze==null?void 0:Ze.offsetHeight)||280;let dt=Be.clientX-Xe.left-ue.current.x,zr=Be.clientY-Xe.top-ue.current.y;const D=Q.current.scrollWidth,H=Q.current.scrollHeight;dt=Math.max(0,Math.min(dt,D-bt)),zr=Math.max(0,Math.min(zr,H-yn)),i(ae.current,{x:dt,y:zr}),ae.current=null,setTimeout(ft,0)},vr=async()=>{z(!0),ye(null);try{const Be=await zM(t,e,n);V(Be),Z(!0)}catch(Be){ye(Be instanceof Error?Be.message:"プロジェクト診断レポートの生成に失敗しました。")}finally{z(!1)}},yr=async()=>{if(Ee){Re(!0);return}xt(!0),St(null);try{const Be=await qM(t,e,n);Ke(Be),Re(!0)}catch(Be){St(Be instanceof Error?Be.message:"プロジェクトレポートの生成に失敗しました。")}finally{xt(!1)}},Sa=async()=>{if(b){Me(!0);return}nn(!0),on(null);try{const Be=await zy(t,e,n);O(Be),Me(!0)}catch(Be){on(Be instanceof Error?Be.message:"ガントチャートのデータ生成に失敗しました。")}finally{nn(!1)}},Hr=async()=>{nn(!0),on(null);try{const Be=await zy(t,e,n);O(Be)}catch(Be){on(Be instanceof Error?Be.message:"ガントチャートのデータ再生成に失敗しました。")}finally{nn(!1)}},Gr=async()=>{if(P){je(!0);try{await ne(),alert("プロジェクトが保存されました！")}catch(Be){alert("プロジェクトの保存に失敗しました: "+(Be instanceof Error?Be.message:"不明なエラー"))}finally{je(!1)}}else{const Be=prompt("プロジェクト名を入力してください:",`${e.substring(0,50)}...`);if(!Be)return;je(!0);try{const Xe=await Uc.createProject(Be,e,n,t,b);alert("プロジェクトが保存されました！")}catch(Xe){alert("プロジェクトの保存に失敗しました: "+(Xe instanceof Error?Xe.message:"不明なエラー"))}finally{je(!1)}}},$r=(Be,Xe)=>{if(!Q.current)return;const Ze=Q.current.getBoundingClientRect(),bt={x:Xe.clientX-Ze.left+Q.current.scrollLeft,y:Xe.clientY-Ze.top+Q.current.scrollTop};zt({fromId:Be,fromPos:bt})},vt=Be=>{if(!Xt||Xt.fromId===Be){zt(null);return}const Xe=t.find(Ze=>Ze.id===Xt.fromId);if(Xe){const Ze=Array.from(new Set([...Xe.nextTaskIds||[],Be]));k(Xe.id,Ze)}zt(null)},un=(Be,Xe)=>{const Ze=t.find(bt=>bt.id===Be);if(Ze){const bt=(Ze.nextTaskIds||[]).filter(yn=>yn!==Xe);k(Ze.id,bt)}},$n=Be=>{if(!Xt||!Q.current)return;const Xe=Q.current.getBoundingClientRect();Ie({x:Be.clientX-Xe.left+Q.current.scrollLeft,y:Be.clientY-Xe.top+Q.current.scrollTop})},cr=()=>{Xt&&zt(null)},oa=Be=>{const Xe=Be.type==="task"?Be.id:Be.parentId;if(!Xe)return;const Ze=t.find(bt=>bt.id===Xe);Ze&&(Me(!1),r(Ze))},la=Be=>{U(Be),Nn(!1)},ms=n?new Date(n+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"未設定";return Ce&&Ee?x.jsx(Qm,{tasks:t,initialDeck:Ee,onSave:Be=>Ke(Be),onClose:()=>Re(!1),projectGoal:e,targetDate:n,reportScope:"project",generateUniqueId:R}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"min-h-screen bg-slate-100 p-4 md:p-6 flex flex-col overflow-hidden",children:[x.jsxs("div",{className:"max-w-full mx-auto w-full",children:[x.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[x.jsxs("button",{onClick:()=>Ct(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-slate-600 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-transform hover:scale-105",children:[x.jsx(nl,{className:"w-5 h-5 mr-2"}),"新規プロジェクト"]}),x.jsxs("div",{className:"flex flex-wrap gap-2",children:[x.jsx("button",{onClick:F,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"保存済みプロジェクト",children:x.jsx(Di,{className:"w-5 h-5"})}),x.jsx("button",{onClick:Gr,disabled:Fe,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 disabled:bg-slate-400",title:"プロジェクトを保存",children:Fe?x.jsx(Ar,{size:"sm",color:"border-white"}):x.jsx(tl,{className:"w-5 h-5"})}),x.jsx("button",{onClick:w,disabled:!E,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"元に戻す",children:x.jsx(j2,{className:"w-5 h-5"})}),x.jsx("button",{onClick:S,disabled:!C,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"やり直し",children:x.jsx(V2,{className:"w-5 h-5"})}),x.jsx("button",{onClick:j,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"APIキーを変更",children:x.jsx(jc,{className:"w-5 h-5 text-yellow-600"})}),x.jsx("button",{onClick:K,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700",title:"ログアウト",children:x.jsx(jc,{className:"w-5 h-5"})}),x.jsxs("button",{onClick:f,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700",children:[x.jsx(Km,{className:"w-5 h-5 mr-2"}),"タスク追加"]}),x.jsxs("button",{onClick:d,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[x.jsx(tl,{className:"w-5 h-5 mr-2"}),"JSONエクスポート"]}),x.jsxs("button",{onClick:_,className:"inline-flex items-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",title:"自動整列",children:[x.jsx(pd,{className:"w-5 h-5 mr-2"}),"整列"]})]})]}),x.jsxs("header",{className:"mb-6 p-6 bg-white rounded-xl shadow-lg",children:[x.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-3",children:"プロジェクトフロー"}),x.jsxs("div",{className:"space-y-2 text-slate-700",children:[x.jsxs("p",{className:"flex items-start",children:[x.jsx(Jm,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0 mt-1"}),x.jsx("strong",{children:"目的:"})," ",x.jsx("span",{className:"break-all",children:e})]}),x.jsxs("p",{className:"flex items-center",children:[x.jsx(Wm,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0"}),x.jsx("strong",{children:"目標日:"})," ",ms]}),P&&x.jsx("p",{className:"text-sm text-green-600",children:"✓ Supabaseに保存済み"})]})]}),x.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[x.jsxs("button",{onClick:()=>W(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx(H2,{className:"w-5 h-5 mr-2"}),"アクションアイテム一覧"]}),x.jsxs("button",{onClick:()=>Nn(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx(Di,{className:"w-5 h-5 mr-2"}),"資料センター"]}),x.jsxs("button",{onClick:Sa,disabled:jt,className:"inline-flex items-center justify-center px-4 py-2 border border-amber-300 text-sm font-medium rounded-md shadow-sm text-amber-800 bg-amber-100 hover:bg-amber-200 disabled:bg-slate-400",children:[jt?x.jsx(Ar,{size:"sm"}):x.jsx(G2,{className:"w-5 h-5 mr-2"}),"ガントチャート"]}),x.jsxs("button",{onClick:vr,disabled:Y,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400",children:[Y?x.jsx(Ar,{size:"sm"}):x.jsx(nu,{className:"w-5 h-5 mr-2"}),"AIプロジェクト診断"]}),x.jsxs("button",{onClick:yr,disabled:J,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-teal-600 hover:bg-teal-700 disabled:bg-slate-400",children:[J?x.jsx(Ar,{size:"sm"}):x.jsx(B2,{className:"w-5 h-5 mr-2"}),"プロジェクトレポート作成"]})]})]}),ie&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:ie})}),et&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:et})}),xn&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:xn})})]})]}),x.jsxs("div",{ref:Q,className:"flex-grow overflow-auto pb-8 relative min-h-[600px] border border-slate-300 rounded-lg bg-slate-50 p-4 shadow-inner",onDragOver:cn,onDrop:Gn,onMouseMove:$n,onMouseUp:cr,children:[x.jsxs("div",{className:"relative w-full h-full min-w-[1200px] min-h-[800px]",children:[t.map((Be,Xe)=>x.jsx(mF,{cardRef:te.get(Be.id),task:Be,onSelectTask:r,onRemoveTask:g,onUpdateStatus:l,onDragCardStart:lt,onStartConnection:$r,onEndConnection:vt,index:Xe},Be.id)),Le.map(Be=>x.jsx(Vc,{from:Be.from,to:Be.to,id:Be.id,onDelete:()=>un(Be.sourceId,Be.targetId)},Be.id)),Xt&&x.jsx(Vc,{from:Xt.fromPos,to:De,id:"preview-connector"})]}),t.length===0&&x.jsx("div",{className:"text-center py-10 flex-grow flex items-center justify-center",children:x.jsx("p",{className:"text-slate-500 text-lg",children:"タスクがありません。「タスク追加」ボタンで最初のタスクを作成しましょう。"})})]})]}),st&&b&&x.jsx(x8,{data:b,onClose:()=>Me(!1),onItemClick:oa,onRegenerate:Hr,isRegenerating:jt}),vn&&x.jsx(y8,{tasks:t,projectGoal:e,targetDate:n,ganttData:b,projectReportDeck:Ee,onClose:()=>Nn(!1),onReportGenerated:la,generateUniqueId:R}),re&&x.jsx(pF,{tasks:t,onClose:()=>W(!1)}),N&&x.jsx(gF,{report:M,onClose:()=>Z(!1)}),lr&&x.jsx(EF,{onClose:()=>Ct(!1),onDownloadAndStartNew:()=>{d(),c()},onStartNewWithoutSaving:c})]})},T8=({proposals:t,existingSubSteps:e,onConfirm:n,onClose:r})=>{const[a,i]=ce.useState(()=>{const d={};return t.forEach((f,g)=>{d[g]={decision:"NEW",targetSubStepId:void 0}}),d}),l=(d,f,g)=>{i(y=>({...y,[d]:{...y[d],[f]:g}}))},c=()=>{const d=[],f=[];Object.entries(a).forEach(([g,y])=>{const _=parseInt(g,10),w=t[_];y.decision==="NEW"?d.push(w):y.decision==="ADD"&&y.targetSubStepId&&f.push({targetSubStepId:y.targetSubStepId,title:w.title})}),n({newSubSteps:d,newActionItems:f})};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AIによる計画提案のレビュー"}),x.jsx("button",{onClick:r,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Vr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-5 overflow-y-auto space-y-4",children:[x.jsx("p",{className:"text-sm text-slate-600",children:"AIが以下のステップを提案しました。計画に追加する項目と方法を選択してください。"}),x.jsx("div",{className:"space-y-3",children:t.map((d,f)=>x.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[x.jsx("p",{className:"font-semibold text-slate-800",children:d.title}),x.jsx("p",{className:"text-sm text-slate-600 mb-3",children:d.description}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("select",{value:a[f].decision,onChange:g=>l(f,"decision",g.target.value),className:"p-2 border border-slate-300 rounded-md text-sm",children:[x.jsx("option",{value:"NEW",children:"新しいサブステップとして追加"}),e.length>0&&x.jsx("option",{value:"ADD",children:"既存のサブステップに追加"}),x.jsx("option",{value:"IGNORE",children:"無視する"})]}),a[f].decision==="ADD"&&x.jsxs("select",{value:a[f].targetSubStepId||"",onChange:g=>l(f,"targetSubStepId",g.target.value),className:"flex-grow p-2 border border-slate-300 rounded-md text-sm",children:[x.jsx("option",{value:"",disabled:!0,children:"追加先のサブステップを選択..."}),e.map(g=>x.jsx("option",{value:g.id,children:g.text},g.id))]})]})]},f))})]}),x.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[x.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:"キャンセル"}),x.jsx("button",{onClick:c,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"選択を計画に反映"})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Q2=1252,w8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],np={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},rp=function(t){w8.indexOf(t)!=-1&&(Q2=np[0]=t)};function E8(){rp(1252)}var ya=function(t){rp(t)};function ew(){ya(1200),E8()}function D_(t){for(var e=[],n=0,r=t.length;n<r;++n)e[n]=t.charCodeAt(n);return e}function S8(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n)+(t.charCodeAt(2*n+1)<<8));return e.join("")}function tw(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n+1)+(t.charCodeAt(2*n)<<8));return e.join("")}var gc=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1);return e==255&&n==254?S8(t.slice(2)):e==254&&n==255?tw(t.slice(2)):e==65279?t.slice(1):t},bf=function(e){return String.fromCharCode(e)},M_=function(e){return String.fromCharCode(e)},Hc,$s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function I_(t){for(var e="",n=0,r=0,a=0,i=0,l=0,c=0,d=0,f=0;f<t.length;)n=t.charCodeAt(f++),i=n>>2,r=t.charCodeAt(f++),l=(n&3)<<4|r>>4,a=t.charCodeAt(f++),c=(r&15)<<2|a>>6,d=a&63,isNaN(r)?c=d=64:isNaN(a)&&(d=64),e+=$s.charAt(i)+$s.charAt(l)+$s.charAt(c)+$s.charAt(d);return e}function jr(t){var e="",n=0,r=0,a=0,i=0,l=0,c=0,d=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<t.length;)i=$s.indexOf(t.charAt(f++)),l=$s.indexOf(t.charAt(f++)),n=i<<2|l>>4,e+=String.fromCharCode(n),c=$s.indexOf(t.charAt(f++)),r=(l&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(r)),d=$s.indexOf(t.charAt(f++)),a=(c&3)<<6|d,d!==64&&(e+=String.fromCharCode(a));return e}var kt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Bi=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Xs(t){return kt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function F_(t){return kt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var va=function(e){return kt?Bi(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function ji(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function ap(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return ap(new Uint8Array(t));for(var e=new Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e}var Gs=kt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Bi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),a=0;for(e=0,n=0;e<t.length;n+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function C8(t){for(var e=[],n=0,r=t.length+250,a=Xs(t.length+255),i=0;i<t.length;++i){var l=t.charCodeAt(i);if(l<128)a[n++]=l;else if(l<2048)a[n++]=192|l>>6&31,a[n++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=t.charCodeAt(++i)&1023;a[n++]=240|l>>8&7,a[n++]=128|l>>2&63,a[n++]=128|c>>6&15|(l&3)<<4,a[n++]=128|c&63}else a[n++]=224|l>>12&15,a[n++]=128|l>>6&63,a[n++]=128|l&63;n>r&&(e.push(a.slice(0,n)),n=0,a=Xs(65535),r=65530)}return e.push(a.slice(0,n)),Gs(e)}var pr=/\u0000/g,xc=/[\u0001-\u0006]/g;function qo(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function _a(t,e){var n=""+t;return n.length>=e?n:pn("0",e-n.length)+n}function sp(t,e){var n=""+t;return n.length>=e?n:pn(" ",e-n.length)+n}function Kf(t,e){var n=""+t;return n.length>=e?n:n+pn(" ",e-n.length)}function b8(t,e){var n=""+Math.round(t);return n.length>=e?n:pn("0",e-n.length)+n}function A8(t,e){var n=""+t;return n.length>=e?n:pn("0",e-n.length)+n}var O_=Math.pow(2,32);function Uo(t,e){if(t>O_||t<-O_)return b8(t,e);var n=Math.round(t);return A8(n,e)}function Xf(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var L_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Bh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function k8(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},P_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},N8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Zf(t,e,n){for(var r=t<0?-1:1,a=t*r,i=0,l=1,c=0,d=1,f=0,g=0,y=Math.floor(a);f<e&&(y=Math.floor(a),c=y*l+i,g=y*f+d,!(a-y<5e-8));)a=1/(a-y),i=l,l=c,d=f,f=g;if(g>e&&(f>e?(g=d,c=i):(g=f,c=l)),!n)return[0,r*c,g];var _=Math.floor(r*c/g);return[_,r*c-_*g,g]}function Si(t,e,n){if(t>2958465||t<0)return null;var r=t|0,a=Math.floor(86400*(t-r)),i=0,l=[],c={D:r,T:a,u:86400*(t-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=n?[1317,10,29]:[1900,2,29],i=3;else if(r===0)l=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var d=new Date(1900,0,1);d.setDate(d.getDate()+r-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],i=d.getDay(),r<60&&(i=(i+6)%7),n&&(i=O8(d,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var nw=new Date(1899,11,31,0,0,0),R8=nw.getTime(),D8=new Date(1900,2,1,0,0,0);function rw(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=D8&&(n+=24*60*60*1e3),(n-(R8+(t.getTimezoneOffset()-nw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ip(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function M8(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function I8(t){var e=t<0?12:11,n=ip(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function F8(t){var e=ip(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Gc(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=I8(t):e===10?n=t.toFixed(10).substr(0,12):n=F8(t),ip(M8(n.toUpperCase()))}function Ii(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Gc(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return aa(14,rw(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function O8(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function L8(t,e,n,r){var a="",i=0,l=0,c=n.y,d,f=0;switch(t){case 98:c=n.y+543;case 121:switch(e.length){case 1:case 2:d=c%100,f=2;break;default:d=c%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:d=n.m,f=e.length;break;case 3:return Bh[n.m-1][1];case 5:return Bh[n.m-1][0];default:return Bh[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:d=n.d,f=e.length;break;case 3:return L_[n.q][0];default:return L_[n.q][1]}break;case 104:switch(e.length){case 1:case 2:d=1+(n.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:d=n.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:d=n.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?_a(n.S,e.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,i=Math.round(l*(n.S+n.u)),i>=60*l&&(i=0),e==="s"?i===0?"0":""+i/l:(a=_a(i,2+r),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":d=n.D*24+n.H;break;case"[m]":case"[mm]":d=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":d=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:d=c,f=1;break}var g=f>0?_a(d,f):"";return g}function zs(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var aw=/%/g;function P8(t,e,n){var r=e.replace(aw,""),a=e.length-r.length;return is(t,r,n*Math.pow(10,2*a))+pn("%",a)}function U8(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return is(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function sw(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+sw(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),n=(e/Math.pow(10,i)).toPrecision(r+1+(a+i)%a),n.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+i):n+="E+"+(l-i);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,g){return d+f+g.substr(0,(a+i)%a)+"."+g.substr(i)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var iw=/# (\?+)( ?)\/( ?)(\d+)/;function B8(t,e,n){var r=parseInt(t[4],10),a=Math.round(e*r),i=Math.floor(a/r),l=a-i*r,c=r;return n+(i===0?"":""+i)+" "+(l===0?pn(" ",t[1].length+1+t[4].length):sp(l,t[1].length)+t[2]+"/"+t[3]+_a(c,t[4].length))}function j8(t,e,n){return n+(e===0?"":""+e)+pn(" ",t[1].length+2+t[4].length)}var ow=/^#*0*\.([0#]+)/,lw=/\).*[0#]/,cw=/\(###\) ###\\?-####/;function dr(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function U_(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function B_(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function V8(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function H8(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ta(t,e,n){if(t.charCodeAt(0)===40&&!e.match(lw)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?ta("n",r,n):"("+ta("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return U8(t,e,n);if(e.indexOf("%")!==-1)return P8(t,e,n);if(e.indexOf("E")!==-1)return sw(e,n);if(e.charCodeAt(0)===36)return"$"+ta(t,e.substr(e.charAt(1)==" "?2:1),n);var a,i,l,c,d=Math.abs(n),f=n<0?"-":"";if(e.match(/^00+$/))return f+Uo(d,e.length);if(e.match(/^[#?]+$/))return a=Uo(n,0),a==="0"&&(a=""),a.length>e.length?a:dr(e.substr(0,e.length-a.length))+a;if(i=e.match(iw))return B8(i,d,f);if(e.match(/^#+0+$/))return f+Uo(d,e.length-e.indexOf("0"));if(i=e.match(ow))return a=U_(n,i[1].length).replace(/^([^\.]+)$/,"$1."+dr(i[1])).replace(/\.$/,"."+dr(i[1])).replace(/\.(\d*)$/,function(E,S){return"."+S+pn("0",dr(i[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return f+U_(d,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return f+zs(Uo(d,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+ta(t,e,-n):zs(""+(Math.floor(n)+V8(n,i[1].length)))+"."+_a(B_(n,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return ta(t,e.replace(/^#,#*,/,""),n);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qo(ta(t,e.replace(/[\\-]/g,""),n)),l=0,qo(qo(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(cw))return a=ta(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=Zf(d,Math.pow(10,l)-1,!1),a=""+f,g=is("n",i[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+i[2]+"/"+i[3],g=Kf(c[2],l),g.length<i[4].length&&(g=dr(i[4].substr(i[4].length-g.length))+g),a+=g,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=Zf(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?sp(c[1],l)+i[2]+"/"+i[3]+Kf(c[2],l):pn(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=Uo(n,0),e.length<=a.length?a:dr(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=e.indexOf(".")-l,_=e.length-a.length-y;return dr(e.substr(0,y)+a+e.substr(e.length-_))}if(i=e.match(/^00,000\.([#0]*0)$/))return l=B_(n,i[1].length),n<0?"-"+ta(t,e,-n):zs(H8(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?_a(0,3-E.length):"")+E})+"."+_a(l,i[1].length);switch(e){case"###,##0.00":return ta(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var w=zs(Uo(d,0));return w!=="0"?f+w:"";case"###,###.00":return ta(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return ta(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function G8(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return is(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function $8(t,e,n){var r=e.replace(aw,""),a=e.length-r.length;return is(t,r,n*Math.pow(10,2*a))+pn("%",a)}function uw(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+uw(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),n=(e/Math.pow(10,i)).toPrecision(r+1+(a+i)%a),!n.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+i):n+="E+"+(l-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,g){return d+f+g.substr(0,(a+i)%a)+"."+g.substr(i)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Ma(t,e,n){if(t.charCodeAt(0)===40&&!e.match(lw)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Ma("n",r,n):"("+Ma("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return G8(t,e,n);if(e.indexOf("%")!==-1)return $8(t,e,n);if(e.indexOf("E")!==-1)return uw(e,n);if(e.charCodeAt(0)===36)return"$"+Ma(t,e.substr(e.charAt(1)==" "?2:1),n);var a,i,l,c,d=Math.abs(n),f=n<0?"-":"";if(e.match(/^00+$/))return f+_a(d,e.length);if(e.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>e.length?a:dr(e.substr(0,e.length-a.length))+a;if(i=e.match(iw))return j8(i,d,f);if(e.match(/^#+0+$/))return f+_a(d,e.length-e.indexOf("0"));if(i=e.match(ow))return a=(""+n).replace(/^([^\.]+)$/,"$1."+dr(i[1])).replace(/\.$/,"."+dr(i[1])),a=a.replace(/\.(\d*)$/,function(E,S){return"."+S+pn("0",dr(i[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return f+zs(""+d);if(i=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Ma(t,e,-n):zs(""+n)+"."+pn("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Ma(t,e.replace(/^#,#*,/,""),n);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qo(Ma(t,e.replace(/[\\-]/g,""),n)),l=0,qo(qo(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(cw))return a=Ma(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=Zf(d,Math.pow(10,l)-1,!1),a=""+f,g=is("n",i[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+i[2]+"/"+i[3],g=Kf(c[2],l),g.length<i[4].length&&(g=dr(i[4].substr(i[4].length-g.length))+g),a+=g,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=Zf(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?sp(c[1],l)+i[2]+"/"+i[3]+Kf(c[2],l):pn(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=""+n,e.length<=a.length?a:dr(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=e.indexOf(".")-l,_=e.length-a.length-y;return dr(e.substr(0,y)+a+e.substr(e.length-_))}if(i=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Ma(t,e,-n):zs(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?_a(0,3-E.length):"")+E})+"."+_a(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var w=zs(""+d);return w!=="0"?f+w:"";default:if(e.match(/\.[0#?]*$/))return Ma(t,e.slice(0,e.lastIndexOf(".")),n)+dr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function is(t,e,n){return(n|0)===n?Ma(t,e,n):ta(t,e,n)}function z8(t){for(var e=[],n=!1,r=0,a=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(a,r-a),a=r+1}if(e[e.length]=t.substr(a),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var fw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fl(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":Xf(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match(fw))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function q8(t,e,n,r){for(var a=[],i="",l=0,c="",d="t",f,g,y,_="H";l<t.length;)switch(c=t.charAt(l)){case"G":if(!Xf(t,l))throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(y=t.charCodeAt(++l))!==34&&l<t.length;)i+=String.fromCharCode(y);a[a.length]={t:"t",v:i},++l;break;case"\\":var w=t.charAt(++l),E=w==="("||w===")"?w:"t";a[a.length]={t:E,v:w},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(f==null&&(f=Si(e,n,t.charAt(l+1)==="2"),f==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},d=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=Si(e,n),f==null))return"";for(i=c;++l<t.length&&t.charAt(l).toLowerCase()===c;)i+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=_),a[a.length]={t:c,v:i},d=c;break;case"A":case"a":case"上":var S={t:c,v:c};if(f==null&&(f=Si(e,n)),t.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(S.v=f.H>=12?"P":"A"),S.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(S.v=f.H>=12?"PM":"AM"),S.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="上午/下午"?(f!=null&&(S.v=f.H>=12?"下午":"上午"),S.t="T",l+=5,_="h"):(S.t="t",++l),f==null&&S.t==="T")return"";a[a.length]=S,d=c;break;case"[":for(i=c;t.charAt(l++)!=="]"&&l<t.length;)i+=t.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(fw)){if(f==null&&(f=Si(e,n),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},d=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",fl(t)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=c;++l<t.length&&(c=t.charAt(l))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++l<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(l))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;t.charAt(++l)===c;)i+=c;a[a.length]={t:c,v:i},d=c;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)i+=t.charAt(l);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"t",v:c},++l;break}var C=0,R=0,k;for(l=a.length-1,d="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,d="h",C<1&&(C=1);break;case"s":(k=a[l].v.match(/\.0+$/))&&(R=Math.max(R,k[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":d=a[l].t;break;case"m":d==="s"&&(a[l].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&a[l].v.match(/[Hh]/)&&(C=1),C<2&&a[l].v.match(/[Mm]/)&&(C=2),C<3&&a[l].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var b="",O;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=L8(a[l].t.charCodeAt(0),a[l].v,f,R),a[l].t="t";break;case"n":case"?":for(O=l+1;a[O]!=null&&((c=a[O].t)==="?"||c==="D"||(c===" "||c==="t")&&a[O+1]!=null&&(a[O+1].t==="?"||a[O+1].t==="t"&&a[O+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[O].v==="/"||a[O].v===" "&&a[O+1]!=null&&a[O+1].t=="?"));)a[l].v+=a[O].v,a[O]={v:"",t:";"},++O;b+=a[l].v,l=O-1;break;case"G":a[l].t="t",a[l].v=Ii(e,n);break}var U="",j,F;if(b.length>0){b.charCodeAt(0)==40?(j=e<0&&b.charCodeAt(0)===45?-e:e,F=is("n",b,j)):(j=e<0&&r>1?-e:e,F=is("n",b,j),j<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),O=F.length-1;var K=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){K=l;break}var P=a.length;if(K===a.length&&F.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(O>=a[l].v.length-1?(O-=a[l].v.length,a[l].v=F.substr(O+1,a[l].v.length)):O<0?a[l].v="":(a[l].v=F.substr(0,O+1),O=-1),a[l].t="t",P=l);O>=0&&P<a.length&&(a[P].v=F.substr(0,O+1)+a[P].v)}else if(K!==a.length&&F.indexOf("E")===-1){for(O=F.indexOf(".")-1,l=K;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(g=a[l].v.indexOf(".")>-1&&l===K?a[l].v.indexOf(".")-1:a[l].v.length-1,U=a[l].v.substr(g+1);g>=0;--g)O>=0&&(a[l].v.charAt(g)==="0"||a[l].v.charAt(g)==="#")&&(U=F.charAt(O--)+U);a[l].v=U,a[l].t="t",P=l}for(O>=0&&P<a.length&&(a[P].v=F.substr(0,O+1)+a[P].v),O=F.indexOf(".")+1,l=K;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==K)){for(g=a[l].v.indexOf(".")>-1&&l===K?a[l].v.indexOf(".")+1:0,U=a[l].v.substr(0,g);g<a[l].v.length;++g)O<F.length&&(U+=F.charAt(O++));a[l].v=U,a[l].t="t",P=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(j=r>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=is(a[l].t,a[l].v,j),a[l].t="t");var ne="";for(l=0;l!==a.length;++l)a[l]!=null&&(ne+=a[l].v);return ne}var j_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function V_(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function Y8(t,e){var n=z8(t),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var i=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,i];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var l=n[0].match(j_),c=n[1].match(j_);return V_(e,l)?[r,n[0]]:V_(e,c)?[r,n[1]]:[r,n[l!=null&&c!=null?2:1]]}return[r,i]}function aa(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:ut)[t],r==null&&(r=n.table&&n.table[P_[t]]||ut[P_[t]]),r==null&&(r=N8[t]||"General");break}if(Xf(r,0))return Ii(e,n);e instanceof Date&&(e=rw(e,n.date1904));var a=Y8(r,e);if(Xf(a[1]))return Ii(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return q8(a[1],e,n,a[0])}function Ci(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(ut[n]==null){e<0&&(e=n);continue}if(ut[n]==t){e=n;break}}e<0&&(e=391)}return ut[e]=t,e}function dw(){ut=k8()}var W8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},hw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function J8(t){var e=typeof t=="number"?ut[t]:t;return e=e.replace(hw,"(\\d+)"),new RegExp("^"+e+"$")}function K8(t,e,n){var r=-1,a=-1,i=-1,l=-1,c=-1,d=-1;(e.match(hw)||[]).forEach(function(y,_){var w=parseInt(n[_+1],10);switch(y.toLowerCase().charAt(0)){case"y":r=w;break;case"d":i=w;break;case"h":l=w;break;case"s":d=w;break;case"m":l>=0?c=w:a=w;break}}),d>=0&&c==-1&&a>=0&&(c=a,a=-1);var f=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var g=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&c==-1&&d==-1?f:r==-1&&a==-1&&i==-1?g:f+"T"+g}var X8=function(){var t={};t.version="1.2.0";function e(){for(var F=0,K=new Array(256),P=0;P!=256;++P)F=P,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,K[P]=F;return typeof Int32Array<"u"?new Int32Array(K):K}var n=e();function r(F){var K=0,P=0,ne=0,Q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ne=0;ne!=256;++ne)Q[ne]=F[ne];for(ne=0;ne!=256;++ne)for(P=F[ne],K=256+ne;K<4096;K+=256)P=Q[K]=P>>>8^F[P&255];var te=[];for(ne=1;ne!=16;++ne)te[ne-1]=typeof Int32Array<"u"?Q.subarray(ne*256,ne*256+256):Q.slice(ne*256,ne*256+256);return te}var a=r(n),i=a[0],l=a[1],c=a[2],d=a[3],f=a[4],g=a[5],y=a[6],_=a[7],w=a[8],E=a[9],S=a[10],C=a[11],R=a[12],k=a[13],b=a[14];function O(F,K){for(var P=K^-1,ne=0,Q=F.length;ne<Q;)P=P>>>8^n[(P^F.charCodeAt(ne++))&255];return~P}function U(F,K){for(var P=K^-1,ne=F.length-15,Q=0;Q<ne;)P=b[F[Q++]^P&255]^k[F[Q++]^P>>8&255]^R[F[Q++]^P>>16&255]^C[F[Q++]^P>>>24]^S[F[Q++]]^E[F[Q++]]^w[F[Q++]]^_[F[Q++]]^y[F[Q++]]^g[F[Q++]]^f[F[Q++]]^d[F[Q++]]^c[F[Q++]]^l[F[Q++]]^i[F[Q++]]^n[F[Q++]];for(ne+=15;Q<ne;)P=P>>>8^n[(P^F[Q++])&255];return~P}function j(F,K){for(var P=K^-1,ne=0,Q=F.length,te=0,_e=0;ne<Q;)te=F.charCodeAt(ne++),te<128?P=P>>>8^n[(P^te)&255]:te<2048?(P=P>>>8^n[(P^(192|te>>6&31))&255],P=P>>>8^n[(P^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,_e=F.charCodeAt(ne++)&1023,P=P>>>8^n[(P^(240|te>>8&7))&255],P=P>>>8^n[(P^(128|te>>2&63))&255],P=P>>>8^n[(P^(128|_e>>6&15|(te&3)<<4))&255],P=P>>>8^n[(P^(128|_e&63))&255]):(P=P>>>8^n[(P^(224|te>>12&15))&255],P=P>>>8^n[(P^(128|te>>6&63))&255],P=P>>>8^n[(P^(128|te&63))&255]);return~P}return t.table=n,t.bstr=O,t.buf=U,t.str=j,t}(),Dt=function(){var e={};e.version="1.2.1";function n(D,H){for(var L=D.split("/"),B=H.split("/"),G=0,q=0,de=Math.min(L.length,B.length);G<de;++G){if(q=L[G].length-B[G].length)return q;if(L[G]!=B[G])return L[G]<B[G]?-1:1}return L.length-B.length}function r(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:r(D.slice(0,-1));var H=D.lastIndexOf("/");return H===-1?D:D.slice(0,H+1)}function a(D){if(D.charAt(D.length-1)=="/")return a(D.slice(0,-1));var H=D.lastIndexOf("/");return H===-1?D:D.slice(H+1)}function i(D,H){typeof H=="string"&&(H=new Date(H));var L=H.getHours();L=L<<6|H.getMinutes(),L=L<<5|H.getSeconds()>>>1,D.write_shift(2,L);var B=H.getFullYear()-1980;B=B<<4|H.getMonth()+1,B=B<<5|H.getDate(),D.write_shift(2,B)}function l(D){var H=D.read_shift(2)&65535,L=D.read_shift(2)&65535,B=new Date,G=L&31;L>>>=5;var q=L&15;L>>>=4,B.setMilliseconds(0),B.setFullYear(L+1980),B.setMonth(q-1),B.setDate(G);var de=H&31;H>>>=5;var ve=H&63;return H>>>=6,B.setHours(H),B.setMinutes(ve),B.setSeconds(de<<1),B}function c(D){Wn(D,0);for(var H={},L=0;D.l<=D.length-4;){var B=D.read_shift(2),G=D.read_shift(2),q=D.l+G,de={};switch(B){case 21589:L=D.read_shift(1),L&1&&(de.mtime=D.read_shift(4)),G>5&&(L&2&&(de.atime=D.read_shift(4)),L&4&&(de.ctime=D.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}D.l=q,H[B]=de}return H}var d;function f(){return d||(d={})}function g(D,H){if(D[0]==80&&D[1]==75)return Gr(D,H);if((D[0]|32)==109&&(D[1]|32)==105)return Be(D,H);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var L=3,B=512,G=0,q=0,de=0,ve=0,le=0,me=[],pe=D.slice(0,512);Wn(pe,0);var Ne=y(pe);switch(L=Ne[0],L){case 3:B=512;break;case 4:B=4096;break;case 0:if(Ne[1]==0)return Gr(D,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}B!==512&&(pe=D.slice(0,B),Wn(pe,28));var Pe=D.slice(0,B);_(pe,L);var He=pe.read_shift(4,"i");if(L===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);pe.l+=4,de=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),ve=pe.read_shift(4,"i"),G=pe.read_shift(4,"i"),le=pe.read_shift(4,"i"),q=pe.read_shift(4,"i");for(var Oe=-1,X=0;X<109&&(Oe=pe.read_shift(4,"i"),!(Oe<0));++X)me[X]=Oe;var we=w(D,B);C(le,q,we,B,me);var Ae=k(we,de,me,B);Ae[de].name="!Directory",G>0&&ve!==_e&&(Ae[ve].name="!MiniFAT"),Ae[me[0]].name="!FAT",Ae.fat_addrs=me,Ae.ssz=B;var Ve={},$e=[],ht=[],Ot=[];b(de,Ae,we,$e,G,Ve,ht,ve),E(ht,Ot,$e),$e.shift();var At={FileIndex:ht,FullPaths:Ot};return H&&H.raw&&(At.raw={header:Pe,sectors:we}),At}function y(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(Le,"Header Signature: "),D.l+=16;var H=D.read_shift(2,"u");return[D.read_shift(2,"u"),H]}function _(D,H){var L=9;switch(D.l+=2,L=D.read_shift(2)){case 9:if(H!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(H!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function w(D,H){for(var L=Math.ceil(D.length/H)-1,B=[],G=1;G<L;++G)B[G-1]=D.slice(G*H,(G+1)*H);return B[L-1]=D.slice(L*H),B}function E(D,H,L){for(var B=0,G=0,q=0,de=0,ve=0,le=L.length,me=[],pe=[];B<le;++B)me[B]=pe[B]=B,H[B]=L[B];for(;ve<pe.length;++ve)B=pe[ve],G=D[B].L,q=D[B].R,de=D[B].C,me[B]===B&&(G!==-1&&me[G]!==G&&(me[B]=me[G]),q!==-1&&me[q]!==q&&(me[B]=me[q])),de!==-1&&(me[de]=B),G!==-1&&B!=me[B]&&(me[G]=me[B],pe.lastIndexOf(G)<ve&&pe.push(G)),q!==-1&&B!=me[B]&&(me[q]=me[B],pe.lastIndexOf(q)<ve&&pe.push(q));for(B=1;B<le;++B)me[B]===B&&(q!==-1&&me[q]!==q?me[B]=me[q]:G!==-1&&me[G]!==G&&(me[B]=me[G]));for(B=1;B<le;++B)if(D[B].type!==0){if(ve=B,ve!=me[ve])do ve=me[ve],H[B]=H[ve]+"/"+H[B];while(ve!==0&&me[ve]!==-1&&ve!=me[ve]);me[B]=-1}for(H[0]+="/",B=1;B<le;++B)D[B].type!==2&&(H[B]+="/")}function S(D,H,L){for(var B=D.start,G=D.size,q=[],de=B;L&&G>0&&de>=0;)q.push(H.slice(de*te,de*te+te)),G-=te,de=Ei(L,de*4);return q.length===0?In(0):Gs(q).slice(0,D.size)}function C(D,H,L,B,G){var q=_e;if(D===_e){if(H!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var de=L[D],ve=(B>>>2)-1;if(!de)return;for(var le=0;le<ve&&(q=Ei(de,le*4))!==_e;++le)G.push(q);C(Ei(de,B-4),H-1,L,B,G)}}function R(D,H,L,B,G){var q=[],de=[];G||(G=[]);var ve=B-1,le=0,me=0;for(le=H;le>=0;){G[le]=!0,q[q.length]=le,de.push(D[le]);var pe=L[Math.floor(le*4/B)];if(me=le*4&ve,B<4+me)throw new Error("FAT boundary crossed: "+le+" 4 "+B);if(!D[pe])break;le=Ei(D[pe],me)}return{nodes:q,data:X_([de])}}function k(D,H,L,B){var G=D.length,q=[],de=[],ve=[],le=[],me=B-1,pe=0,Ne=0,Pe=0,He=0;for(pe=0;pe<G;++pe)if(ve=[],Pe=pe+H,Pe>=G&&(Pe-=G),!de[Pe]){le=[];var Oe=[];for(Ne=Pe;Ne>=0;){Oe[Ne]=!0,de[Ne]=!0,ve[ve.length]=Ne,le.push(D[Ne]);var X=L[Math.floor(Ne*4/B)];if(He=Ne*4&me,B<4+He)throw new Error("FAT boundary crossed: "+Ne+" 4 "+B);if(!D[X]||(Ne=Ei(D[X],He),Oe[Ne]))break}q[Pe]={nodes:ve,data:X_([le])}}return q}function b(D,H,L,B,G,q,de,ve){for(var le=0,me=B.length?2:0,pe=H[D].data,Ne=0,Pe=0,He;Ne<pe.length;Ne+=128){var Oe=pe.slice(Ne,Ne+128);Wn(Oe,64),Pe=Oe.read_shift(2),He=fp(Oe,0,Pe-me),B.push(He);var X={name:He,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},we=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);we!==0&&(X.ct=O(Oe,Oe.l-8));var Ae=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);Ae!==0&&(X.mt=O(Oe,Oe.l-8)),X.start=Oe.read_shift(4,"i"),X.size=Oe.read_shift(4,"i"),X.size<0&&X.start<0&&(X.size=X.type=0,X.start=_e,X.name=""),X.type===5?(le=X.start,G>0&&le!==_e&&(H[le].name="!StreamData")):X.size>=4096?(X.storage="fat",H[X.start]===void 0&&(H[X.start]=R(L,X.start,H.fat_addrs,H.ssz)),H[X.start].name=X.name,X.content=H[X.start].data.slice(0,X.size)):(X.storage="minifat",X.size<0?X.size=0:le!==_e&&X.start!==_e&&H[le]&&(X.content=S(X,H[le].data,(H[ve]||{}).data))),X.content&&Wn(X.content,0),q[He]=X,de.push(X)}}function O(D,H){return new Date((Ur(D,H+4)/1e7*Math.pow(2,32)+Ur(D,H)/1e7-11644473600)*1e3)}function U(D,H){return f(),g(d.readFileSync(D),H)}function j(D,H){var L=H&&H.type;switch(L||kt&&Buffer.isBuffer(D)&&(L="buffer"),L||"base64"){case"file":return U(D,H);case"base64":return g(va(jr(D)),H);case"binary":return g(va(D),H)}return g(D,H)}function F(D,H){var L=H||{},B=L.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=B+"/",D.FileIndex[0]={name:B,type:5}),L.CLSID&&(D.FileIndex[0].clsid=L.CLSID),K(D)}function K(D){var H="Sh33tJ5";if(!Dt.find(D,"/"+H)){var L=In(4);L[0]=55,L[1]=L[3]=50,L[2]=54,D.FileIndex.push({name:H,type:2,content:L,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+H),P(D)}}function P(D,H){F(D);for(var L=!1,B=!1,G=D.FullPaths.length-1;G>=0;--G){var q=D.FileIndex[G];switch(q.type){case 0:B?L=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(q.R*q.L*q.C)&&(L=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!H)){var de=new Date(1987,1,19),ve=0,le=Object.create?Object.create(null):{},me=[];for(G=0;G<D.FullPaths.length;++G)le[D.FullPaths[G]]=!0,D.FileIndex[G].type!==0&&me.push([D.FullPaths[G],D.FileIndex[G]]);for(G=0;G<me.length;++G){var pe=r(me[G][0]);B=le[pe],B||(me.push([pe,{name:a(pe).replace("/",""),type:1,clsid:ae,ct:de,mt:de,content:null}]),le[pe]=!0)}for(me.sort(function(He,Oe){return n(He[0],Oe[0])}),D.FullPaths=[],D.FileIndex=[],G=0;G<me.length;++G)D.FullPaths[G]=me[G][0],D.FileIndex[G]=me[G][1];for(G=0;G<me.length;++G){var Ne=D.FileIndex[G],Pe=D.FullPaths[G];if(Ne.name=a(Pe).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||ae,G===0)Ne.C=me.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Pe.slice(-1)=="/"){for(ve=G+1;ve<me.length&&r(D.FullPaths[ve])!=Pe;++ve);for(Ne.C=ve>=me.length?-1:ve,ve=G+1;ve<me.length&&r(D.FullPaths[ve])!=r(Pe);++ve);Ne.R=ve>=me.length?-1:ve,Ne.type=1}else r(D.FullPaths[G+1]||"")==r(Pe)&&(Ne.R=G+1),Ne.type=2}}}function ne(D,H){var L=H||{};if(L.fileType=="mad")return Xe(D,L);switch(P(D),L.fileType){case"zip":return vt(D,L)}var B=function(He){for(var Oe=0,X=0,we=0;we<He.FileIndex.length;++we){var Ae=He.FileIndex[we];if(Ae.content){var Ve=Ae.content.length;Ve>0&&(Ve<4096?Oe+=Ve+63>>6:X+=Ve+511>>9)}}for(var $e=He.FullPaths.length+3>>2,ht=Oe+7>>3,Ot=Oe+127>>7,At=ht+X+$e+Ot,Lt=At+127>>7,fn=Lt<=109?0:Math.ceil((Lt-109)/127);At+Lt+fn+127>>7>Lt;)fn=++Lt<=109?0:Math.ceil((Lt-109)/127);var Pt=[1,fn,Lt,Ot,$e,X,Oe,0];return He.FileIndex[0].size=Oe<<6,Pt[7]=(He.FileIndex[0].start=Pt[0]+Pt[1]+Pt[2]+Pt[3]+Pt[4]+Pt[5])+(Pt[6]+7>>3),Pt}(D),G=In(B[7]<<9),q=0,de=0;{for(q=0;q<8;++q)G.write_shift(1,Te[q]);for(q=0;q<8;++q)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),q=0;q<3;++q)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,B[2]),G.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:_e),G.write_shift(4,B[3]),G.write_shift(-4,B[1]?B[0]-1:_e),G.write_shift(4,B[1]),q=0;q<109;++q)G.write_shift(-4,q<B[2]?B[1]+q:-1)}if(B[1])for(de=0;de<B[1];++de){for(;q<236+de*127;++q)G.write_shift(-4,q<B[2]?B[1]+q:-1);G.write_shift(-4,de===B[1]-1?_e:de+1)}var ve=function(He){for(de+=He;q<de-1;++q)G.write_shift(-4,q+1);He&&(++q,G.write_shift(-4,_e))};for(de=q=0,de+=B[1];q<de;++q)G.write_shift(-4,ue.DIFSECT);for(de+=B[2];q<de;++q)G.write_shift(-4,ue.FATSECT);ve(B[3]),ve(B[4]);for(var le=0,me=0,pe=D.FileIndex[0];le<D.FileIndex.length;++le)pe=D.FileIndex[le],pe.content&&(me=pe.content.length,!(me<4096)&&(pe.start=de,ve(me+511>>9)));for(ve(B[6]+7>>3);G.l&511;)G.write_shift(-4,ue.ENDOFCHAIN);for(de=q=0,le=0;le<D.FileIndex.length;++le)pe=D.FileIndex[le],pe.content&&(me=pe.content.length,!(!me||me>=4096)&&(pe.start=de,ve(me+63>>6)));for(;G.l&511;)G.write_shift(-4,ue.ENDOFCHAIN);for(q=0;q<B[4]<<2;++q){var Ne=D.FullPaths[q];if(!Ne||Ne.length===0){for(le=0;le<17;++le)G.write_shift(4,0);for(le=0;le<3;++le)G.write_shift(4,-1);for(le=0;le<12;++le)G.write_shift(4,0);continue}pe=D.FileIndex[q],q===0&&(pe.start=pe.size?pe.start-1:_e);var Pe=q===0&&L.root||pe.name;if(me=2*(Pe.length+1),G.write_shift(64,Pe,"utf16le"),G.write_shift(2,me),G.write_shift(1,pe.type),G.write_shift(1,pe.color),G.write_shift(-4,pe.L),G.write_shift(-4,pe.R),G.write_shift(-4,pe.C),pe.clsid)G.write_shift(16,pe.clsid,"hex");else for(le=0;le<4;++le)G.write_shift(4,0);G.write_shift(4,pe.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,pe.start),G.write_shift(4,pe.size),G.write_shift(4,0)}for(q=1;q<D.FileIndex.length;++q)if(pe=D.FileIndex[q],pe.size>=4096)if(G.l=pe.start+1<<9,kt&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+511&-512;else{for(le=0;le<pe.size;++le)G.write_shift(1,pe.content[le]);for(;le&511;++le)G.write_shift(1,0)}for(q=1;q<D.FileIndex.length;++q)if(pe=D.FileIndex[q],pe.size>0&&pe.size<4096)if(kt&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+63&-64;else{for(le=0;le<pe.size;++le)G.write_shift(1,pe.content[le]);for(;le&63;++le)G.write_shift(1,0)}if(kt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function Q(D,H){var L=D.FullPaths.map(function(le){return le.toUpperCase()}),B=L.map(function(le){var me=le.split("/");return me[me.length-(le.slice(-1)=="/"?2:1)]}),G=!1;H.charCodeAt(0)===47?(G=!0,H=L[0].slice(0,-1)+H):G=H.indexOf("/")!==-1;var q=H.toUpperCase(),de=G===!0?L.indexOf(q):B.indexOf(q);if(de!==-1)return D.FileIndex[de];var ve=!q.match(xc);for(q=q.replace(pr,""),ve&&(q=q.replace(xc,"!")),de=0;de<L.length;++de)if((ve?L[de].replace(xc,"!"):L[de]).replace(pr,"")==q||(ve?B[de].replace(xc,"!"):B[de]).replace(pr,"")==q)return D.FileIndex[de];return null}var te=64,_e=-2,Le="d0cf11e0a1b11ae1",Te=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:_e,FREESECT:-1,HEADER_SIGNATURE:Le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(D,H,L){f();var B=ne(D,L);d.writeFileSync(H,B)}function W(D){for(var H=new Array(D.length),L=0;L<D.length;++L)H[L]=String.fromCharCode(D[L]);return H.join("")}function N(D,H){var L=ne(D,H);switch(H&&H.type||"buffer"){case"file":return f(),d.writeFileSync(H.filename,L),L;case"binary":return typeof L=="string"?L:W(L);case"base64":return I_(typeof L=="string"?L:W(L));case"buffer":if(kt)return Buffer.isBuffer(L)?L:Bi(L);case"array":return typeof L=="string"?va(L):L}return L}var Z;function M(D){try{var H=D.InflateRaw,L=new H;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)Z=D;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function V(D,H){if(!Z)return Sa(D,H);var L=Z.InflateRaw,B=new L,G=B._processChunk(D.slice(D.l),B._finishFlushFlag);return D.l+=B.bytesRead,G}function Y(D){return Z?Z.deflateRawSync(D):Fe(D)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(D){var H=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(H>>16|H>>8|H)&255}for(var Re=typeof Uint8Array<"u",Ee=Re?new Uint8Array(256):[],Ke=0;Ke<256;++Ke)Ee[Ke]=Ce(Ke);function J(D,H){var L=Ee[D&255];return H<=8?L>>>8-H:(L=L<<8|Ee[D>>8&255],H<=16?L>>>16-H:(L=L<<8|Ee[D>>16&255],L>>>24-H))}function xt(D,H){var L=H&7,B=H>>>3;return(D[B]|(L<=6?0:D[B+1]<<8))>>>L&3}function et(D,H){var L=H&7,B=H>>>3;return(D[B]|(L<=5?0:D[B+1]<<8))>>>L&7}function St(D,H){var L=H&7,B=H>>>3;return(D[B]|(L<=4?0:D[B+1]<<8))>>>L&15}function st(D,H){var L=H&7,B=H>>>3;return(D[B]|(L<=3?0:D[B+1]<<8))>>>L&31}function Me(D,H){var L=H&7,B=H>>>3;return(D[B]|(L<=1?0:D[B+1]<<8))>>>L&127}function jt(D,H,L){var B=H&7,G=H>>>3,q=(1<<L)-1,de=D[G]>>>B;return L<8-B||(de|=D[G+1]<<8-B,L<16-B)||(de|=D[G+2]<<16-B,L<24-B)||(de|=D[G+3]<<24-B),de&q}function nn(D,H,L){var B=H&7,G=H>>>3;return B<=5?D[G]|=(L&7)<<B:(D[G]|=L<<B&255,D[G+1]=(L&7)>>8-B),H+3}function xn(D,H,L){var B=H&7,G=H>>>3;return L=(L&1)<<B,D[G]|=L,H+1}function on(D,H,L){var B=H&7,G=H>>>3;return L<<=B,D[G]|=L&255,L>>>=8,D[G+1]=L,H+8}function lr(D,H,L){var B=H&7,G=H>>>3;return L<<=B,D[G]|=L&255,L>>>=8,D[G+1]=L&255,D[G+2]=L>>>8,H+16}function Ct(D,H){var L=D.length,B=2*L>H?2*L:H+5,G=0;if(L>=H)return D;if(kt){var q=F_(B);if(D.copy)D.copy(q);else for(;G<D.length;++G)q[G]=D[G];return q}else if(Re){var de=new Uint8Array(B);if(de.set)de.set(D);else for(;G<L;++G)de[G]=D[G];return de}return D.length=B,D}function vn(D){for(var H=new Array(D),L=0;L<D;++L)H[L]=0;return H}function Nn(D,H,L){var B=1,G=0,q=0,de=0,ve=0,le=D.length,me=Re?new Uint16Array(32):vn(32);for(q=0;q<32;++q)me[q]=0;for(q=le;q<L;++q)D[q]=0;le=D.length;var pe=Re?new Uint16Array(le):vn(le);for(q=0;q<le;++q)me[G=D[q]]++,B<G&&(B=G),pe[q]=0;for(me[0]=0,q=1;q<=B;++q)me[q+16]=ve=ve+me[q-1]<<1;for(q=0;q<le;++q)ve=D[q],ve!=0&&(pe[q]=me[ve+16]++);var Ne=0;for(q=0;q<le;++q)if(Ne=D[q],Ne!=0)for(ve=J(pe[q],B)>>B-Ne,de=(1<<B+4-Ne)-1;de>=0;--de)H[ve|de<<Ne]=Ne&15|q<<4;return B}var Xt=Re?new Uint16Array(512):vn(512),zt=Re?new Uint16Array(32):vn(32);if(!Re){for(var De=0;De<512;++De)Xt[De]=0;for(De=0;De<32;++De)zt[De]=0}(function(){for(var D=[],H=0;H<32;H++)D.push(5);Nn(D,zt,32);var L=[];for(H=0;H<=143;H++)L.push(8);for(;H<=255;H++)L.push(9);for(;H<=279;H++)L.push(7);for(;H<=287;H++)L.push(8);Nn(L,Xt,288)})();var Ie=function(){for(var H=Re?new Uint8Array(32768):[],L=0,B=0;L<ye.length-1;++L)for(;B<ye[L+1];++B)H[B]=L;for(;B<32768;++B)H[B]=29;var G=Re?new Uint8Array(259):[];for(L=0,B=0;L<ie.length-1;++L)for(;B<ie[L+1];++B)G[B]=L;function q(ve,le){for(var me=0;me<ve.length;){var pe=Math.min(65535,ve.length-me),Ne=me+pe==ve.length;for(le.write_shift(1,+Ne),le.write_shift(2,pe),le.write_shift(2,~pe&65535);pe-- >0;)le[le.l++]=ve[me++]}return le.l}function de(ve,le){for(var me=0,pe=0,Ne=Re?new Uint16Array(32768):[];pe<ve.length;){var Pe=Math.min(65535,ve.length-pe);if(Pe<10){for(me=nn(le,me,+(pe+Pe==ve.length)),me&7&&(me+=8-(me&7)),le.l=me/8|0,le.write_shift(2,Pe),le.write_shift(2,~Pe&65535);Pe-- >0;)le[le.l++]=ve[pe++];me=le.l*8;continue}me=nn(le,me,+(pe+Pe==ve.length)+2);for(var He=0;Pe-- >0;){var Oe=ve[pe];He=(He<<5^Oe)&32767;var X=-1,we=0;if((X=Ne[He])&&(X|=pe&-32768,X>pe&&(X-=32768),X<pe))for(;ve[X+we]==ve[pe+we]&&we<250;)++we;if(we>2){Oe=G[we],Oe<=22?me=on(le,me,Ee[Oe+1]>>1)-1:(on(le,me,3),me+=5,on(le,me,Ee[Oe-23]>>5),me+=3);var Ae=Oe<8?0:Oe-4>>2;Ae>0&&(lr(le,me,we-ie[Oe]),me+=Ae),Oe=H[pe-X],me=on(le,me,Ee[Oe]>>3),me-=3;var Ve=Oe<4?0:Oe-2>>1;Ve>0&&(lr(le,me,pe-X-ye[Oe]),me+=Ve);for(var $e=0;$e<we;++$e)Ne[He]=pe&32767,He=(He<<5^ve[pe])&32767,++pe;Pe-=we-1}else Oe<=143?Oe=Oe+48:me=xn(le,me,1),me=on(le,me,Ee[Oe]),Ne[He]=pe&32767,++pe}me=on(le,me,0)-1}return le.l=(me+7)/8|0,le.l}return function(le,me){return le.length<8?q(le,me):de(le,me)}}();function Fe(D){var H=In(50+Math.floor(D.length*1.1)),L=Ie(D,H);return H.slice(0,L)}var je=Re?new Uint16Array(32768):vn(32768),ft=Re?new Uint16Array(32768):vn(32768),lt=Re?new Uint16Array(128):vn(128),cn=1,Gn=1;function vr(D,H){var L=st(D,H)+257;H+=5;var B=st(D,H)+1;H+=5;var G=St(D,H)+4;H+=4;for(var q=0,de=Re?new Uint8Array(19):vn(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,me=Re?new Uint8Array(8):vn(8),pe=Re?new Uint8Array(8):vn(8),Ne=de.length,Pe=0;Pe<G;++Pe)de[z[Pe]]=q=et(D,H),le<q&&(le=q),me[q]++,H+=3;var He=0;for(me[0]=0,Pe=1;Pe<=le;++Pe)pe[Pe]=He=He+me[Pe-1]<<1;for(Pe=0;Pe<Ne;++Pe)(He=de[Pe])!=0&&(ve[Pe]=pe[He]++);var Oe=0;for(Pe=0;Pe<Ne;++Pe)if(Oe=de[Pe],Oe!=0){He=Ee[ve[Pe]]>>8-Oe;for(var X=(1<<7-Oe)-1;X>=0;--X)lt[He|X<<Oe]=Oe&7|Pe<<3}var we=[];for(le=1;we.length<L+B;)switch(He=lt[Me(D,H)],H+=He&7,He>>>=3){case 16:for(q=3+xt(D,H),H+=2,He=we[we.length-1];q-- >0;)we.push(He);break;case 17:for(q=3+et(D,H),H+=3;q-- >0;)we.push(0);break;case 18:for(q=11+Me(D,H),H+=7;q-- >0;)we.push(0);break;default:we.push(He),le<He&&(le=He);break}var Ae=we.slice(0,L),Ve=we.slice(L);for(Pe=L;Pe<286;++Pe)Ae[Pe]=0;for(Pe=B;Pe<30;++Pe)Ve[Pe]=0;return cn=Nn(Ae,je,286),Gn=Nn(Ve,ft,30),H}function yr(D,H){if(D[0]==3&&!(D[1]&3))return[Xs(H),2];for(var L=0,B=0,G=F_(H||1<<18),q=0,de=G.length>>>0,ve=0,le=0;(B&1)==0;){if(B=et(D,L),L+=3,B>>>1)B>>1==1?(ve=9,le=5):(L=vr(D,L),ve=cn,le=Gn);else{L&7&&(L+=8-(L&7));var me=D[L>>>3]|D[(L>>>3)+1]<<8;if(L+=32,me>0)for(!H&&de<q+me&&(G=Ct(G,q+me),de=G.length);me-- >0;)G[q++]=D[L>>>3],L+=8;continue}for(;;){!H&&de<q+32767&&(G=Ct(G,q+32767),de=G.length);var pe=jt(D,L,ve),Ne=B>>>1==1?Xt[pe]:je[pe];if(L+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)G[q++]=Ne;else{if(Ne==256)break;Ne-=257;var Pe=Ne<8?0:Ne-4>>2;Pe>5&&(Pe=0);var He=q+ie[Ne];Pe>0&&(He+=jt(D,L,Pe),L+=Pe),pe=jt(D,L,le),Ne=B>>>1==1?zt[pe]:ft[pe],L+=Ne&15,Ne>>>=4;var Oe=Ne<4?0:Ne-2>>1,X=ye[Ne];for(Oe>0&&(X+=jt(D,L,Oe),L+=Oe),!H&&de<He&&(G=Ct(G,He+100),de=G.length);q<He;)G[q]=G[q-X],++q}}}return H?[G,L+7>>>3]:[G.slice(0,q),L+7>>>3]}function Sa(D,H){var L=D.slice(D.l||0),B=yr(L,H);return D.l+=B[1],B[0]}function Hr(D,H){if(D)typeof console<"u"&&console.error(H);else throw new Error(H)}function Gr(D,H){var L=D;Wn(L,0);var B=[],G=[],q={FileIndex:B,FullPaths:G};F(q,{root:H.root});for(var de=L.length-4;(L[de]!=80||L[de+1]!=75||L[de+2]!=5||L[de+3]!=6)&&de>=0;)--de;L.l=de+4,L.l+=4;var ve=L.read_shift(2);L.l+=6;var le=L.read_shift(4);for(L.l=le,de=0;de<ve;++de){L.l+=20;var me=L.read_shift(4),pe=L.read_shift(4),Ne=L.read_shift(2),Pe=L.read_shift(2),He=L.read_shift(2);L.l+=8;var Oe=L.read_shift(4),X=c(L.slice(L.l+Ne,L.l+Ne+Pe));L.l+=Ne+Pe+He;var we=L.l;L.l=Oe+4,$r(L,me,pe,q,X),L.l=we}return q}function $r(D,H,L,B,G){D.l+=2;var q=D.read_shift(2),de=D.read_shift(2),ve=l(D);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var le=D.read_shift(4),me=D.read_shift(4),pe=D.read_shift(4),Ne=D.read_shift(2),Pe=D.read_shift(2),He="",Oe=0;Oe<Ne;++Oe)He+=String.fromCharCode(D[D.l++]);if(Pe){var X=c(D.slice(D.l,D.l+Pe));(X[21589]||{}).mt&&(ve=X[21589].mt),((G||{})[21589]||{}).mt&&(ve=G[21589].mt)}D.l+=Pe;var we=D.slice(D.l,D.l+me);switch(de){case 8:we=V(D,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Ae=!1;q&8&&(le=D.read_shift(4),le==134695760&&(le=D.read_shift(4),Ae=!0),me=D.read_shift(4),pe=D.read_shift(4)),me!=H&&Hr(Ae,"Bad compressed size: "+H+" != "+me),pe!=L&&Hr(Ae,"Bad uncompressed size: "+L+" != "+pe),bt(B,He,we,{unsafe:!0,mt:ve})}function vt(D,H){var L=H||{},B=[],G=[],q=In(1),de=L.compression?8:0,ve=0,le=0,me=0,pe=0,Ne=0,Pe=D.FullPaths[0],He=Pe,Oe=D.FileIndex[0],X=[],we=0;for(le=1;le<D.FullPaths.length;++le)if(He=D.FullPaths[le].slice(Pe.length),Oe=D.FileIndex[le],!(!Oe.size||!Oe.content||He=="Sh33tJ5")){var Ae=pe,Ve=In(He.length);for(me=0;me<He.length;++me)Ve.write_shift(1,He.charCodeAt(me)&127);Ve=Ve.slice(0,Ve.l),X[Ne]=X8.buf(Oe.content,0);var $e=Oe.content;de==8&&($e=Y($e)),q=In(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,ve),q.write_shift(2,de),Oe.mt?i(q,Oe.mt):q.write_shift(4,0),q.write_shift(-4,X[Ne]),q.write_shift(4,$e.length),q.write_shift(4,Oe.content.length),q.write_shift(2,Ve.length),q.write_shift(2,0),pe+=q.length,B.push(q),pe+=Ve.length,B.push(Ve),pe+=$e.length,B.push($e),q=In(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,ve),q.write_shift(2,de),q.write_shift(4,0),q.write_shift(-4,X[Ne]),q.write_shift(4,$e.length),q.write_shift(4,Oe.content.length),q.write_shift(2,Ve.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,Ae),we+=q.l,G.push(q),we+=Ve.length,G.push(Ve),++Ne}return q=In(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,Ne),q.write_shift(2,Ne),q.write_shift(4,we),q.write_shift(4,pe),q.write_shift(2,0),Gs([Gs(B),Gs(G),q])}var un={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $n(D,H){if(D.ctype)return D.ctype;var L=D.name||"",B=L.match(/\.([^\.]+)$/);return B&&un[B[1]]||H&&(B=(L=H).match(/[\.\\]([^\.\\])+$/),B&&un[B[1]])?un[B[1]]:"application/octet-stream"}function cr(D){for(var H=I_(D),L=[],B=0;B<H.length;B+=76)L.push(H.slice(B,B+76));return L.join(`\r
`)+`\r
`}function oa(D){var H=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var pe=me.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});H=H.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),H.charAt(0)==`
`&&(H="=0D"+H.slice(1)),H=H.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],B=H.split(`\r
`),G=0;G<B.length;++G){var q=B[G];if(q.length==0){L.push("");continue}for(var de=0;de<q.length;){var ve=76,le=q.slice(de,de+ve);le.charAt(ve-1)=="="?ve--:le.charAt(ve-2)=="="?ve-=2:le.charAt(ve-3)=="="&&(ve-=3),le=q.slice(de,de+ve),de+=ve,de<q.length&&(le+="="),L.push(le)}}return L.join(`\r
`)}function la(D){for(var H=[],L=0;L<D.length;++L){for(var B=D[L];L<=D.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+D[++L];H.push(B)}for(var G=0;G<H.length;++G)H[G]=H[G].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return va(H.join(`\r
`))}function ms(D,H,L){for(var B="",G="",q="",de,ve=0;ve<10;++ve){var le=H[ve];if(!le||le.match(/^\s*$/))break;var me=le.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":B=me[2].trim();break;case"content-type":q=me[2].trim();break;case"content-transfer-encoding":G=me[2].trim();break}}switch(++ve,G.toLowerCase()){case"base64":de=va(jr(H.slice(ve).join("")));break;case"quoted-printable":de=la(H.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var pe=bt(D,B.slice(L.length),de,{unsafe:!0});q&&(pe.ctype=q)}function Be(D,H){if(W(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=H&&H.root||"",B=(kt&&Buffer.isBuffer(D)?D.toString("binary"):W(D)).split(`\r
`),G=0,q="";for(G=0;G<B.length;++G)if(q=B[G],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),L||(L=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),q.slice(0,L.length)!=L););var de=(B[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var ve="--"+(de[1]||""),le=[],me=[],pe={FileIndex:le,FullPaths:me};F(pe);var Ne,Pe=0;for(G=0;G<B.length;++G){var He=B[G];He!==ve&&He!==ve+"--"||(Pe++&&ms(pe,B.slice(Ne,G),L),Ne=G)}return pe}function Xe(D,H){var L=H||{},B=L.boundary||"SheetJS";B="------="+B;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],q=D.FullPaths[0],de=q,ve=D.FileIndex[0],le=1;le<D.FullPaths.length;++le)if(de=D.FullPaths[le].slice(q.length),ve=D.FileIndex[le],!(!ve.size||!ve.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(we){return"_x"+we.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(we){return"_u"+we.charCodeAt(0).toString(16)+"_"});for(var me=ve.content,pe=kt&&Buffer.isBuffer(me)?me.toString("binary"):W(me),Ne=0,Pe=Math.min(1024,pe.length),He=0,Oe=0;Oe<=Pe;++Oe)(He=pe.charCodeAt(Oe))>=32&&He<128&&++Ne;var X=Ne>=Pe*4/5;G.push(B),G.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+de),G.push("Content-Transfer-Encoding: "+(X?"quoted-printable":"base64")),G.push("Content-Type: "+$n(ve,de)),G.push(""),G.push(X?oa(pe):cr(pe))}return G.push(B+`--\r
`),G.join(`\r
`)}function Ze(D){var H={};return F(H,D),H}function bt(D,H,L,B){var G=B&&B.unsafe;G||F(D);var q=!G&&Dt.find(D,H);if(!q){var de=D.FullPaths[0];H.slice(0,de.length)==de?de=H:(de.slice(-1)!="/"&&(de+="/"),de=(de+H).replace("//","/")),q={name:a(H),type:2},D.FileIndex.push(q),D.FullPaths.push(de),G||Dt.utils.cfb_gc(D)}return q.content=L,q.size=L?L.length:0,B&&(B.CLSID&&(q.clsid=B.CLSID),B.mt&&(q.mt=B.mt),B.ct&&(q.ct=B.ct)),q}function yn(D,H){F(D);var L=Dt.find(D,H);if(L){for(var B=0;B<D.FileIndex.length;++B)if(D.FileIndex[B]==L)return D.FileIndex.splice(B,1),D.FullPaths.splice(B,1),!0}return!1}function dt(D,H,L){F(D);var B=Dt.find(D,H);if(B){for(var G=0;G<D.FileIndex.length;++G)if(D.FileIndex[G]==B)return D.FileIndex[G].name=a(L),D.FullPaths[G]=L,!0}return!1}function zr(D){P(D,!0)}return e.find=Q,e.read=j,e.parse=g,e.write=N,e.writeFile=re,e.utils={cfb_new:Ze,cfb_add:bt,cfb_del:yn,cfb_mov:dt,cfb_gc:zr,ReadShift:bc,CheckField:Ow,prep_blob:Wn,bconcat:Gs,use_zlib:M,_deflateRaw:Fe,_inflateRaw:Sa,consts:ue},e}();function Z8(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var n=e.read();return e.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+t)}function Ua(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function op(t){for(var e=[],n=Ua(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}var Qf=new Date(1899,11,30,0,0,0);function xr(t,e){var n=t.getTime(),r=Qf.getTime()+(t.getTimezoneOffset()-Qf.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var mw=new Date,Q8=Qf.getTime()+(mw.getTimezoneOffset()-Qf.getTimezoneOffset())*6e4,H_=mw.getTimezoneOffset();function xd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+Q8),e.getTimezoneOffset()!==H_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-H_)*6e4),e}function eO(t){var e=0,n=0,r=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(n=1,i>3&&(r=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=n*parseInt(a[i],10)}return e}var G_=new Date("2017-02-19T19:06:09.000Z"),pw=isNaN(G_.getFullYear())?new Date("2/19/17"):G_,tO=pw.getFullYear()==2017;function Hn(t,e){var n=new Date(t);if(tO)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(pw.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Fi(t,e){if(kt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return yc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return yc(tw(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return yc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return yc(new TextDecoder("utf-16be").decode(t.slice(2)))}var n={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return n[i]||i})}catch{}for(var r=[],a=0;a!=t.length;++a)r.push(String.fromCharCode(t[a]));return r.join("")}function Jn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Jn(t[n]));return e}function pn(t,e){for(var n="";n.length<e;)n+=t;return n}function Ta(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,i){return n=-n,i}),!isNaN(e=Number(r)))?e/n:e}var nO=["january","february","march","april","may","june","july","august","september","october","november","december"];function rl(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),a=e.getMonth(),i=e.getDate();if(isNaN(i))return n;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&nO.indexOf(l)==-1)return n}else if(l.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||i>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}var rO=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(n,r,a){if(t||typeof r=="string")return n.split(r);for(var i=n.split(r),l=[i[0]],c=1;c<i.length;++c)l.push(a),l.push(i[c]);return l}}();function gw(t){return t?t.content&&t.type?Fi(t.content,!0):t.data?gc(t.data):t.asNodeBuffer&&kt?gc(t.asNodeBuffer().toString("binary")):t.asBinary?gc(t.asBinary()):t._data&&t._data.getContent?gc(Fi(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function xw(t){if(!t)return null;if(t.data)return D_(t.data);if(t.asNodeBuffer&&kt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?D_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function aO(t){return t&&t.name.slice(-4)===".bin"?xw(t):gw(t)}function na(t,e){for(var n=t.FullPaths||Ua(t.files),r=e.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),i=0;i<n.length;++i){var l=n[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return t.files?t.files[n[i]]:t.FileIndex[i]}return null}function lp(t,e){var n=na(t,e);if(n==null)throw new Error("Cannot find file "+e+" in zip");return n}function bn(t,e,n){if(!n)return aO(lp(t,e));if(!e)return null;try{return bn(t,e)}catch{return null}}function Br(t,e,n){if(!n)return gw(lp(t,e));if(!e)return null;try{return Br(t,e)}catch{return null}}function sO(t,e,n){return xw(lp(t,e))}function $_(t){for(var e=t.FullPaths||Ua(t.files),n=[],r=0;r<e.length;++r)e[r].slice(-1)!="/"&&n.push(e[r].replace(/^Root Entry[\/]/,""));return n.sort()}function iO(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return kt?r=Bi(n):r=C8(n),Dt.utils.cfb_add(t,e,r)}Dt.utils.cfb_add(t,e,n)}else t.file(e,n)}function vw(t,e){switch(e.type){case"base64":return Dt.read(t,{type:"base64"});case"binary":return Dt.read(t,{type:"binary"});case"buffer":case"array":return Dt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function vc(t,e){if(t.charAt(0)=="/")return t.slice(1);var n=e.split("/");e.slice(-1)!="/"&&n.pop();for(var r=t.split("/");r.length!==0;){var a=r.shift();a===".."?n.pop():a!=="."&&n.push(a)}return n.join("/")}var yw=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,oO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,z_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,lO=/<[^>]*>/g,or=yw.match(z_)?z_:lO,cO=/<\w*:/,uO=/<(\/?)\w+:/;function rt(t,e,n){for(var r={},a=0,i=0;a!==t.length&&!((i=t.charCodeAt(a))===32||i===10||i===13);++a);if(e||(r[0]=t.slice(0,a)),a===t.length)return r;var l=t.match(oO),c=0,d="",f=0,g="",y="",_=1;if(l)for(f=0;f!=l.length;++f){for(y=l[f],i=0;i!=y.length&&y.charCodeAt(i)!==61;++i);for(g=y.slice(0,i).trim();y.charCodeAt(i+1)==32;)++i;for(_=(a=y.charCodeAt(i+1))==34||a==39?1:0,d=y.slice(i+1+_,y.length-_),c=0;c!=g.length&&g.charCodeAt(c)!==58;++c);if(c===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),r[g]=d,r[g.toLowerCase()]=d;else{var w=(c===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(c+1);if(r[w]&&g.slice(c-3,c)=="ext")continue;r[w]=d,r[w.toLowerCase()]=d}}return r}function ja(t){return t.replace(uO,"<$1")}var _w={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},fO=op(_w),Ft=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function n(r){var a=r+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(t,function(c,d){return _w[c]||String.fromCharCode(parseInt(d,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,d){return String.fromCharCode(parseInt(d,16))});var l=a.indexOf("]]>");return n(a.slice(0,i))+a.slice(i+9,l)+n(a.slice(l+3))}}(),dO=/[&<>'"]/g,hO=/[\u0000-\u001f]/g;function cp(t){var e=t+"";return e.replace(dO,function(n){return fO[n]}).replace(/\n/g,"<br/>").replace(hO,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}var q_=function(){var t=/&#(\d+);/g;function e(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(t,e)}}();function sn(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function jh(t){for(var e="",n=0,r=0,a=0,i=0,l=0,c=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(a=t.charCodeAt(n++),r>191&&r<224){l=(r&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(i=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(a&63)<<6|i&63);continue}l=t.charCodeAt(n++),c=((r&7)<<18|(a&63)<<12|(i&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function Y_(t){var e=Xs(2*t.length),n,r,a=1,i=0,l=0,c;for(r=0;r<t.length;r+=a)a=1,(c=t.charCodeAt(r))<128?n=c:c<224?(n=(c&31)*64+(t.charCodeAt(r+1)&63),a=2):c<240?(n=(c&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),a=3):(a=4,n=(c&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,l=55296+(n>>>10&1023),n=56320+(n&1023)),l!==0&&(e[i++]=l&255,e[i++]=l>>>8,l=0),e[i++]=n%256,e[i++]=n>>>8;return e.slice(0,i).toString("ucs2")}function W_(t){return Bi(t,"binary").toString("utf8")}var Af="foo bar bazâð£",en=kt&&(W_(Af)==jh(Af)&&W_||Y_(Af)==jh(Af)&&Y_)||jh,yc=kt?function(t){return Bi(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,a=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},$c=function(){var t={};return function(n,r){var a=n+"|"+(r||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),Tw=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)r=r.replace(t[a][0],t[a][1]);return r}}(),mO=function(){var t={};return function(n){return t[n]!==void 0?t[n]:t[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),pO=/<\/?(?:vt:)?variant>/g,gO=/<(?:vt:)([^>]*)>([\s\S]*)</;function J_(t,e){var n=rt(t),r=t.match(mO(n.baseType))||[],a=[];if(r.length!=n.size){if(e.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(i){var l=i.replace(pO,"").match(gO);l&&a.push({v:en(l[2]),t:l[1]})}),a}var xO=/(^\s|\s$|\n)/;function vO(t){return Ua(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function yO(t,e,n){return"<"+t+(n!=null?vO(n):"")+(e!=null?(e.match(xO)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function up(t){if(kt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return en(ji(ap(t)));throw new Error("Bad input format: expected Buffer or string")}var zc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,_O={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},TO=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function wO(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,i=5;i>=0;--i)a=a*256+t[e+i];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function EO(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,a=0,i=0,l=r?-e:e;isFinite(l)?l==0?a=i=0:(a=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(e)?26985:0);for(var c=0;c<=5;++c,i/=256)t[n+c]=i&255;t[n+6]=(a&15)<<4|i&15,t[n+7]=a>>4|r}var K_=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var a=0,i=t[0][r].length;a<i;a+=n)e.push.apply(e,t[0][r].slice(a,a+n));return e},X_=kt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Bi(e)})):K_(t)}:K_,Z_=function(t,e,n){for(var r=[],a=e;a<n;a+=2)r.push(String.fromCharCode(as(t,a)));return r.join("").replace(pr,"")},fp=kt?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(pr,""):Z_(t,e,n)}:Z_,Q_=function(t,e,n){for(var r=[],a=e;a<e+n;++a)r.push(("0"+t[a].toString(16)).slice(-2));return r.join("")},ww=kt?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):Q_(t,e,n)}:Q_,eT=function(t,e,n){for(var r=[],a=e;a<n;a++)r.push(String.fromCharCode(Vo(t,a)));return r.join("")},ru=kt?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):eT(e,n,r)}:eT,Ew=function(t,e){var n=Ur(t,e);return n>0?ru(t,e+4,e+4+n-1):""},Sw=Ew,Cw=function(t,e){var n=Ur(t,e);return n>0?ru(t,e+4,e+4+n-1):""},bw=Cw,Aw=function(t,e){var n=2*Ur(t,e);return n>0?ru(t,e+4,e+4+n-1):""},kw=Aw,Nw=function(e,n){var r=Ur(e,n);return r>0?fp(e,n+4,n+4+r):""},Rw=Nw,Dw=function(t,e){var n=Ur(t,e);return n>0?ru(t,e+4,e+4+n):""},Mw=Dw,Iw=function(t,e){return wO(t,e)},ed=Iw,Fw=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};kt&&(Sw=function(e,n){if(!Buffer.isBuffer(e))return Ew(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},bw=function(e,n){if(!Buffer.isBuffer(e))return Cw(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},kw=function(e,n){if(!Buffer.isBuffer(e))return Aw(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},Rw=function(e,n){if(!Buffer.isBuffer(e))return Nw(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},Mw=function(e,n){if(!Buffer.isBuffer(e))return Dw(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},ed=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):Iw(e,n)},Fw=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Vo=function(t,e){return t[e]},as=function(t,e){return t[e+1]*256+t[e]},SO=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},Ur=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Ei=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},CO=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function bc(t,e){var n="",r,a,i=[],l,c,d,f;switch(e){case"dbcs":if(f=this.l,kt&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(d=0;d<t;++d)n+=String.fromCharCode(as(this,f)),f+=2;t*=2;break;case"utf8":n=ru(this,this.l,this.l+t);break;case"utf16le":t*=2,n=fp(this,this.l,this.l+t);break;case"wstr":return bc.call(this,t,"dbcs");case"lpstr-ansi":n=Sw(this,this.l),t=4+Ur(this,this.l);break;case"lpstr-cp":n=bw(this,this.l),t=4+Ur(this,this.l);break;case"lpwstr":n=kw(this,this.l),t=4+2*Ur(this,this.l);break;case"lpp4":t=4+Ur(this,this.l),n=Rw(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ur(this,this.l),n=Mw(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(l=Vo(this,this.l+t++))!==0;)i.push(bf(l));n=i.join("");break;case"_wstr":for(t=0,n="";(l=as(this,this.l+t))!==0;)i.push(bf(l)),t+=2;t+=2,n=i.join("");break;case"dbcs-cont":for(n="",f=this.l,d=0;d<t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Vo(this,f),this.l=f+1,c=bc.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(bf(as(this,f))),f+=2}n=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",f=this.l,d=0;d!=t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Vo(this,f),this.l=f+1,c=bc.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(bf(Vo(this,f))),f+=1}n=i.join("");break;default:switch(t){case 1:return r=Vo(this,this.l),this.l++,r;case 2:return r=(e==="i"?SO:as)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(t>0?Ei:CO)(this,this.l),this.l+=4,r):(a=Ur(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=ed(this,this.l):a=ed([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:n=ww(this,this.l,t);break}}return this.l+=t,n}var bO=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},AO=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},kO=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function NO(t,e,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=e.length;++a)kO(this,e.charCodeAt(a),this.l+2*a);r=2*e.length}else if(n==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;r=e.length}else if(n==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,bO(this,e,this.l);break;case 8:if(r=8,n==="f"){EO(this,e,this.l);break}case 16:break;case-4:r=4,AO(this,e,this.l);break}return this.l+=r,this}function Ow(t,e){var n=ww(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function Wn(t,e){t.l=e,t.read_shift=bc,t.chk=Ow,t.write_shift=NO}function ir(t,e){t.l+=e}function In(t){var e=Xs(t);return Wn(e,0),e}function hs(t,e,n){if(t){var r,a,i;Wn(t,t.l||0);for(var l=t.length,c=0,d=0;t.l<l;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var f=id[c]||id[65535];for(r=t.read_shift(1),i=r&127,a=1;a<4&&r&128;++a)i+=((r=t.read_shift(1))&127)<<7*a;d=t.l+i;var g=f.f&&f.f(t,i,n);if(t.l=d,e(g,f,c))return}}}function Sm(){var t=[],e=kt?256:2048,n=function(f){var g=In(f);return Wn(g,0),g},r=n(e),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},i=function(f){return r&&f<r.length-r.l?r:(a(),r=n(Math.max(f+1,e)))},l=function(){return a(),Gs(t)},c=function(f){a(),r=f,r.l==null&&(r.l=r.length),i(e)};return{next:i,push:c,end:l,_bufs:t}}function Ac(t,e,n){var r=Jn(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function tT(t,e,n){var r=Jn(t);return r.s=Ac(r.s,e.s,n),r.e=Ac(r.e,e.s,n),r}function kc(t,e){if(t.cRel&&t.c<0)for(t=Jn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Jn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=ot(t);return!t.cRel&&t.cRel!=null&&(n=MO(n)),!t.rRel&&t.rRel!=null&&(n=RO(n)),n}function Vh(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Fn(t.s.c)+":"+(t.e.cRel?"":"$")+Fn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Kn(t.s.r)+":"+(t.e.rRel?"":"$")+Kn(t.e.r):kc(t.s,e.biff)+":"+kc(t.e,e.biff)}function dp(t){return parseInt(DO(t),10)-1}function Kn(t){return""+(t+1)}function RO(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function DO(t){return t.replace(/\$(\d+)$/,"$1")}function hp(t){for(var e=IO(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function Fn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function MO(t){return t.replace(/^([A-Z])/,"$$$1")}function IO(t){return t.replace(/^\$([A-Z])/,"$1")}function FO(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function mr(t){for(var e=0,n=0,r=0;r<t.length;++r){var a=t.charCodeAt(r);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:e-1}}function ot(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function dl(t){var e=t.indexOf(":");return e==-1?{s:mr(t),e:mr(t)}:{s:mr(t.slice(0,e)),e:mr(t.slice(e+1))}}function It(t,e){return typeof e>"u"||typeof e=="number"?It(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function gn(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,i=t.length;for(n=0;r<i&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.s.c=--n,n=0;r<i&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(e.s.r=--n,r===i||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=i&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.e.c=--n,n=0;r!=i&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return e.e.r=--n,e}function nT(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=aa(t.z,n?xr(e):e)}catch{}try{return t.w=aa((t.XF||{}).numFmtId||(n?14:0),n?xr(e):e)}catch{return""+e}}function us(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?Gi[t.v]||t.v:e==null?nT(t,t.v):nT(t,e))}function ei(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function Lw(t,e,n){var r=n||{},a=t?Array.isArray(t):r.dense,i=t||(a?[]:{}),l=0,c=0;if(i&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?mr(r.origin):r.origin;l=d.r,c=d.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var g=gn(i["!ref"]);f.s.c=g.s.c,f.s.r=g.s.r,f.e.c=Math.max(f.e.c,g.e.c),f.e.r=Math.max(f.e.r,g.e.r),l==-1&&(f.e.r=l=g.e.r+1)}for(var y=0;y!=e.length;++y)if(e[y]){if(!Array.isArray(e[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[y].length;++_)if(!(typeof e[y][_]>"u")){var w={v:e[y][_]},E=l+y,S=c+_;if(f.s.r>E&&(f.s.r=E),f.s.c>S&&(f.s.c=S),f.e.r<E&&(f.e.r=E),f.e.c<S&&(f.e.c=S),e[y][_]&&typeof e[y][_]=="object"&&!Array.isArray(e[y][_])&&!(e[y][_]instanceof Date))w=e[y][_];else if(Array.isArray(w.v)&&(w.f=e[y][_][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(r.nullError)w.t="e",w.v=0;else if(r.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=r.dateNF||ut[14],r.cellDates?(w.t="d",w.w=aa(w.z,xr(w.v))):(w.t="n",w.v=xr(w.v),w.w=aa(w.z,w.v))):w.t="s";if(a)i[E]||(i[E]=[]),i[E][S]&&i[E][S].z&&(w.z=i[E][S].z),i[E][S]=w;else{var C=ot({c:S,r:E});i[C]&&i[C].z&&(w.z=i[C].z),i[C]=w}}}return f.s.c<1e7&&(i["!ref"]=It(f)),i}function hl(t,e){return Lw(null,t,e)}function OO(t){return t.read_shift(4,"i")}function sr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function LO(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function mp(t,e){var n=t.l,r=t.read_shift(1),a=sr(t),i=[],l={t:a,h:a};if((r&1)!==0){for(var c=t.read_shift(4),d=0;d!=c;++d)i.push(LO(t));l.r=i}else l.r=[{ich:0,ifnt:0}];return t.l=n+e,l}var PO=mp;function ia(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function Vi(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var UO=sr;function pp(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var BO=sr,Cm=pp;function gp(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var a=r===0?ed([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ei(e,0)>>2;return n?a/100:a}function Pw(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Hi=Pw;function nr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function jO(t){var e={},n=t.read_shift(1),r=n>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),l=t.read_shift(1),c=t.read_shift(1),d=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=a;var f=bi[a];f&&(e.rgb=Yc(f));break;case 2:e.rgb=Yc([l,c,d]);break;case 3:e.theme=a;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function VO(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function Uw(t,e){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=t.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[t.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function HO(t){return Uw(t,1)}function GO(t){return Uw(t,2)}var xp=2,br=3,kf=11,rT=12,td=19,Nf=64,$O=65,zO=71,qO=4108,YO=4126,Vn=80,Bw=81,WO=[Vn,Bw],JO={1:{n:"CodePage",t:xp},2:{n:"Category",t:Vn},3:{n:"PresentationFormat",t:Vn},4:{n:"ByteCount",t:br},5:{n:"LineCount",t:br},6:{n:"ParagraphCount",t:br},7:{n:"SlideCount",t:br},8:{n:"NoteCount",t:br},9:{n:"HiddenCount",t:br},10:{n:"MultimediaClipCount",t:br},11:{n:"ScaleCrop",t:kf},12:{n:"HeadingPairs",t:qO},13:{n:"TitlesOfParts",t:YO},14:{n:"Manager",t:Vn},15:{n:"Company",t:Vn},16:{n:"LinksUpToDate",t:kf},17:{n:"CharacterCount",t:br},19:{n:"SharedDoc",t:kf},22:{n:"HyperlinksChanged",t:kf},23:{n:"AppVersion",t:br,p:"version"},24:{n:"DigSig",t:$O},26:{n:"ContentType",t:Vn},27:{n:"ContentStatus",t:Vn},28:{n:"Language",t:Vn},29:{n:"Version",t:Vn},255:{},2147483648:{n:"Locale",t:td},2147483651:{n:"Behavior",t:td},1919054434:{}},KO={1:{n:"CodePage",t:xp},2:{n:"Title",t:Vn},3:{n:"Subject",t:Vn},4:{n:"Author",t:Vn},5:{n:"Keywords",t:Vn},6:{n:"Comments",t:Vn},7:{n:"Template",t:Vn},8:{n:"LastAuthor",t:Vn},9:{n:"RevNumber",t:Vn},10:{n:"EditTime",t:Nf},11:{n:"LastPrinted",t:Nf},12:{n:"CreatedDate",t:Nf},13:{n:"ModifiedDate",t:Nf},14:{n:"PageCount",t:br},15:{n:"WordCount",t:br},16:{n:"CharCount",t:br},17:{n:"Thumbnail",t:zO},18:{n:"Application",t:Vn},19:{n:"DocSecurity",t:br},255:{},2147483648:{n:"Locale",t:td},2147483651:{n:"Behavior",t:td},1919054434:{}},aT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ZO(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var QO=ZO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),bi=Jn(QO),Gi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},jw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},sT={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function eL(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function tL(t){var e=eL();if(!t||!t.match)return e;var n={};if((t.match(or)||[]).forEach(function(r){var a=rt(r);switch(a[0].replace(cO,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[a.Extension]=a.ContentType;break;case"<Override":e[sT[a.ContentType]]!==void 0&&e[sT[a.ContentType]].push(a.PartName);break}}),e.xmlns!==_O.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=n,delete e.calcchains,e}var Go={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function bm(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Nc(t,e){var n={"!id":{}};if(!t)return n;e.charAt(0)!=="/"&&(e="/"+e);var r={};return(t.match(or)||[]).forEach(function(a){var i=rt(a);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:vc(i.Target,e);n[c]=l,r[i.Id]=l}}),n["!id"]=r,n}var nL="application/vnd.oasis.opendocument.spreadsheet";function rL(t,e){for(var n=up(t),r,a;r=zc.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(a=rt(r[0],!1),a.path=="/"&&a.type!==nL)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw r}}var Rc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],aL=function(){for(var t=new Array(Rc.length),e=0;e<Rc.length;++e){var n=Rc[e],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);t[e]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return t}();function Vw(t){var e={};t=en(t);for(var n=0;n<Rc.length;++n){var r=Rc[n],a=t.match(aL[n]);a!=null&&a.length>0&&(e[r[1]]=Ft(a[1])),r[2]==="date"&&e[r[1]]&&(e[r[1]]=Hn(e[r[1]]))}return e}var sL=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Hw(t,e,n,r){var a=[];if(typeof t=="string")a=J_(t,r);else for(var i=0;i<t.length;++i)a=a.concat(t[i].map(function(g){return{v:g}}));var l=typeof e=="string"?J_(e,r).map(function(g){return g.v}):e,c=0,d=0;if(l.length>0)for(var f=0;f!==a.length;f+=2){switch(d=+a[f+1].v,a[f].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":n.Worksheets=d,n.SheetNames=l.slice(c,c+d);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":n.NamedRanges=d,n.DefinedNames=l.slice(c,c+d);break;case"Charts":case"Diagramme":n.Chartsheets=d,n.ChartNames=l.slice(c,c+d);break}c+=d}}function iL(t,e,n){var r={};return e||(e={}),t=en(t),sL.forEach(function(a){var i=(t.match($c(a[0]))||[])[1];switch(a[2]){case"string":i&&(e[a[1]]=Ft(i));break;case"bool":e[a[1]]=i==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&Hw(r.HeadingPairs,r.TitlesOfParts,e,n),e}var oL=/<[^>]+>[^<]*/g;function lL(t,e){var n={},r="",a=t.match(oL);if(a)for(var i=0;i!=a.length;++i){var l=a[i],c=rt(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Ft(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var d=l.split(">"),f=d[0].slice(4),g=d[1];switch(f){case"lpstr":case"bstr":case"lpwstr":n[r]=Ft(g);break;case"bool":n[r]=sn(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(g,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(g);break;case"filetime":case"date":n[r]=Hn(g);break;case"cy":case"error":n[r]=Ft(g);break;default:if(f.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,d)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return n}var cL={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hh;function uL(t,e,n){Hh||(Hh=op(cL)),e=Hh[e]||e,t[e]=n}function vp(t){var e=t.read_shift(4),n=t.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Gw(t,e,n){var r=t.l,a=t.read_shift(0,"lpstr-cp");if(n)for(;t.l-r&3;)++t.l;return a}function $w(t,e,n){var r=t.read_shift(0,"lpwstr");return r}function zw(t,e,n){return e===31?$w(t):Gw(t,e,n)}function Am(t,e,n){return zw(t,e,n===!1?0:4)}function fL(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return zw(t,e,0)}function dL(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r){var a=t.l;n[r]=t.read_shift(0,"lpwstr").replace(pr,""),t.l-a&2&&(t.l+=2)}return n}function hL(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r)n[r]=t.read_shift(0,"lpstr-cp").replace(pr,"");return n}function mL(t){var e=t.l,n=nd(t,Bw);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var r=nd(t,br);return[n,r]}function pL(t){for(var e=t.read_shift(4),n=[],r=0;r<e/2;++r)n.push(mL(t));return n}function iT(t,e){for(var n=t.read_shift(4),r={},a=0;a!=n;++a){var i=t.read_shift(4),l=t.read_shift(4);r[i]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(pr,"").replace(xc,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),r}function qw(t){var e=t.read_shift(4),n=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),n}function gL(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function nd(t,e,n){var r=t.read_shift(2),a,i=n||{};if(t.l+=2,e!==rT&&r!==e&&WO.indexOf(e)===-1&&!((e&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+e+" saw "+r);switch(e===rT?r:e){case 2:return a=t.read_shift(2,"i"),i.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return Gw(t,r,4).replace(pr,"");case 31:return $w(t);case 64:return vp(t);case 65:return qw(t);case 71:return gL(t);case 80:return Am(t,r,!i.raw).replace(pr,"");case 81:return fL(t,r).replace(pr,"");case 4108:return pL(t);case 4126:case 4127:return r==4127?dL(t):hL(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function oT(t,e){var n=t.l,r=t.read_shift(4),a=t.read_shift(4),i=[],l=0,c=0,d=-1,f={};for(l=0;l!=a;++l){var g=t.read_shift(4),y=t.read_shift(4);i[l]=[g,y+n]}i.sort(function(k,b){return k[1]-b[1]});var _={};for(l=0;l!=a;++l){if(t.l!==i[l][1]){var w=!0;if(l>0&&e)switch(e[i[l-1][0]].t){case 2:t.l+2===i[l][1]&&(t.l+=2,w=!1);break;case 80:t.l<=i[l][1]&&(t.l=i[l][1],w=!1);break;case 4108:t.l<=i[l][1]&&(t.l=i[l][1],w=!1);break}if((!e||l==0)&&t.l<=i[l][1]&&(w=!1,t.l=i[l][1]),w)throw new Error("Read Error: Expected address "+i[l][1]+" at "+t.l+" :"+l)}if(e){var E=e[i[l][0]];if(_[E.n]=nd(t,E.t,{raw:!0}),E.p==="version"&&(_[E.n]=String(_[E.n]>>16)+"."+("0000"+String(_[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(_[E.n]){case 0:_[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ya(c=_[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[E.n])}}else if(i[l][0]===1){if(c=_.CodePage=nd(t,xp),ya(c),d!==-1){var S=t.l;t.l=i[d][1],f=iT(t,c),t.l=S}}else if(i[l][0]===0){if(c===0){d=l,t.l=i[l+1][1];continue}f=iT(t,c)}else{var C=f[i[l][0]],R;switch(t[t.l]){case 65:t.l+=4,R=qw(t);break;case 30:t.l+=4,R=Am(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,R=Am(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,R=t.read_shift(4,"i");break;case 19:t.l+=4,R=t.read_shift(4);break;case 5:t.l+=4,R=t.read_shift(8,"f");break;case 11:t.l+=4,R=wn(t,4);break;case 64:t.l+=4,R=Hn(vp(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[C]=R}}return t.l=n+r,_}function lT(t,e,n){var r=t.content;if(!r)return{};Wn(r,0);var a,i,l,c,d=0;r.chk("feff","Byte Order: "),r.read_shift(2);var f=r.read_shift(4),g=r.read_shift(16);if(g!==Dt.utils.consts.HEADER_CLSID&&g!==n)throw new Error("Bad PropertySet CLSID "+g);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),d=r.read_shift(4));var y=oT(r,e),_={SystemIdentifier:f};for(var w in y)_[w]=y[w];if(_.FMTID=i,a===1)return _;if(d-r.l==2&&(r.l+=2),r.l!==d)throw new Error("Length mismatch 2: "+r.l+" !== "+d);var E;try{E=oT(r,null)}catch{}for(w in E)_[w]=E[w];return _.FMTID=[i,l],_}function Us(t,e){return t.read_shift(e),null}function xL(t,e,n){for(var r=[],a=t.l+e;t.l<a;)r.push(n(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return r}function wn(t,e){return t.read_shift(e)===1}function An(t){return t.read_shift(2,"u")}function Yw(t,e){return xL(t,e,An)}function vL(t){var e=t.read_shift(1),n=t.read_shift(1);return n===1?e:e===1}function au(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var l=r?t.read_shift(r,a):"";return l}function yL(t){var e=t.read_shift(2),n=t.read_shift(1),r=n&4,a=n&8,i=1+(n&1),l=0,c,d={};a&&(l=t.read_shift(2)),r&&(c=t.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",g=e===0?"":t.read_shift(e,f);return a&&(t.l+=4*l),r&&(t.l+=c),d.t=g,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function Oi(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function su(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):Oi(t,r,n)}function $i(t,e,n){if(n.biff>5)return su(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function _L(t){var e=t.read_shift(1);t.l++;var n=t.read_shift(2);return t.l+=2,[e,n]}function TL(t){var e=t.read_shift(4),n=t.l,r=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),t.l=n);var a=t.read_shift((r?e-24:e)>>1,"utf16le").replace(pr,"");return r&&(t.l+=24),a}function wL(t){for(var e=t.read_shift(2),n="";e-- >0;)n+="../";var r=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return n+r.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(i>>1,"utf16le").replace(pr,"");return n+l}function EL(t,e){var n=t.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return TL(t);case"0303000000000000c000000000000046":return wL(t);default:throw new Error("Unsupported Moniker "+n)}}function Rf(t){var e=t.read_shift(4),n=e>0?t.read_shift(e,"utf16le").replace(pr,""):"";return n}function SL(t,e){var n=t.l+e,r=t.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=t.read_shift(2);t.l+=2;var i,l,c,d,f="",g,y;a&16&&(i=Rf(t,n-t.l)),a&128&&(l=Rf(t,n-t.l)),(a&257)===257&&(c=Rf(t,n-t.l)),(a&257)===1&&(d=EL(t,n-t.l)),a&8&&(f=Rf(t,n-t.l)),a&32&&(g=t.read_shift(16)),a&64&&(y=vp(t)),t.l=n;var _=l||c||d||"";_&&f&&(_+="#"+f),_||(_="#"+f),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var w={Target:_};return g&&(w.guid=g),y&&(w.time=y),i&&(w.Tooltip=i),w}function Ww(t){var e=t.read_shift(1),n=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1);return[e,n,r,a]}function Jw(t,e){var n=Ww(t);return n[3]=0,n}function Va(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return{r:e,c:n,ixfe:r}}function CL(t){var e=t.read_shift(2),n=t.read_shift(2);return t.l+=8,{type:e,flags:n}}function bL(t,e,n){return e===0?"":$i(t,e,n)}function AL(t,e,n){var r=n.biff>8?4:2,a=t.read_shift(r),i=t.read_shift(r,"i"),l=t.read_shift(r,"i");return[a,i,l]}function Kw(t){var e=t.read_shift(2),n=gp(t);return[e,n]}function kL(t,e,n){t.l+=4,e-=4;var r=t.l+e,a=au(t,e,n),i=t.read_shift(2);if(r-=t.l,i!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+i);return t.l+=i,a}function vd(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{s:{c:r,r:e},e:{c:a,r:n}}}function Xw(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(1),a=t.read_shift(1);return{s:{c:r,r:e},e:{c:a,r:n}}}var NL=Xw;function Zw(t){t.l+=4;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return t.l+=12,[n,e,r]}function RL(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function DL(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Qn(t){t.l+=2,t.l+=t.read_shift(2)}var ML={0:Qn,4:Qn,5:Qn,6:Qn,7:DL,8:Qn,9:Qn,10:Qn,11:Qn,12:Qn,13:RL,14:Qn,15:Qn,16:Qn,17:Qn,18:Qn,19:Qn,20:Qn,21:Zw};function IL(t,e){for(var n=t.l+e,r=[];t.l<n;){var a=t.read_shift(2);t.l-=2;try{r.push(ML[a](t,n-t.l))}catch{return t.l=n,r}}return t.l!=n&&(t.l=n),r}function Df(t,e){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=t.read_shift(2),e-=2,e>=2&&(n.dt=t.read_shift(2),t.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return t.read_shift(e),n}function FL(t,e){return e===0||t.read_shift(2),1200}function OL(t,e,n){if(n.enc)return t.l+=e,"";var r=t.l,a=$i(t,0,n);return t.read_shift(e+r-t.l),a}function LL(t,e,n){var r=n&&n.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function PL(t,e,n){var r=t.read_shift(4),a=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=au(t,0,n);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:i,name:l}}function UL(t,e){for(var n=t.l+e,r=t.read_shift(4),a=t.read_shift(4),i=[],l=0;l!=a&&t.l<n;++l)i.push(yL(t));return i.Count=r,i.Unique=a,i}function BL(t,e){var n={};return n.dsst=t.read_shift(2),t.l+=e-2,n}function jL(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var n=t.read_shift(2);t.l+=4;var r=t.read_shift(1);return t.l+=3,r&7&&(e.level=r&7),r&32&&(e.hidden=!0),r&64&&(e.hpt=n/20),e}function VL(t){var e=CL(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var n=t.read_shift(4);return n!==0}function HL(t){return t.read_shift(2),t.read_shift(4)}function cT(t,e,n){var r=0;n&&n.biff==2||(r=t.read_shift(2));var a=t.read_shift(2);n&&n.biff==2&&(r=1-(a>>15),a&=32767);var i={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[i,a]}function GL(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),d=t.read_shift(2),f=t.read_shift(2);return{Pos:[e,n],Dim:[r,a],Flags:i,CurTab:l,FirstTab:c,Selected:d,TabRatio:f}}function $L(t,e,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=t.read_shift(2);return{RTL:r&64}}function zL(){}function qL(t,e,n){var r={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return r.name=au(t,0,n),r}function YL(t){var e=Va(t);return e.isst=t.read_shift(4),e}function WL(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=t.l+e,a=Va(t);n.biff==2&&t.l++;var i=su(t,r-t.l,n);return a.val=i,a}function JL(t,e,n){var r=t.read_shift(2),a=$i(t,0,n);return[r,a]}var KL=$i;function uT(t,e,n){var r=t.l+e,a=n.biff==8||!n.biff?4:2,i=t.read_shift(a),l=t.read_shift(a),c=t.read_shift(2),d=t.read_shift(2);return t.l=r,{s:{r:i,c},e:{r:l,c:d}}}function XL(t){var e=t.read_shift(2),n=t.read_shift(2),r=Kw(t);return{r:e,c:n,ixfe:r[0],rknum:r[1]}}function ZL(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),i=[];t.l<n;)i.push(Kw(t));if(t.l!==n)throw new Error("MulRK read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:i}}function QL(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),i=[];t.l<n;)i.push(t.read_shift(2));if(t.l!==n)throw new Error("MulBlank read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:i}}function eP(t,e,n,r){var a={},i=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(4),d=t.read_shift(2);return a.patternType=XO[c>>26],r.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=d&127,a.icvBack=d>>7&127,a.fsxButton=d>>14&1),a}function tP(t,e,n){var r={};return r.ifnt=t.read_shift(2),r.numFmtId=t.read_shift(2),r.flags=t.read_shift(2),r.fStyle=r.flags>>2&1,e-=6,r.data=eP(t,e,r.fStyle,n),r}function nP(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function fT(t,e,n){var r=Va(t);(n.biff==2||e==9)&&++t.l;var a=vL(t);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function rP(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=Va(t),a=nr(t);return r.val=a,r}var dT=bL;function aP(t,e,n){var r=t.l+e,a=t.read_shift(2),i=t.read_shift(2);if(n.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Oi(t,i),c=[];r>t.l;)c.push(su(t));return[i,a,l,c]}function hT(t,e,n){var r=t.read_shift(2),a,i={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(a=kL(t,e-2,n)),i.body=a||t.read_shift(e-2),typeof a=="string"&&(i.Name=a),i}var sP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function mT(t,e,n){var r=t.l+e,a=t.read_shift(2),i=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(n&&n.biff==2?1:2),d=0;(!n||n.biff>=5)&&(n.biff!=5&&(t.l+=2),d=t.read_shift(2),n.biff==5&&(t.l+=2),t.l+=4);var f=Oi(t,l,n);a&32&&(f=sP[f.charCodeAt(0)]);var g=r-t.l;n&&n.biff==2&&--g;var y=r==t.l||c===0||!(g>0)?[]:j9(t,g,n,c);return{chKey:i,Name:f,itab:d,rgce:y}}function Qw(t,e,n){if(n.biff<8)return iP(t,e,n);for(var r=[],a=t.l+e,i=t.read_shift(n.biff>8?4:2);i--!==0;)r.push(AL(t,n.biff>8?12:6,n));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return r}function iP(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=au(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function oP(t,e,n){if(n.biff<8){t.l+=e;return}var r=t.read_shift(2),a=t.read_shift(2),i=Oi(t,r,n),l=Oi(t,a,n);return[i,l]}function lP(t,e,n){var r=Xw(t);t.l++;var a=t.read_shift(1);return e-=8,[V9(t,e,n),a,r]}function pT(t,e,n){var r=NL(t);switch(n.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[r,U9(t,e,n)]}function cP(t){var e=t.read_shift(4)!==0,n=t.read_shift(4)!==0,r=t.read_shift(4);return[e,n,r]}function uP(t,e,n){if(!(n.biff<8)){var r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=$i(t,0,n);return n.biff<8&&t.read_shift(1),[{r,c:a},c,l,i]}}function fP(t,e,n){return uP(t,e,n)}function dP(t,e){for(var n=[],r=t.read_shift(2);r--;)n.push(vd(t));return n}function hP(t,e,n){if(n&&n.biff<8)return pP(t,e,n);var r=Zw(t),a=IL(t,e-22,r[1]);return{cmo:r,ft:a}}var mP={8:function(t,e){var n=t.l+e;t.l+=10;var r=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=n,{fmt:r}}};function pP(t,e,n){t.l+=4;var r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((mP[r]||ir)(t,e,n)),{cmo:[a,r,i],ft:l}}function gP(t,e,n){var r=t.l,a="";try{t.l+=4;var i=(n.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:l=_L(t,6,n);var c=t.read_shift(2);t.read_shift(2),An(t,2);var d=t.read_shift(2);t.l+=d;for(var f=1;f<t.lens.length-1;++f){if(t.l-r!=t.lens[f])throw new Error("TxO: bad continue record");var g=t[t.l],y=Oi(t,t.lens[f+1]-t.lens[f]-1);if(a+=y,a.length>=(g?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return t.l=r+e,{t:a}}catch{return t.l=r+e,{t:a}}}function xP(t,e){var n=vd(t);t.l+=16;var r=SL(t,e-24);return[n,r]}function vP(t,e){t.read_shift(2);var n=vd(t),r=t.read_shift((e-10)/2,"dbcs-cont");return r=r.replace(pr,""),[n,r]}function yP(t){var e=[0,0],n;return n=t.read_shift(2),e[0]=aT[n]||n,n=t.read_shift(2),e[1]=aT[n]||n,e}function _P(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(Jw(t));return n}function TP(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(Jw(t));return n}function wP(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function eE(t,e,n){if(!n.cellStyles)return ir(t,e);var r=n&&n.biff>=12?4:2,a=t.read_shift(r),i=t.read_shift(r),l=t.read_shift(r),c=t.read_shift(r),d=t.read_shift(2);r==2&&(t.l+=2);var f={s:a,e:i,w:l,ixfe:c,flags:d};return(n.biff>=5||!n.biff)&&(f.level=d>>8&7),f}function EP(t,e){var n={};return e<32||(t.l+=16,n.header=nr(t),n.footer=nr(t),t.l+=2),n}function SP(t,e,n){var r={area:!1};if(n.biff!=5)return t.l+=e,r;var a=t.read_shift(1);return t.l+=3,a&16&&(r.area=!0),r}var CP=Va,bP=Yw,AP=su;function kP(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a={fmt:e,env:n,len:r,data:t.slice(t.l,t.l+r)};return t.l+=r,a}function NP(t,e,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=Va(t);++t.l;var a=$i(t,e-7,n);return r.t="str",r.val=a,r}function RP(t){var e=Va(t);++t.l;var n=nr(t);return e.t="n",e.val=n,e}function DP(t){var e=Va(t);++t.l;var n=t.read_shift(2);return e.t="n",e.val=n,e}function MP(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function IP(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function FP(t,e,n){var r=t.l+e,a=Va(t),i=t.read_shift(2),l=Oi(t,i,n);return t.l=r,a.t="str",a.val=l,a}var OP=[2,3,48,49,131,139,140,245],gT=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=op({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(c,d){var f=[],g=Xs(1);switch(d.type){case"base64":g=va(jr(c));break;case"binary":g=va(c);break;case"buffer":case"array":g=c;break}Wn(g,0);var y=g.read_shift(1),_=!!(y&136),w=!1,E=!1;switch(y){case 2:break;case 3:break;case 48:w=!0,_=!0;break;case 49:w=!0,_=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var S=0,C=521;y==2&&(S=g.read_shift(2)),g.l+=3,y!=2&&(S=g.read_shift(4)),S>1048576&&(S=1e6),y!=2&&(C=g.read_shift(2));var R=g.read_shift(2),k=d.codepage||1252;y!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(k=t[g[g.l]]),g.l+=1,g.l+=2),E&&(g.l+=36);for(var b=[],O={},U=Math.min(g.length,y==2?521:C-10-(w?264:0)),j=E?32:11;g.l<U&&g[g.l]!=13;)switch(O={},O.name=Hc.utils.decode(k,g.slice(g.l,g.l+j)).replace(/[\u0000\r\n].*$/g,""),g.l+=j,O.type=String.fromCharCode(g.read_shift(1)),y!=2&&!E&&(O.offset=g.read_shift(4)),O.len=g.read_shift(1),y==2&&(O.offset=g.read_shift(2)),O.dec=g.read_shift(1),O.name.length&&b.push(O),y!=2&&(g.l+=E?13:14),O.type){case"B":(!w||O.len!=8)&&d.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(g[g.l]!==13&&(g.l=C-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=C;var F=0,K=0;for(f[0]=[],K=0;K!=b.length;++K)f[0][K]=b[K].name;for(;S-- >0;){if(g[g.l]===42){g.l+=R;continue}for(++g.l,f[++F]=[],K=0,K=0;K!=b.length;++K){var P=g.slice(g.l,g.l+b[K].len);g.l+=b[K].len,Wn(P,0);var ne=Hc.utils.decode(k,P);switch(b[K].type){case"C":ne.trim().length&&(f[F][K]=ne.replace(/\s+$/,""));break;case"D":ne.length===8?f[F][K]=new Date(+ne.slice(0,4),+ne.slice(4,6)-1,+ne.slice(6,8)):f[F][K]=ne;break;case"F":f[F][K]=parseFloat(ne.trim());break;case"+":case"I":f[F][K]=E?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(ne.trim().toUpperCase()){case"Y":case"T":f[F][K]=!0;break;case"N":case"F":f[F][K]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ne+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));f[F][K]="##MEMO##"+(E?parseInt(ne.trim(),10):P.read_shift(4));break;case"N":ne=ne.replace(/\u0000/g,"").trim(),ne&&ne!="."&&(f[F][K]=+ne||0);break;case"@":f[F][K]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":f[F][K]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":f[F][K]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[F][K]=-P.read_shift(-8,"f");break;case"B":if(w&&b[K].len==8){f[F][K]=P.read_shift(8,"f");break}case"G":case"P":P.l+=b[K].len;break;case"0":if(b[K].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[K].type)}}}if(y!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=b,f}function r(c,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var g=hl(n(c,f),f);return g["!cols"]=f.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete f.DBF,g}function a(c,d){try{return ei(r(c,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,d){var f=d||{};if(+f.codepage>=0&&ya(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var g=Sm(),y=Fm(c,{header:1,raw:!0,cellDates:!0}),_=y[0],w=y.slice(1),E=c["!cols"]||[],S=0,C=0,R=0,k=1;for(S=0;S<_.length;++S){if(((E[S]||{}).DBF||{}).name){_[S]=E[S].DBF.name,++R;continue}if(_[S]!=null){if(++R,typeof _[S]=="number"&&(_[S]=_[S].toString(10)),typeof _[S]!="string")throw new Error("DBF Invalid column name "+_[S]+" |"+typeof _[S]+"|");if(_.indexOf(_[S])!==S){for(C=0;C<1024;++C)if(_.indexOf(_[S]+"_"+C)==-1){_[S]+="_"+C;break}}}}var b=gn(c["!ref"]),O=[],U=[],j=[];for(S=0;S<=b.e.c-b.s.c;++S){var F="",K="",P=0,ne=[];for(C=0;C<w.length;++C)w[C][S]!=null&&ne.push(w[C][S]);if(ne.length==0||_[S]==null){O[S]="?";continue}for(C=0;C<ne.length;++C){switch(typeof ne[C]){case"number":K="B";break;case"string":K="C";break;case"boolean":K="L";break;case"object":K=ne[C]instanceof Date?"D":"C";break;default:K="C"}P=Math.max(P,String(ne[C]).length),F=F&&F!=K?"C":K}P>250&&(P=250),K=((E[S]||{}).DBF||{}).type,K=="C"&&E[S].DBF.len>P&&(P=E[S].DBF.len),F=="B"&&K=="N"&&(F="N",j[S]=E[S].DBF.dec,P=E[S].DBF.len),U[S]=F=="C"||K=="N"?P:i[F]||0,k+=U[S],O[S]=F}var Q=g.next(32);for(Q.write_shift(4,318902576),Q.write_shift(4,w.length),Q.write_shift(2,296+32*R),Q.write_shift(2,k),S=0;S<4;++S)Q.write_shift(4,0);for(Q.write_shift(4,0|(+e[Q2]||3)<<8),S=0,C=0;S<_.length;++S)if(_[S]!=null){var te=g.next(32),_e=(_[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,_e,"sbcs"),te.write_shift(1,O[S]=="?"?"C":O[S],"sbcs"),te.write_shift(4,C),te.write_shift(1,U[S]||i[O[S]]||0),te.write_shift(1,j[S]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),C+=U[S]||i[O[S]]||0}var Le=g.next(264);for(Le.write_shift(4,13),S=0;S<65;++S)Le.write_shift(4,0);for(S=0;S<w.length;++S){var Te=g.next(k);for(Te.write_shift(1,0),C=0;C<_.length;++C)if(_[C]!=null)switch(O[C]){case"L":Te.write_shift(1,w[S][C]==null?63:w[S][C]?84:70);break;case"B":Te.write_shift(8,w[S][C]||0,"f");break;case"N":var ae="0";for(typeof w[S][C]=="number"&&(ae=w[S][C].toFixed(j[C]||0)),R=0;R<U[C]-ae.length;++R)Te.write_shift(1,32);Te.write_shift(1,ae,"sbcs");break;case"D":w[S][C]?(Te.write_shift(4,("0000"+w[S][C].getFullYear()).slice(-4),"sbcs"),Te.write_shift(2,("00"+(w[S][C].getMonth()+1)).slice(-2),"sbcs"),Te.write_shift(2,("00"+w[S][C].getDate()).slice(-2),"sbcs")):Te.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(w[S][C]!=null?w[S][C]:"").slice(0,U[C]);for(Te.write_shift(1,ue,"sbcs"),R=0;R<U[C]-ue.length;++R)Te.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}}(),LP=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ua(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(_,w){var E=t[w];return typeof E=="number"?M_(E):E},r=function(_,w,E){var S=w.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return S==59?_:M_(S)};t["|"]=254;function a(_,w){switch(w.type){case"base64":return i(jr(_),w);case"binary":return i(_,w);case"buffer":return i(kt&&Buffer.isBuffer(_)?_.toString("binary"):ji(_),w);case"array":return i(Fi(_),w)}throw new Error("Unrecognized type "+w.type)}function i(_,w){var E=_.split(/[\n\r]+/),S=-1,C=-1,R=0,k=0,b=[],O=[],U=null,j={},F=[],K=[],P=[],ne=0,Q;for(+w.codepage>=0&&ya(+w.codepage);R!==E.length;++R){ne=0;var te=E[R].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),_e=te.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),Le=_e[0],Te;if(te.length>0)switch(Le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":_e[1].charAt(0)=="P"&&O.push(te.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,ue=!1,re=!1,W=!1,N=-1,Z=-1;for(k=1;k<_e.length;++k)switch(_e[k].charAt(0)){case"A":break;case"X":C=parseInt(_e[k].slice(1))-1,ue=!0;break;case"Y":for(S=parseInt(_e[k].slice(1))-1,ue||(C=0),Q=b.length;Q<=S;++Q)b[Q]=[];break;case"K":Te=_e[k].slice(1),Te.charAt(0)==='"'?Te=Te.slice(1,Te.length-1):Te==="TRUE"?Te=!0:Te==="FALSE"?Te=!1:isNaN(Ta(Te))?isNaN(rl(Te).getDate())||(Te=Hn(Te)):(Te=Ta(Te),U!==null&&fl(U)&&(Te=xd(Te))),ae=!0;break;case"E":W=!0;var M=Yo(_e[k].slice(1),{r:S,c:C});b[S][C]=[b[S][C],M];break;case"S":re=!0,b[S][C]=[b[S][C],"S5S"];break;case"G":break;case"R":N=parseInt(_e[k].slice(1))-1;break;case"C":Z=parseInt(_e[k].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+te)}if(ae&&(b[S][C]&&b[S][C].length==2?b[S][C][0]=Te:b[S][C]=Te,U=null),re){if(W)throw new Error("SYLK shared formula cannot have own formula");var V=N>-1&&b[N][Z];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");b[S][C][1]=uE(V[1],{r:S-N,c:C-Z})}break;case"F":var Y=0;for(k=1;k<_e.length;++k)switch(_e[k].charAt(0)){case"X":C=parseInt(_e[k].slice(1))-1,++Y;break;case"Y":for(S=parseInt(_e[k].slice(1))-1,Q=b.length;Q<=S;++Q)b[Q]=[];break;case"M":ne=parseInt(_e[k].slice(1))/20;break;case"F":break;case"G":break;case"P":U=O[parseInt(_e[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=_e[k].slice(1).split(" "),Q=parseInt(P[0],10);Q<=parseInt(P[1],10);++Q)ne=parseInt(P[2],10),K[Q-1]=ne===0?{hidden:!0}:{wch:ne},al(K[Q-1]);break;case"C":C=parseInt(_e[k].slice(1))-1,K[C]||(K[C]={});break;case"R":S=parseInt(_e[k].slice(1))-1,F[S]||(F[S]={}),ne>0?(F[S].hpt=ne,F[S].hpx=Wc(ne)):ne===0&&(F[S].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+te)}Y<1&&(U=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+te)}}return F.length>0&&(j["!rows"]=F),K.length>0&&(j["!cols"]=K),w&&w.sheetRows&&(b=b.slice(0,w.sheetRows)),[b,j]}function l(_,w){var E=a(_,w),S=E[0],C=E[1],R=hl(S,w);return Ua(C).forEach(function(k){R[k]=C[k]}),R}function c(_,w){return ei(l(_,w),w)}function d(_,w,E,S){var C="C;Y"+(E+1)+";X"+(S+1)+";K";switch(_.t){case"n":C+=_.v||0,_.f&&!_.F&&(C+=";E"+w7(_.f,{r:E,c:S}));break;case"b":C+=_.v?"TRUE":"FALSE";break;case"e":C+=_.w||_.v;break;case"d":C+='"'+(_.w||_.v)+'"';break;case"s":C+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function f(_,w){w.forEach(function(E,S){var C="F;W"+(S+1)+" "+(S+1)+" ";E.hidden?C+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=ad(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=sd(E.wpx)),typeof E.wch=="number"&&(C+=Math.round(E.wch))),C.charAt(C.length-1)!=" "&&_.push(C)})}function g(_,w){w.forEach(function(E,S){var C="F;";E.hidden?C+="M0;":E.hpt?C+="M"+20*E.hpt+";":E.hpx&&(C+="M"+20*oE(E.hpx)+";"),C.length>2&&_.push(C+"R"+(S+1))})}function y(_,w){var E=["ID;PWXL;N;E"],S=[],C=gn(_["!ref"]),R,k=Array.isArray(_),b=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),_["!cols"]&&f(E,_["!cols"]),_["!rows"]&&g(E,_["!rows"]),E.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var O=C.s.r;O<=C.e.r;++O)for(var U=C.s.c;U<=C.e.c;++U){var j=ot({r:O,c:U});R=k?(_[O]||[])[U]:_[j],!(!R||R.v==null&&(!R.f||R.F))&&S.push(d(R,_,O,U))}return E.join(b)+b+S.join(b)+b+"E"+b}return{to_workbook:c,to_sheet:l,from_sheet:y}}(),PP=function(){function t(i,l){switch(l.type){case"base64":return e(jr(i),l);case"binary":return e(i,l);case"buffer":return e(kt&&Buffer.isBuffer(i)?i.toString("binary"):ji(i),l);case"array":return e(Fi(i),l)}throw new Error("Unrecognized type "+l.type)}function e(i,l){for(var c=i.split(`
`),d=-1,f=-1,g=0,y=[];g!==c.length;++g){if(c[g].trim()==="BOT"){y[++d]=[],f=0;continue}if(!(d<0)){var _=c[g].trim().split(","),w=_[0],E=_[1];++g;for(var S=c[g]||"";(S.match(/["]/g)||[]).length&1&&g<c.length-1;)S+=`
`+c[++g];switch(S=S.trim(),+w){case-1:if(S==="BOT"){y[++d]=[],f=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?y[d][f]=!0:S==="FALSE"?y[d][f]=!1:isNaN(Ta(E))?isNaN(rl(E).getDate())?y[d][f]=E:y[d][f]=Hn(E):y[d][f]=Ta(E),++f;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),y[d][f++]=S!==""?S:null;break}if(S==="EOD")break}}return l&&l.sheetRows&&(y=y.slice(0,l.sheetRows)),y}function n(i,l){return hl(t(i,l),l)}function r(i,l){return ei(n(i,l),l)}var a=function(){var i=function(d,f,g,y,_){d.push(f),d.push(g+","+y),d.push('"'+_.replace(/"/g,'""')+'"')},l=function(d,f,g,y){d.push(f+","+g),d.push(f==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(d){var f=[],g=gn(d["!ref"]),y,_=Array.isArray(d);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,g.e.r-g.s.r+1,""),i(f,"TUPLES",0,g.e.c-g.s.c+1,""),i(f,"DATA",0,0,"");for(var w=g.s.r;w<=g.e.r;++w){l(f,-1,0,"BOT");for(var E=g.s.c;E<=g.e.c;++E){var S=ot({r:w,c:E});if(y=_?(d[w]||[])[E]:d[S],!y){l(f,1,0,"");continue}switch(y.t){case"n":var C=y.w;!C&&y.v!=null&&(C=y.v),C==null?y.f&&!y.F?l(f,1,0,"="+y.f):l(f,1,0,""):l(f,0,C,"V");break;case"b":l(f,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=aa(y.z||ut[14],xr(Hn(y.v)))),l(f,0,y.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var R=`\r
`,k=f.join(R);return k}}();return{to_workbook:r,to_sheet:n,from_sheet:a}}(),UP=function(){function t(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(y,_){for(var w=y.split(`
`),E=-1,S=-1,C=0,R=[];C!==w.length;++C){var k=w[C].trim().split(":");if(k[0]==="cell"){var b=mr(k[1]);if(R.length<=b.r)for(E=R.length;E<=b.r;++E)R[E]||(R[E]=[]);switch(E=b.r,S=b.c,k[2]){case"t":R[E][S]=t(k[3]);break;case"v":R[E][S]=+k[3];break;case"vtf":var O=k[k.length-1];case"vtc":switch(k[3]){case"nl":R[E][S]=!!+k[4];break;default:R[E][S]=+k[4];break}k[2]=="vtf"&&(R[E][S]=[R[E][S],O])}}}return _&&_.sheetRows&&(R=R.slice(0,_.sheetRows)),R}function r(y,_){return hl(n(y,_),_)}function a(y,_){return ei(r(y,_),_)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(y){if(!y||!y["!ref"])return"";for(var _=[],w=[],E,S="",C=dl(y["!ref"]),R=Array.isArray(y),k=C.s.r;k<=C.e.r;++k)for(var b=C.s.c;b<=C.e.c;++b)if(S=ot({r:k,c:b}),E=R?(y[k]||[])[b]:y[S],!(!E||E.v==null||E.t==="z")){switch(w=["cell",S,"t"],E.t){case"s":case"str":w.push(e(E.v));break;case"n":E.f?(w[2]="vtf",w[3]="n",w[4]=E.v,w[5]=e(E.f)):(w[2]="v",w[3]=E.v);break;case"b":w[2]="vt"+(E.f?"f":"c"),w[3]="nl",w[4]=E.v?"1":"0",w[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var O=xr(Hn(E.v));w[2]="vtc",w[3]="nd",w[4]=""+O,w[5]=E.w||aa(E.z||ut[14],O);break;case"e":continue}_.push(w.join(":"))}return _.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function g(y){return[i,l,c,l,f(y),d].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:g}}(),qc=function(){function t(g,y,_,w,E){E.raw?y[_][w]=g:g===""||(g==="TRUE"?y[_][w]=!0:g==="FALSE"?y[_][w]=!1:isNaN(Ta(g))?isNaN(rl(g).getDate())?y[_][w]=g:y[_][w]=Hn(g):y[_][w]=Ta(g))}function e(g,y){var _=y||{},w=[];if(!g||g.length===0)return w;for(var E=g.split(/[\r\n]/),S=E.length-1;S>=0&&E[S].length===0;)--S;for(var C=10,R=0,k=0;k<=S;++k)R=E[k].indexOf(" "),R==-1?R=E[k].length:R++,C=Math.max(C,R);for(k=0;k<=S;++k){w[k]=[];var b=0;for(t(E[k].slice(0,C).trim(),w,k,b,_),b=1;b<=(E[k].length-C)/10+1;++b)t(E[k].slice(C+(b-1)*10,C+b*10).trim(),w,k,b,_)}return _.sheetRows&&(w=w.slice(0,_.sheetRows)),w}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(g){for(var y={},_=!1,w=0,E=0;w<g.length;++w)(E=g.charCodeAt(w))==34?_=!_:!_&&E in n&&(y[E]=(y[E]||0)+1);E=[];for(w in y)Object.prototype.hasOwnProperty.call(y,w)&&E.push([y[w],w]);if(!E.length){y=r;for(w in y)Object.prototype.hasOwnProperty.call(y,w)&&E.push([y[w],w])}return E.sort(function(S,C){return S[0]-C[0]||r[S[1]]-r[C[1]]}),n[E.pop()[1]]||44}function i(g,y){var _=y||{},w="",E=_.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(w=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(w=g.charAt(4),g=g.slice(6)):w=a(g.slice(0,1024)):_&&_.FS?w=_.FS:w=a(g.slice(0,1024));var C=0,R=0,k=0,b=0,O=0,U=w.charCodeAt(0),j=!1,F=0,K=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var P=_.dateNF!=null?J8(_.dateNF):null;function ne(){var Q=g.slice(b,O),te={};if(Q.charAt(0)=='"'&&Q.charAt(Q.length-1)=='"'&&(Q=Q.slice(1,-1).replace(/""/g,'"')),Q.length===0)te.t="z";else if(_.raw)te.t="s",te.v=Q;else if(Q.trim().length===0)te.t="s",te.v=Q;else if(Q.charCodeAt(0)==61)Q.charCodeAt(1)==34&&Q.charCodeAt(Q.length-1)==34?(te.t="s",te.v=Q.slice(2,-1).replace(/""/g,'"')):S7(Q)?(te.t="n",te.f=Q.slice(1)):(te.t="s",te.v=Q);else if(Q=="TRUE")te.t="b",te.v=!0;else if(Q=="FALSE")te.t="b",te.v=!1;else if(!isNaN(k=Ta(Q)))te.t="n",_.cellText!==!1&&(te.w=Q),te.v=k;else if(!isNaN(rl(Q).getDate())||P&&Q.match(P)){te.z=_.dateNF||ut[14];var _e=0;P&&Q.match(P)&&(Q=K8(Q,_.dateNF,Q.match(P)||[]),_e=1),_.cellDates?(te.t="d",te.v=Hn(Q,_e)):(te.t="n",te.v=xr(Hn(Q,_e))),_.cellText!==!1&&(te.w=aa(te.z,te.v instanceof Date?xr(te.v):te.v)),_.cellNF||delete te.z}else te.t="s",te.v=Q;if(te.t=="z"||(_.dense?(E[C]||(E[C]=[]),E[C][R]=te):E[ot({c:R,r:C})]=te),b=O+1,K=g.charCodeAt(b),S.e.c<R&&(S.e.c=R),S.e.r<C&&(S.e.r=C),F==U)++R;else if(R=0,++C,_.sheetRows&&_.sheetRows<=C)return!0}e:for(;O<g.length;++O)switch(F=g.charCodeAt(O)){case 34:K===34&&(j=!j);break;case U:case 10:case 13:if(!j&&ne())break e;break}return O-b>0&&ne(),E["!ref"]=It(S),E}function l(g,y){return!(y&&y.PRN)||y.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?i(g,y):hl(e(g,y),y)}function c(g,y){var _="",w=y.type=="string"?[0,0,0,0]:bp(g,y);switch(y.type){case"base64":_=jr(g);break;case"binary":_=g;break;case"buffer":y.codepage==65001?_=g.toString("utf8"):y.codepage&&typeof Hc<"u"||(_=kt&&Buffer.isBuffer(g)?g.toString("binary"):ji(g));break;case"array":_=Fi(g);break;case"string":_=g;break;default:throw new Error("Unrecognized type "+y.type)}return w[0]==239&&w[1]==187&&w[2]==191?_=en(_.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?_=en(_):y.type=="binary"&&typeof Hc<"u",_.slice(0,19)=="socialcalc:version:"?UP.to_sheet(y.type=="string"?_:en(_),y):l(_,y)}function d(g,y){return ei(c(g,y),y)}function f(g){for(var y=[],_=gn(g["!ref"]),w,E=Array.isArray(g),S=_.s.r;S<=_.e.r;++S){for(var C=[],R=_.s.c;R<=_.e.c;++R){var k=ot({r:S,c:R});if(w=E?(g[S]||[])[R]:g[k],!w||w.v==null){C.push("          ");continue}for(var b=(w.w||(us(w),w.w)||"").slice(0,10);b.length<10;)b+=" ";C.push(b+(R===0?" ":""))}y.push(C.join(""))}return y.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:f}}();function BP(t,e){var n=e||{},r=!!n.WTF;n.WTF=!0;try{var a=LP.to_workbook(t,n);return n.WTF=r,a}catch(i){if(n.WTF=r,!i.message.match(/SYLK bad record ID/)&&r)throw i;return qc.to_workbook(t,e)}}var Dc=function(){function t(M,V,Y){if(M){Wn(M,M.l||0);for(var z=Y.Enum||N;M.l<M.length;){var ie=M.read_shift(2),ye=z[ie]||z[65535],Ce=M.read_shift(2),Re=M.l+Ce,Ee=ye.f&&ye.f(M,Ce,Y);if(M.l=Re,V(Ee,ye,ie))return}}}function e(M,V){switch(V.type){case"base64":return n(va(jr(M)),V);case"binary":return n(va(M),V);case"buffer":case"array":return n(M,V)}throw"Unsupported type "+V.type}function n(M,V){if(!M)return M;var Y=V||{},z=Y.dense?[]:{},ie="Sheet1",ye="",Ce=0,Re={},Ee=[],Ke=[],J={s:{r:0,c:0},e:{r:0,c:0}},xt=Y.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)Y.Enum=N,t(M,function(Me,jt,nn){switch(nn){case 0:Y.vers=Me,Me>=4096&&(Y.qpro=!0);break;case 6:J=Me;break;case 204:Me&&(ye=Me);break;case 222:ye=Me;break;case 15:case 51:Y.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:nn==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=Y.dateNF||ut[14],Y.cellDates&&(Me[1].t="d",Me[1].v=xd(Me[1].v))),Y.qpro&&Me[3]>Ce&&(z["!ref"]=It(J),Re[ie]=z,Ee.push(ie),z=Y.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},Ce=Me[3],ie=ye||"Sheet"+(Ce+1),ye="");var xn=Y.dense?(z[Me[0].r]||[])[Me[0].c]:z[ot(Me[0])];if(xn){xn.t=Me[1].t,xn.v=Me[1].v,Me[1].z!=null&&(xn.z=Me[1].z),Me[1].f!=null&&(xn.f=Me[1].f);break}Y.dense?(z[Me[0].r]||(z[Me[0].r]=[]),z[Me[0].r][Me[0].c]=Me[1]):z[ot(Me[0])]=Me[1];break}},Y);else if(M[2]==26||M[2]==14)Y.Enum=Z,M[2]==14&&(Y.qpro=!0,M.l=0),t(M,function(Me,jt,nn){switch(nn){case 204:ie=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>Ce&&(z["!ref"]=It(J),Re[ie]=z,Ee.push(ie),z=Y.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},Ce=Me[3],ie="Sheet"+(Ce+1)),xt>0&&Me[0].r>=xt)break;Y.dense?(z[Me[0].r]||(z[Me[0].r]=[]),z[Me[0].r][Me[0].c]=Me[1]):z[ot(Me[0])]=Me[1],J.e.c<Me[0].c&&(J.e.c=Me[0].c),J.e.r<Me[0].r&&(J.e.r=Me[0].r);break;case 27:Me[14e3]&&(Ke[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Ke[Me[0]]=Me[1],Me[0]==Ce&&(ie=Me[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(z["!ref"]=It(J),Re[ye||ie]=z,Ee.push(ye||ie),!Ke.length)return{SheetNames:Ee,Sheets:Re};for(var et={},St=[],st=0;st<Ke.length;++st)Re[Ee[st]]?(St.push(Ke[st]||Ee[st]),et[Ke[st]]=Re[Ke[st]]||Re[Ee[st]]):(St.push(Ke[st]),et[Ke[st]]={"!ref":"A1"});return{SheetNames:St,Sheets:et}}function r(M,V){var Y=V||{};if(+Y.codepage>=0&&ya(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var z=Sm(),ie=gn(M["!ref"]),ye=Array.isArray(M),Ce=[];ma(z,0,i(1030)),ma(z,6,d(ie));for(var Re=Math.min(ie.e.r,8191),Ee=ie.s.r;Ee<=Re;++Ee)for(var Ke=Kn(Ee),J=ie.s.c;J<=ie.e.c;++J){Ee===ie.s.r&&(Ce[J]=Fn(J));var xt=Ce[J]+Ke,et=ye?(M[Ee]||[])[J]:M[xt];if(!(!et||et.t=="z"))if(et.t=="n")(et.v|0)==et.v&&et.v>=-32768&&et.v<=32767?ma(z,13,w(Ee,J,et.v)):ma(z,14,S(Ee,J,et.v));else{var St=us(et);ma(z,15,y(Ee,J,St.slice(0,239)))}}return ma(z,1),z.end()}function a(M,V){var Y=V||{};if(+Y.codepage>=0&&ya(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var z=Sm();ma(z,0,l(M));for(var ie=0,ye=0;ie<M.SheetNames.length;++ie)(M.Sheets[M.SheetNames[ie]]||{})["!ref"]&&ma(z,27,W(M.SheetNames[ie],ye++));var Ce=0;for(ie=0;ie<M.SheetNames.length;++ie){var Re=M.Sheets[M.SheetNames[ie]];if(!(!Re||!Re["!ref"])){for(var Ee=gn(Re["!ref"]),Ke=Array.isArray(Re),J=[],xt=Math.min(Ee.e.r,8191),et=Ee.s.r;et<=xt;++et)for(var St=Kn(et),st=Ee.s.c;st<=Ee.e.c;++st){et===Ee.s.r&&(J[st]=Fn(st));var Me=J[st]+St,jt=Ke?(Re[et]||[])[st]:Re[Me];if(!(!jt||jt.t=="z"))if(jt.t=="n")ma(z,23,ne(et,st,Ce,jt.v));else{var nn=us(jt);ma(z,22,F(et,st,Ce,nn.slice(0,239)))}}++Ce}}return ma(z,1),z.end()}function i(M){var V=In(2);return V.write_shift(2,M),V}function l(M){var V=In(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var Y=0,z=0,ie=0,ye=0;ye<M.SheetNames.length;++ye){var Ce=M.SheetNames[ye],Re=M.Sheets[Ce];if(!(!Re||!Re["!ref"])){++ie;var Ee=dl(Re["!ref"]);Y<Ee.e.r&&(Y=Ee.e.r),z<Ee.e.c&&(z=Ee.e.c)}}return Y>8191&&(Y=8191),V.write_shift(2,Y),V.write_shift(1,ie),V.write_shift(1,z),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function c(M,V,Y){var z={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&Y.qpro?(z.s.c=M.read_shift(1),M.l++,z.s.r=M.read_shift(2),z.e.c=M.read_shift(1),M.l++,z.e.r=M.read_shift(2),z):(z.s.c=M.read_shift(2),z.s.r=M.read_shift(2),V==12&&Y.qpro&&(M.l+=2),z.e.c=M.read_shift(2),z.e.r=M.read_shift(2),V==12&&Y.qpro&&(M.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function d(M){var V=In(8);return V.write_shift(2,M.s.c),V.write_shift(2,M.s.r),V.write_shift(2,M.e.c),V.write_shift(2,M.e.r),V}function f(M,V,Y){var z=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(z[0].c=M.read_shift(1),z[3]=M.read_shift(1),z[0].r=M.read_shift(2),M.l+=2):(z[2]=M.read_shift(1),z[0].c=M.read_shift(2),z[0].r=M.read_shift(2)),z}function g(M,V,Y){var z=M.l+V,ie=f(M,V,Y);if(ie[1].t="s",Y.vers==20768){M.l++;var ye=M.read_shift(1);return ie[1].v=M.read_shift(ye,"utf8"),ie}return Y.qpro&&M.l++,ie[1].v=M.read_shift(z-M.l,"cstr"),ie}function y(M,V,Y){var z=In(7+Y.length);z.write_shift(1,255),z.write_shift(2,V),z.write_shift(2,M),z.write_shift(1,39);for(var ie=0;ie<z.length;++ie){var ye=Y.charCodeAt(ie);z.write_shift(1,ye>=128?95:ye)}return z.write_shift(1,0),z}function _(M,V,Y){var z=f(M,V,Y);return z[1].v=M.read_shift(2,"i"),z}function w(M,V,Y){var z=In(7);return z.write_shift(1,255),z.write_shift(2,V),z.write_shift(2,M),z.write_shift(2,Y,"i"),z}function E(M,V,Y){var z=f(M,V,Y);return z[1].v=M.read_shift(8,"f"),z}function S(M,V,Y){var z=In(13);return z.write_shift(1,255),z.write_shift(2,V),z.write_shift(2,M),z.write_shift(8,Y,"f"),z}function C(M,V,Y){var z=M.l+V,ie=f(M,V,Y);if(ie[1].v=M.read_shift(8,"f"),Y.qpro)M.l=z;else{var ye=M.read_shift(2);O(M.slice(M.l,M.l+ye),ie),M.l+=ye}return ie}function R(M,V,Y){var z=V&32768;return V&=-32769,V=(z?M:0)+(V>=8192?V-16384:V),(z?"":"$")+(Y?Fn(V):Kn(V))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(M,V){Wn(M,0);for(var Y=[],z=0,ie="",ye="",Ce="",Re="";M.l<M.length;){var Ee=M[M.l++];switch(Ee){case 0:Y.push(M.read_shift(8,"f"));break;case 1:ye=R(V[0].c,M.read_shift(2),!0),ie=R(V[0].r,M.read_shift(2),!1),Y.push(ye+ie);break;case 2:{var Ke=R(V[0].c,M.read_shift(2),!0),J=R(V[0].r,M.read_shift(2),!1);ye=R(V[0].c,M.read_shift(2),!0),ie=R(V[0].r,M.read_shift(2),!1),Y.push(Ke+J+":"+ye+ie)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(M.read_shift(2));break;case 6:{for(var xt="";Ee=M[M.l++];)xt+=String.fromCharCode(Ee);Y.push('"'+xt.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:Re=Y.pop(),Ce=Y.pop(),Y.push(["AND","OR"][Ee-20]+"("+Ce+","+Re+")");break;default:if(Ee<32&&b[Ee])Re=Y.pop(),Ce=Y.pop(),Y.push(Ce+b[Ee]+Re);else if(k[Ee]){if(z=k[Ee][1],z==69&&(z=M[M.l++]),z>Y.length){console.error("WK1 bad formula parse 0x"+Ee.toString(16)+":|"+Y.join("|")+"|");return}var et=Y.slice(-z);Y.length-=z,Y.push(k[Ee][0]+"("+et.join(",")+")")}else return Ee<=7?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=24?console.error("WK1 unsupported op "+Ee.toString(16)):Ee<=30?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=115?console.error("WK1 unsupported function opcode "+Ee.toString(16)):console.error("WK1 unrecognized opcode "+Ee.toString(16))}}Y.length==1?V[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function U(M){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=M.read_shift(2),V[3]=M[M.l++],V[0].c=M[M.l++],V}function j(M,V){var Y=U(M);return Y[1].t="s",Y[1].v=M.read_shift(V-4,"cstr"),Y}function F(M,V,Y,z){var ie=In(6+z.length);ie.write_shift(2,M),ie.write_shift(1,Y),ie.write_shift(1,V),ie.write_shift(1,39);for(var ye=0;ye<z.length;++ye){var Ce=z.charCodeAt(ye);ie.write_shift(1,Ce>=128?95:Ce)}return ie.write_shift(1,0),ie}function K(M,V){var Y=U(M);Y[1].v=M.read_shift(2);var z=Y[1].v>>1;if(Y[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return Y[1].v=z,Y}function P(M,V){var Y=U(M),z=M.read_shift(4),ie=M.read_shift(4),ye=M.read_shift(2);if(ye==65535)return z===0&&ie===3221225472?(Y[1].t="e",Y[1].v=15):z===0&&ie===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var Ce=ye&32768;return ye=(ye&32767)-16446,Y[1].v=(1-Ce*2)*(ie*Math.pow(2,ye+32)+z*Math.pow(2,ye)),Y}function ne(M,V,Y,z){var ie=In(14);if(ie.write_shift(2,M),ie.write_shift(1,Y),ie.write_shift(1,V),z==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var ye=0,Ce=0,Re=0,Ee=0;return z<0&&(ye=1,z=-z),Ce=Math.log2(z)|0,z/=Math.pow(2,Ce-31),Ee=z>>>0,(Ee&2147483648)==0&&(z/=2,++Ce,Ee=z>>>0),z-=Ee,Ee|=2147483648,Ee>>>=0,z*=Math.pow(2,32),Re=z>>>0,ie.write_shift(4,Re),ie.write_shift(4,Ee),Ce+=16383+(ye?32768:0),ie.write_shift(2,Ce),ie}function Q(M,V){var Y=P(M);return M.l+=V-14,Y}function te(M,V){var Y=U(M),z=M.read_shift(4);return Y[1].v=z>>6,Y}function _e(M,V){var Y=U(M),z=M.read_shift(8,"f");return Y[1].v=z,Y}function Le(M,V){var Y=_e(M);return M.l+=V-10,Y}function Te(M,V){return M[M.l+V-1]==0?M.read_shift(V,"cstr"):""}function ae(M,V){var Y=M[M.l++];Y>V-1&&(Y=V-1);for(var z="";z.length<Y;)z+=String.fromCharCode(M[M.l++]);return z}function ue(M,V,Y){if(!(!Y.qpro||V<21)){var z=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var ie=M.read_shift(V-21,"cstr");return[z,ie]}}function re(M,V){for(var Y={},z=M.l+V;M.l<z;){var ie=M.read_shift(2);if(ie==14e3){for(Y[ie]=[0,""],Y[ie][0]=M.read_shift(2);M[M.l];)Y[ie][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return Y}function W(M,V){var Y=In(5+M.length);Y.write_shift(2,14e3),Y.write_shift(2,V);for(var z=0;z<M.length;++z){var ie=M.charCodeAt(z);Y[Y.l++]=ie>127?95:ie}return Y[Y.l++]=0,Y}var N={0:{n:"BOF",f:An},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Te},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},Z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:K},25:{n:"FORMULA19",f:Q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:_e},40:{n:"FORMULA28",f:Le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:e}}();function jP(t){var e={},n=t.match(or),r=0,a=!1;if(n)for(;r!=n.length;++r){var i=rt(n[r]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=np[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return e}var VP=function(){var t=$c("t"),e=$c("rPr");function n(i){var l=i.match(t);if(!l)return{t:"s",v:""};var c={t:"s",v:Ft(l[1])},d=i.match(e);return d&&(c.s=jP(d[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(n).filter(function(c){return c.v})}}(),HP=function(){var e=/(\r\n|\n)/g;function n(a,i,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),l.push("</b>")),a.i&&(i.push("<i>"),l.push("</i>")),a.strike&&(i.push("<s>"),l.push("</s>"));var d=a.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(i.push("<"+d+">"),l.push("</"+d+">")),l.push("</span>"),a}function r(a){var i=[[],a.v,[]];return a.v?(a.s&&n(a.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(r).join("")}}(),GP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,$P=/<(?:\w+:)?r>/,zP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function yp(t,e){var n=e?e.cellHTML:!0,r={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Ft(en(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=en(t),n&&(r.h=cp(r.t))):t.match($P)&&(r.r=en(t),r.t=Ft(en((t.replace(zP,"").match(GP)||[]).join("").replace(or,""))),n&&(r.h=HP(VP(r.r)))),r):{t:""}}var qP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,YP=/<(?:\w+:)?(?:si|sstItem)>/g,WP=/<\/(?:\w+:)?(?:si|sstItem)>/;function JP(t,e){var n=[],r="";if(!t)return n;var a=t.match(qP);if(a){r=a[2].replace(YP,"").split(WP);for(var i=0;i!=r.length;++i){var l=yp(r[i].trim(),e);l!=null&&(n[n.length]=l)}a=rt(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}function KP(t){return[t.read_shift(4),t.read_shift(4)]}function XP(t,e){var n=[],r=!1;return hs(t,function(i,l,c){switch(c){case 159:n.Count=i[0],n.Unique=i[1];break;case 19:n.push(i);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function tE(t){for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function os(t,e){var n={};return n.Major=t.read_shift(2),n.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),n}function ZP(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=os(t,4),e.U=os(t,4),e.W=os(t,4),e}function QP(t){for(var e=t.read_shift(4),n=t.l+e-4,r={},a=t.read_shift(4),i=[];a-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(r.name=t.read_shift(0,"lpp4"),r.comps=i,t.l!=n)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+n);return r}function eU(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(QP(t));return e}function tU(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function nU(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=os(t,4),e.U=os(t,4),e.W=os(t,4),e}function rU(t){var e=nU(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function nE(t,e){var n=t.l+e,r={};r.Flags=t.read_shift(4)&63,t.l+=4,r.AlgID=t.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=t.read_shift(4),r.KeySize=t.read_shift(4),r.ProviderType=t.read_shift(4),t.l+=8,r.CSPName=t.read_shift(n-t.l>>1,"utf16le"),t.l=n,r}function rE(t,e){var n={},r=t.l+e;return t.l+=4,n.Salt=t.slice(t.l,t.l+16),t.l+=16,n.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),n.VerifierHash=t.slice(t.l,r),t.l=r,n}function aU(t){var e=os(t);switch(e.Minor){case 2:return[e.Minor,sU(t)];case 3:return[e.Minor,iU()];case 4:return[e.Minor,oU(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function sU(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var n=t.read_shift(4),r=nE(t,n),a=rE(t,t.length-t.l);return{t:"Std",h:r,v:a}}function iU(){throw new Error("File is password-protected: ECMA-376 Extensible")}function oU(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var n=t.read_shift(t.length-t.l,"utf8"),r={};return n.replace(or,function(i){var l=rt(i);switch(ja(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function lU(t,e){var n={},r=n.EncryptionVersionInfo=os(t,4);if(e-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,n.EncryptionHeader=nE(t,a),e-=a,n.EncryptionVerifier=rE(t,e),n}function cU(t){var e={},n=e.EncryptionVersionInfo=os(t,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function uU(t){var e=0,n,r=tE(t),a=r.length+1,i,l,c,d,f;for(n=Xs(a),n[0]=r.length,i=1;i!=a;++i)n[i]=r[i-1];for(i=a-1;i>=0;--i)l=n[i],c=(e&16384)===0?0:1,d=e<<1&32767,f=c|d,e=f^l;return e^52811}var aE=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},i=function(l){for(var c=e[l.length-1],d=104,f=l.length-1;f>=0;--f)for(var g=l[f],y=0;y!=7;++y)g&64&&(c^=n[d]),g*=2,--d;return c};return function(l){for(var c=tE(l),d=i(c),f=c.length,g=Xs(16),y=0;y!=16;++y)g[y]=0;var _,w,E;for((f&1)===1&&(_=d>>8,g[f]=a(t[0],_),--f,_=d&255,w=c[c.length-1],g[f]=a(w,_));f>0;)--f,_=d>>8,g[f]=a(c[f],_),--f,_=d&255,g[f]=a(c[f],_);for(f=15,E=15-c.length;E>0;)_=d>>8,g[f]=a(t[E],_),--f,--E,_=d&255,g[f]=a(c[f],_),--f,--E;return g}}(),fU=function(t,e,n,r,a){a||(a=e),r||(r=aE(t));var i,l;for(i=0;i!=e.length;++i)l=e[i],l^=r[n],l=(l>>5|l<<3)&255,a[i]=l,++n;return[a,n,r]},dU=function(t){var e=0,n=aE(t);return function(r){var a=fU("",r,e,n);return e=a[1],a[0]}};function hU(t,e,n,r){var a={key:An(t),verificationBytes:An(t)};return n.password&&(a.verifier=uU(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=dU(n.password)),a}function mU(t,e,n){var r=n||{};return r.Info=t.read_shift(2),t.l-=2,r.Info===1?r.Data=cU(t):r.Data=lU(t,e),r}function pU(t,e,n){var r={Type:n.biff>=8?t.read_shift(2):0};return r.Type?mU(t,e-2,r):hU(t,n.biff>=8?e:e-2,n,r),r}var gU=function(){function t(a,i){switch(i.type){case"base64":return e(jr(a),i);case"binary":return e(a,i);case"buffer":return e(kt&&Buffer.isBuffer(a)?a.toString("binary"):ji(a),i);case"array":return e(Fi(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){var l=i||{},c=l.dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(g,y){Array.isArray(c)&&(c[y]=[]);for(var _=/\\\w+\b/g,w=0,E,S=-1;E=_.exec(g);){switch(E[0]){case"\\cell":var C=g.slice(w,_.lastIndex-E[0].length);if(C[0]==" "&&(C=C.slice(1)),++S,C.length){var R={v:C,t:"s"};Array.isArray(c)?c[y][S]=R:c[ot({r:y,c:S})]=R}break}w=_.lastIndex}S>f.e.c&&(f.e.c=S)}),c["!ref"]=It(f),c}function n(a,i){return ei(t(a,i),i)}function r(a){for(var i=["{\\rtf1\\ansi"],l=gn(a["!ref"]),c,d=Array.isArray(a),f=l.s.r;f<=l.e.r;++f){i.push("\\trowd\\trautofit1");for(var g=l.s.c;g<=l.e.c;++g)i.push("\\cellx"+(g+1));for(i.push("\\pard\\intbl"),g=l.s.c;g<=l.e.c;++g){var y=ot({r:f,c:g});c=d?(a[f]||[])[g]:a[y],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(us(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}}();function xU(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Yc(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}function vU(t){var e=t[0]/255,n=t[1]/255,r=t[2]/255,a=Math.max(e,n,r),i=Math.min(e,n,r),l=a-i;if(l===0)return[0,0,e];var c=0,d=0,f=a+i;switch(d=l/(f>1?2-f:f),a){case e:c=((n-r)/l+6)%6;break;case n:c=(r-e)/l+2;break;case r:c=(e-n)/l+4;break}return[c/6,d,f/2]}function yU(t){var e=t[0],n=t[1],r=t[2],a=n*2*(r<.5?r:1-r),i=r-a/2,l=[i,i,i],c=6*e,d;if(n!==0)switch(c|0){case 0:case 6:d=a*c,l[0]+=a,l[1]+=d;break;case 1:d=a*(2-c),l[0]+=d,l[1]+=a;break;case 2:d=a*(c-2),l[1]+=a,l[2]+=d;break;case 3:d=a*(4-c),l[1]+=d,l[2]+=a;break;case 4:d=a*(c-4),l[2]+=a,l[0]+=d;break;case 5:d=a*(6-c),l[2]+=d,l[0]+=a;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function rd(t,e){if(e===0)return t;var n=vU(xU(t));return e<0?n[2]=n[2]*(1+e):n[2]=1-(1-n[2])*(1-e),Yc(yU(n))}var sE=6,_U=15,TU=1,hr=sE;function ad(t){return Math.floor((t+Math.round(128/hr)/256)*hr)}function sd(t){return Math.floor((t-5)/hr*100+.5)/100}function km(t){return Math.round((t*hr+5)/hr*256)/256}function Gh(t){return km(sd(ad(t)))}function _p(t){var e=Math.abs(t-Gh(t)),n=hr;if(e>.005)for(hr=TU;hr<_U;++hr)Math.abs(t-Gh(t))<=e&&(e=Math.abs(t-Gh(t)),n=hr);hr=n}function al(t){t.width?(t.wpx=ad(t.width),t.wch=sd(t.wpx),t.MDW=hr):t.wpx?(t.wch=sd(t.wpx),t.width=km(t.wch),t.MDW=hr):typeof t.wch=="number"&&(t.width=km(t.wch),t.wpx=ad(t.width),t.MDW=hr),t.customWidth&&delete t.customWidth}var wU=96,iE=wU;function oE(t){return t*96/iE}function Wc(t){return t*iE/96}var EU={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function SU(t,e,n,r){e.Borders=[];var a={},i=!1;(t[0].match(or)||[]).forEach(function(l){var c=rt(l);switch(ja(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=sn(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=sn(c.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function CU(t,e,n,r){e.Fills=[];var a={},i=!1;(t[0].match(or)||[]).forEach(function(l){var c=rt(l);switch(ja(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function bU(t,e,n,r){e.Fonts=[];var a={},i=!1;(t[0].match(or)||[]).forEach(function(l){var c=rt(l);switch(ja(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=en(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?sn(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?sn(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?sn(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?sn(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?sn(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?sn(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?sn(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=np[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=sn(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var d=bi[a.color.index];a.color.index==81&&(d=bi[1]),d||(d=bi[1]),a.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=rd(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function AU(t,e,n){e.NumberFmt=[];for(var r=Ua(ut),a=0;a<r.length;++a)e.NumberFmt[r[a]]=ut[r[a]];var i=t[0].match(or);if(i)for(a=0;a<i.length;++a){var l=rt(i[a]);switch(ja(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Ft(en(l.formatCode)),d=parseInt(l.numFmtId,10);if(e.NumberFmt[d]=c,d>0){if(d>392){for(d=392;d>60&&e.NumberFmt[d]!=null;--d);e.NumberFmt[d]=c}Ci(c,d)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var Mf=["numFmtId","fillId","fontId","borderId","xfId"],If=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function kU(t,e,n){e.CellXf=[];var r,a=!1;(t[0].match(or)||[]).forEach(function(i){var l=rt(i),c=0;switch(ja(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<Mf.length;++c)r[Mf[c]]&&(r[Mf[c]]=parseInt(r[Mf[c]],10));for(c=0;c<If.length;++c)r[If[c]]&&(r[If[c]]=sn(r[If[c]]));if(e.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[r.numFmtId]==e.NumberFmt[c]){r.numFmtId=c;break}}e.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};l.vertical&&(d.vertical=l.vertical),l.horizontal&&(d.horizontal=l.horizontal),l.textRotation!=null&&(d.textRotation=l.textRotation),l.indent&&(d.indent=l.indent),l.wrapText&&(d.wrapText=sn(l.wrapText)),r.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var NU=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,d,f){var g={};if(!c)return g;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var y;return(y=c.match(e))&&AU(y,g,f),(y=c.match(a))&&bU(y,g,d,f),(y=c.match(r))&&CU(y,g,d,f),(y=c.match(i))&&SU(y,g,d,f),(y=c.match(n))&&kU(y,g,f),g}}();function RU(t,e){var n=t.read_shift(2),r=sr(t);return[n,r]}function DU(t,e,n){var r={};r.sz=t.read_shift(2)/20;var a=VO(t);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var i=t.read_shift(2);switch(i===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(r.underline=l);var c=t.read_shift(1);c>0&&(r.family=c);var d=t.read_shift(1);switch(d>0&&(r.charset=d),t.l++,r.color=jO(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=sr(t),r}var MU=ir;function IU(t,e){var n=t.l+e,r=t.read_shift(2),a=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:a}}var FU=ir;function OU(t,e,n){var r={};r.NumberFmt=[];for(var a in ut)r.NumberFmt[a]=ut[a];r.CellXf=[],r.Fonts=[];var i=[],l=!1;return hs(t,function(d,f,g){switch(g){case 44:r.NumberFmt[d[0]]=d[1],Ci(d[1],d[0]);break;case 43:r.Fonts.push(d),d.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(d.color.rgb=rd(e.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&r.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(g),l=!0;break;case 38:i.pop(),l=!1;break;default:if(f.T>0)i.push(g);else if(f.T<0)i.pop();else if(!l||n.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),r}var LU=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function PU(t,e,n){e.themeElements.clrScheme=[];var r={};(t[0].match(or)||[]).forEach(function(a){var i=rt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=i.val;break;case"<a:sysClr":r.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[LU.indexOf(i[0])]=r,r={}):r.name=i[0].slice(3,i[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function UU(){}function BU(){}var jU=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,VU=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,HU=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function GU(t,e,n){e.themeElements={};var r;[["clrScheme",jU,PU],["fontScheme",VU,UU],["fmtScheme",HU,BU]].forEach(function(a){if(!(r=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,e,n)})}var $U=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function lE(t,e){(!t||t.length===0)&&(t=zU());var n,r={};if(!(n=t.match($U)))throw new Error("themeElements not found in theme");return GU(n[0],r,e),r.raw=t,r}function zU(t,e){var n=[yw];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function qU(t,e,n){var r=t.l+e,a=t.read_shift(4);if(a!==124226){if(!n.cellStyles){t.l=r;return}var i=t.slice(t.l);t.l=r;var l;try{l=vw(i,{type:"array"})}catch{return}var c=Br(l,"theme/theme/theme1.xml",!0);if(c)return lE(c,n)}}function YU(t){return t.read_shift(4)}function WU(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=JU(t,4);break;case 2:e.xclrValue=Ww(t);break;case 3:e.xclrValue=YU(t);break;case 4:t.l+=4;break}return t.l+=8,e}function JU(t,e){return ir(t,e)}function KU(t,e){return ir(t,e)}function XU(t){var e=t.read_shift(2),n=t.read_shift(2)-4,r=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=WU(t);break;case 6:r[1]=KU(t,n);break;case 14:case 15:r[1]=t.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+n)}return r}function ZU(t,e){var n=t.l+e;t.l+=2;var r=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),i=[];a-- >0;)i.push(XU(t,n-t.l));return{ixfe:r,ext:i}}function QU(t,e){e.forEach(function(n){n[0]})}function e7(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:sr(t)}}function t7(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function n7(t){return t.l+=4,t.read_shift(4)!=0}function r7(t,e,n){var r={Types:[],Cell:[],Value:[]},a=n||{},i=[],l=!1,c=2;return hs(t,function(d,f,g){switch(g){case 335:r.Types.push({name:d.name});break;case 51:d.forEach(function(y){c==1?r.Cell.push({type:r.Types[y[0]-1].name,index:y[1]}):c==0&&r.Value.push({type:r.Types[y[0]-1].name,index:y[1]})});break;case 337:c=d?1:0;break;case 338:c=2;break;case 35:i.push(g),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!f.T){if(!l||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),r}function a7(t,e,n){var r={Types:[],Cell:[],Value:[]};if(!t)return r;var a=!1,i=2,l;return t.replace(or,function(c){var d=rt(c);switch(ja(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<r.Types.length;++f)r.Types[f].name==d.name&&(l=r.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?r.Cell.push({type:r.Types[d.t-1].name,index:+d.v}):i==0&&r.Value.push({type:r.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+d.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return c}),r}function s7(t){var e=[];if(!t)return e;var n=1;return(t.match(or)||[]).forEach(function(r){var a=rt(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?n=a.i:a.i=n,e.push(a);break}}),e}function i7(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=ot(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function o7(t,e,n){var r=[];return hs(t,function(i,l,c){switch(c){case 63:r.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function l7(t,e,n,r){if(!t)return t;var a=r||{},i=!1;hs(t,function(c,d,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!d.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function c7(t,e){if(!t)return"??";var n=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][n].Target}function xT(t,e,n,r){var a=Array.isArray(t),i;e.forEach(function(l){var c=mr(l.ref);if(a?(t[c.r]||(t[c.r]=[]),i=t[c.r][c.c]):i=t[l.ref],!i){i={t:"z"},a?t[c.r][c.c]=i:t[l.ref]=i;var d=gn(t["!ref"]||"BDWGO1000001:A1");d.s.r>c.r&&(d.s.r=c.r),d.e.r<c.r&&(d.e.r=c.r),d.s.c>c.c&&(d.s.c=c.c),d.e.c<c.c&&(d.e.c=c.c);var f=It(d);f!==t["!ref"]&&(t["!ref"]=f)}i.c||(i.c=[]);var g={a:l.author,t:l.t,r:l.r,T:n};l.h&&(g.h=l.h);for(var y=i.c.length-1;y>=0;--y){if(!n&&i.c[y].T)return;n&&!i.c[y].T&&i.c.splice(y,1)}if(n&&r){for(y=0;y<r.length;++y)if(g.a==r[y].id){g.a=r[y].name||g.a;break}}i.c.push(g)})}function u7(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&n.push(c[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var d=rt(c[0]),f={author:d.authorId&&n[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},g=mr(d.ref);if(!(e.sheetRows&&e.sheetRows<=g.r)){var y=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!y&&!!y[1]&&yp(y[1])||{r:"",t:"",h:""};f.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),f.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(f.h=_.h),r.push(f)}}}}),r}function f7(t,e){var n=[],r=!1,a={},i=0;return t.replace(or,function(c,d){var f=rt(c);switch(ja(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&n.push(a);break;case"<text>":case"<text":i=d+c.length;break;case"</text>":a.t=t.slice(i,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),n}function d7(t,e){var n=[],r=!1;return t.replace(or,function(i){var l=rt(i);switch(ja(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),n}function h7(t){var e={};e.iauthor=t.read_shift(4);var n=Hi(t);return e.rfx=n.s,e.ref=ot(n.s),t.l+=16,e}var m7=sr;function p7(t,e){var n=[],r=[],a={},i=!1;return hs(t,function(c,d,f){switch(f){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}var g7="application/vnd.ms-office.vbaProject";function x7(t){var e=Dt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Dt.utils.cfb_add(e,a,t.FileIndex[r].content)}}),Dt.write(e)}function v7(){return{"!type":"dialog"}}function y7(){return{"!type":"dialog"}}function _7(){return{"!type":"macro"}}function T7(){return{"!type":"macro"}}var Yo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,a,i,l){var c=!1,d=!1;i.length==0?d=!0:i.charAt(0)=="["&&(d=!0,i=i.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,g=l.length>0?parseInt(l,10)|0:0;return c?g+=e.c:--g,d?f+=e.r:--f,a+(c?"":"$")+Fn(g)+(d?"":"$")+Kn(f)}return function(a,i){return e=i,a.replace(t,n)}}(),cE=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,w7=function(){return function(e,n){return e.replace(cE,function(r,a,i,l,c,d){var f=hp(l)-(i?0:n.c),g=dp(d)-(c?0:n.r),y=g==0?"":c?g+1:"["+g+"]",_=f==0?"":i?f+1:"["+f+"]";return a+"R"+y+"C"+_})}}();function uE(t,e){return t.replace(cE,function(n,r,a,i,l,c){return r+(a=="$"?a+i:Fn(hp(i)+e.c))+(l=="$"?l+c:Kn(dp(c)+e.r))})}function E7(t,e,n){var r=dl(e),a=r.s,i=mr(n),l={r:i.r-a.r,c:i.c-a.c};return uE(t,l)}function S7(t){return t.length!=1}function vT(t){return t.replace(/_xlfn\./g,"")}function Cn(t){t.l+=1}function Zs(t,e){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function fE(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return dE(t);n.biff==12&&(r=4)}var a=t.read_shift(r),i=t.read_shift(r),l=Zs(t),c=Zs(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function dE(t){var e=Zs(t),n=Zs(t),r=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function C7(t,e,n){if(n.biff<8)return dE(t);var r=t.read_shift(n.biff==12?4:2),a=t.read_shift(n.biff==12?4:2),i=Zs(t),l=Zs(t);return{s:{r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function hE(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return b7(t);var r=t.read_shift(n&&n.biff==12?4:2),a=Zs(t);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function b7(t){var e=Zs(t),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function A7(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function k7(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return N7(t);var a=t.read_shift(r>=12?4:2),i=t.read_shift(2),l=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:l,rRel:c}}function N7(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),a==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:a,rRel:r}}function R7(t,e,n){var r=(t[t.l++]&96)>>5,a=fE(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function D7(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(n)switch(n.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var l=fE(t,i,n);return[r,a,l]}function M7(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function I7(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(n)switch(n.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[r,a]}function F7(t,e,n){var r=(t[t.l++]&96)>>5,a=C7(t,e-1,n);return[r,a]}function O7(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function yT(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function L7(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),a=[],i=0;i<=r;++i)a.push(t.read_shift(n&&n.biff==2?1:2));return a}function P7(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function U7(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function B7(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function j7(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function mE(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function V7(t){return t.read_shift(2),mE(t)}function H7(t){return t.read_shift(2),mE(t)}function G7(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=hE(t,0,n);return[r,a]}function $7(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=k7(t,0,n);return[r,a]}function z7(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var i=hE(t,0,n);return[r,a,i]}function q7(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(n&&n.biff<=3?1:2);return[Y9[a],xE[a],r]}function Y7(t,e,n){var r=t[t.l++],a=t.read_shift(1),i=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:W7(t);return[a,(i[0]===0?xE:q9)[i[1]]]}function W7(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function J7(t,e,n){t.l+=n&&n.biff==2?3:4}function K7(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function X7(t){return t.l++,Gi[t.read_shift(1)]}function Z7(t){return t.l++,t.read_shift(2)}function Q7(t){return t.l++,t.read_shift(1)!==0}function e9(t){return t.l++,nr(t)}function t9(t,e,n){return t.l++,au(t,e-1,n)}function n9(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=wn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=Gi[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=nr(t);break;case 2:n[1]=$i(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function r9(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),a=[],i=0;i!=r;++i)a.push((n.biff==12?Hi:vd)(t));return a}function a9(t,e,n){var r=0,a=0;n.biff==12?(r=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var i=0,l=[];i!=r&&(l[i]=[]);++i)for(var c=0;c!=a;++c)l[i][c]=n9(t,n.biff);return l}function s9(t,e,n){var r=t.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=t.read_shift(a);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,i]}function i9(t,e,n){if(n.biff==5)return o9(t);var r=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[r,a,i]}function o9(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function l9(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function c9(t,e,n){var r=t.read_shift(1)>>>5&3,a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function u9(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function f9(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[r,a]}var d9=ir,h9=ir,m9=ir;function iu(t,e,n){return t.l+=2,[A7(t)]}function Tp(t){return t.l+=6,[]}var p9=iu,g9=Tp,x9=Tp,v9=iu;function pE(t){return t.l+=2,[An(t),t.read_shift(2)&1]}var y9=iu,_9=pE,T9=Tp,w9=iu,E9=iu,S9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function C9(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),l=S9[n>>2&31];return{ixti:e,coltype:n&3,rt:l,idx:r,c:a,C:i}}function b9(t){return t.l+=2,[t.read_shift(4)]}function A9(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function k9(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function N9(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function R9(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function D9(t){return t.l+=4,[0,0]}var _T={1:{n:"PtgExp",f:K7},2:{n:"PtgTbl",f:m9},3:{n:"PtgAdd",f:Cn},4:{n:"PtgSub",f:Cn},5:{n:"PtgMul",f:Cn},6:{n:"PtgDiv",f:Cn},7:{n:"PtgPower",f:Cn},8:{n:"PtgConcat",f:Cn},9:{n:"PtgLt",f:Cn},10:{n:"PtgLe",f:Cn},11:{n:"PtgEq",f:Cn},12:{n:"PtgGe",f:Cn},13:{n:"PtgGt",f:Cn},14:{n:"PtgNe",f:Cn},15:{n:"PtgIsect",f:Cn},16:{n:"PtgUnion",f:Cn},17:{n:"PtgRange",f:Cn},18:{n:"PtgUplus",f:Cn},19:{n:"PtgUminus",f:Cn},20:{n:"PtgPercent",f:Cn},21:{n:"PtgParen",f:Cn},22:{n:"PtgMissArg",f:Cn},23:{n:"PtgStr",f:t9},26:{n:"PtgSheet",f:A9},27:{n:"PtgEndSheet",f:k9},28:{n:"PtgErr",f:X7},29:{n:"PtgBool",f:Q7},30:{n:"PtgInt",f:Z7},31:{n:"PtgNum",f:e9},32:{n:"PtgArray",f:O7},33:{n:"PtgFunc",f:q7},34:{n:"PtgFuncVar",f:Y7},35:{n:"PtgName",f:s9},36:{n:"PtgRef",f:G7},37:{n:"PtgArea",f:R7},38:{n:"PtgMemArea",f:l9},39:{n:"PtgMemErr",f:d9},40:{n:"PtgMemNoMem",f:h9},41:{n:"PtgMemFunc",f:c9},42:{n:"PtgRefErr",f:u9},43:{n:"PtgAreaErr",f:M7},44:{n:"PtgRefN",f:$7},45:{n:"PtgAreaN",f:F7},46:{n:"PtgMemAreaN",f:N9},47:{n:"PtgMemNoMemN",f:R9},57:{n:"PtgNameX",f:i9},58:{n:"PtgRef3d",f:z7},59:{n:"PtgArea3d",f:D7},60:{n:"PtgRefErr3d",f:f9},61:{n:"PtgAreaErr3d",f:I7},255:{}},M9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},I9={1:{n:"PtgElfLel",f:pE},2:{n:"PtgElfRw",f:w9},3:{n:"PtgElfCol",f:p9},6:{n:"PtgElfRwV",f:E9},7:{n:"PtgElfColV",f:v9},10:{n:"PtgElfRadical",f:y9},11:{n:"PtgElfRadicalS",f:T9},13:{n:"PtgElfColS",f:g9},15:{n:"PtgElfColSV",f:x9},16:{n:"PtgElfRadicalLel",f:_9},25:{n:"PtgList",f:C9},29:{n:"PtgSxName",f:b9},255:{}},F9={0:{n:"PtgAttrNoop",f:D9},1:{n:"PtgAttrSemi",f:j7},2:{n:"PtgAttrIf",f:U7},4:{n:"PtgAttrChoose",f:L7},8:{n:"PtgAttrGoto",f:P7},16:{n:"PtgAttrSum",f:J7},32:{n:"PtgAttrBaxcel",f:yT},33:{n:"PtgAttrBaxcel",f:yT},64:{n:"PtgAttrSpace",f:V7},65:{n:"PtgAttrSpaceSemi",f:H7},128:{n:"PtgAttrIfError",f:B7},255:{}};function ou(t,e,n,r){if(r.biff<8)return ir(t,e);for(var a=t.l+e,i=[],l=0;l!==n.length;++l)switch(n[l][0]){case"PtgArray":n[l][1]=a9(t,0,r),i.push(n[l][1]);break;case"PtgMemArea":n[l][2]=r9(t,n[l][1],r),i.push(n[l][2]);break;case"PtgExp":r&&r.biff==12&&(n[l][1][1]=t.read_shift(4),i.push(n[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[l][0]}return e=a-t.l,e!==0&&i.push(ir(t,e)),i}function lu(t,e,n){for(var r=t.l+e,a,i,l=[];r!=t.l;)e=r-t.l,i=t[t.l],a=_T[i]||_T[M9[i]],(i===24||i===25)&&(a=(i===24?I9:F9)[t[t.l+1]]),!a||!a.f?ir(t,e):l.push([a.n,a.f(t,e,n)]);return l}function O9(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],a=[],i=0;i<r.length;++i){var l=r[i];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var L9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function P9(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function gE(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(t[r[0]][0]){case 357:return a=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[r[0]][0][3]?(a=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function TT(t,e,n){var r=gE(t,e,n);return r=="#REF"?r:P9(r,n)}function tr(t,e,n,r,a){var i=a&&a.biff||8,l={s:{c:0,r:0}},c=[],d,f,g,y=0,_=0,w,E="";if(!t[0]||!t[0][0])return"";for(var S=-1,C="",R=0,k=t[0].length;R<k;++R){var b=t[0][R];switch(b[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),f=c.pop(),S>=0){switch(t[0][S][1][0]){case 0:C=pn(" ",t[0][S][1][1]);break;case 1:C=pn("\r",t[0][S][1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}f=f+C,S=-1}c.push(f+L9[b[0]]+d);break;case"PtgIsect":d=c.pop(),f=c.pop(),c.push(f+" "+d);break;case"PtgUnion":d=c.pop(),f=c.pop(),c.push(f+","+d);break;case"PtgRange":d=c.pop(),f=c.pop(),c.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Ac(b[1][1],l,a),c.push(kc(g,i));break;case"PtgRefN":g=n?Ac(b[1][1],n,a):b[1][1],c.push(kc(g,i));break;case"PtgRef3d":y=b[1][1],g=Ac(b[1][2],l,a),E=TT(r,y,a),c.push(E+"!"+kc(g,i));break;case"PtgFunc":case"PtgFuncVar":var O=b[1][0],U=b[1][1];O||(O=0),O&=127;var j=O==0?[]:c.slice(-O);c.length-=O,U==="User"&&(U=j.shift()),c.push(U+"("+j.join(",")+")");break;case"PtgBool":c.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(b[1]);break;case"PtgNum":c.push(String(b[1]));break;case"PtgStr":c.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(b[1]);break;case"PtgAreaN":w=tT(b[1][1],n?{s:n}:l,a),c.push(Vh(w,a));break;case"PtgArea":w=tT(b[1][1],l,a),c.push(Vh(w,a));break;case"PtgArea3d":y=b[1][1],w=b[1][2],E=TT(r,y,a),c.push(E+"!"+Vh(w,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=b[1][2];var F=(r.names||[])[_-1]||(r[0]||[])[_],K=F?F.Name:"SH33TJSNAME"+String(_);K&&K.slice(0,6)=="_xlfn."&&!a.xlfn&&(K=K.slice(6)),c.push(K);break;case"PtgNameX":var P=b[1][1];_=b[1][2];var ne;if(a.biff<=5)P<0&&(P=-P),r[P]&&(ne=r[P][_]);else{var Q="";if(((r[P]||[])[0]||[])[0]==14849||(((r[P]||[])[0]||[])[0]==1025?r[P][_]&&r[P][_].itab>0&&(Q=r.SheetNames[r[P][_].itab-1]+"!"):Q=r.SheetNames[_-1]+"!"),r[P]&&r[P][_])Q+=r[P][_].Name;else if(r[0]&&r[0][_])Q+=r[0][_].Name;else{var te=(gE(r,P,a)||"").split(";;");te[_-1]?Q=te[_-1]:Q+="SH33TJSERRX"}c.push(Q);break}ne||(ne={Name:"SH33TJSERRY"}),c.push(ne.Name);break;case"PtgParen":var _e="(",Le=")";if(S>=0){switch(C="",t[0][S][1][0]){case 2:_e=pn(" ",t[0][S][1][1])+_e;break;case 3:_e=pn("\r",t[0][S][1][1])+_e;break;case 4:Le=pn(" ",t[0][S][1][1])+Le;break;case 5:Le=pn("\r",t[0][S][1][1])+Le;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}S=-1}c.push(_e+c.pop()+Le);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":g={c:b[1][1],r:b[1][0]};var Te={c:n.c,r:n.r};if(r.sharedf[ot(g)]){var ae=r.sharedf[ot(g)];c.push(tr(ae,l,Te,r,a))}else{var ue=!1;for(d=0;d!=r.arrayf.length;++d)if(f=r.arrayf[d],!(g.c<f[0].s.c||g.c>f[0].e.c)&&!(g.r<f[0].s.r||g.r>f[0].e.r)){c.push(tr(f[1],l,Te,r,a)),ue=!0;break}ue||c.push(b[1])}break;case"PtgArray":c.push("{"+O9(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=R;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&re.indexOf(t[0][R][0])==-1){b=t[0][S];var W=!0;switch(b[1][0]){case 4:W=!1;case 0:C=pn(" ",b[1][1]);break;case 5:W=!1;case 1:C=pn("\r",b[1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}c.push((W?C:"")+c.pop()+(W?"":C)),S=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function U9(t,e,n){var r=t.l+e,a=n.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],ir(t,e-2)];var c=lu(t,l,n);return e!==l+a&&(i=ou(t,e-l-a,c,n)),t.l=r,[c,i]}function B9(t,e,n){var r=t.l+e,a=n.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],ir(t,e-2)];var c=lu(t,l,n);return e!==l+a&&(i=ou(t,e-l-a,c,n)),t.l=r,[c,i]}function j9(t,e,n,r){var a=t.l+e,i=lu(t,r,n),l;return a!==t.l&&(l=ou(t,a-t.l,i,n)),[i,l]}function V9(t,e,n){var r=t.l+e,a,i=t.read_shift(2),l=lu(t,i,n);return i==65535?[[],ir(t,e-2)]:(e!==i+2&&(a=ou(t,r-i-2,l,n)),[l,a])}function H9(t){var e;if(as(t,t.l+6)!==65535)return[nr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function $h(t,e,n){var r=t.l+e,a=Va(t);n.biff==2&&++t.l;var i=H9(t),l=t.read_shift(1);n.biff!=2&&(t.read_shift(1),n.biff>=5&&t.read_shift(4));var c=B9(t,r-t.l,n);return{cell:a,val:i[0],formula:c,shared:l>>3&1,tt:i[1]}}function yd(t,e,n){var r=t.read_shift(4),a=lu(t,r,n),i=t.read_shift(4),l=i>0?ou(t,i,a,n):null;return[a,l]}var G9=yd,_d=yd,$9=yd,z9=yd,q9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},xE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Y9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function wT(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,n){return n.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function zh(t){var e=t.split(":"),n=e[0].split(".")[0];return[n,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Mc={},Wo={};function Ic(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(n=[1,1,1,1,.5,.5]),t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function vE(t,e,n,r,a,i){try{r.cellNF&&(t.z=ut[e])}catch(c){if(r.WTF)throw c}if(!(t.t==="z"&&!r.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Hn(t.v)),(!r||r.cellText!==!1)&&t.t!=="z")try{if(ut[e]==null&&Ci(W8[e]||"General",e),t.t==="e")t.w=t.w||Gi[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Gc(t.v);else if(t.t==="d"){var l=xr(t.v);(l|0)===l?t.w=l.toString(10):t.w=Gc(l)}else{if(t.v===void 0)return"";t.w=Ii(t.v,Wo)}else t.t==="d"?t.w=aa(e,xr(t.v),Wo):t.w=aa(e,t.v,Wo)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&n!=null)try{t.s=i.Fills[n],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=rd(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),r.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=rd(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),r.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&i.Fills)throw c}}}function W9(t,e){var n=gn(e);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(t["!ref"]=It(n))}var J9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,K9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,X9=/<(?:\w:)?hyperlink [^>]*>/mg,Z9=/"(\w*:\w*)"/,Q9=/<(?:\w:)?col\b[^>]*[\/]?>/g,eB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,tB=/<(?:\w:)?pageMargins[^>]*\/>/g,yE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,nB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,rB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function aB(t,e,n,r,a,i,l){if(!t)return t;r||(r={"!id":{}});var c=e.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",g="",y=t.match(K9);y?(f=t.slice(0,y.index),g=t.slice(y.index+y[0].length)):f=g=t;var _=f.match(yE);_?wp(_[0],c,a,n):(_=f.match(nB))&&sB(_[0],_[1]||"",c,a,n);var w=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(w>0){var E=f.slice(w,w+50).match(Z9);E&&W9(c,E[1])}var S=f.match(rB);S&&S[1]&&fB(S[1],a);var C=[];if(e.cellStyles){var R=f.match(Q9);R&&lB(C,R)}y&&dB(y[1],c,e,d,i,l);var k=g.match(eB);k&&(c["!autofilter"]=cB(k[0]));var b=[],O=g.match(J9);if(O)for(w=0;w!=O.length;++w)b[w]=gn(O[w].slice(O[w].indexOf('"')+1));var U=g.match(X9);U&&iB(c,U,r);var j=g.match(tB);if(j&&(c["!margins"]=oB(rt(j[0]))),!c["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(c["!ref"]=It(d)),e.sheetRows>0&&c["!ref"]){var F=gn(c["!ref"]);e.sheetRows<=+F.e.r&&(F.e.r=e.sheetRows-1,F.e.r>d.e.r&&(F.e.r=d.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>d.e.c&&(F.e.c=d.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),c["!fullref"]=c["!ref"],c["!ref"]=It(F))}return C.length>0&&(c["!cols"]=C),b.length>0&&(c["!merges"]=b),c}function wp(t,e,n,r){var a=rt(t);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=Ft(en(a.codeName)))}function sB(t,e,n,r,a){wp(t.slice(0,t.indexOf(">")),n,r,a)}function iB(t,e,n){for(var r=Array.isArray(t),a=0;a!=e.length;++a){var i=rt(en(e[a]),!0);if(!i.ref)return;var l=((n||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Ft(i.location))):(i.Target="#"+Ft(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=gn(i.ref),d=c.s.r;d<=c.e.r;++d)for(var f=c.s.c;f<=c.e.c;++f){var g=ot({c:f,r:d});r?(t[d]||(t[d]=[]),t[d][f]||(t[d][f]={t:"z",v:void 0}),t[d][f].l=i):(t[g]||(t[g]={t:"z",v:void 0}),t[g].l=i)}}}function oB(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(n){t[n]&&(e[n]=parseFloat(t[n]))}),e}function lB(t,e){for(var n=!1,r=0;r!=e.length;++r){var a=rt(e[r],!0);a.hidden&&(a.hidden=sn(a.hidden));var i=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,_p(a.width)),al(a);i<=l;)t[i++]=Jn(a)}}function cB(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var uB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function fB(t,e){e.Views||(e.Views=[{}]),(t.match(uB)||[]).forEach(function(n,r){var a=rt(n);e.Views[r]||(e.Views[r]={}),+a.zoomScale&&(e.Views[r].zoom=+a.zoomScale),sn(a.rightToLeft)&&(e.Views[r].RTL=!0)})}var dB=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=$c("v"),l=$c("f");return function(d,f,g,y,_,w){for(var E=0,S="",C=[],R=[],k=0,b=0,O=0,U="",j,F,K=0,P=0,ne,Q,te=0,_e=0,Le=Array.isArray(w.CellXf),Te,ae=[],ue=[],re=Array.isArray(f),W=[],N={},Z=!1,M=!!g.sheetStubs,V=d.split(e),Y=0,z=V.length;Y!=z;++Y){S=V[Y].trim();var ie=S.length;if(ie!==0){var ye=0;e:for(E=0;E<ie;++E)switch(S[E]){case">":if(S[E-1]!="/"){++E;break e}if(g&&g.cellStyles){if(F=rt(S.slice(ye,E),!0),K=F.r!=null?parseInt(F.r,10):K+1,P=-1,g.sheetRows&&g.sheetRows<K)continue;N={},Z=!1,F.ht&&(Z=!0,N.hpt=parseFloat(F.ht),N.hpx=Wc(N.hpt)),F.hidden=="1"&&(Z=!0,N.hidden=!0),F.outlineLevel!=null&&(Z=!0,N.level=+F.outlineLevel),Z&&(W[K-1]=N)}break;case"<":ye=E;break}if(ye>=E)break;if(F=rt(S.slice(ye,E),!0),K=F.r!=null?parseInt(F.r,10):K+1,P=-1,!(g.sheetRows&&g.sheetRows<K)){y.s.r>K-1&&(y.s.r=K-1),y.e.r<K-1&&(y.e.r=K-1),g&&g.cellStyles&&(N={},Z=!1,F.ht&&(Z=!0,N.hpt=parseFloat(F.ht),N.hpx=Wc(N.hpt)),F.hidden=="1"&&(Z=!0,N.hidden=!0),F.outlineLevel!=null&&(Z=!0,N.level=+F.outlineLevel),Z&&(W[K-1]=N)),C=S.slice(E).split(t);for(var Ce=0;Ce!=C.length&&C[Ce].trim().charAt(0)=="<";++Ce);for(C=C.slice(Ce),E=0;E!=C.length;++E)if(S=C[E].trim(),S.length!==0){if(R=S.match(n),k=E,b=0,O=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,R!=null&&R.length===2){for(k=0,U=R[1],b=0;b!=U.length&&!((O=U.charCodeAt(b)-64)<1||O>26);++b)k=26*k+O;--k,P=k}else++P;for(b=0;b!=S.length&&S.charCodeAt(b)!==62;++b);if(++b,F=rt(S.slice(0,b),!0),F.r||(F.r=ot({r:K-1,c:P})),U=S.slice(b),j={t:""},(R=U.match(i))!=null&&R[1]!==""&&(j.v=Ft(R[1])),g.cellFormula){if((R=U.match(l))!=null&&R[1]!==""){if(j.f=Ft(en(R[1])).replace(/\r\n/g,`
`),g.xlfn||(j.f=vT(j.f)),R[0].indexOf('t="array"')>-1)j.F=(U.match(a)||[])[1],j.F.indexOf(":")>-1&&ae.push([gn(j.F),j.F]);else if(R[0].indexOf('t="shared"')>-1){Q=rt(R[0]);var Re=Ft(en(R[1]));g.xlfn||(Re=vT(Re)),ue[parseInt(Q.si,10)]=[Q,Re,F.r]}}else(R=U.match(/<f[^>]*\/>/))&&(Q=rt(R[0]),ue[Q.si]&&(j.f=E7(ue[Q.si][1],ue[Q.si][2],F.r)));var Ee=mr(F.r);for(b=0;b<ae.length;++b)Ee.r>=ae[b][0].s.r&&Ee.r<=ae[b][0].e.r&&Ee.c>=ae[b][0].s.c&&Ee.c<=ae[b][0].e.c&&(j.F=ae[b][1])}if(F.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(M)j.t="z";else continue;else j.t=F.t||"n";switch(y.s.c>P&&(y.s.c=P),y.e.c<P&&(y.e.c=P),j.t){case"n":if(j.v==""||j.v==null){if(!M)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!M)continue;j.t="z"}else ne=Mc[parseInt(j.v,10)],j.v=ne.t,j.r=ne.r,g.cellHTML&&(j.h=ne.h);break;case"str":j.t="s",j.v=j.v!=null?en(j.v):"",g.cellHTML&&(j.h=cp(j.v));break;case"inlineStr":R=U.match(r),j.t="s",R!=null&&(ne=yp(R[1]))?(j.v=ne.t,g.cellHTML&&(j.h=ne.h)):j.v="";break;case"b":j.v=sn(j.v);break;case"d":g.cellDates?j.v=Hn(j.v,1):(j.v=xr(Hn(j.v,1)),j.t="n");break;case"e":(!g||g.cellText!==!1)&&(j.w=j.v),j.v=jw[j.v];break}if(te=_e=0,Te=null,Le&&F.s!==void 0&&(Te=w.CellXf[F.s],Te!=null&&(Te.numFmtId!=null&&(te=Te.numFmtId),g.cellStyles&&Te.fillId!=null&&(_e=Te.fillId))),vE(j,te,_e,g,_,w),g.cellDates&&Le&&j.t=="n"&&fl(ut[te])&&(j.t="d",j.v=xd(j.v)),F.cm&&g.xlmeta){var Ke=(g.xlmeta.Cell||[])[+F.cm-1];Ke&&Ke.type=="XLDAPR"&&(j.D=!0)}if(re){var J=mr(F.r);f[J.r]||(f[J.r]=[]),f[J.r][J.c]=j}else f[F.r]=j}}}}W.length>0&&(f["!rows"]=W)}}();function hB(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=r,i&7&&(n.level=i&7),i&16&&(n.hidden=!0),i&32&&(n.hpt=a/20),n}var mB=Hi;function pB(){}function gB(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=UO(t),n}function xB(t){var e=ia(t);return[e]}function vB(t){var e=Vi(t);return[e]}function yB(t){var e=ia(t),n=t.read_shift(1);return[e,n,"b"]}function _B(t){var e=Vi(t),n=t.read_shift(1);return[e,n,"b"]}function TB(t){var e=ia(t),n=t.read_shift(1);return[e,n,"e"]}function wB(t){var e=Vi(t),n=t.read_shift(1);return[e,n,"e"]}function EB(t){var e=ia(t),n=t.read_shift(4);return[e,n,"s"]}function SB(t){var e=Vi(t),n=t.read_shift(4);return[e,n,"s"]}function CB(t){var e=ia(t),n=nr(t);return[e,n,"n"]}function _E(t){var e=Vi(t),n=nr(t);return[e,n,"n"]}function bB(t){var e=ia(t),n=gp(t);return[e,n,"n"]}function AB(t){var e=Vi(t),n=gp(t);return[e,n,"n"]}function kB(t){var e=ia(t),n=mp(t);return[e,n,"is"]}function NB(t){var e=ia(t),n=sr(t);return[e,n,"str"]}function RB(t){var e=Vi(t),n=sr(t);return[e,n,"str"]}function DB(t,e,n){var r=t.l+e,a=ia(t);a.r=n["!row"];var i=t.read_shift(1),l=[a,i,"b"];if(n.cellFormula){t.l+=2;var c=_d(t,r-t.l,n);l[3]=tr(c,null,a,n.supbooks,n)}else t.l=r;return l}function MB(t,e,n){var r=t.l+e,a=ia(t);a.r=n["!row"];var i=t.read_shift(1),l=[a,i,"e"];if(n.cellFormula){t.l+=2;var c=_d(t,r-t.l,n);l[3]=tr(c,null,a,n.supbooks,n)}else t.l=r;return l}function IB(t,e,n){var r=t.l+e,a=ia(t);a.r=n["!row"];var i=nr(t),l=[a,i,"n"];if(n.cellFormula){t.l+=2;var c=_d(t,r-t.l,n);l[3]=tr(c,null,a,n.supbooks,n)}else t.l=r;return l}function FB(t,e,n){var r=t.l+e,a=ia(t);a.r=n["!row"];var i=sr(t),l=[a,i,"str"];if(n.cellFormula){t.l+=2;var c=_d(t,r-t.l,n);l[3]=tr(c,null,a,n.supbooks,n)}else t.l=r;return l}var OB=Hi;function LB(t,e){var n=t.l+e,r=Hi(t),a=pp(t),i=sr(t),l=sr(t),c=sr(t);t.l=n;var d={rfx:r,relId:a,loc:i,display:c};return l&&(d.Tooltip=l),d}function PB(){}function UB(t,e,n){var r=t.l+e,a=Pw(t),i=t.read_shift(1),l=[a];if(l[2]=i,n.cellFormula){var c=G9(t,r-t.l,n);l[1]=c}else t.l=r;return l}function BB(t,e,n){var r=t.l+e,a=Hi(t),i=[a];if(n.cellFormula){var l=z9(t,r-t.l,n);i[1]=l,t.l=r}else t.l=r;return i}var jB=["left","right","top","bottom","header","footer"];function VB(t){var e={};return jB.forEach(function(n){e[n]=nr(t)}),e}function HB(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function GB(){}function $B(){}function zB(t,e,n,r,a,i,l){if(!t)return t;var c=e||{};r||(r={"!id":{}});var d=c.dense?[]:{},f,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,_=!1,w,E,S,C,R,k,b,O,U,j=[];c.biff=12,c["!row"]=0;var F=0,K=!1,P=[],ne={},Q=c.supbooks||a.supbooks||[[]];if(Q.sharedf=ne,Q.arrayf=P,Q.SheetNames=a.SheetNames||a.Sheets.map(function(re){return re.name}),!c.supbooks&&(c.supbooks=Q,a.Names))for(var te=0;te<a.Names.length;++te)Q[0][te+1]=a.Names[te];var _e=[],Le=[],Te=!1;id[16]={n:"BrtShortReal",f:_E};var ae;if(hs(t,function(W,N,Z){if(!_)switch(Z){case 148:f=W;break;case 0:w=W,c.sheetRows&&c.sheetRows<=w.r&&(_=!0),O=Kn(C=w.r),c["!row"]=w.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=Wc(W.hpt)),Le[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:W[2]},W[2]){case"n":E.v=W[1];break;case"s":b=Mc[W[1]],E.v=b.t,E.r=b.r;break;case"b":E.v=!!W[1];break;case"e":E.v=W[1],c.cellText!==!1&&(E.w=Gi[E.v]);break;case"str":E.t="s",E.v=W[1];break;case"is":E.t="s",E.v=W[1].t;break}if((S=l.CellXf[W[0].iStyleRef])&&vE(E,S.numFmtId,null,c,i,l),R=W[0].c==-1?R+1:W[0].c,c.dense?(d[C]||(d[C]=[]),d[C][R]=E):d[Fn(R)+O]=E,c.cellFormula){for(K=!1,F=0;F<P.length;++F){var M=P[F];w.r>=M[0].s.r&&w.r<=M[0].e.r&&R>=M[0].s.c&&R<=M[0].e.c&&(E.F=It(M[0]),K=!0)}!K&&W.length>3&&(E.f=W[3])}if(g.s.r>w.r&&(g.s.r=w.r),g.s.c>R&&(g.s.c=R),g.e.r<w.r&&(g.e.r=w.r),g.e.c<R&&(g.e.c=R),c.cellDates&&S&&E.t=="n"&&fl(ut[S.numFmtId])){var V=Si(E.v);V&&(E.t="d",E.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}ae&&(ae.type=="XLDAPR"&&(E.D=!0),ae=void 0);break;case 1:case 12:if(!c.sheetStubs||y)break;E={t:"z",v:void 0},R=W[0].c==-1?R+1:W[0].c,c.dense?(d[C]||(d[C]=[]),d[C][R]=E):d[Fn(R)+O]=E,g.s.r>w.r&&(g.s.r=w.r),g.s.c>R&&(g.s.c=R),g.e.r<w.r&&(g.e.r=w.r),g.e.c<R&&(g.e.c=R),ae&&(ae.type=="XLDAPR"&&(E.D=!0),ae=void 0);break;case 176:j.push(W);break;case 49:ae=((c.xlmeta||{}).Cell||[])[W-1];break;case 494:var Y=r["!id"][W.relId];for(Y?(W.Target=Y.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=Y):W.relId==""&&(W.Target="#"+W.loc),C=W.rfx.s.r;C<=W.rfx.e.r;++C)for(R=W.rfx.s.c;R<=W.rfx.e.c;++R)c.dense?(d[C]||(d[C]=[]),d[C][R]||(d[C][R]={t:"z",v:void 0}),d[C][R].l=W):(k=ot({c:R,r:C}),d[k]||(d[k]={t:"z",v:void 0}),d[k].l=W);break;case 426:if(!c.cellFormula)break;P.push(W),U=c.dense?d[C][R]:d[Fn(R)+O],U.f=tr(W[1],g,{r:w.r,c:R},Q,c),U.F=It(W[0]);break;case 427:if(!c.cellFormula)break;ne[ot(W[0].s)]=W[1],U=c.dense?d[C][R]:d[Fn(R)+O],U.f=tr(W[1],g,{r:w.r,c:R},Q,c);break;case 60:if(!c.cellStyles)break;for(;W.e>=W.s;)_e[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},Te||(Te=!0,_p(W.w/256)),al(_e[W.e+1]);break;case 161:d["!autofilter"]={ref:It(W)};break;case 476:d["!margins"]=W;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),W.name&&(a.Sheets[n].CodeName=W.name),(W.above||W.left)&&(d["!outline"]={above:W.above,left:W.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),W.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:y=!0;break;case 38:y=!1;break;default:if(!N.T){if(!y||c.WTF)throw new Error("Unexpected record 0x"+Z.toString(16))}}},c),delete c.supbooks,delete c["!row"],!d["!ref"]&&(g.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(d["!ref"]=It(f||g)),c.sheetRows&&d["!ref"]){var ue=gn(d["!ref"]);c.sheetRows<=+ue.e.r&&(ue.e.r=c.sheetRows-1,ue.e.r>g.e.r&&(ue.e.r=g.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>g.e.c&&(ue.e.c=g.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),d["!fullref"]=d["!ref"],d["!ref"]=It(ue))}return j.length>0&&(d["!merges"]=j),_e.length>0&&(d["!cols"]=_e),Le.length>0&&(d["!rows"]=Le),d}function qB(t){var e=[],n=t.match(/^<c:numCache>/),r;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=n?+l[2]:l[2])});var a=Ft((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){r=i.replace(/<.*?>/g,"")}),[e,a,r]}function YB(t,e,n,r,a,i){var l=i||{"!type":"chart"};if(!t)return i;var c=0,d=0,f="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(y){var _=qB(y);g.s.r=g.s.c=0,g.e.c=c,f=Fn(c),_[0].forEach(function(w,E){l[f+Kn(E)]={t:"n",v:w,z:_[1]},d=E}),g.e.r<d&&(g.e.r=d),++c}),c>0&&(l["!ref"]=It(g)),l}function WB(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,c=t.match(yE);return c&&wp(c[0],i,a,n),(l=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}function JB(t,e){t.l+=10;var n=sr(t);return{name:n}}function KB(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return hs(t,function(d,f,g){switch(g){case 550:i["!rel"]=d;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),d.name&&(a.Sheets[n].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},e),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}var TE=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],XB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ZB=[],QB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ET(t,e){for(var n=0;n!=t.length;++n)for(var r=t[n],a=0;a!=e.length;++a){var i=e[a];if(r[i[0]]==null)r[i[0]]=i[1];else switch(i[2]){case"bool":typeof r[i[0]]=="string"&&(r[i[0]]=sn(r[i[0]]));break;case"int":typeof r[i[0]]=="string"&&(r[i[0]]=parseInt(r[i[0]],10));break}}}function ST(t,e){for(var n=0;n!=e.length;++n){var r=e[n];if(t[r[0]]==null)t[r[0]]=r[1];else switch(r[2]){case"bool":typeof t[r[0]]=="string"&&(t[r[0]]=sn(t[r[0]]));break;case"int":typeof t[r[0]]=="string"&&(t[r[0]]=parseInt(t[r[0]],10));break}}}function wE(t){ST(t.WBProps,TE),ST(t.CalcPr,QB),ET(t.WBView,XB),ET(t.Sheets,ZB),Wo.date1904=sn(t.WBProps.date1904)}var ej="][*?/\\".split("");function tj(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return ej.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}var nj=/<\w+:workbook/;function rj(t,e){if(!t)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",i={},l=0;if(t.replace(or,function(d,f){var g=rt(d);switch(ja(g[0])){case"<?xml":break;case"<workbook":d.match(nj)&&(a="xmlns"+d.match(/<(\w+):/)[1]),n.xmlns=g[a];break;case"</workbook>":break;case"<fileVersion":delete g[0],n.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":TE.forEach(function(y){if(g[y[0]]!=null)switch(y[2]){case"bool":n.WBProps[y[0]]=sn(g[y[0]]);break;case"int":n.WBProps[y[0]]=parseInt(g[y[0]],10);break;default:n.WBProps[y[0]]=g[y[0]]}}),g.codeName&&(n.WBProps.CodeName=en(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],n.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Ft(en(g.name)),delete g[0],n.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":i={},i.Name=en(g.name),g.comment&&(i.Comment=g.comment),g.localSheetId&&(i.Sheet=+g.localSheetId),sn(g.hidden||"0")&&(i.Hidden=!0),l=f+d.length;break;case"</definedName>":i.Ref=Ft(en(t.slice(l,f))),n.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete g[0],n.CalcPr=g;break;case"<calcPr/>":delete g[0],n.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&e.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return d}),TO.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return wE(n),n}function aj(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=Cm(t),n.name=sr(t),n}function sj(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var a=e>8?sr(t):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function ij(t,e){var n={};return t.read_shift(4),n.ArchID=t.read_shift(4),t.l+=e-8,n}function oj(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),i=BO(t),l=$9(t,0,n),c=pp(t);t.l=r;var d={Name:i,Ptg:l};return a<268435455&&(d.Sheet=a),c&&(d.Comment=c),d}function lj(t,e){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;e||(e={}),e.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],id[16]={n:"BrtFRTArchID$",f:ij},hs(t,function(d,f,g){switch(g){case 156:l.SheetNames.push(d.name),n.Sheets.push(d);break;case 153:n.WBProps=d;break;case 39:d.Sheet!=null&&(e.SID=d.Sheet),d.Ref=tr(d.Ptg,null,null,l,e),delete e.SID,delete d.Ptg,i.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([g,d]):l[0]=[g,d],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(d),l.XTI=l.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(g),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(g),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||e.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},e),wE(n),n.Names=i,n.supbooks=l,n}function cj(t,e,n){return e.slice(-4)===".bin"?lj(t,n):rj(t,n)}function uj(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?zB(t,r,n,a,i,l,c):aB(t,r,n,a,i,l,c)}function fj(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?KB(t,r,n,a,i):WB(t,r,n,a,i)}function dj(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?_7():T7()}function hj(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?v7():y7()}function mj(t,e,n,r){return e.slice(-4)===".bin"?OU(t,n,r):NU(t,n,r)}function pj(t,e,n){return lE(t,n)}function gj(t,e,n){return e.slice(-4)===".bin"?XP(t,n):JP(t,n)}function xj(t,e,n){return e.slice(-4)===".bin"?p7(t,n):u7(t,n)}function vj(t,e,n){return e.slice(-4)===".bin"?o7(t):s7(t)}function yj(t,e,n,r){return n.slice(-4)===".bin"?l7(t,e,n,r):void 0}function _j(t,e,n){return e.slice(-4)===".bin"?r7(t,e,n):a7(t,e,n)}var EE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,SE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ha(t,e){var n=t.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var a=t.match(EE),i,l,c,d;if(a)for(d=0;d!=a.length;++d)i=a[d].match(SE),(l=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(l+1),r[c]=i[2].slice(1,i[2].length-1));return r}function Tj(t){var e=t.split(/\s+/),n={};if(e.length===1)return n;var r=t.match(EE),a,i,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(SE),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),n[l]=a[2].slice(1,a[2].length-1));return n}var Fc;function wj(t,e){var n=Fc[t]||Ft(t);return n==="General"?Ii(e):aa(n,e)}function Ej(t,e,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=sn(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Hn(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}t[Ft(e)]=a}function Sj(t,e,n){if(t.t!=="z"){if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||Gi[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Gc(t.v):t.w=Ii(t.v):t.w=wj(e||"General",t.v)}catch(i){if(n.WTF)throw i}try{var r=Fc[e]||e||"General";if(n.cellNF&&(t.z=r),n.cellDates&&t.t=="n"&&fl(r)){var a=Si(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(n.WTF)throw i}}}function Cj(t,e,n){if(n.cellStyles&&e.Interior){var r=e.Interior;r.Pattern&&(r.patternType=EU[r.Pattern]||r.Pattern)}t[e.ID]=e}function bj(t,e,n,r,a,i,l,c,d,f){var g="General",y=r.StyleID,_={};f=f||{};var w=[],E=0;for(y===void 0&&c&&(y=c.StyleID),y===void 0&&l&&(y=l.StyleID);i[y]!==void 0&&(i[y].nf&&(g=i[y].nf),i[y].Interior&&w.push(i[y].Interior),!!i[y].Parent);)y=i[y].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=sn(t);break;case"String":r.t="s",r.r=q_(Ft(t)),r.v=t.indexOf("<")>-1?Ft(e||t).replace(/<.*?>/g,""):r.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),r.v=(Hn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=Ft(t):r.v<60&&(r.v=r.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+t),r.t||(r.t="n");break;case"Error":r.t="e",r.v=jw[t],f.cellText!==!1&&(r.w=t);break;default:t==""&&e==""?r.t="z":(r.t="s",r.v=q_(e||t));break}if(Sj(r,g,f),f.cellFormula!==!1)if(r.Formula){var S=Ft(r.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),r.f=Yo(S,a),delete r.Formula,r.ArrayRange=="RC"?r.F=Yo("RC:RC",a):r.ArrayRange&&(r.F=Yo(r.ArrayRange,a),d.push([gn(r.F),r.F]))}else for(E=0;E<d.length;++E)a.r>=d[E][0].s.r&&a.r<=d[E][0].e.r&&a.c>=d[E][0].s.c&&a.c<=d[E][0].e.c&&(r.F=d[E][1]);f.cellStyles&&(w.forEach(function(C){!_.patternType&&C.patternType&&(_.patternType=C.patternType)}),r.s=_),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function Aj(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function qh(t,e){var n=e||{};dw();var r=gc(up(t));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=en(r));var a=r.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Jn(n);return l.type="string",qc.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(jt){a.indexOf("<"+jt)>=0&&(i=!0)}),i)return Lj(r,n);Fc={"General Number":"General","General Date":ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ut[15],"Short Date":ut[14],"Long Time":ut[19],"Medium Time":ut[18],"Short Time":ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ut[2],Standard:ut[4],Percent:ut[10],Scientific:ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,d=[],f,g={},y=[],_=n.dense?[]:{},w="",E={},S={},C=ha('<Data ss:Type="String">'),R=0,k=0,b=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},U={},j={},F="",K=0,P=[],ne={},Q={},te=0,_e=[],Le=[],Te={},ae=[],ue,re=!1,W=[],N=[],Z={},M=0,V=0,Y={Sheets:[],WBProps:{date1904:!1}},z={};zc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";c=zc.exec(r);)switch(c[3]=(ie=c[3]).toLowerCase()){case"data":if(ie=="data"){if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break}if(d[d.length-1][1])break;c[1]==="/"?bj(r.slice(R,c.index),F,C,d[d.length-1][0]=="comment"?Te:E,{c:k,r:b},U,ae[k],S,W,n):(F="",C=ha(c[0]),R=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Le.length>0&&(E.c=Le),(!n.sheetRows||n.sheetRows>b)&&E.v!==void 0&&(n.dense?(_[b]||(_[b]=[]),_[b][k]=E):_[Fn(k)+Kn(b)]=E),E.HRef&&(E.l={Target:Ft(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(M=k+(parseInt(E.MergeAcross,10)|0),V=b+(parseInt(E.MergeDown,10)|0),P.push({s:{c:k,r:b},e:{c:M,r:V}})),!n.sheetStubs)E.MergeAcross?k=M+1:++k;else if(E.MergeAcross||E.MergeDown){for(var ye=k;ye<=M;++ye)for(var Ce=b;Ce<=V;++Ce)(ye>k||Ce>b)&&(n.dense?(_[Ce]||(_[Ce]=[]),_[Ce][ye]={t:"z"}):_[Fn(ye)+Kn(Ce)]={t:"z"});k=M+1}else++k;else E=Tj(c[0]),E.Index&&(k=+E.Index-1),k<O.s.c&&(O.s.c=k),k>O.e.c&&(O.e.c=k),c[0].slice(-2)==="/>"&&++k,Le=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(b<O.s.r&&(O.s.r=b),b>O.e.r&&(O.e.r=b),c[0].slice(-2)==="/>"&&(S=ha(c[0]),S.Index&&(b=+S.Index-1)),k=0,++b):(S=ha(c[0]),S.Index&&(b=+S.Index-1),Z={},(S.AutoFitHeight=="0"||S.Height)&&(Z.hpx=parseInt(S.Height,10),Z.hpt=oE(Z.hpx),N[b]=Z),S.Hidden=="1"&&(Z.hidden=!0,N[b]=Z));break;case"worksheet":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));y.push(w),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(_["!ref"]=It(O),n.sheetRows&&n.sheetRows<=O.e.r&&(_["!fullref"]=_["!ref"],O.e.r=n.sheetRows-1,_["!ref"]=It(O))),P.length&&(_["!merges"]=P),ae.length>0&&(_["!cols"]=ae),N.length>0&&(_["!rows"]=N),g[w]=_}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=k=0,d.push([c[3],!1]),f=ha(c[0]),w=Ft(f.Name),_=n.dense?[]:{},P=[],W=[],N=[],z={name:w,Hidden:0},Y.Sheets.push(z);break;case"table":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;d.push([c[3],!1]),ae=[],re=!1}break;case"style":c[1]==="/"?Cj(U,j,n):j=ha(c[0]);break;case"numberformat":j.nf=Ft(ha(c[0]).Format||"General"),Fc[j.nf]&&(j.nf=Fc[j.nf]);for(var Re=0;Re!=392&&ut[Re]!=j.nf;++Re);if(Re==392){for(Re=57;Re!=392;++Re)if(ut[Re]==null){Ci(j.nf,Re);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(ue=ha(c[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!re&&ue.wpx>10){re=!0,hr=sE;for(var Ee=0;Ee<ae.length;++Ee)ae[Ee]&&al(ae[Ee])}re&&al(ue),ae[ue.Index-1||ae.length]=ue;for(var Ke=0;Ke<+ue.Span;++Ke)ae[ae.length]=Jn(ue);break;case"namedrange":if(c[1]==="/")break;Y.Names||(Y.Names=[]);var J=rt(c[0]),xt={Name:J.Name,Ref:Yo(J.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(xt.Sheet=Y.Sheets.length-1),Y.Names.push(xt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?F+=r.slice(K,c.index):K=c.index+c[0].length;break;case"interior":if(!n.cellStyles)break;j.Interior=ha(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?uL(ne,ie,r.slice(te,c.index)):te=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else d.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));Aj(Te),Le.push(Te)}else d.push([c[3],!1]),f=ha(c[0]),Te={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var et=ha(c[0]);_["!autofilter"]={ref:Yo(et.Range).replace(/\$/g,"")},d.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"null":break;default:if(d.length==0&&c[3]=="document"||d.length==0&&c[3]=="uof")return RT(r,n);var St=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:St=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:St=!1}break;case"excelworkbook":switch(c[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:St=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:St=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(te,c.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else te=c.index+c[0].length;break;case"header":_["!margins"]||Ic(_["!margins"]={},"xlml"),isNaN(+rt(c[0]).Margin)||(_["!margins"].header=+rt(c[0]).Margin);break;case"footer":_["!margins"]||Ic(_["!margins"]={},"xlml"),isNaN(+rt(c[0]).Margin)||(_["!margins"].footer=+rt(c[0]).Margin);break;case"pagemargins":var st=rt(c[0]);_["!margins"]||Ic(_["!margins"]={},"xlml"),isNaN(+st.Top)||(_["!margins"].top=+st.Top),isNaN(+st.Left)||(_["!margins"].left=+st.Left),isNaN(+st.Right)||(_["!margins"].right=+st.Right),isNaN(+st.Bottom)||(_["!margins"].bottom=+st.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:St=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:St=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:St=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:St=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:St=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:St=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:St=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:St=!1}break;case"smarttags":break;default:St=!1;break}if(St||c[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?Ej(Q,ie,_e,r.slice(te,c.index)):(_e=c,te=c.index+c[0].length);break}if(n.WTF)throw"Unrecognized tag: "+c[3]+"|"+d.join("|")}var Me={};return!n.bookSheets&&!n.bookProps&&(Me.Sheets=g),Me.SheetNames=y,Me.Workbook=Y,Me.SSF=Jn(ut),Me.Props=ne,Me.Custprops=Q,Me}function Nm(t,e){switch(Cp(e=e||{}),e.type||"base64"){case"base64":return qh(jr(t),e);case"binary":case"buffer":case"file":return qh(t,e);case"array":return qh(ji(t),e)}}function kj(t){var e={},n=t.content;if(n.l=28,e.AnsiUserType=n.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=HO(n),n.length-n.l<=4)return e;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,e.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(e.UnicodeClipboardFormat=GO(n),r=n.read_shift(4),r==0||r>40))return e;n.l-=4,e.Reserved2=n.read_shift(0,"lpwstr")}var Nj=[60,1084,2066,2165,2175];function Rj(t,e,n,r,a){var i=r,l=[],c=n.slice(n.l,n.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),n.l+=i;for(var d=as(n,n.l),f=Rm[d],g=0;f!=null&&Nj.indexOf(d)>-1;)i=as(n,n.l+2),g=n.l+4,d==2066?g+=4:(d==2165||d==2175)&&(g+=12),c=n.slice(g,n.l+4+i),l.push(c),n.l+=4+i,f=Rm[d=as(n,n.l)];var y=Gs(l);Wn(y,0);var _=0;y.lens=[];for(var w=0;w<l.length;++w)y.lens.push(_),_+=l[w].length;if(y.length<r)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+y.length+" < "+r;return e.f(y,y.length,a)}function Ra(t,e,n){if(t.t!=="z"&&t.XF){var r=0;try{r=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ut[r])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Gi[t.v]:r===0||r=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Gc(t.v):t.w=Ii(t.v):t.w=aa(r,t.v,{date1904:!!n,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&r&&t.t=="n"&&fl(ut[r]||String(r))){var a=Si(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Ff(t,e,n){return{v:t,ixfe:e,t:n}}function Dj(t,e){var n={opts:{}},r={},a=e.dense?[]:{},i={},l={},c=null,d=[],f="",g={},y,_="",w,E,S,C,R={},k=[],b,O,U=[],j=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},K={},P=function(Fe){return Fe<8?bi[Fe]:Fe<64&&j[Fe-8]||bi[Fe]},ne=function(Fe,je,ft){var lt=je.XF.data;if(!(!lt||!lt.patternType||!ft||!ft.cellStyles)){je.s={},je.s.patternType=lt.patternType;var cn;(cn=Yc(P(lt.icvFore)))&&(je.s.fgColor={rgb:cn}),(cn=Yc(P(lt.icvBack)))&&(je.s.bgColor={rgb:cn})}},Q=function(Fe,je,ft){if(!(Z>1)&&!(ft.sheetRows&&Fe.r>=ft.sheetRows)){if(ft.cellStyles&&je.XF&&je.XF.data&&ne(Fe,je,ft),delete je.ixfe,delete je.XF,y=Fe,_=ot(Fe),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<l.s.r&&(l.s.r=Fe.r),Fe.c<l.s.c&&(l.s.c=Fe.c),Fe.r+1>l.e.r&&(l.e.r=Fe.r+1),Fe.c+1>l.e.c&&(l.e.c=Fe.c+1),ft.cellFormula&&je.f){for(var lt=0;lt<k.length;++lt)if(!(k[lt][0].s.c>Fe.c||k[lt][0].s.r>Fe.r)&&!(k[lt][0].e.c<Fe.c||k[lt][0].e.r<Fe.r)){je.F=It(k[lt][0]),(k[lt][0].s.c!=Fe.c||k[lt][0].s.r!=Fe.r)&&delete je.f,je.f&&(je.f=""+tr(k[lt][1],l,Fe,W,te));break}}ft.dense?(a[Fe.r]||(a[Fe.r]=[]),a[Fe.r][Fe.c]=je):a[_]=je}},te={enc:!1,sbcch:0,snames:[],sharedf:R,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(te.password=e.password);var _e,Le=[],Te=[],ae=[],ue=[],re=!1,W=[];W.SheetNames=te.snames,W.sharedf=te.sharedf,W.arrayf=te.arrayf,W.names=[],W.XTI=[];var N=0,Z=0,M=0,V=[],Y=[],z;te.codepage=1200,ya(1200);for(var ie=!1;t.l<t.length-1;){var ye=t.l,Ce=t.read_shift(2);if(Ce===0&&N===10)break;var Re=t.l===t.length?0:t.read_shift(2),Ee=Rm[Ce];if(Ee&&Ee.f){if(e.bookSheets&&N===133&&Ce!==133)break;if(N=Ce,Ee.r===2||Ee.r==12){var Ke=t.read_shift(2);if(Re-=2,!te.enc&&Ke!==Ce&&((Ke&255)<<8|Ke>>8)!==Ce)throw new Error("rt mismatch: "+Ke+"!="+Ce);Ee.r==12&&(t.l+=10,Re-=10)}var J={};if(Ce===10?J=Ee.f(t,Re,te):J=Rj(Ce,Ee,t,Re,te),Z==0&&[9,521,1033,2057].indexOf(N)===-1)continue;switch(Ce){case 34:n.opts.Date1904=F.WBProps.date1904=J;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(te.enc||(t.l=0),te.enc=J,!e.password)throw new Error("File is password-protected");if(J.valid==null)throw new Error("Encryption scheme unsupported");if(!J.valid)throw new Error("Password is incorrect");break;case 92:te.lastuser=J;break;case 66:var xt=Number(J);switch(xt){case 21010:xt=1200;break;case 32768:xt=1e4;break;case 32769:xt=1252;break}ya(te.codepage=xt),ie=!0;break;case 317:te.rrtabid=J;break;case 25:te.winlocked=J;break;case 439:n.opts.RefreshAll=J;break;case 12:n.opts.CalcCount=J;break;case 16:n.opts.CalcDelta=J;break;case 17:n.opts.CalcIter=J;break;case 13:n.opts.CalcMode=J;break;case 14:n.opts.CalcPrecision=J;break;case 95:n.opts.CalcSaveRecalc=J;break;case 15:te.CalcRefMode=J;break;case 2211:n.opts.FullCalc=J;break;case 129:J.fDialog&&(a["!type"]="dialog"),J.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),J.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:U.push(J);break;case 430:W.push([J]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(J);break;case 24:case 536:z={Name:J.Name,Ref:tr(J.rgce,l,null,W,te)},J.itab>0&&(z.Sheet=J.itab-1),W.names.push(z),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(J),J.Name=="_xlnm._FilterDatabase"&&J.itab>0&&J.rgce&&J.rgce[0]&&J.rgce[0][0]&&J.rgce[0][0][0]=="PtgArea3d"&&(Y[J.itab-1]={ref:It(J.rgce[0][0][1][2])});break;case 22:te.ExternCount=J;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(J),W.XTI=W.XTI.concat(J);break;case 2196:if(te.biff<8)break;z!=null&&(z.Comment=J[1]);break;case 18:a["!protect"]=J;break;case 19:J!==0&&te.WTF&&console.error("Password verifier: "+J);break;case 133:i[J.pos]=J,te.snames.push(J.name);break;case 10:{if(--Z)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=It(l),e.sheetRows&&e.sheetRows<=l.e.r){var et=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=It(l),l.e.r=et}l.e.r++,l.e.c++}Le.length>0&&(a["!merges"]=Le),Te.length>0&&(a["!objects"]=Te),ae.length>0&&(a["!cols"]=ae),ue.length>0&&(a["!rows"]=ue),F.Sheets.push(K)}f===""?g=a:r[f]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(te.biff===8&&(te.biff={9:2,521:3,1033:4}[Ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[J.BIFFVer]||8),te.biffguess=J.BIFFVer==0,J.BIFFVer==0&&J.dt==4096&&(te.biff=5,ie=!0,ya(te.codepage=28591)),te.biff==8&&J.BIFFVer==0&&J.dt==16&&(te.biff=2),Z++)break;if(a=e.dense?[]:{},te.biff<8&&!ie&&(ie=!0,ya(te.codepage=e.codepage||1252)),te.biff<5||J.BIFFVer==0&&J.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var St={pos:t.l-Re,name:f};i[St.pos]=St,te.snames.push(f)}else f=(i[ye]||{name:""}).name;J.dt==32&&(a["!type"]="chart"),J.dt==64&&(a["!type"]="macro"),Le=[],Te=[],te.arrayf=k=[],ae=[],ue=[],re=!1,K={Hidden:(i[ye]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[J.r]||[])[J.c]:a[ot({c:J.c,r:J.r})])&&++J.c,b={ixfe:J.ixfe,XF:U[J.ixfe]||{},v:J.val,t:"n"},M>0&&(b.z=V[b.ixfe>>8&63]),Ra(b,e,n.opts.Date1904),Q({c:J.c,r:J.r},b,e);break;case 5:case 517:b={ixfe:J.ixfe,XF:U[J.ixfe],v:J.val,t:J.t},M>0&&(b.z=V[b.ixfe>>8&63]),Ra(b,e,n.opts.Date1904),Q({c:J.c,r:J.r},b,e);break;case 638:b={ixfe:J.ixfe,XF:U[J.ixfe],v:J.rknum,t:"n"},M>0&&(b.z=V[b.ixfe>>8&63]),Ra(b,e,n.opts.Date1904),Q({c:J.c,r:J.r},b,e);break;case 189:for(var st=J.c;st<=J.C;++st){var Me=J.rkrec[st-J.c][0];b={ixfe:Me,XF:U[Me],v:J.rkrec[st-J.c][1],t:"n"},M>0&&(b.z=V[b.ixfe>>8&63]),Ra(b,e,n.opts.Date1904),Q({c:st,r:J.r},b,e)}break;case 6:case 518:case 1030:{if(J.val=="String"){c=J;break}if(b=Ff(J.val,J.cell.ixfe,J.tt),b.XF=U[b.ixfe],e.cellFormula){var jt=J.formula;if(jt&&jt[0]&&jt[0][0]&&jt[0][0][0]=="PtgExp"){var nn=jt[0][0][1][0],xn=jt[0][0][1][1],on=ot({r:nn,c:xn});R[on]?b.f=""+tr(J.formula,l,J.cell,W,te):b.F=((e.dense?(a[nn]||[])[xn]:a[on])||{}).F}else b.f=""+tr(J.formula,l,J.cell,W,te)}M>0&&(b.z=V[b.ixfe>>8&63]),Ra(b,e,n.opts.Date1904),Q(J.cell,b,e),c=J}break;case 7:case 519:if(c)c.val=J,b=Ff(J,c.cell.ixfe,"s"),b.XF=U[b.ixfe],e.cellFormula&&(b.f=""+tr(c.formula,l,c.cell,W,te)),M>0&&(b.z=V[b.ixfe>>8&63]),Ra(b,e,n.opts.Date1904),Q(c.cell,b,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(J);var lr=ot(J[0].s);if(w=e.dense?(a[J[0].s.r]||[])[J[0].s.c]:a[lr],e.cellFormula&&w){if(!c||!lr||!w)break;w.f=""+tr(J[1],l,J[0],W,te),w.F=It(J[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!c)break;R[ot(c.cell)]=J[0],w=e.dense?(a[c.cell.r]||[])[c.cell.c]:a[ot(c.cell)],(w||{}).f=""+tr(J[0],l,y,W,te)}}break;case 253:b=Ff(d[J.isst].t,J.ixfe,"s"),d[J.isst].h&&(b.h=d[J.isst].h),b.XF=U[b.ixfe],M>0&&(b.z=V[b.ixfe>>8&63]),Ra(b,e,n.opts.Date1904),Q({c:J.c,r:J.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:J.ixfe,XF:U[J.ixfe],t:"z"},M>0&&(b.z=V[b.ixfe>>8&63]),Ra(b,e,n.opts.Date1904),Q({c:J.c,r:J.r},b,e));break;case 190:if(e.sheetStubs)for(var Ct=J.c;Ct<=J.C;++Ct){var vn=J.ixfe[Ct-J.c];b={ixfe:vn,XF:U[vn],t:"z"},M>0&&(b.z=V[b.ixfe>>8&63]),Ra(b,e,n.opts.Date1904),Q({c:Ct,r:J.r},b,e)}break;case 214:case 516:case 4:b=Ff(J.val,J.ixfe,"s"),b.XF=U[b.ixfe],M>0&&(b.z=V[b.ixfe>>8&63]),Ra(b,e,n.opts.Date1904),Q({c:J.c,r:J.r},b,e);break;case 0:case 512:Z===1&&(l=J);break;case 252:d=J;break;case 1054:if(te.biff==4){V[M++]=J[1];for(var Nn=0;Nn<M+163&&ut[Nn]!=J[1];++Nn);Nn>=163&&Ci(J[1],M+163)}else Ci(J[1],J[0]);break;case 30:{V[M++]=J;for(var Xt=0;Xt<M+163&&ut[Xt]!=J;++Xt);Xt>=163&&Ci(J,M+163)}break;case 229:Le=Le.concat(J);break;case 93:Te[J.cmo[0]]=te.lastobj=J;break;case 438:te.lastobj.TxO=J;break;case 127:te.lastobj.ImData=J;break;case 440:for(C=J[0].s.r;C<=J[0].e.r;++C)for(S=J[0].s.c;S<=J[0].e.c;++S)w=e.dense?(a[C]||[])[S]:a[ot({c:S,r:C})],w&&(w.l=J[1]);break;case 2048:for(C=J[0].s.r;C<=J[0].e.r;++C)for(S=J[0].s.c;S<=J[0].e.c;++S)w=e.dense?(a[C]||[])[S]:a[ot({c:S,r:C})],w&&w.l&&(w.l.Tooltip=J[1]);break;case 28:{if(te.biff<=5&&te.biff>=2)break;w=e.dense?(a[J[0].r]||[])[J[0].c]:a[ot(J[0])];var zt=Te[J[2]];w||(e.dense?(a[J[0].r]||(a[J[0].r]=[]),w=a[J[0].r][J[0].c]={t:"z"}):w=a[ot(J[0])]={t:"z"},l.e.r=Math.max(l.e.r,J[0].r),l.s.r=Math.min(l.s.r,J[0].r),l.e.c=Math.max(l.e.c,J[0].c),l.s.c=Math.min(l.s.c,J[0].c)),w.c||(w.c=[]),E={a:J[1],t:zt.TxO.t},w.c.push(E)}break;case 2173:QU(U[J.ixfe],J.ext);break;case 125:{if(!te.cellStyles)break;for(;J.e>=J.s;)ae[J.e--]={width:J.w/256,level:J.level||0,hidden:!!(J.flags&1)},re||(re=!0,_p(J.w/256)),al(ae[J.e+1])}break;case 520:{var De={};J.level!=null&&(ue[J.r]=De,De.level=J.level),J.hidden&&(ue[J.r]=De,De.hidden=!0),J.hpt&&(ue[J.r]=De,De.hpt=J.hpt,De.hpx=Wc(J.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Ic(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ce]]=J;break;case 161:a["!margins"]||Ic(a["!margins"]={}),a["!margins"].header=J.header,a["!margins"].footer=J.footer;break;case 574:J.RTL&&(F.Views[0].RTL=!0);break;case 146:j=J;break;case 2198:_e=J;break;case 140:O=J;break;case 442:f?K.CodeName=J||K.name:F.WBProps.CodeName=J||"ThisWorkbook";break}}else Ee||console.error("Missing Info for XLS Record 0x"+Ce.toString(16)),t.l+=Re}return n.SheetNames=Ua(i).sort(function(Ie,Fe){return Number(Ie)-Number(Fe)}).map(function(Ie){return i[Ie].name}),e.bookSheets||(n.Sheets=r),!n.SheetNames.length&&g["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=g)):n.Preamble=g,n.Sheets&&Y.forEach(function(Ie,Fe){n.Sheets[n.SheetNames[Fe]]["!autofilter"]=Ie}),n.Strings=d,n.SSF=Jn(ut),te.enc&&(n.Encryption=te.enc),_e&&(n.Themes=_e),n.Metadata={},O!==void 0&&(n.Metadata.Country=O),W.names.length>0&&(F.Names=W.names),n.Workbook=F,n}var CT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Mj(t,e,n){var r=Dt.find(t,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=lT(r,JO,CT.DSI);for(var i in a)e[i]=a[i]}catch(f){if(n.WTF)throw f}var l=Dt.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var c=lT(l,KO,CT.SI);for(var d in c)e[d]==null&&(e[d]=c[d])}catch(f){if(n.WTF)throw f}e.HeadingPairs&&e.TitlesOfParts&&(Hw(e.HeadingPairs,e.TitlesOfParts,e,n),delete e.HeadingPairs,delete e.TitlesOfParts)}function CE(t,e){e||(e={}),Cp(e),ew(),e.codepage&&rp(e.codepage);var n,r;if(t.FullPaths){if(Dt.find(t,"/encryption"))throw new Error("File is password-protected");n=Dt.find(t,"!CompObj"),r=Dt.find(t,"/Workbook")||Dt.find(t,"/Book")}else{switch(e.type){case"base64":t=va(jr(t));break;case"binary":t=va(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Wn(t,0),r={content:t}}var a,i;if(n&&kj(n),e.bookProps&&!e.bookSheets)a={};else{var l=kt?"buffer":"array";if(r&&r.content)a=Dj(r.content,e);else if((i=Dt.find(t,"PerfectOffice_MAIN"))&&i.content)a=Dc.to_workbook(i.content,(e.type=l,e));else if((i=Dt.find(t,"NativeContent_MAIN"))&&i.content)a=Dc.to_workbook(i.content,(e.type=l,e));else throw(i=Dt.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Dt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=x7(t))}var c={};return t.FullPaths&&Mj(t,c,e),a.Props=a.Custprops=c,e.bookFiles&&(a.cfb=t),a}var id={0:{f:hB},1:{f:xB},2:{f:bB},3:{f:TB},4:{f:yB},5:{f:CB},6:{f:NB},7:{f:EB},8:{f:FB},9:{f:IB},10:{f:DB},11:{f:MB},12:{f:vB},13:{f:AB},14:{f:wB},15:{f:_B},16:{f:_E},17:{f:RB},18:{f:SB},19:{f:mp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:oj},40:{},42:{},43:{f:DU},44:{f:RU},45:{f:MU},46:{f:FU},47:{f:IU},48:{},49:{f:OO},50:{},51:{f:t7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:eE},62:{f:kB},63:{f:i7},64:{f:GB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ir,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:HB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:gB},148:{f:mB,p:16},151:{f:PB},152:{},153:{f:sj},154:{},155:{},156:{f:aj},157:{},158:{},159:{T:1,f:KP},160:{T:-1},161:{T:1,f:Hi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:OB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:e7},336:{T:-1},337:{f:n7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Cm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Qw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:UB},427:{f:BB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:VB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:pB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:LB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Cm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:m7},633:{T:1},634:{T:-1},635:{T:1,f:h7},636:{T:-1},637:{f:PO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:JB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:$B},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Rm={6:{f:$h},10:{f:Us},12:{f:An},13:{f:An},14:{f:wn},15:{f:wn},16:{f:nr},17:{f:wn},18:{f:wn},19:{f:An},20:{f:dT},21:{f:dT},23:{f:Qw},24:{f:mT},25:{f:wn},26:{},27:{},28:{f:fP},29:{},34:{f:wn},35:{f:hT},38:{f:nr},39:{f:nr},40:{f:nr},41:{f:nr},42:{f:wn},43:{f:wn},47:{f:pU},49:{f:qL},51:{f:An},60:{},61:{f:GL},64:{f:wn},65:{f:zL},66:{f:An},77:{},80:{},81:{},82:{},85:{f:An},89:{},90:{},91:{},92:{f:OL},93:{f:hP},94:{},95:{f:wn},96:{},97:{},99:{f:wn},125:{f:eE},128:{f:nP},129:{f:LL},130:{f:An},131:{f:wn},132:{f:wn},133:{f:PL},134:{},140:{f:yP},141:{f:An},144:{},146:{f:TP},151:{},152:{},153:{},154:{},155:{},156:{f:An},157:{},158:{},160:{f:bP},161:{f:EP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ZL},190:{f:QL},193:{f:Us},197:{},198:{},199:{},200:{},201:{},202:{f:wn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:An},220:{},221:{f:wn},222:{},224:{f:tP},225:{f:FL},226:{f:Us},227:{},229:{f:dP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:UL},253:{f:YL},255:{f:BL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Yw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:wn},353:{f:Us},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:aP},431:{f:wn},432:{},433:{},434:{},437:{},438:{f:gP},439:{f:wn},440:{f:xP},441:{},442:{f:su},443:{},444:{f:An},445:{},446:{},448:{f:Us},449:{f:HL,r:2},450:{f:Us},512:{f:uT},513:{f:CP},515:{f:rP},516:{f:WL},517:{f:fT},519:{f:AP},520:{f:jL},523:{},545:{f:pT},549:{f:cT},566:{},574:{f:$L},638:{f:XL},659:{},1048:{},1054:{f:JL},1084:{},1212:{f:lP},2048:{f:vP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Df},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Us},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:wP,r:12},2173:{f:ZU,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:wn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:oP,r:12},2197:{},2198:{f:qU,r:12},2199:{},2200:{},2201:{},2202:{f:cP,r:12},2203:{f:Us},2204:{},2205:{},2206:{},2207:{},2211:{f:VL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:An},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:SP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_P},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:uT},1:{},2:{f:DP},3:{f:RP},4:{f:NP},5:{f:fT},7:{f:MP},8:{},9:{f:Df},11:{},22:{f:An},30:{f:KL},31:{},32:{},33:{f:pT},36:{},37:{f:cT},50:{f:IP},62:{},52:{},67:{},68:{f:An},69:{},86:{},126:{},127:{f:kP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:FP},223:{},234:{},354:{},421:{},518:{f:$h},521:{f:Df},536:{f:mT},547:{f:hT},561:{},579:{},1030:{f:$h},1033:{f:Df},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ma(t,e,n,r){var a=e;if(!isNaN(a)){var i=(n||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,i),i>0&&Fw(n)&&t.push(n)}}function bT(t,e){var n=e||{},r=n.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),l=a.index,c=i&&i.index||t.length,d=rO(t.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,g=0,y=0,_=0,w={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(l=0;l<d.length;++l){var S=d[l].trim(),C=S.slice(0,3).toLowerCase();if(C=="<tr"){if(++f,n.sheetRows&&n.sheetRows<=f){--f;break}g=0;continue}if(!(C!="<td"&&C!="<th")){var R=S.split(/<\/t[dh]>/i);for(c=0;c<R.length;++c){var k=R[c].trim();if(k.match(/<t[dh]/i)){for(var b=k,O=0;b.charAt(0)=="<"&&(O=b.indexOf(">"))>-1;)b=b.slice(O+1);for(var U=0;U<E.length;++U){var j=E[U];j.s.c==g&&j.s.r<f&&f<=j.e.r&&(g=j.e.c+1,U=-1)}var F=rt(k.slice(0,k.indexOf(">")));_=F.colspan?+F.colspan:1,((y=+F.rowspan)>1||_>1)&&E.push({s:{r:f,c:g},e:{r:f+(y||1)-1,c:g+_-1}});var K=F.t||F["data-t"]||"";if(!b.length){g+=_;continue}if(b=Tw(b),w.s.r>f&&(w.s.r=f),w.e.r<f&&(w.e.r=f),w.s.c>g&&(w.s.c=g),w.e.c<g&&(w.e.c=g),!b.length){g+=_;continue}var P={t:"s",v:b};n.raw||!b.trim().length||K=="s"||(b==="TRUE"?P={t:"b",v:!0}:b==="FALSE"?P={t:"b",v:!1}:isNaN(Ta(b))?isNaN(rl(b).getDate())||(P={t:"d",v:Hn(b)},n.cellDates||(P={t:"n",v:xr(P.v)}),P.z=n.dateNF||ut[14]):P={t:"n",v:Ta(b)}),n.dense?(r[f]||(r[f]=[]),r[f][g]=P):r[ot({r:f,c:g})]=P,g+=_}}}}return r["!ref"]=It(w),E.length&&(r["!merges"]=E),r}function Ij(t,e,n,r){for(var a=t["!merges"]||[],i=[],l=e.s.c;l<=e.e.c;++l){for(var c=0,d=0,f=0;f<a.length;++f)if(!(a[f].s.r>n||a[f].s.c>l)&&!(a[f].e.r<n||a[f].e.c<l)){if(a[f].s.r<n||a[f].s.c<l){c=-1;break}c=a[f].e.r-a[f].s.r+1,d=a[f].e.c-a[f].s.c+1;break}if(!(c<0)){var g=ot({r:n,c:l}),y=r.dense?(t[n]||[])[l]:t[g],_=y&&y.v!=null&&(y.h||cp(y.w||(us(y),y.w)||""))||"",w={};c>1&&(w.rowspan=c),d>1&&(w.colspan=d),r.editable?_='<span contenteditable="true">'+_+"</span>":y&&(w["data-t"]=y&&y.t||"z",y.v!=null&&(w["data-v"]=y.v),y.z!=null&&(w["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+y.l.Target+'">'+_+"</a>")),w.id=(r.id||"sjs")+"-"+g,i.push(yO("td",_,w))}}var E="<tr>";return E+i.join("")+"</tr>"}var Fj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Oj="</body></html>";function Lj(t,e){var n=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return ei(bT(n[0],e),e);var r=Ap();return n.forEach(function(a,i){kp(r,bT(a,e),"Sheet"+(i+1))}),r}function Pj(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Uj(t,e){var n=e||{},r=n.header!=null?n.header:Fj,a=n.footer!=null?n.footer:Oj,i=[r],l=dl(t["!ref"]);n.dense=Array.isArray(t),i.push(Pj(t,l,n));for(var c=l.s.r;c<=l.e.r;++c)i.push(Ij(t,l,c,n));return i.push("</table>"+a),i.join("")}function bE(t,e,n){var r=n||{},a=0,i=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?mr(r.origin):r.origin;a=l.r,i=l.c}var c=e.getElementsByTagName("tr"),d=Math.min(r.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var g=dl(t["!ref"]);f.s.r=Math.min(f.s.r,g.s.r),f.s.c=Math.min(f.s.c,g.s.c),f.e.r=Math.max(f.e.r,g.e.r),f.e.c=Math.max(f.e.c,g.e.c),a==-1&&(f.e.r=a=g.e.r+1)}var y=[],_=0,w=t["!rows"]||(t["!rows"]=[]),E=0,S=0,C=0,R=0,k=0,b=0;for(t["!cols"]||(t["!cols"]=[]);E<c.length&&S<d;++E){var O=c[E];if(AT(O)){if(r.display)continue;w[S]={hidden:!0}}var U=O.children;for(C=R=0;C<U.length;++C){var j=U[C];if(!(r.display&&AT(j))){var F=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):Tw(j.innerHTML),K=j.getAttribute("data-z")||j.getAttribute("z");for(_=0;_<y.length;++_){var P=y[_];P.s.c==R+i&&P.s.r<S+a&&S+a<=P.e.r&&(R=P.e.c+1-i,_=-1)}b=+j.getAttribute("colspan")||1,((k=+j.getAttribute("rowspan")||1)>1||b>1)&&y.push({s:{r:S+a,c:R+i},e:{r:S+a+(k||1)-1,c:R+i+(b||1)-1}});var ne={t:"s",v:F},Q=j.getAttribute("data-t")||j.getAttribute("t")||"";F!=null&&(F.length==0?ne.t=Q||"z":r.raw||F.trim().length==0||Q=="s"||(F==="TRUE"?ne={t:"b",v:!0}:F==="FALSE"?ne={t:"b",v:!1}:isNaN(Ta(F))?isNaN(rl(F).getDate())||(ne={t:"d",v:Hn(F)},r.cellDates||(ne={t:"n",v:xr(ne.v)}),ne.z=r.dateNF||ut[14]):ne={t:"n",v:Ta(F)})),ne.z===void 0&&K!=null&&(ne.z=K);var te="",_e=j.getElementsByTagName("A");if(_e&&_e.length)for(var Le=0;Le<_e.length&&!(_e[Le].hasAttribute("href")&&(te=_e[Le].getAttribute("href"),te.charAt(0)!="#"));++Le);te&&te.charAt(0)!="#"&&(ne.l={Target:te}),r.dense?(t[S+a]||(t[S+a]=[]),t[S+a][R+i]=ne):t[ot({c:R+i,r:S+a})]=ne,f.e.c<R+i&&(f.e.c=R+i),R+=b}}++S}return y.length&&(t["!merges"]=(t["!merges"]||[]).concat(y)),f.e.r=Math.max(f.e.r,S-1+a),t["!ref"]=It(f),S>=d&&(t["!fullref"]=It((f.e.r=c.length-E+S-1+a,f))),t}function AE(t,e){var n=e||{},r=n.dense?[]:{};return bE(r,t,e)}function Bj(t,e){return ei(AE(t,e),e)}function AT(t){var e="",n=jj(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function jj(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Vj(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=Ft(e.replace(/<[^>]*>/g,""));return[n]}var kT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function kE(t,e){var n=e||{},r=up(t),a=[],i,l,c={name:""},d="",f=0,g,y,_={},w=[],E=n.dense?[]:{},S,C,R={value:""},k="",b=0,O=[],U=-1,j=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},K=0,P={},ne=[],Q={},te=0,_e=0,Le=[],Te=1,ae=1,ue=[],re={Names:[]},W={},N=["",""],Z=[],M={},V="",Y=0,z=!1,ie=!1,ye=0;for(zc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=zc.exec(r);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"工作表":S[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?E["!ref"]=It(F):E["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=F.e.r&&(E["!fullref"]=E["!ref"],F.e.r=n.sheetRows-1,E["!ref"]=It(F)),ne.length&&(E["!merges"]=ne),Le.length&&(E["!rows"]=Le),g.name=g.名称||g.name,typeof JSON<"u"&&JSON.stringify(g),w.push(g.name),_[g.name]=E,ie=!1):S[0].charAt(S[0].length-2)!=="/"&&(g=rt(S[0],!1),U=j=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,E=n.dense?[]:{},ne=[],Le=[],ie=!0);break;case"table-row-group":S[1]==="/"?--K:++K;break;case"table-row":case"行":if(S[1]==="/"){U+=Te,Te=1;break}if(y=rt(S[0],!1),y.行号?U=y.行号-1:U==-1&&(U=0),Te=+y["number-rows-repeated"]||1,Te<10)for(ye=0;ye<Te;++ye)K>0&&(Le[U+ye]={level:K});j=-1;break;case"covered-table-cell":S[1]!=="/"&&++j,n.sheetStubs&&(n.dense?(E[U]||(E[U]=[]),E[U][j]={t:"z"}):E[ot({r:U,c:j})]={t:"z"}),k="",O=[];break;case"table-cell":case"数据":if(S[0].charAt(S[0].length-2)==="/")++j,R=rt(S[0],!1),ae=parseInt(R["number-columns-repeated"]||"1",10),C={t:"z",v:null},R.formula&&n.cellFormula!=!1&&(C.f=wT(Ft(R.formula))),(R.数据类型||R["value-type"])=="string"&&(C.t="s",C.v=Ft(R["string-value"]||""),n.dense?(E[U]||(E[U]=[]),E[U][j]=C):E[ot({r:U,c:j})]=C),j+=ae-1;else if(S[1]!=="/"){++j,k="",b=0,O=[],ae=1;var Ce=Te?U+Te-1:U;if(j>F.e.c&&(F.e.c=j),j<F.s.c&&(F.s.c=j),U<F.s.r&&(F.s.r=U),Ce>F.e.r&&(F.e.r=Ce),R=rt(S[0],!1),Z=[],M={},C={t:R.数据类型||R["value-type"],v:null},n.cellFormula)if(R.formula&&(R.formula=Ft(R.formula)),R["number-matrix-columns-spanned"]&&R["number-matrix-rows-spanned"]&&(te=parseInt(R["number-matrix-rows-spanned"],10)||0,_e=parseInt(R["number-matrix-columns-spanned"],10)||0,Q={s:{r:U,c:j},e:{r:U+te-1,c:j+_e-1}},C.F=It(Q),ue.push([Q,C.F])),R.formula)C.f=wT(R.formula);else for(ye=0;ye<ue.length;++ye)U>=ue[ye][0].s.r&&U<=ue[ye][0].e.r&&j>=ue[ye][0].s.c&&j<=ue[ye][0].e.c&&(C.F=ue[ye][1]);switch((R["number-columns-spanned"]||R["number-rows-spanned"])&&(te=parseInt(R["number-rows-spanned"],10)||0,_e=parseInt(R["number-columns-spanned"],10)||0,Q={s:{r:U,c:j},e:{r:U+te-1,c:j+_e-1}},ne.push(Q)),R["number-columns-repeated"]&&(ae=parseInt(R["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=sn(R["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(R.value);break;case"percentage":C.t="n",C.v=parseFloat(R.value);break;case"currency":C.t="n",C.v=parseFloat(R.value);break;case"date":C.t="d",C.v=Hn(R["date-value"]),n.cellDates||(C.t="n",C.v=xr(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=eO(R["time-value"])/86400,n.cellDates&&(C.t="d",C.v=xd(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(R.数据数值);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",R["string-value"]!=null&&(k=Ft(R["string-value"]),O=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(z=!1,C.t==="s"&&(C.v=k||"",O.length&&(C.R=O),z=b==0),W.Target&&(C.l=W),Z.length>0&&(C.c=Z,Z=[]),k&&n.cellText!==!1&&(C.w=k),z&&(C.t="z",delete C.v),(!z||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=U))for(var Re=0;Re<Te;++Re){if(ae=parseInt(R["number-columns-repeated"]||"1",10),n.dense)for(E[U+Re]||(E[U+Re]=[]),E[U+Re][j]=Re==0?C:Jn(C);--ae>0;)E[U+Re][j+ae]=Jn(C);else for(E[ot({r:U+Re,c:j})]=C;--ae>0;)E[ot({r:U+Re,c:j+ae})]=Jn(C);F.e.c<=j&&(F.e.c=j)}ae=parseInt(R["number-columns-repeated"]||"1",10),j+=ae-1,ae=0,C={},k="",O=[]}W={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i;M.t=k,O.length&&(M.R=O),M.a=V,Z.push(M)}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);V="",Y=0,k="",b=0,O=[];break;case"creator":S[1]==="/"?V=r.slice(Y,S.index):Y=S.index+S[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);k="",b=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(P[c.name]=d,(i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&(d="",c=rt(S[0],!1),a.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=rt(S[0],!1),d+=kT[S[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=rt(S[0],!1),d+=kT[S[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":d+=r.slice(f,S.index);break}else f=S.index+S[0].length;break;case"named-range":l=rt(S[0],!1),N=zh(l["cell-range-address"]);var Ee={Name:l.name,Ref:N[0]+"!"+N[1]};ie&&(Ee.Sheet=w.length),re.Names.push(Ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(S[1]==="/"&&(!R||!R["string-value"])){var Ke=Vj(r.slice(b,S.index));k=(k.length>0?k+`
`:"")+Ke[0]}else rt(S[0],!1),b=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{N=zh(rt(S[0])["target-range-address"]),_[N[0]]["!autofilter"]={ref:N[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(W=rt(S[0],!1),!W.href)break;W.Target=Ft(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(N=zh(W.Target.slice(1)),W.Target="#"+N[0]+"!"+N[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(n.WTF)throw new Error(S)}}var J={Sheets:_,SheetNames:w,Workbook:re};return n.bookSheets&&delete J.Sheets,J}function NT(t,e){e=e||{},na(t,"META-INF/manifest.xml")&&rL(bn(t,"META-INF/manifest.xml"),e);var n=Br(t,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=kE(en(n),e);return na(t,"meta.xml")&&(r.Props=Vw(bn(t,"meta.xml"))),r}function RT(t,e){return kE(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ep(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Dm(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):en(ji(t))}function Mm(t){var e=t.reduce(function(a,i){return a+i.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(a){n.set(a,r),r+=a.length}),n}function DT(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Hj(t,e){for(var n=(t[e+15]&127)<<7|t[e+14]>>1,r=t[e+14]&1,a=e+13;a>=e;--a)r=r*256+t[a];return(t[e+15]&128?-r:r)*Math.pow(10,n-6176)}function Jc(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function On(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function ar(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],a=Jc(t,n),i=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(i){case 0:{for(var d=n[0];t[n[0]++]>=128;);c=t.slice(d,n[0])}break;case 5:l=4,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 1:l=8,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 2:l=Jc(t,n),c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(r))}var f={data:c,type:i};e[a]==null?e[a]=[f]:e[a].push(f)}return e}function Sp(t,e){return(t==null?void 0:t.map(function(n){return e(n.data)}))||[]}function Gj(t){for(var e,n=[],r=[0];r[0]<t.length;){var a=Jc(t,r),i=ar(t.slice(r[0],r[0]+a));r[0]+=a;var l={id:On(i[1][0].data),messages:[]};i[2].forEach(function(c){var d=ar(c.data),f=On(d[3][0].data);l.messages.push({meta:d,data:t.slice(r[0],r[0]+f)}),r[0]+=f}),(e=i[3])!=null&&e[0]&&(l.merge=On(i[3][0].data)>>>0>0),n.push(l)}return n}function $j(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=Jc(e,n),a=[];n[0]<e.length;){var i=e[n[0]]&3;if(i==0){var l=e[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=e[n[0]],c>1&&(l|=e[n[0]+1]<<8),c>2&&(l|=e[n[0]+2]<<16),c>3&&(l|=e[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(e.slice(n[0],n[0]+l)),n[0]+=l;continue}else{var d=0,f=0;if(i==1?(f=(e[n[0]]>>2&7)+4,d=(e[n[0]++]&224)<<3,d|=e[n[0]++]):(f=(e[n[0]++]>>2)+1,i==2?(d=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(d=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),a=[Mm(a)],d==0)throw new Error("Invalid offset 0");if(d>a[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(a.push(a[0].slice(-d)),f-=d;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-d,-d+f))}}var g=Mm(a);if(g.length!=r)throw new Error("Unexpected length: ".concat(g.length," != ").concat(r));return g}function zj(t){for(var e=[],n=0;n<t.length;){var r=t[n++],a=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push($j(r,t.slice(n,n+a))),n+=a}if(n!==t.length)throw new Error("data is not a valid framed stream!");return Mm(e)}function qj(t,e,n,r){var a=Ep(t),i=a.getUint32(4,!0),l=(r>1?12:8)+DT(i&(r>1?3470:398))*4,c=-1,d=-1,f=NaN,g=new Date(2001,0,1);i&512&&(c=a.getUint32(l,!0),l+=4),l+=DT(i&(r>1?12288:4096))*4,i&16&&(d=a.getUint32(l,!0),l+=4),i&32&&(f=a.getFloat64(l,!0),l+=8),i&64&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var y;switch(t[2]){case 0:break;case 2:y={t:"n",v:f};break;case 3:y={t:"s",v:e[d]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:f>0};break;case 7:y={t:"n",v:f/86400};break;case 8:y={t:"e",v:0};break;case 9:if(c>-1)y={t:"s",v:n[c]};else if(d>-1)y={t:"s",v:e[d]};else if(!isNaN(f))y={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return y}function Yj(t,e,n){var r=Ep(t),a=r.getUint32(8,!0),i=12,l=-1,c=-1,d=NaN,f=NaN,g=new Date(2001,0,1);a&1&&(d=Hj(t,i),i+=16),a&2&&(f=r.getFloat64(i,!0),i+=8),a&4&&(g.setTime(g.getTime()+r.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=r.getUint32(i,!0),i+=4),a&16&&(l=r.getUint32(i,!0),i+=4);var y;switch(t[1]){case 0:break;case 2:y={t:"n",v:d};break;case 3:y={t:"s",v:e[c]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:f>0};break;case 7:y={t:"n",v:f/86400};break;case 8:y={t:"e",v:0};break;case 9:if(l>-1)y={t:"s",v:n[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:y={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return y}function Wj(t,e,n){switch(t[0]){case 0:case 1:case 2:case 3:return qj(t,e,n,t[0]);case 5:return Yj(t,e,n);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Js(t){var e=ar(t);return Jc(e[1][0].data)}function MT(t,e){var n=ar(e.data),r=On(n[1][0].data),a=n[3],i=[];return(a||[]).forEach(function(l){var c=ar(l.data),d=On(c[1][0].data)>>>0;switch(r){case 1:i[d]=Dm(c[3][0].data);break;case 8:{var f=t[Js(c[9][0].data)][0],g=ar(f.data),y=t[Js(g[1][0].data)][0],_=On(y.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var w=ar(y.data);i[d]=w[3].map(function(E){return Dm(E.data)}).join("")}break}}),i}function Jj(t,e){var n,r,a,i,l,c,d,f,g,y,_,w,E,S,C=ar(t),R=On(C[1][0].data)>>>0,k=On(C[2][0].data)>>>0,b=((r=(n=C[8])==null?void 0:n[0])==null?void 0:r.data)&&On(C[8][0].data)>0||!1,O,U;if((i=(a=C[7])==null?void 0:a[0])!=null&&i.data&&e!=0)O=(c=(l=C[7])==null?void 0:l[0])==null?void 0:c.data,U=(f=(d=C[6])==null?void 0:d[0])==null?void 0:f.data;else if((y=(g=C[4])==null?void 0:g[0])!=null&&y.data&&e!=1)O=(w=(_=C[4])==null?void 0:_[0])==null?void 0:w.data,U=(S=(E=C[3])==null?void 0:E[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var j=b?4:1,F=Ep(O),K=[],P=0;P<O.length/2;++P){var ne=F.getUint16(P*2,!0);ne<65535&&K.push([P,ne])}if(K.length!=k)throw"Expected ".concat(k," cells, found ").concat(K.length);var Q=[];for(P=0;P<K.length-1;++P)Q[K[P][0]]=U.subarray(K[P][1]*j,K[P+1][1]*j);return K.length>=1&&(Q[K[K.length-1][0]]=U.subarray(K[K.length-1][1]*j)),{R,cells:Q}}function Kj(t,e){var n,r=ar(e.data),a=(n=r==null?void 0:r[7])!=null&&n[0]?On(r[7][0].data)>>>0>0?1:0:-1,i=Sp(r[5],function(l){return Jj(l,a)});return{nrows:On(r[4][0].data)>>>0,data:i.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(d,f){if(l[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));l[c.R][f]=d}),l},[])}}function Xj(t,e,n){var r,a=ar(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(On(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(On(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=It(i);var l=ar(a[4][0].data),c=MT(t,t[Js(l[4][0].data)][0]),d=(r=l[17])!=null&&r[0]?MT(t,t[Js(l[17][0].data)][0]):[],f=ar(l[3][0].data),g=0;f[1].forEach(function(y){var _=ar(y.data),w=t[Js(_[2][0].data)][0],E=On(w.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var S=Kj(t,w);S.data.forEach(function(C,R){C.forEach(function(k,b){var O=ot({r:g+R,c:b}),U=Wj(k,c,d);U&&(n[O]=U)})}),g+=S.nrows})}function Zj(t,e){var n=ar(e.data),r={"!ref":"A1"},a=t[Js(n[2][0].data)],i=On(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Xj(t,a[0],r),r}function Qj(t,e){var n,r=ar(e.data),a={name:(n=r[1])!=null&&n[0]?Dm(r[1][0].data):"",sheets:[]},i=Sp(r[2],Js);return i.forEach(function(l){t[l].forEach(function(c){var d=On(c.meta[1][0].data);d==6e3&&a.sheets.push(Zj(t,c))})}),a}function eV(t,e){var n=Ap(),r=ar(e.data),a=Sp(r[1],Js);if(a.forEach(function(i){t[i].forEach(function(l){var c=On(l.meta[1][0].data);if(c==2){var d=Qj(t,l);d.sheets.forEach(function(f,g){kp(n,f,g==0?d.name:d.name+"_"+g,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function Yh(t){var e,n,r,a,i={},l=[];if(t.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var f;try{f=zj(d.content)}catch(y){return console.log("?? "+d.content.length+" "+(y.message||y))}var g;try{g=Gj(f)}catch(y){return console.log("## "+(y.message||y))}g.forEach(function(y){i[y.id]=y.messages,l.push(y.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(n=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&On(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||l.forEach(function(d){i[d].forEach(function(f){var g=On(f.meta[1][0].data)>>>0;if(g==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return eV(i,c)}function tV(t){return function(n){for(var r=0;r!=t.length;++r){var a=t[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function Cp(t){tV([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function nV(t){return Go.WS.indexOf(t)>-1?"sheet":t==Go.CS?"chart":t==Go.DS?"dialog":t==Go.MS?"macro":t&&t.length?t:"sheet"}function rV(t,e){if(!t)return 0;try{t=e.map(function(r){return r.id||(r.id=r.strRelID),[r.name,t["!id"][r.id].Target,nV(t["!id"][r.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function aV(t,e,n,r,a,i,l,c,d,f,g,y){try{i[r]=Nc(Br(t,n,!0),e);var _=bn(t,e),w;switch(c){case"sheet":w=uj(_,e,a,d,i[r],f,g,y);break;case"chart":if(w=fj(_,e,a,d,i[r],f,g,y),!w||!w["!drawel"])break;var E=vc(w["!drawel"].Target,e),S=bm(E),C=c7(Br(t,E,!0),Nc(Br(t,S,!0),E)),R=vc(C,E),k=bm(R);w=YB(Br(t,R,!0),R,d,Nc(Br(t,k,!0),R),f,w);break;case"macro":w=dj(_,e,a,d,i[r],f,g,y);break;case"dialog":w=hj(_,e,a,d,i[r],f,g,y);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=w;var b=[];i&&i[r]&&Ua(i[r]).forEach(function(O){var U="";if(i[r][O].Type==Go.CMNT){U=vc(i[r][O].Target,e);var j=xj(bn(t,U,!0),U,d);if(!j||!j.length)return;xT(w,j,!1)}i[r][O].Type==Go.TCMNT&&(U=vc(i[r][O].Target,e),b=b.concat(f7(bn(t,U,!0),d)))}),b&&b.length&&xT(w,b,!0,d.people||[])}catch(O){if(d.WTF)throw O}}function ea(t){return t.charAt(0)=="/"?t.slice(1):t}function sV(t,e){if(dw(),e=e||{},Cp(e),na(t,"META-INF/manifest.xml")||na(t,"objectdata.xml"))return NT(t,e);if(na(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Yh<"u"){if(t.FileIndex)return Yh(t);var n=Dt.utils.cfb_new();return $_(t).forEach(function(Le){iO(n,Le,sO(t,Le))}),Yh(n)}throw new Error("Unsupported NUMBERS file")}if(!na(t,"[Content_Types].xml"))throw na(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):na(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=$_(t),a=tL(Br(t,"[Content_Types].xml")),i=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",bn(t,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!bn(t,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var d={},f={};if(!e.bookSheets&&!e.bookProps){if(Mc=[],a.sst)try{Mc=gj(bn(t,ea(a.sst)),a.sst,e)}catch(Le){if(e.WTF)throw Le}e.cellStyles&&a.themes.length&&(d=pj(Br(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(f=mj(bn(t,ea(a.style)),a.style,d,e))}a.links.map(function(Le){try{var Te=Nc(Br(t,bm(ea(Le))),Le);return yj(bn(t,ea(Le)),Te,Le,e)}catch{}});var g=cj(bn(t,ea(a.workbooks[0])),a.workbooks[0],e),y={},_="";a.coreprops.length&&(_=bn(t,ea(a.coreprops[0]),!0),_&&(y=Vw(_)),a.extprops.length!==0&&(_=bn(t,ea(a.extprops[0]),!0),_&&iL(_,y,e)));var w={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=Br(t,ea(a.custprops[0]),!0),_&&(w=lL(_,e)));var E={};if((e.bookSheets||e.bookProps)&&(g.Sheets?l=g.Sheets.map(function(Te){return Te.name}):y.Worksheets&&y.SheetNames.length>0&&(l=y.SheetNames),e.bookProps&&(E.Props=y,E.Custprops=w),e.bookSheets&&typeof l<"u"&&(E.SheetNames=l),e.bookSheets?E.SheetNames:e.bookProps))return E;l={};var S={};e.bookDeps&&a.calcchain&&(S=vj(bn(t,ea(a.calcchain)),a.calcchain));var C=0,R={},k,b;{var O=g.Sheets;y.Worksheets=O.length,y.SheetNames=[];for(var U=0;U!=O.length;++U)y.SheetNames[U]=O[U].name}var j=i?"bin":"xml",F=a.workbooks[0].lastIndexOf("/"),K=(a.workbooks[0].slice(0,F+1)+"_rels/"+a.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");na(t,K)||(K="xl/_rels/workbook."+j+".rels");var P=Nc(Br(t,K,!0),K.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=_j(bn(t,ea(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=d7(bn(t,ea(a.people[0])),e)),P&&(P=rV(P,g.Sheets));var ne=bn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=y.Worksheets;++C){var Q="sheet";if(P&&P[C]?(k="xl/"+P[C][1].replace(/[\/]?xl\//,""),na(t,k)||(k=P[C][1]),na(t,k)||(k=K.replace(/_rels\/.*$/,"")+P[C][1]),Q=P[C][2]):(k="xl/worksheets/sheet"+(C+1-ne)+"."+j,k=k.replace(/sheet0\./,"sheet.")),b=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(C!=e.sheets)continue e;break;case"string":if(y.SheetNames[C].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var te=!1,_e=0;_e!=e.sheets.length;++_e)typeof e.sheets[_e]=="number"&&e.sheets[_e]==C&&(te=1),typeof e.sheets[_e]=="string"&&e.sheets[_e].toLowerCase()==y.SheetNames[C].toLowerCase()&&(te=1);if(!te)continue e}}aV(t,k,b,y.SheetNames[C],C,R,l,Q,e,g,d,f)}return E={Directory:a,Workbook:g,Props:y,Custprops:w,Deps:S,Sheets:l,SheetNames:y.SheetNames,Strings:Mc,Styles:f,Themes:d,SSF:Jn(ut)},e&&e.bookFiles&&(t.files?(E.keys=r,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Le,Te){Le=Le.replace(/^Root Entry[\/]/,""),E.keys.push(Le),E.files[Le]=t.FileIndex[Te]}))),e&&e.bookVBA&&(a.vba.length>0?E.vbaraw=bn(t,ea(a.vba[0]),!0):a.defaults&&a.defaults.bin===g7&&(E.vbaraw=bn(t,"xl/vbaProject.bin",!0))),E}function iV(t,e){var n=e||{},r="Workbook",a=Dt.find(t,r);try{if(r="/!DataSpaces/Version",a=Dt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(ZP(a.content),r="/!DataSpaces/DataSpaceMap",a=Dt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=eU(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Dt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=tU(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Dt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);rU(a.content)}catch{}if(r="/EncryptionInfo",a=Dt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=aU(a.content);if(r="/EncryptedPackage",a=Dt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,n.password||"",n);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function bp(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=jr(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function oV(t,e){return Dt.find(t,"EncryptedPackage")?iV(t,e):CE(t,e)}function lV(t,e){var n,r=t,a=e||{};return a.type||(a.type=kt&&Buffer.isBuffer(t)?"buffer":"base64"),n=vw(r,a),sV(n,a)}function NE(t,e){var n=0;e:for(;n<t.length;)switch(t.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return Nm(t.slice(n),e);default:break e}return qc.to_workbook(t,e)}function cV(t,e){var n="",r=bp(t,e);switch(e.type){case"base64":n=jr(t);break;case"binary":n=t;break;case"buffer":n=t.toString("binary");break;case"array":n=Fi(t);break;default:throw new Error("Unrecognized type "+e.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=en(n)),e.type="binary",NE(n,e)}function uV(t,e){var n=t;return e.type=="base64"&&(n=jr(n)),n=Hc.utils.decode(1200,n.slice(2),"str"),e.type="binary",NE(n,e)}function fV(t){return t.match(/[^\x00-\x7F]/)?yc(t):t}function Wh(t,e,n,r){return r?(n.type="string",qc.to_workbook(t,n)):qc.to_workbook(e,n)}function Im(t,e){ew();var n=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Im(new Uint8Array(t),(n=Jn(n),n.type="array",n));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=t,a=[0,0,0,0],i=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),Wo={},n.dateNF&&(Wo.dateNF=n.dateNF),n.type||(n.type=kt&&Buffer.isBuffer(t)?"buffer":"base64"),n.type=="file"&&(n.type=kt?"buffer":"binary",r=Z8(t),typeof Uint8Array<"u"&&!kt&&(n.type="array")),n.type=="string"&&(i=!0,n.type="binary",n.codepage=65001,r=fV(t)),n.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return n=Jn(n),n.type="array",Im(ap(r),n)}switch((a=bp(r,n))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return oV(Dt.read(r,n),n);break;case 9:if(a[1]<=8)return CE(r,n);break;case 60:return Nm(r,n);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return BP(r,n);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return PP.to_workbook(r,n);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?lV(r,n):Wh(t,r,n,i);case 239:return a[3]===60?Nm(r,n):Wh(t,r,n,i);case 255:if(a[1]===254)return uV(r,n);if(a[1]===0&&a[2]===2&&a[3]===0)return Dc.to_workbook(r,n);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Dc.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return gT.to_workbook(r,n);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return gU.to_workbook(r,n);break;case 10:case 13:case 32:return cV(r,n);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return OP.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?gT.to_workbook(r,n):Wh(t,r,n,i)}function dV(t,e,n,r,a,i,l,c){var d=Kn(n),f=c.defval,g=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),y=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:n,enumerable:!1})}catch{_.__rowNum__=n}else _.__rowNum__=n;if(!l||t[n])for(var w=e.s.c;w<=e.e.c;++w){var E=l?t[n][w]:t[r[w]+d];if(E===void 0||E.t===void 0){if(f===void 0)continue;i[w]!=null&&(_[i[w]]=f);continue}var S=E.v;switch(E.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(i[w]!=null){if(S==null)if(E.t=="e"&&S===null)_[i[w]]=null;else if(f!==void 0)_[i[w]]=f;else if(g&&S===null)_[i[w]]=null;else continue;else _[i[w]]=g&&(E.t!=="n"||E.t==="n"&&c.rawNumbers!==!1)?S:us(E,S,c);S!=null&&(y=!1)}}return{row:_,isempty:y}}function Fm(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,i=[],l=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},g=f.range!=null?f.range:t["!ref"];switch(f.header===1?r=1:f.header==="A"?r=2:Array.isArray(f.header)?r=3:f.header==null&&(r=0),typeof g){case"string":d=gn(g);break;case"number":d=gn(t["!ref"]),d.s.r=g;break;default:d=g}r>0&&(a=0);var y=Kn(d.s.r),_=[],w=[],E=0,S=0,C=Array.isArray(t),R=d.s.r,k=0,b={};C&&!t[R]&&(t[R]=[]);var O=f.skipHidden&&t["!cols"]||[],U=f.skipHidden&&t["!rows"]||[];for(k=d.s.c;k<=d.e.c;++k)if(!(O[k]||{}).hidden)switch(_[k]=Fn(k),n=C?t[R][k]:t[_[k]+y],r){case 1:i[k]=k-d.s.c;break;case 2:i[k]=_[k];break;case 3:i[k]=f.header[k-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=l=us(n,null,f),S=b[l]||0,!S)b[l]=1;else{do c=l+"_"+S++;while(b[c]);b[l]=S,b[c]=1}i[k]=c}for(R=d.s.r+a;R<=d.e.r;++R)if(!(U[R]||{}).hidden){var j=dV(t,d,R,_,r,i,C,f);(j.isempty===!1||(r===1?f.blankrows!==!1:f.blankrows))&&(w[E++]=j.row)}return w.length=E,w}var IT=/"/g;function hV(t,e,n,r,a,i,l,c){for(var d=!0,f=[],g="",y=Kn(n),_=e.s.c;_<=e.e.c;++_)if(r[_]){var w=c.dense?(t[n]||[])[_]:t[r[_]+y];if(w==null)g="";else if(w.v!=null){d=!1,g=""+(c.rawNumbers&&w.t=="n"?w.v:us(w,null,c));for(var E=0,S=0;E!==g.length;++E)if((S=g.charCodeAt(E))===a||S===i||S===34||c.forceQuotes){g='"'+g.replace(IT,'""')+'"';break}g=="ID"&&(g='"ID"')}else w.f!=null&&!w.F?(d=!1,g="="+w.f,g.indexOf(",")>=0&&(g='"'+g.replace(IT,'""')+'"')):g="";f.push(g)}return c.blankrows===!1&&d?null:f.join(l)}function RE(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var a=gn(t["!ref"]),i=r.FS!==void 0?r.FS:",",l=i.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,d=c.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),g="",y=[];r.dense=Array.isArray(t);for(var _=r.skipHidden&&t["!cols"]||[],w=r.skipHidden&&t["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(_[E]||{}).hidden||(y[E]=Fn(E));for(var S=0,C=a.s.r;C<=a.e.r;++C)(w[C]||{}).hidden||(g=hV(t,a,C,y,l,d,i,r),g!=null&&(r.strip&&(g=g.replace(f,"")),(g||r.blankrows!==!1)&&n.push((S++?c:"")+g)));return delete r.dense,n.join("")}function mV(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=RE(t,e);return n}function pV(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var a=gn(t["!ref"]),i="",l=[],c,d=[],f=Array.isArray(t);for(c=a.s.c;c<=a.e.c;++c)l[c]=Fn(c);for(var g=a.s.r;g<=a.e.r;++g)for(i=Kn(g),c=a.s.c;c<=a.e.c;++c)if(e=l[c]+i,n=f?(t[g]||[])[c]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}d[d.length]=e+"="+r}return d}function DE(t,e,n){var r=n||{},a=+!r.skipHeader,i=t||{},l=0,c=0;if(i&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?mr(r.origin):r.origin;l=d.r,c=d.c}var f,g={s:{c:0,r:0},e:{c,r:l+e.length-1+a}};if(i["!ref"]){var y=gn(i["!ref"]);g.e.c=Math.max(g.e.c,y.e.c),g.e.r=Math.max(g.e.r,y.e.r),l==-1&&(l=y.e.r+1,g.e.r=l+e.length-1+a)}else l==-1&&(l=0,g.e.r=e.length-1+a);var _=r.header||[],w=0;e.forEach(function(S,C){Ua(S).forEach(function(R){(w=_.indexOf(R))==-1&&(_[w=_.length]=R);var k=S[R],b="z",O="",U=ot({c:c+w,r:l+C+a});f=Kc(i,U),k&&typeof k=="object"&&!(k instanceof Date)?i[U]=k:(typeof k=="number"?b="n":typeof k=="boolean"?b="b":typeof k=="string"?b="s":k instanceof Date?(b="d",r.cellDates||(b="n",k=xr(k)),O=r.dateNF||ut[14]):k===null&&r.nullError&&(b="e",k=0),f?(f.t=b,f.v=k,delete f.w,delete f.R,O&&(f.z=O)):i[U]=f={t:b,v:k},O&&(f.z=O))})}),g.e.c=Math.max(g.e.c,c+_.length-1);var E=Kn(l);if(a)for(w=0;w<_.length;++w)i[Fn(w+c)+E]={t:"s",v:_[w]};return i["!ref"]=It(g),i}function gV(t,e){return DE(null,t,e)}function Kc(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=mr(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Kc(t,ot(e)):Kc(t,ot({r:e,c:n||0}))}function xV(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Ap(){return{SheetNames:[],Sheets:{}}}function kp(t,e,n,r){var a=1;if(!n)for(;a<=65535&&t.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var l=i&&i[1]||n;for(++a;a<=65535&&t.SheetNames.indexOf(n=l+a)!=-1;++a);}if(tj(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function vV(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=xV(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function yV(t,e){return t.z=e,t}function ME(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function _V(t,e,n){return ME(t,"#"+e,n)}function TV(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function wV(t,e,n,r){for(var a=typeof e!="string"?e:gn(e),i=typeof e=="string"?e:It(e),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var d=Kc(t,l,c);d.t="n",d.F=i,delete d.v,l==a.s.r&&c==a.s.c&&(d.f=n,r&&(d.D=!0))}return t}var EV={encode_col:Fn,encode_row:Kn,encode_cell:ot,encode_range:It,decode_col:hp,decode_row:dp,split_cell:FO,decode_cell:mr,decode_range:dl,format_cell:us,sheet_add_aoa:Lw,sheet_add_json:DE,sheet_add_dom:bE,aoa_to_sheet:hl,json_to_sheet:gV,table_to_sheet:AE,table_to_book:Bj,sheet_to_csv:RE,sheet_to_txt:mV,sheet_to_json:Fm,sheet_to_html:Uj,sheet_to_formulae:pV,sheet_to_row_object_array:Fm,sheet_get_cell:Kc,book_new:Ap,book_append_sheet:kp,book_set_sheet_visibility:vV,cell_set_number_format:yV,cell_set_hyperlink:ME,cell_set_internal_link:_V,cell_add_comment:TV,sheet_set_array_formula:wV,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const IE=({matrixData:t,onUpdate:e})=>{const n=(d,f)=>e({...t,headers:t.headers.map((g,y)=>y===d?f:g)}),r=(d,f,g)=>e({...t,rows:t.rows.map((y,_)=>_===d?y.map((w,E)=>E===f?g:w):y)}),a=()=>e({...t,rows:[...t.rows,Array(t.headers.length).fill("")]}),i=d=>e({...t,rows:t.rows.filter((f,g)=>g!==d)}),l=()=>{const d=`列 ${t.headers.length+1}`;e({headers:[...t.headers,d],rows:t.rows.map(f=>[...f,""])})},c=d=>{t.headers.length<=1||e({headers:t.headers.filter((f,g)=>g!==d),rows:t.rows.map(f=>f.filter((g,y)=>y!==d))})};return x.jsxs("div",{className:"overflow-x-auto p-1 bg-slate-50 rounded-md border",children:[x.jsxs("table",{className:"w-full text-xs border-collapse",children:[x.jsx("thead",{children:x.jsxs("tr",{className:"bg-slate-200",children:[t.headers.map((d,f)=>x.jsx("th",{className:"border border-slate-300 p-0 font-semibold text-slate-700",children:x.jsxs("div",{className:"flex items-center justify-between gap-1 px-1",children:[x.jsx("input",{type:"text",value:d,onChange:g=>n(f,g.target.value),className:"w-full bg-transparent outline-none text-center font-semibold text-slate-800"}),x.jsx("button",{onClick:()=>c(f),className:"text-red-500 hover:text-red-700 opacity-30 hover:opacity-100",title:"列を削除",children:x.jsx(Pa,{className:"w-3 h-3"})})]})},f)),x.jsx("th",{className:"border border-slate-300 p-1 w-10"})]})}),x.jsx("tbody",{children:t.rows.map((d,f)=>x.jsxs("tr",{children:[d.map((g,y)=>x.jsx("td",{className:"border border-slate-300 p-0",children:x.jsx("input",{type:"text",value:g,onChange:_=>r(f,y,_.target.value),className:"w-full bg-white text-slate-900 outline-none p-1 focus:bg-blue-50"})},y)),x.jsx("td",{className:"border border-slate-300 p-1 text-center",children:x.jsx("button",{onClick:()=>i(f),className:"text-red-500 hover:text-red-700",title:"行を削除",children:x.jsx(Pa,{className:"w-3 h-3"})})})]},f))})]}),x.jsxs("div",{className:"flex gap-2 mt-2",children:[x.jsxs("button",{onClick:a,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[x.jsx(nl,{className:"w-3 h-3"}),"行を追加"]}),x.jsxs("button",{onClick:l,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[x.jsx(nl,{className:"w-3 h-3"}),"列を追加"]})]})]})},FT=t=>{const e=Math.cos(2*Math.PI*t),n=Math.sin(2*Math.PI*t);return[e,n]},SV=({data:t,title:e})=>{const n=t.reduce((l,c)=>l+c.value,0);if(n===0)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"});let r=0;const a=["#4A90E2","#50E3C2","#F5A623","#F8E71C","#7ED321","#9013FE","#BD10E0","#4A4A4A"],i=t.map((l,c)=>{const d=l.value/n,[f,g]=FT(r);r+=d;const[y,_]=FT(r),w=d>.5?1:0;return{path:`M ${f} ${g} A 1 1 0 ${w} 1 ${y} ${_} L 0 0`,color:a[c%a.length],label:l.label,value:l.value}});return x.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"font-bold text-sm mb-2",children:e}),x.jsx("svg",{viewBox:"-1.2 -1.2 2.4 2.4",className:"w-32 h-32 mb-2",children:i.map((l,c)=>x.jsx("path",{d:l.path,fill:l.color},c))}),x.jsx("div",{className:"text-[10px] space-y-0.5 w-full",children:i.map((l,c)=>x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:l.color}}),x.jsx("span",{children:l.label})]}),x.jsxs("span",{children:[l.value," (",(l.value/n*100).toFixed(1),"%)"]})]},c))})]})},CV=({data:t,title:e})=>{if(t.length<2)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"Need at least 2 data points for a line chart."});const n=Math.max(...t.map(r=>r.value),0);return x.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:e}),x.jsxs("svg",{viewBox:"0 0 100 50",className:"w-full h-40",children:[[0,.25,.5,.75,1].map(r=>x.jsx("line",{x1:"0",y1:50-r*45,x2:"100",y2:50-r*45,stroke:"#f0f0f0",strokeWidth:"0.5"},r)),x.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1",points:t.map((r,a)=>`${a/(t.length-1)*100},${50-r.value/n*45}`).join(" ")}),t.map((r,a)=>x.jsx("circle",{cx:`${a/(t.length-1)*100}`,cy:`${50-r.value/n*45}`,r:"1.5",fill:"#4a90e2"},a))]})]})},bV=({data:t,title:e})=>{const n=Math.max(...t.map(r=>r.value),0);return n===0?x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"}):x.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:e}),x.jsx("div",{className:"space-y-1",children:t.map(r=>x.jsxs("div",{className:"flex items-center text-xs",children:[x.jsx("div",{className:"w-24 truncate pr-2 text-right text-slate-600",children:r.label}),x.jsx("div",{className:"flex-grow bg-slate-200 rounded-full h-4",children:x.jsx("div",{className:"bg-blue-500 h-4 rounded-full text-white text-right pr-1",style:{width:`${r.value/n*100}%`},children:x.jsx("span",{className:"text-[10px]",children:r.value})})})]},r.label))})]})},AV=({actionItem:t,onSave:e,onClose:n,generateUniqueId:r})=>{var R;const[a,i]=ce.useState(t.report||{notes:"",attachments:[],matrixData:null}),[l,c]=ce.useState("bar"),d=ce.useRef(null),f=ce.useRef(null),g=k=>{i(b=>({...b,...k}))},y=()=>{e({...t,report:a})},_=k=>{var F;const b=(F=k.target.files)==null?void 0:F[0];if(!b)return;const O=5,U=O*1024*1024;if(b.size>U){alert(`ファイルサイズが大きすぎます。${O}MB未満のファイルを選択してください。`),k.target&&(k.target.value="");return}const j=new FileReader;j.onload=K=>{var P;if(typeof((P=K.target)==null?void 0:P.result)=="string"){const ne={id:r("attach"),name:b.name,type:b.type,dataUrl:K.target.result};g({attachments:[...a.attachments||[],ne]})}else alert("ファイルの読み込みに失敗しました。")},j.onerror=()=>{alert("ファイルの読み込み中にエラーが発生しました。")},j.readAsDataURL(b),k.target&&(k.target.value="")},w=k=>{var b;g({attachments:(b=a.attachments)==null?void 0:b.filter(O=>O.id!==k)})},E=k=>{var U;const b=(U=k.target.files)==null?void 0:U[0];if(!b)return;const O=new FileReader;O.onload=j=>{var F;try{const K=(F=j.target)==null?void 0:F.result,P=Im(K,{type:"array"}),ne=P.SheetNames[0],Q=P.Sheets[ne],te=EV.sheet_to_json(Q,{header:1});if(!Array.isArray(te)||te.length===0){alert("Excelファイルが空か、有効なデータが含まれていません。"),k.target&&(k.target.value="");return}const _e=te[0];if(!Array.isArray(_e)){alert("Excelファイルのヘッダー行が読み取れませんでした。"),k.target&&(k.target.value="");return}const Le=_e.map(String),Te=te.slice(1),ae=[];for(const ue of Te)if(Array.isArray(ue)){const re=Array(Le.length).fill("");for(let W=0;W<Le.length;W++)re[W]=ue[W]!==null&&ue[W]!==void 0?String(ue[W]):"";ae.push(re)}g({matrixData:{headers:Le,rows:ae}})}catch(K){console.error("Error parsing Excel file:",K),alert(`Excelファイルの解析中にエラーが発生しました: ${K instanceof Error?K.message:"Unknown error"}`)}finally{k.target&&(k.target.value="")}},O.readAsArrayBuffer(b)},S=(((R=a.matrixData)==null?void 0:R.rows)||[]).map(k=>({label:k[0],value:parseFloat(k[1])||0})).filter(k=>k.label&&!isNaN(k.value)),C=()=>{if(!a.matrixData||S.length===0)return null;switch(l){case"line":return x.jsx(CV,{data:S,title:"データチャート"});case"pie":return x.jsx(SV,{data:S,title:"データチャート"});case"bar":default:return x.jsx(bV,{data:S,title:"データチャート"})}};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[70]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"実施レポート"}),x.jsx("p",{className:"text-sm text-slate-500",children:t.text})]}),x.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Vr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-5 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"text-sm font-semibold text-slate-700",children:"実施内容・メモ"}),x.jsx("textarea",{value:a.notes,onChange:k=>g({notes:k.target.value}),className:"w-full mt-1 p-2 border rounded-md h-32 bg-slate-50 focus:bg-white text-slate-800",placeholder:"実施した内容、結果、考察などを記録..."})]}),x.jsxs("div",{children:[x.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center mb-2",children:["添付ファイル",x.jsx("button",{onClick:()=>{var k;return(k=d.current)==null?void 0:k.click()},className:"p-1 hover:bg-slate-200 rounded-full",children:x.jsx(Ys,{className:"w-5 h-5"})}),x.jsx("input",{type:"file",ref:d,onChange:_,className:"hidden",multiple:!1})]}),x.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-48 overflow-y-auto border p-2 rounded-md bg-slate-50",children:(a.attachments||[]).map(k=>x.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-24",children:[x.jsx("a",{href:k.dataUrl,download:k.name,className:"block w-full h-full","aria-label":`Download ${k.name}`,children:k.type.startsWith("image/")?x.jsx("img",{src:k.dataUrl,alt:k.name,className:"w-full h-full object-cover"}):x.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-2 hover:bg-slate-200",children:x.jsx(Ys,{className:"w-8 h-8 text-slate-500"})})}),x.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:x.jsx("p",{className:"text-white text-[10px] truncate",title:k.name,children:k.name})}),x.jsx("button",{onClick:()=>w(k.id),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:x.jsx(Pa,{className:"w-3 h-3"})})]},k.id))})]})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center",children:["データ・マトリクス",x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>{var k;return(k=f.current)==null?void 0:k.click()},className:"p-1 hover:bg-slate-200 rounded-full",title:"Excelからインポート",children:x.jsx(P2,{className:"w-5 h-5 text-green-600"})}),x.jsx("input",{type:"file",ref:f,onChange:E,className:"hidden",accept:".xlsx, .xls, .csv"}),a.matrixData&&S.length>0&&x.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-200 p-0.5",children:[x.jsx("button",{onClick:()=>c("bar"),className:`px-2 py-0.5 rounded-full text-xs ${l==="bar"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Bar"}),x.jsx("button",{onClick:()=>c("line"),className:`px-2 py-0.5 rounded-full text-xs ${l==="line"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Line"}),x.jsx("button",{onClick:()=>c("pie"),className:`px-2 py-0.5 rounded-full text-xs ${l==="pie"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Pie"})]}),x.jsx("button",{onClick:()=>g({matrixData:a.matrixData?null:{headers:["項目","値"],rows:[["",""]]}}),className:"p-1 hover:bg-slate-200 rounded-full",title:a.matrixData?"マトリクスを削除":"マトリクスを追加",children:a.matrixData?x.jsx(Pa,{className:"w-5 h-5 text-red-500"}):x.jsx(tu,{className:"w-5 h-5"})})]})]}),a.matrixData?x.jsx(IE,{matrixData:a.matrixData,onUpdate:k=>g({matrixData:k})}):null,x.jsx("div",{className:"mt-4",children:C()})]})]}),x.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[x.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:"キャンセル"}),x.jsx("button",{onClick:y,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"保存して閉じる"})]})]})})},Jh=({value:t,onChange:e,placeholder:n})=>x.jsx("textarea",{value:t,onChange:r=>e(r.target.value),placeholder:n,rows:3,className:"w-full h-full text-sm bg-transparent outline-none p-2 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-blue-50 resize-none text-slate-800 placeholder-slate-400"}),kV=({isOpen:t,onClose:e,onSave:n,task:r,generateUniqueId:a})=>{var F;const[i,l]=ce.useState([]),[c,d]=ce.useState(!1),[f,g]=ce.useState(null),[y,_]=ce.useState({key:"status",direction:"ascending"});ce.useEffect(()=>{var K;t&&l(((K=r.extendedDetails)==null?void 0:K.decisions)||[])},[t,(F=r.extendedDetails)==null?void 0:F.decisions]);const w=ce.useMemo(()=>{let K=[...i];return y!==null&&K.sort((P,ne)=>{let Q="",te="";switch(y.key){case"status":Q=P.status==="undecided"?0:1,te=ne.status==="undecided"?0:1;break;case"date":Q=P.date||"9999-12-31",te=ne.date||"9999-12-31";break;default:Q=(P[y.key]||"").toLowerCase(),te=(ne[y.key]||"").toLowerCase()}return Q<te?y.direction==="ascending"?-1:1:Q>te?y.direction==="ascending"?1:-1:0}),K},[i,y]),E=K=>{let P="ascending";y&&y.key===K&&y.direction==="ascending"&&(P="descending"),_({key:K,direction:P})},S=K=>!y||y.key!==K?x.jsx(Mi,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):y.direction==="ascending"?x.jsx(Bc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Mi,{className:"w-3 h-3 ml-1 text-blue-600"}),C=({sortKey:K,label:P,className:ne})=>x.jsx("th",{className:`p-0 border border-slate-300 ${ne||""}`,children:x.jsxs("button",{onClick:()=>E(K),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[x.jsx("span",{children:P}),S(K)]})}),R=async()=>{d(!0),g(null);try{const P=(await HM(r,i)).map(ne=>ne.id==="NEW"?{...ne,id:a("dec_ai")}:ne);l(P)}catch(K){g(K instanceof Error?K.message:"決定事項の抽出に失敗しました。")}finally{d(!1)}},k=(K,P)=>{l(ne=>ne.map(Q=>Q.id===K?{...Q,...P}:Q))},b=(K,P)=>{const ne=i.find(te=>te.id===K);if(!ne)return;const Q={status:P};P==="decided"&&!ne.date?Q.date=new Date().toISOString().split("T")[0]:P==="undecided"&&(Q.date=void 0),k(K,Q)},O=K=>{l(P=>P.filter(ne=>ne.id!==K))},U=()=>{const K={id:a("dec_manual"),question:"",status:"undecided"};l(P=>[K,...P])},j=()=>{n(i)};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[50]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"決定事項の管理"}),x.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[x.jsxs("button",{onClick:R,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-cyan-600 rounded-md hover:bg-cyan-700 disabled:bg-slate-400",children:[c?x.jsx(Ar,{size:"sm",color:"border-white"}):x.jsx(nu,{className:"w-5 h-5"}),x.jsx("span",{children:"AIでリストを更新"})]}),x.jsxs("button",{onClick:U,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300 disabled:bg-slate-400",children:[x.jsx(Km,{className:"w-5 h-5"}),x.jsx("span",{children:"手動で追加"})]}),x.jsx("button",{onClick:e,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(Vr,{className:"w-6 h-6 text-slate-500"})})]})]}),f&&x.jsx("div",{className:"p-4",children:x.jsx(ul,{message:f})}),x.jsx("main",{className:"flex-grow p-4 overflow-auto",children:x.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx(C,{sortKey:"status",label:"ステータス",className:"w-32"}),x.jsx(C,{sortKey:"question",label:"決定すべき項目 (Question)",className:"w-[25%]"}),x.jsx(C,{sortKey:"decision",label:"決定した内容 (Decision)",className:"w-[25%]"}),x.jsx(C,{sortKey:"reasoning",label:"理由/重要性",className:"w-[25%]"}),x.jsx(C,{sortKey:"date",label:"日付",className:"w-36"}),x.jsx("th",{className:"p-2 border border-slate-300 w-16",children:"アクション"})]})}),x.jsxs("tbody",{children:[w.map(K=>x.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"border border-slate-300 align-top p-2",children:x.jsxs("select",{value:K.status,onChange:P=>b(K.id,P.target.value),className:`w-full p-2 rounded-md font-semibold text-xs border ${K.status==="decided"?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:[x.jsx("option",{value:"undecided",children:"未決定"}),x.jsx("option",{value:"decided",children:"決定済み"})]})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(Jh,{value:K.question||"",onChange:P=>k(K.id,{question:P}),placeholder:"例：どのクラウドプロバイダーを利用するか？"})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(Jh,{value:K.decision||"",onChange:P=>k(K.id,{decision:P}),placeholder:"決定内容..."})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(Jh,{value:K.reasoning||"",onChange:P=>k(K.id,{reasoning:P}),placeholder:"理由や背景..."})}),x.jsx("td",{className:"border border-slate-300 align-top p-2",children:x.jsx("input",{type:"date",value:K.date||"",onChange:P=>k(K.id,{date:P.target.value}),className:"w-full bg-transparent border-b border-dotted border-slate-400 outline-none p-1 text-xs text-slate-600 focus:border-solid focus:border-blue-500 disabled:border-none disabled:bg-slate-100",disabled:K.status==="undecided"})}),x.jsx("td",{className:"border border-slate-300 text-center align-middle",children:x.jsx("button",{onClick:()=>O(K.id),className:"text-red-400 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors",title:"この項目を削除",children:x.jsx(Pa,{className:"w-5 h-5"})})})]},K.id)),i.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:6,className:"text-center py-12 text-slate-500 bg-white border border-slate-300",children:"決定事項はありません。「手動で追加」するか、「AIでリストを更新」してください。"})})]})]})}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:[x.jsx("button",{onClick:e,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:"キャンセル"}),x.jsx("button",{onClick:j,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"変更を保存"})]})]})}):null},OT=({items:t,taskName:e,onClose:n})=>{var g;const[r,a]=ce.useState(null),i=ce.useMemo(()=>new Set(t.map(y=>y.subStep.id)).size<=1,[t]),l=ce.useMemo(()=>{let y=[...t];return r!==null&&y.sort((_,w)=>{let E="",S="";switch(r.key){case"status":E=_.actionItem.completed,S=w.actionItem.completed;break;case"dueDate":E=_.actionItem.dueDate||"9999-12-31",S=w.actionItem.dueDate||"9999-12-31";break;case"completedDate":E=_.actionItem.completedDate||"9999-12-31",S=w.actionItem.completedDate||"9999-12-31";break;case"text":E=(_.actionItem.text||"").toLowerCase(),S=(w.actionItem.text||"").toLowerCase();break;case"subStep":E=(_.subStep.text||"").toLowerCase(),S=(w.subStep.text||"").toLowerCase();break;case"responsible":E=(_.actionItem.responsible||"").toLowerCase(),S=(w.actionItem.responsible||"").toLowerCase();break}return E<S?r.direction==="ascending"?-1:1:E>S?r.direction==="ascending"?1:-1:0}),y},[t,r]),c=y=>{let _="ascending";r&&r.key===y&&r.direction==="ascending"&&(_="descending"),a({key:y,direction:_})},d=y=>!r||r.key!==y?x.jsx(Mi,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):r.direction==="ascending"?x.jsx(Bc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Mi,{className:"w-3 h-3 ml-1 text-blue-600"}),f=({sortKey:y,label:_,className:w})=>x.jsx("th",{scope:"col",className:`p-0 ${w||""}`,children:x.jsxs("button",{onClick:()=>c(y),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[x.jsx("span",{children:_}),d(y)]})});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"アクションアイテム一覧"}),x.jsx("p",{className:"text-sm text-slate-500",children:i?`タスク: ${e} / サブステップ: ${((g=t[0])==null?void 0:g.subStep.text)||""}`:`タスク: ${e}`})]}),x.jsx("button",{onClick:n,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(Vr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsx("main",{className:"flex-grow p-4 overflow-auto",children:x.jsxs("table",{className:"w-full border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx(f,{sortKey:"status",label:"状態",className:"w-28 border border-slate-300"}),x.jsx(f,{sortKey:"text",label:"アクションアイテム",className:"w-2/5 border border-slate-300"}),!i&&x.jsx(f,{sortKey:"subStep",label:"所属サブステップ",className:"w-1/5 border border-slate-300"}),x.jsx(f,{sortKey:"responsible",label:"担当者",className:"w-40 border border-slate-300"}),x.jsx(f,{sortKey:"dueDate",label:"期日",className:"w-40 border border-slate-300"}),x.jsx(f,{sortKey:"completedDate",label:"完了日",className:"w-40 border border-slate-300"})]})}),x.jsxs("tbody",{className:"bg-white",children:[l.map(({actionItem:y,subStep:_})=>{var w;return x.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"p-2 border border-slate-300 align-top text-center",children:y.completed?x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[x.jsx(eu,{className:"w-4 h-4 mr-1"}),"完了"]}):x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[x.jsx(md,{className:"w-4 h-4 mr-1"}),"未完了"]})}),x.jsxs("td",{className:"p-2 border border-slate-300 align-top font-medium text-slate-800",children:[y.text,y.report&&Array.isArray(y.report.attachments)&&y.report.attachments.length>0&&x.jsx("div",{className:"mt-2 pt-2 border-t border-slate-200 space-y-1",children:y.report.attachments.map(E=>x.jsxs("a",{href:E.dataUrl,target:"_blank",rel:"noopener noreferrer",download:E.name,className:"flex items-center gap-1.5 text-xs text-blue-600 hover:underline",children:[x.jsx(Ys,{className:"w-3.5 h-3.5"}),x.jsx("span",{children:E.name})]},E.id))}),((w=y.report)==null?void 0:w.notes)&&x.jsx("p",{className:"text-xs text-slate-500 mt-1 pt-1 border-t border-slate-200 whitespace-pre-wrap",children:y.report.notes})]}),!i&&x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:_.text}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:y.responsible||""}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:y.dueDate||""}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:y.completedDate||""})]},y.id)}),t.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:i?5:6,className:"text-center py-10 text-slate-500",children:"アクションアイテムはありません。"})})]})]})}),x.jsx("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:x.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"閉じる"})})]})})},NV=({task:t,isOpen:e,onClose:n,onReportGenerated:r})=>{const[a,i]=ce.useState(""),[l,c]=ce.useState(new Set),[d,f]=ce.useState(!1),[g,y]=ce.useState(null),_=ce.useMemo(()=>{var b,O,U,j;const k=[];return k.push({id:`task-data-${t.id}`,name:`基本タスク情報: ${t.title}`,type:"Task Data",source:{name:`タスクデータ: ${t.title}`,type:"json",content:t}}),(O=(b=t.extendedDetails)==null?void 0:b.attachments)==null||O.forEach(F=>{k.push({id:F.id,name:`添付: ${F.name}`,type:"Attachment",source:{name:F.name,type:F.type.startsWith("image/")?"image":"text",content:F.dataUrl}})}),(j=(U=t.extendedDetails)==null?void 0:U.subSteps)==null||j.forEach(F=>{var K;(K=F.actionItems)==null||K.forEach(P=>{var ne,Q,te;(ne=P.report)!=null&&ne.matrixData&&k.push({id:`matrix-${P.id}`,name:`データ: ${P.text} (${F.text})`,type:"Data Matrix",source:{name:`データマトリクス: ${P.text}`,type:"json",content:P.report.matrixData}}),(te=(Q=P.report)==null?void 0:Q.attachments)==null||te.forEach(_e=>{k.push({id:_e.id,name:`添付: ${_e.name} (${P.text})`,type:"Attachment",source:{name:_e.name,type:_e.type.startsWith("image/")?"image":"text",content:_e.dataUrl}})})})}),k},[t]),w=ce.useMemo(()=>_.find(k=>k.type==="Task Data"),[_]),E=ce.useMemo(()=>_.filter(k=>k.type!=="Task Data"),[_]);ce.useEffect(()=>{if(e){const k=new Set;w&&k.add(w.id),c(k)}},[e,w]);const S=k=>{const b=_.find(O=>O.id===k);(b==null?void 0:b.type)!=="Task Data"&&c(O=>{const U=new Set(O);return U.has(k)?U.delete(k):U.add(k),U})},C=async()=>{if(!a.trim()){y("レポート作成の目的を入力してください。");return}if(l.size===0){y("少なくとも1つの資料を選択してください。");return}f(!0),y(null);try{const k=_.filter(O=>l.has(O.id)).map(O=>O.source),b=await g2(k,a);r(b)}catch(k){y(k instanceof Error?k.message:"レポートの生成中にエラーが発生しました。")}finally{f(!1)}};if(!e)return null;const R=k=>{switch(k){case"Task Data":return x.jsx(Di,{className:"w-5 h-5 text-blue-600"});case"Attachment":return x.jsx(Ys,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return x.jsx(tu,{className:"w-5 h-5 text-purple-600"});default:return x.jsx(Di,{className:"w-5 h-5 text-slate-500"})}};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"カスタムレポート作成"}),x.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Vr,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-8",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"1. 資料の選択"}),x.jsxs("div",{className:"mb-4",children:[x.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:"常に使用される情報:"}),x.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md bg-slate-200",children:[x.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"w-4 h-4 accent-blue-600"}),w&&R(w.type),x.jsx("span",{className:"text-sm text-slate-800 font-medium truncate",title:w==null?void 0:w.name,children:w==null?void 0:w.name})]})]}),E.length>0&&x.jsxs(x.Fragment,{children:[x.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:"追加の資料 (任意):"}),x.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-80 overflow-y-auto space-y-2",children:E.map(k=>x.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-slate-100 cursor-pointer",children:[x.jsx("input",{type:"checkbox",checked:l.has(k.id),onChange:()=>S(k.id),className:"w-4 h-4 accent-blue-600"}),R(k.type),x.jsx("span",{className:"text-sm text-slate-700 truncate",title:k.name,children:k.name})]},k.id))})]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"2. レポート作成の指示"}),x.jsx("textarea",{value:a,onChange:k=>i(k.target.value),placeholder:"例：選択した資料を基に、プロジェクトの技術的な課題とそれに対する解決策をまとめたスライドを作成してください。",rows:8,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),g&&x.jsx("div",{className:"mt-2",children:x.jsx(ul,{message:g})})]})]}),x.jsxs("footer",{className:"flex-shrink-0 p-5 bg-slate-100 border-t flex justify-end items-center gap-4",children:[x.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:"キャンセル"}),x.jsxs("button",{onClick:C,disabled:d,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[d?x.jsx(Ar,{size:"sm",color:"border-white"}):x.jsx(nu,{className:"w-5 h-5"}),x.jsx("span",{children:d?"生成中...":"レポートを生成"})]})]})]})})},Da=({label:t,name:e,value:n,onChange:r,type:a="text",placeholder:i,rows:l,disabled:c=!1,icon:d,required:f=!1})=>x.jsxs("div",{className:"mb-4",children:[x.jsxs("label",{htmlFor:e,className:"block text-sm font-medium text-slate-700 mb-1 flex items-center",children:[d&&x.jsx("span",{className:"mr-1.5 text-slate-500 w-4 h-4",children:d}),t,f&&x.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),a==="textarea"?x.jsx("textarea",{id:e,name:e,value:n,onChange:r,rows:l||3,placeholder:i,disabled:c,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"}):x.jsx("input",{type:a,id:e,name:e,value:n,onChange:r,placeholder:i,disabled:c,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"})]}),RV=ls.memo(({subStep:t,onRemove:e,onDragStart:n,onClick:r,cardRef:a,isSelected:i,onStartConnection:l,onEndConnection:c})=>{var g,y;const d=_=>{switch(_){case fr.COMPLETED:return"border-l-4 border-green-500";case fr.IN_PROGRESS:return"border-l-4 border-blue-500";default:return"border-l-4 border-slate-300"}},f=_=>{_.stopPropagation(),l(t.id,_)};return x.jsxs("div",{ref:a,draggable:!0,onDragStart:_=>n(_,t.id),onClick:r,onMouseUp:_=>{_.stopPropagation(),c(t.id)},className:`substep-card absolute p-2.5 rounded-lg shadow-sm cursor-grab active:cursor-grabbing bg-white border w-56 h-auto min-h-[100px] text-xs flex flex-col hover:shadow-md transition-all duration-200 ${i?"ring-2 ring-blue-500 shadow-lg":"border-slate-300"} ${d(t.status)}`,style:{left:((g=t.position)==null?void 0:g.x)||0,top:((y=t.position)==null?void 0:y.y)||0,touchAction:"none"},children:[x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between items-start text-slate-400 mb-1",children:[x.jsxs("span",{className:"font-mono text-[10px] select-none",children:["ID: ...",t.id.slice(-4)]}),x.jsx("button",{onClick:_=>{_.stopPropagation(),e()},className:"text-red-400 hover:text-red-600 p-0.5",title:"サブステップ削除",children:x.jsx(Pa,{className:"w-3.5 h-3.5"})})]}),x.jsx("p",{className:`mb-1 break-words font-semibold text-slate-800 ${t.status===fr.COMPLETED?"line-through text-slate-500":""}`,children:t.text||"クリックして編集"})]}),x.jsx("div",{className:"flex-grow my-1 border-t pt-1 min-h-0",children:x.jsx("div",{className:"text-[10px] text-slate-600 space-y-1 h-full max-h-20 overflow-y-auto pr-1",children:(t.actionItems||[]).length>0?(t.actionItems||[]).map(_=>x.jsxs("div",{className:`flex justify-between items-center ${_.completed?"text-slate-400 line-through":""}`,children:[x.jsx("span",{className:"truncate pr-1",title:_.text,children:_.text}),_.dueDate&&x.jsx("span",{className:"flex-shrink-0 text-slate-500",children:new Date(_.dueDate+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"numeric",day:"numeric"})})]},_.id)):x.jsx("div",{className:"text-center text-slate-400 pt-2",children:"アクションなし"})})}),x.jsx("div",{className:"mt-auto",children:t.dueDate&&x.jsxs("div",{className:"text-[11px] text-orange-600 font-medium flex items-center justify-end",children:[x.jsx(Zm,{className:"w-3 h-3 mr-1"}),"期日: ",new Date(t.dueDate+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"2-digit",month:"numeric",day:"numeric"})]})}),x.jsx("div",{onMouseDown:f,className:"absolute right-[-5px] top-1/2 -translate-y-1/2 w-3 h-3 bg-blue-500 rounded-full cursor-crosshair hover:scale-125 transition-transform",title:"ドラッグして接続"})]})}),DV=ls.memo(({items:t,onToggle:e,onAdd:n,onUpdate:r,onRemove:a,onOpenReport:i,onOpenTable:l})=>x.jsxs("div",{className:"space-y-2 mt-2",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("h6",{className:"text-sm font-semibold text-slate-600",children:"アクションアイテム"}),x.jsx("button",{onClick:l,className:"p-1 rounded-full hover:bg-slate-200",title:"表形式で表示",children:x.jsx(tu,{className:"w-5 h-5 text-slate-500"})})]}),x.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-2",children:t.map(c=>x.jsxs("div",{className:"group bg-slate-50 p-2 rounded-md transition-all border border-transparent hover:border-slate-200",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>e(c.id),className:"flex-shrink-0",children:c.completed?x.jsx(eu,{className:"w-5 h-5 text-green-600"}):x.jsx(md,{className:"w-5 h-5 text-slate-400"})}),x.jsx("div",{className:"flex-grow",onDoubleClick:()=>i(c),children:x.jsx("input",{type:"text",value:c.text,onChange:d=>r(c.id,{text:d.target.value}),placeholder:"アクションアイテム名",className:`w-full text-sm bg-transparent outline-none p-1 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-white ${c.completed?"line-through text-slate-500":"text-slate-800"}`})}),x.jsx("button",{onClick:()=>a(c.id),className:"ml-2 text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:x.jsx(Pa,{className:"w-4 h-4"})})]}),x.jsxs("div",{className:"pl-7 pt-1.5 flex justify-end items-center gap-4 text-xs text-slate-500",children:[c.completed&&c.completedDate?x.jsxs("span",{className:"text-xs text-green-600 font-medium flex items-center mr-auto",children:[x.jsx(hd,{className:"w-4 h-4 mr-1"}),"完了日: ",new Date(c.completedDate+"T00:00:00Z").toLocaleDateString("ja-JP")]}):x.jsx("div",{className:"mr-auto"}),x.jsxs("div",{className:"flex items-center",children:[x.jsx("label",{htmlFor:`responsible-${c.id}`,className:"mr-1 flex items-center",title:"担当者",children:x.jsx(U2,{className:"w-4 h-4"})}),x.jsx("input",{type:"text",id:`responsible-${c.id}`,value:c.responsible||"",onChange:d=>r(c.id,{responsible:d.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-24 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",placeholder:"担当者",disabled:c.completed})]}),x.jsxs("div",{className:"flex items-center",children:[x.jsx("label",{htmlFor:`due-date-${c.id}`,className:"mr-1",children:"期日:"}),x.jsx("input",{type:"date",id:`due-date-${c.id}`,value:c.dueDate||"",onChange:d=>r(c.id,{dueDate:d.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-28 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",style:{colorScheme:"light"},title:"期日",disabled:c.completed})]})]})]},c.id))}),x.jsxs("button",{onClick:n,className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[x.jsx(Km,{className:"w-4 h-4"}),"アイテムを追加"]})]})),MV=({task:t,onClose:e,onUpdateTaskCoreInfo:n,onUpdateExtendedDetails:r,generateUniqueId:a,projectGoal:i,targetDate:l})=>{var D,H,L,B,G,q,de,ve,le,me,pe,Ne,Pe,He,Oe;if(!t)return null;const[c,d]=ce.useState(t),[f,g]=ce.useState(t),[y,_]=ce.useState("none"),[w,E]=ce.useState(!1),[S,C]=ce.useState(!1),[R,k]=ce.useState(!1),[b,O]=ce.useState(!1),[U,j]=ce.useState(!1),[F,K]=ce.useState(null),[P,ne]=ce.useState(!1),[Q,te]=ce.useState(!1),[_e,Le]=ce.useState([]),[Te,ae]=ce.useState([]),[ue,re]=ce.useState(!1),[W,N]=ce.useState(null),[Z,M]=ce.useState([]),V=ce.useRef(null),[Y,z]=ce.useState(new Map),ie=ce.useRef(null),ye=ce.useRef({x:0,y:0}),[Ce,Re]=ce.useState(null),Ee=ce.useRef(null),Ke=ce.useRef(null),[J,xt]=ce.useState(null),[et,St]=ce.useState({x:0,y:0}),[st,Me]=ce.useState([]),jt=ce.useMemo(()=>JSON.stringify(f)!==JSON.stringify(c),[f,c]),nn=ce.useMemo(()=>{var we;const X=((we=c.extendedDetails)==null?void 0:we.decisions)||[];return{decided:X.filter(Ae=>Ae.status==="decided").length,undecided:X.filter(Ae=>Ae.status==="undecided").length}},[(D=c.extendedDetails)==null?void 0:D.decisions]);ce.useEffect(()=>{d(t),g(t),Le([]),ae([])},[t]),ce.useEffect(()=>{var we;const X=new Map;(((we=c.extendedDetails)==null?void 0:we.subSteps)||[]).forEach(Ae=>{Ae&&Ae.id&&X.set(Ae.id,Y.get(Ae.id)||ls.createRef())}),z(X)},[(H=c.extendedDetails)==null?void 0:H.subSteps]);const xn=ce.useCallback(()=>{var we;if(!V.current){Me([]);return}const X=[];(((we=c.extendedDetails)==null?void 0:we.subSteps)||[]).forEach(Ae=>{var Ve,$e;if((Ve=Ae==null?void 0:Ae.nextSubStepIds)!=null&&Ve.length){const ht=($e=Y.get(Ae.id))==null?void 0:$e.current;if(ht&&Ae.position){const Ot={x:Ae.position.x+ht.offsetWidth,y:Ae.position.y+ht.offsetHeight/2};Ae.nextSubStepIds.forEach(At=>{var Pt,qr;const Lt=(Pt=c.extendedDetails)==null?void 0:Pt.subSteps.find(dn=>dn.id===At),fn=(qr=Y.get(At))==null?void 0:qr.current;if(Lt&&fn&&Lt.position){const dn={x:Lt.position.x,y:Lt.position.y+fn.offsetHeight/2};X.push({id:`subconn-${Ae.id}-${At}`,from:Ot,to:dn,sourceId:Ae.id,targetId:At})}})}}}),Me(X)},[(L=c.extendedDetails)==null?void 0:L.subSteps,Y]);ce.useEffect(()=>{const X=setTimeout(xn,100);return()=>clearTimeout(X)},[xn]);const on=ce.useCallback(X=>{d(we=>(Le(Ae=>[...Ae,we]),ae([]),X(we)))},[]),lr=X=>{on(we=>({...we,...typeof X=="function"?X(we):X}))},Ct=X=>{lr(we=>({extendedDetails:{...we.extendedDetails,...typeof X=="function"?X(we.extendedDetails):X}}))},vn=()=>{if(_e.length===0)return;const X=_e[_e.length-1];Le(we=>we.slice(0,-1)),ae(we=>[c,...we]),d(X)},Nn=()=>{if(Te.length===0)return;const X=Te[0];ae(we=>we.slice(1)),Le(we=>[...we,c]),d(X)},Xt=async()=>{re(!0),N(null);try{const X=await VM(c);M(X),C(!0)}catch(X){N(X instanceof Error?X.message:"計画の提案生成に失敗しました。")}finally{re(!1)}},zt=X=>{Ct(we=>{const Ae=we.subSteps||[],Ve=Ae.length,$e=X.newSubSteps.map((Ot,At)=>({id:a("sub_ai"),text:Ot.title,notes:Ot.description,status:fr.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+(Ve+At)%4*210,y:Math.floor((Ve+At)/4)*90+10}}));return{subSteps:[...Ae.map(Ot=>{const At=X.newActionItems.filter(fn=>fn.targetSubStepId===Ot.id);if(At.length===0)return Ot;const Lt=At.map(fn=>({id:a("action_ai"),text:fn.title,completed:!1}));return{...Ot,actionItems:[...Ot.actionItems||[],...Lt]}}),...$e]}}),C(!1)},De=()=>{var Ae,Ve;const X=((Ve=(Ae=c.extendedDetails)==null?void 0:Ae.subSteps)==null?void 0:Ve.length)||0,we={id:a("sub_new"),text:"新しいステップ",status:fr.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+X%4*210,y:Math.floor(X/4)*90+10}};Ct($e=>({subSteps:[...$e.subSteps||[],we]})),Re(we.id)},Ie=ce.useCallback((X,we)=>{Ct(Ae=>({subSteps:(Ae.subSteps||[]).map(Ve=>Ve.id===X?{...Ve,...typeof we=="function"?we(Ve):we}:Ve)}))},[Ct]),Fe=ce.useCallback(X=>{Re(we=>we===X?null:we),Ct(we=>({subSteps:(we.subSteps||[]).filter(Ae=>Ae.id!==X).map(Ae=>{var Ve;return{...Ae,nextSubStepIds:(Ve=Ae.nextSubStepIds)==null?void 0:Ve.filter($e=>$e!==X)}})}))},[Ct]),je=()=>{var ti;const X=(ti=c.extendedDetails)==null?void 0:ti.subSteps,we=V.current;if(!X||X.length===0||!we)return;const Ae=new Map;X.forEach(qt=>{var Rn;const _t=(Rn=Y.get(qt.id))==null?void 0:Rn.current;Ae.set(qt.id,{width:(_t==null?void 0:_t.offsetWidth)||224,height:(_t==null?void 0:_t.offsetHeight)||100})});const Ve=new Map,$e=new Map;X.forEach(qt=>{Ve.set(qt.id,[]),$e.set(qt.id,0)}),X.forEach(qt=>{(qt.nextSubStepIds||[]).forEach(_t=>{Ve.has(_t)&&(Ve.get(qt.id).push(_t),$e.set(_t,$e.get(_t)+1))})});const ht=X.filter(qt=>$e.get(qt.id)===0).map(qt=>qt.id),Ot=[];let At=0;for(;ht.length>0;){const qt=ht.length,_t=[];for(let Rn=0;Rn<qt;Rn++){const ni=ht.shift();_t.push(ni),At++,(Ve.get(ni)||[]).forEach(ca=>{$e.set(ca,$e.get(ca)-1),$e.get(ca)===0&&ht.push(ca)})}Ot.push(_t)}if(At<X.length){const qt=new Set(Ot.flat()),_t=X.filter(Rn=>!qt.has(Rn.id)).map(Rn=>Rn.id);_t.length>0&&Ot.push(_t)}const Lt=we.clientWidth,fn=60,Pt=20,qr=new Map;let dn=10,ml=10,zi=0;Ot.forEach(qt=>{const Rn=Math.max(...qt.map(Nr=>Ae.get(Nr).width))+fn;let ni=qt.reduce((Nr,cu)=>Nr+Ae.get(cu).height+Pt,0)-(qt.length>0?Pt:0);dn>10&&dn+Rn>Lt&&(dn=10,ml+=zi+Pt*2,zi=0);let ca=0;qt.forEach(Nr=>{qr.set(Nr,{x:dn,y:ml+ca}),ca+=Ae.get(Nr).height+Pt}),dn+=Rn,zi=Math.max(zi,ni)});let ps=0,qi=0;qr.forEach((qt,_t)=>{const Rn=Ae.get(_t);ps=Math.max(ps,qt.x+Rn.width),qi=Math.max(qi,qt.y+Rn.height)}),Ct(qt=>({subSteps:(qt.subSteps||[]).map(_t=>({..._t,position:qr.get(_t.id)||_t.position})),subStepCanvasSize:{width:ps+20,height:qi+20}}))},ft=(X,we)=>{ie.current=we;const Ae=X.currentTarget.getBoundingClientRect();ye.current={x:X.clientX-Ae.left,y:X.clientY-Ae.top},X.dataTransfer.effectAllowed="move"},lt=X=>{X.preventDefault(),X.dataTransfer.dropEffect="move"},cn=X=>{var Lt;if(X.preventDefault(),!ie.current||!V.current)return;const we=V.current.getBoundingClientRect(),Ae=(Lt=Y.get(ie.current))==null?void 0:Lt.current;if(!Ae)return;const Ve=Ae.offsetWidth,$e=Ae.offsetHeight;let ht=X.clientX-we.left-ye.current.x+V.current.scrollLeft,Ot=X.clientY-we.top-ye.current.y+V.current.scrollTop;const At=V.current.querySelector(".substep-inner-canvas");At&&(ht=Math.max(0,Math.min(ht,At.scrollWidth-Ve)),Ot=Math.max(0,Math.min(Ot,At.scrollHeight-$e))),Ie(ie.current,{position:{x:ht,y:Ot}}),ie.current=null},Gn=X=>{K(X),k(!0)},vr=(X,we)=>{var Ot;const Ae=(Ot=X.target.files)==null?void 0:Ot[0];if(!Ae)return;const Ve=5,$e=Ve*1024*1024;if(Ae.size>$e){alert(`ファイルサイズが大きすぎます。${Ve}MB未満のファイルを選択してください。`),X.target&&(X.target.value="");return}const ht=new FileReader;ht.onload=At=>{var Lt;if(typeof((Lt=At.target)==null?void 0:Lt.result)=="string"){const fn={id:a("attach"),name:Ae.name,type:Ae.type,dataUrl:At.target.result};we==="task"?Ct(Pt=>({attachments:[...Pt.attachments||[],fn]})):we==="substep"&&Ce&&Ie(Ce,Pt=>({attachments:[...Pt.attachments||[],fn]}))}else alert("ファイルの読み込みに失敗しました。")},ht.onerror=()=>{alert("ファイルの読み込み中にエラーが発生しました。")},ht.readAsDataURL(Ae),X.target&&(X.target.value="")},yr=(X,we)=>{we==="task"?Ct(Ae=>{var Ve;return{attachments:(Ve=Ae.attachments)==null?void 0:Ve.filter($e=>$e.id!==X)}}):we==="substep"&&Ce&&Ie(Ce,Ae=>{var Ve;return{attachments:(Ve=Ae.attachments)==null?void 0:Ve.filter($e=>$e.id!==X)}})},Sa=(X,we)=>{if(!V.current)return;const Ae=V.current.getBoundingClientRect(),Ve={x:we.clientX-Ae.left+V.current.scrollLeft,y:we.clientY-Ae.top+V.current.scrollTop};xt({fromId:X,fromPos:Ve})},Hr=X=>{if(!J)return;const{fromId:we}=J;if(we===X){xt(null);return}Ie(we,Ae=>({...Ae,nextSubStepIds:Array.from(new Set([...Ae.nextSubStepIds||[],X]))})),xt(null)},Gr=(X,we)=>{Ie(X,Ae=>{var Ve;return{...Ae,nextSubStepIds:(Ve=Ae.nextSubStepIds)==null?void 0:Ve.filter($e=>$e!==we)}})},$r=X=>{if(!J||!V.current)return;const we=V.current.getBoundingClientRect();St({x:X.clientX-we.left+V.current.scrollLeft,y:X.clientY-we.top+V.current.scrollTop})},vt=()=>{J&&xt(null)},un=(X,we)=>{Ie(X,Ae=>{var Ve;return{actionItems:(Ve=Ae.actionItems)==null?void 0:Ve.map($e=>$e.id===we.id?we:$e)}}),k(!1),K(null)},$n=(X,we,Ae)=>{Ie(X,Ve=>{var $e;return{actionItems:($e=Ve.actionItems)==null?void 0:$e.map(ht=>ht.id===we?{...ht,...Ae}:ht)}})},cr=(X,we)=>{Ct(Ae=>({subSteps:(Ae.subSteps||[]).map($e=>{var fn;if($e.id!==X)return $e;const ht=(fn=$e.actionItems)==null?void 0:fn.map(Pt=>{if(Pt.id!==we)return Pt;const qr=!Pt.completed;return{...Pt,completed:qr,completedDate:qr?new Date().toISOString().split("T")[0]:void 0}}),Ot=ht==null?void 0:ht.every(Pt=>Pt.completed),At=ht==null?void 0:ht.some(Pt=>Pt.completed);let Lt=$e.status;return ht&&ht.length>0?Ot?Lt=fr.COMPLETED:At?Lt=fr.IN_PROGRESS:Lt=fr.NOT_STARTED:Lt=fr.NOT_STARTED,{...$e,actionItems:ht,status:Lt}})}))},oa=X=>{Ie(X,we=>({actionItems:[...we.actionItems||[],{id:a("action"),text:"新しいアクション",completed:!1}]}))},la=(X,we)=>{Ie(X,Ae=>{var Ve;return{actionItems:(Ve=Ae.actionItems)==null?void 0:Ve.filter($e=>$e.id!==we)}})},ms=()=>{n(c.id,{title:c.title,description:c.description,status:c.status}),r(c.id,c.extendedDetails),e()},Be=X=>{Ct({reportDeck:X})},Xe=()=>{j(!0)},Ze=X=>{Ct({reportDeck:X}),j(!1),E(!0)},bt=()=>{if(!jt){e();return}window.confirm(`変更が保存されていません。現在の変更を破棄してよろしいですか？

・「OK」で変更を破棄して戻る
・「キャンセル」で編集を続ける（手動で保存できます）`)&&e()},yn=X=>{Ct({decisions:X}),O(!1)},dt=((G=(B=c.extendedDetails)==null?void 0:B.subSteps)==null?void 0:G.find(X=>X.id===Ce))||null,zr=(X,we)=>x.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mt-1 max-h-40 overflow-y-auto p-2 border rounded-md bg-slate-50",children:!X||X.length===0?x.jsx("p",{className:"col-span-full text-center text-xs text-slate-400 py-2",children:"添付ファイルはありません"}):X.map(Ae=>x.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-20",children:[x.jsx("a",{href:Ae.dataUrl,download:Ae.name,className:"block w-full h-full","aria-label":`Download ${Ae.name}`,children:Ae.type.startsWith("image/")?x.jsx("img",{src:Ae.dataUrl,alt:Ae.name,className:"w-full h-full object-cover"}):x.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-1 hover:bg-slate-200",children:x.jsx(Ys,{className:"w-8 h-8 text-slate-500"})})}),x.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:x.jsx("p",{className:"text-white text-[10px] truncate",title:Ae.name,children:Ae.name})}),x.jsx("button",{onClick:()=>we(Ae.id),className:"absolute top-1 right-1 bg-black bg-opacity-70 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:x.jsx(Pa,{className:"w-3 h-3"})})]},Ae.id))});return w&&((q=c.extendedDetails)!=null&&q.reportDeck)?x.jsx(Qm,{tasks:[c],initialDeck:c.extendedDetails.reportDeck,onSave:Be,onClose:()=>E(!1),generateUniqueId:a,projectGoal:i,targetDate:l,reportScope:"task"}):S?x.jsx(T8,{proposals:Z,existingSubSteps:((de=c.extendedDetails)==null?void 0:de.subSteps)||[],onConfirm:zt,onClose:()=>C(!1)}):R&&F&&dt?x.jsx(AV,{actionItem:F,onSave:X=>un(dt.id,X),onClose:()=>k(!1),generateUniqueId:a}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"min-h-screen bg-slate-100 flex flex-col",children:[x.jsx("header",{className:"flex-shrink-0 bg-white shadow-md z-10 sticky top-0",children:x.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-5 w-full max-w-screen-2xl mx-auto",children:[x.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-slate-800 truncate pr-2",children:[c.title," - 詳細計画"]}),x.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[x.jsx("button",{onClick:bt,className:"px-3 sm:px-5 py-2 bg-slate-200 text-slate-700 text-sm font-medium rounded-md hover:bg-slate-300",children:"フローに戻る"}),x.jsx("button",{onClick:ms,className:"px-3 sm:px-5 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700",children:"計画の変更を保存"}),x.jsx("button",{onClick:Xe,className:"px-3 sm:px-5 py-2 bg-purple-600 text-white text-sm font-semibold rounded-md hover:bg-purple-700",children:"レポート作成"})]})]})}),x.jsx("main",{className:"flex-grow p-4 sm:p-6 overflow-hidden w-full max-w-screen-2xl mx-auto",children:x.jsxs("div",{className:"flex gap-6 h-full",children:[x.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${y==="info"?"flex-1":y==="none"?"w-[360px] min-w-[360px]":"w-0 p-0 m-0 border-0 overflow-hidden opacity-0"}`,children:[x.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[x.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[x.jsx(eF,{className:"w-5 h-5 mr-2 text-purple-600"}),"タスク情報"]}),x.jsx("button",{onClick:()=>_(y==="info"?"none":"info"),className:"p-1 text-slate-500 hover:text-blue-600",title:y==="info"?"元に戻す":"最大化",children:y==="info"?x.jsx(Ph,{className:"w-5 h-5"}):x.jsx(Lh,{className:"w-5 h-5"})})]}),x.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[x.jsx(Da,{label:"タスクタイトル",name:"title",value:c.title,onChange:X=>lr({title:X.target.value}),required:!0}),x.jsx(Da,{label:"タスク説明",name:"description",value:c.description,onChange:X=>lr({description:X.target.value}),type:"textarea",rows:3,required:!0}),x.jsx(Da,{icon:x.jsx(U2,{}),label:"担当者/チーム",name:"responsible",value:c.extendedDetails.responsible,onChange:X=>Ct({responsible:X.target.value})}),x.jsx(Da,{icon:x.jsx(Zm,{}),label:"このタスクの期日",name:"dueDate",type:"date",value:c.extendedDetails.dueDate||"",onChange:X=>Ct({dueDate:X.target.value})}),x.jsxs("div",{children:[x.jsx(Da,{icon:x.jsx(lF,{}),label:"必要なリソース",name:"resources",value:c.extendedDetails.resources,onChange:X=>Ct({resources:X.target.value}),type:"textarea"}),(ve=c.extendedDetails)!=null&&ve.resourceMatrix?x.jsx("div",{className:"mt-2",children:x.jsx(IE,{matrixData:c.extendedDetails.resourceMatrix,onUpdate:X=>Ct({resourceMatrix:X})})}):x.jsxs("button",{onClick:()=>Ct({resourceMatrix:{headers:["購入品","価格"],rows:[["",""]]}}),className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[x.jsx(tu,{className:"w-4 h-4"}),"マトリクスを追加"]})]}),x.jsx(Da,{icon:x.jsx(oF,{}),label:"備考・詳細メモ",name:"notes",value:c.extendedDetails.notes,onChange:X=>Ct({notes:X.target.value}),type:"textarea",rows:4}),x.jsx("div",{className:"pt-4 border-t mt-4",children:x.jsxs("button",{onClick:()=>O(!0),className:"w-full text-left p-3 bg-cyan-50 hover:bg-cyan-100 rounded-lg text-cyan-800 font-semibold flex justify-between items-center",children:[x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx(H2,{className:"w-5 h-5 text-cyan-600"}),"決定事項の管理"]}),x.jsxs("div",{className:"flex gap-2 text-xs",children:[x.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-green-200 text-green-800",children:["済: ",nn.decided]}),x.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-yellow-200 text-yellow-800",children:["未: ",nn.undecided]})]})]})}),x.jsxs("div",{className:"pt-4",children:[x.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["タスク全体の添付資料",x.jsx("button",{onClick:()=>{var X;return(X=Ee.current)==null?void 0:X.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"添付ファイルを追加",children:x.jsx(Ys,{className:"w-4 h-4 text-slate-600"})})]}),zr((le=c.extendedDetails)==null?void 0:le.attachments,X=>yr(X,"task")),x.jsx("input",{type:"file",ref:Ee,onChange:X=>vr(X,"task"),className:"hidden"})]}),x.jsxs("div",{className:"pt-4",children:[x.jsxs("h4",{className:"text-lg font-semibold text-slate-700 mb-3 border-b pb-2 flex items-center",children:[x.jsx(Xm,{className:"w-5 h-5 mr-2 text-yellow-500"}),"AIによる自動計画"]}),x.jsx("button",{onClick:Xt,disabled:ue,className:"w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md shadow-sm hover:bg-indigo-700 disabled:bg-slate-400",children:ue?x.jsx(Ar,{size:"sm"}):"AIでサブステップを自動計画"}),W&&x.jsx("div",{className:"mt-2",children:x.jsx(ul,{message:W})})]})]})]}),x.jsxs("section",{className:`flex flex-col space-y-4 min-w-0 transition-all duration-300 ease-in-out
                  ${y==="canvas"||y==="none"?"flex-1":"hidden"}`,children:[x.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[x.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[x.jsx(rF,{className:"w-5 h-5 mr-2 text-blue-600"}),"サブステップ計画"]}),x.jsxs("div",{className:"flex gap-2 items-center",children:[x.jsx("button",{onClick:vn,disabled:_e.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"元に戻す",children:x.jsx(j2,{className:"w-3 h-3"})}),x.jsx("button",{onClick:Nn,disabled:Te.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"やり直し",children:x.jsx(V2,{className:"w-3 h-3"})}),x.jsxs("button",{onClick:De,className:"text-xs px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[x.jsx(nl,{className:"w-3 h-3"}),"追加"]}),x.jsxs("button",{onClick:je,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 flex items-center gap-1",title:"自動整列",children:[x.jsx(pd,{className:"w-3 h-3"}),"整列"]}),x.jsx("button",{onClick:()=>_(y==="canvas"?"none":"canvas"),className:"p-1 text-slate-500 hover:text-blue-600",title:y==="canvas"?"元に戻す":"最大化",children:y==="canvas"?x.jsx(Ph,{className:"w-5 h-5"}):x.jsx(Lh,{className:"w-5 h-5"})})]})]}),x.jsx("div",{ref:V,onMouseMove:$r,onMouseUp:vt,onDragOver:lt,onDrop:cn,className:`substep-canvas relative border rounded-md bg-white p-2 overflow-auto shadow-inner ${y==="canvas"?"":"flex-grow"}`,children:x.jsxs("div",{className:"substep-inner-canvas relative",style:{width:`${((pe=(me=c.extendedDetails)==null?void 0:me.subStepCanvasSize)==null?void 0:pe.width)||1200}px`,height:`${((Pe=(Ne=c.extendedDetails)==null?void 0:Ne.subStepCanvasSize)==null?void 0:Pe.height)||800}px`},children:[(((He=c.extendedDetails)==null?void 0:He.subSteps)||[]).map(X=>X?x.jsx(RV,{subStep:X,cardRef:Y.get(X.id),isSelected:Ce===X.id,onClick:()=>Re(X.id),onRemove:()=>Fe(X.id),onDragStart:ft,onStartConnection:Sa,onEndConnection:Hr},X.id):null),st.map(X=>x.jsx(Vc,{from:X.from,to:X.to,id:X.id,onDelete:()=>Gr(X.sourceId,X.targetId)},X.id)),J&&x.jsx(Vc,{from:J.fromPos,to:et,id:"preview-connector"})]})})]}),x.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${y==="details"?"flex-1":y==="none"?"w-[360px] min-w-[360px]":"hidden"}`,children:[x.jsx("div",{className:"mb-0",children:x.jsx("button",{onClick:()=>te(!0),className:"w-full text-left p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg text-indigo-800 font-semibold flex justify-between items-center",children:x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx(eu,{className:"w-5 h-5 text-indigo-600"}),"このタスクのアクションアイテム一覧"]})})}),x.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[x.jsx("h5",{className:"text-lg font-semibold text-slate-800",children:"サブステップ詳細"}),x.jsx("button",{onClick:()=>_(y==="details"?"none":"details"),disabled:!dt,className:"p-1 text-slate-500 hover:text-blue-600 disabled:text-slate-300 disabled:cursor-not-allowed",title:y==="details"?"元に戻す":"最大化",children:y==="details"?x.jsx(Ph,{className:"w-5 h-5"}):x.jsx(Lh,{className:"w-5 h-5"})})]}),x.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:dt?x.jsxs("div",{className:"space-y-4",children:[x.jsx(Da,{label:"テキスト",name:"text",value:dt.text,onChange:X=>Ie(dt.id,{text:X.target.value}),type:"textarea"}),x.jsx(Da,{label:"担当者",name:"responsible",value:dt.responsible||"",onChange:X=>Ie(dt.id,{responsible:X.target.value})}),x.jsx(Da,{label:"期日",name:"dueDate",type:"date",value:dt.dueDate||"",onChange:X=>Ie(dt.id,{dueDate:X.target.value})}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"ステータス"}),x.jsx("select",{value:dt.status||fr.NOT_STARTED,onChange:X=>Ie(dt.id,{status:X.target.value}),className:"w-full p-2 border rounded-md text-sm bg-white text-slate-900",children:Object.values(fr).map(X=>x.jsx("option",{value:X,children:X},X))})]}),x.jsx(Da,{label:"メモ",name:"notes",value:dt.notes||"",onChange:X=>Ie(dt.id,{notes:X.target.value}),type:"textarea"}),x.jsx(DV,{items:dt.actionItems||[],onToggle:X=>cr(dt.id,X),onAdd:()=>oa(dt.id),onUpdate:(X,we)=>$n(dt.id,X,we),onRemove:X=>la(dt.id,X),onOpenReport:Gn,onOpenTable:()=>ne(!0)}),x.jsxs("div",{children:[x.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["このサブステップの添付資料",x.jsx("button",{onClick:()=>{var X;return(X=Ke.current)==null?void 0:X.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"添付ファイルを追加",children:x.jsx(Ys,{className:"w-4 h-4 text-slate-600"})})]}),zr(dt.attachments,X=>yr(X,"substep")),x.jsx("input",{type:"file",ref:Ke,onChange:X=>vr(X,"substep"),className:"hidden"})]})]}):x.jsx("div",{className:"flex items-center justify-center h-full text-center text-slate-500 text-sm",children:x.jsxs("p",{children:["左のフローチャートから",x.jsx("br",{}),"サブステップを選択して詳細を編集します。"]})})})]})]})})]}),b&&x.jsx(kV,{task:c,isOpen:b,onClose:()=>O(!1),onSave:yn,generateUniqueId:a}),Q&&x.jsx(OT,{items:(((Oe=c.extendedDetails)==null?void 0:Oe.subSteps)||[]).flatMap(X=>(X.actionItems||[]).map(we=>({actionItem:we,subStep:X}))),taskName:c.title,onClose:()=>te(!1)}),P&&dt&&x.jsx(OT,{items:(dt.actionItems||[]).map(X=>({actionItem:X,subStep:dt})),taskName:c.title,onClose:()=>ne(!1)}),U&&x.jsx(NV,{task:c,isOpen:U,onClose:()=>j(!1),onReportGenerated:Ze})]})},IV=({onClose:t,onSubmit:e})=>{const[n,r]=ce.useState(""),[a,i]=ce.useState(""),[l,c]=ce.useState(""),d=f=>{if(f.preventDefault(),!n.trim()){c("タスクのタイトルは必須です。");return}if(!a.trim()){c("タスクの説明は必須です。");return}e({title:n,description:a}),c("")};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"新しいタスクを追加"}),x.jsx("button",{onClick:t,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"閉じる","aria-label":"タスク追加モーダルを閉じる",children:x.jsx(Vr,{className:"w-6 h-6"})})]}),x.jsxs("form",{onSubmit:d,children:[x.jsxs("div",{className:"p-6 space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"taskTitle",className:"block text-sm font-medium text-slate-700 mb-1",children:"タスクタイトル"}),x.jsx("input",{type:"text",id:"taskTitle",value:n,onChange:f=>r(f.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:"例: 市場調査を実施"})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"taskDescription",className:"block text-sm font-medium text-slate-700 mb-1",children:"タスク説明"}),x.jsx("textarea",{id:"taskDescription",value:a,onChange:f=>i(f.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:"例: 競合製品の分析とターゲット顧客の特定"})]}),l&&x.jsx("p",{className:"text-sm text-red-600",children:l})]}),x.jsxs("footer",{className:"p-6 bg-slate-50 border-t border-slate-200 flex justify-end space-x-3 rounded-b-xl",children:[x.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"キャンセル"}),x.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"タスクを追加"})]})]})]})})},FV=({onSetApiKey:t,error:e,isLoading:n})=>{const[r,a]=ce.useState(""),i=l=>{l.preventDefault(),t(r)};return x.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[x.jsxs("div",{className:"w-full max-w-md bg-white shadow-2xl rounded-xl p-8",children:[x.jsxs("div",{className:"text-center mb-8",children:[x.jsx(nu,{className:"w-12 h-12 mx-auto text-blue-600 mb-4"}),x.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"AI Project Planner"}),x.jsx("p",{className:"text-slate-600 mt-2",children:"始めるには、Google Gemini APIキーを入力してください。"})]}),x.jsxs("form",{onSubmit:i,className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"apiKey",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(jc,{className:"w-5 h-5 mr-2 text-slate-500"}),"Gemini API Key"]}),x.jsx("input",{id:"apiKey",type:"password",value:r,onChange:l=>a(l.target.value),placeholder:"APIキーをここに貼り付け",className:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-800 placeholder-slate-400"})]}),e&&x.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:e}),x.jsx("button",{type:"submit",disabled:n||!r,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:n?x.jsx(Ar,{size:"sm"}):"保存して開始"})]}),x.jsxs("div",{className:"text-center mt-6",children:[x.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"APIキーの取得はこちら"}),x.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"APIキーはセッション中のみブラウザに保存されます。"})]})]}),x.jsx("footer",{className:"mt-8 text-center",children:x.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},OV=({isOpen:t,onClose:e,onSuccess:n})=>{const[r,a]=ce.useState(!0),[i,l]=ce.useState(""),[c,d]=ce.useState(""),[f,g]=ce.useState(!1),[y,_]=ce.useState(null),w=async E=>{E.preventDefault(),g(!0),_(null);try{if(r){const{error:S}=await xa.auth.signInWithPassword({email:i,password:c});if(S)throw S}else{const{error:S}=await xa.auth.signUp({email:i,password:c});if(S)throw S}n()}catch(S){_(S instanceof Error?S.message:"認証に失敗しました")}finally{g(!1)}};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center",children:[x.jsx(jc,{className:"w-6 h-6 mr-2 text-blue-600"}),r?"ログイン":"アカウント作成"]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(Vr,{className:"w-5 h-5"})})]}),x.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"メールアドレス"}),x.jsx("input",{type:"email",id:"email",value:i,onChange:E=>l(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"パスワード"}),x.jsx("input",{type:"password",id:"password",value:c,onChange:E=>d(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:6})]}),y&&x.jsx("div",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:y}),x.jsx("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:f?x.jsx(Ar,{size:"sm",color:"border-white"}):r?"ログイン":"アカウント作成"}),x.jsx("div",{className:"text-center",children:x.jsx("button",{type:"button",onClick:()=>a(!r),className:"text-sm text-blue-600 hover:underline",children:r?"アカウントをお持ちでない方はこちら":"すでにアカウントをお持ちの方はこちら"})})]})]})}):null},LV=({isOpen:t,onClose:e,onSelectProject:n,onCreateNew:r})=>{const[a,i]=ce.useState([]),[l,c]=ce.useState(!1),[d,f]=ce.useState(null),g=async()=>{c(!0),f(null);try{const w=await Uc.getProjects();i(w)}catch(w){f(w instanceof Error?w.message:"プロジェクトの読み込みに失敗しました")}finally{c(!1)}};ce.useEffect(()=>{t&&g()},[t]);const y=async(w,E)=>{if(E.stopPropagation(),!!confirm("このプロジェクトを削除しますか？この操作は取り消せません。"))try{await Uc.deleteProject(w),await g()}catch(S){f(S instanceof Error?S.message:"プロジェクトの削除に失敗しました")}},_=w=>{const E={projectGoal:w.goal,targetDate:w.targetDate,tasks:w.tasks,ganttData:w.ganttData},S=JSON.stringify(E,null,2),C=new Blob([S],{type:"application/json"}),R=URL.createObjectURL(C),k=document.createElement("a");k.href=R,k.download=`${w.title}.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(R)};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"プロジェクト一覧"}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[x.jsx(nl,{className:"w-5 h-5"}),"新規作成"]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(Vr,{className:"w-6 h-6"})})]})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[d&&x.jsx(ul,{message:d}),l?x.jsx("div",{className:"flex items-center justify-center py-12",children:x.jsx(Ar,{size:"lg",text:"プロジェクトを読み込み中..."})}):a.length===0?x.jsxs("div",{className:"text-center py-12",children:[x.jsx("p",{className:"text-slate-500 text-lg mb-4",children:"プロジェクトがありません"}),x.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mx-auto",children:[x.jsx(nl,{className:"w-5 h-5"}),"最初のプロジェクトを作成"]})]}):x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(w=>x.jsxs("div",{onClick:()=>n(w),className:"bg-slate-50 rounded-lg p-4 cursor-pointer hover:bg-slate-100 transition-colors border border-slate-200 hover:border-blue-300",children:[x.jsxs("div",{className:"flex items-start justify-between mb-3",children:[x.jsx("h4",{className:"font-semibold text-slate-800 truncate flex-grow",children:w.title}),x.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[x.jsx("button",{onClick:E=>{E.stopPropagation(),_(w)},className:"p-1 text-slate-500 hover:text-blue-600 rounded",title:"JSONでダウンロード",children:x.jsx(tl,{className:"w-4 h-4"})}),x.jsx("button",{onClick:E=>y(w.id,E),className:"p-1 text-slate-500 hover:text-red-600 rounded",title:"削除",children:x.jsx(Pa,{className:"w-4 h-4"})})]})]}),x.jsxs("div",{className:"space-y-2 text-sm text-slate-600",children:[x.jsxs("p",{className:"flex items-start",children:[x.jsx(Jm,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0 mt-0.5"}),x.jsx("span",{className:"line-clamp-2",children:w.goal})]}),x.jsxs("p",{className:"flex items-center",children:[x.jsx(Wm,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0"}),new Date(w.targetDate+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"})]}),x.jsxs("p",{className:"text-xs text-slate-500",children:["タスク数: ",w.tasks.length," | 更新: ",new Date(w.updatedAt).toLocaleDateString("ja-JP")]})]})]},w.id))})]})]})}):null},ss={subSteps:[],resources:"",responsible:"",notes:"",numericalTarget:void 0,dueDate:"",reportDeck:void 0,resourceMatrix:null,attachments:[],decisions:[],subStepCanvasSize:{width:1200,height:800}},PV=()=>[{id:"apqp_1",title:"フェーズ1: 計画とプログラムの定義",description:"顧客の声を収集し、ビジネスプランと製品/プロセスベンチマークを定義する。設計・品質目標を設定。",status:Mt.NOT_STARTED,nextTaskIds:["apqp_2"]},{id:"apqp_2",title:"フェーズ2: 製品設計と開発",description:"DFMEA、製品仕様、図面を作成し、プロトタイプを製作・管理する。材料仕様とサプライヤーを確定。",status:Mt.NOT_STARTED,nextTaskIds:["apqp_3"]},{id:"apqp_3",title:"フェーズ3: 工程設計と開発",description:"製造工程フローチャート、PFMEA、コントロールプランを作成する。測定システム分析(MSA)計画を立案。",status:Mt.NOT_STARTED,nextTaskIds:["apqp_4"]},{id:"apqp_4",title:"フェーズ4: 製品と工程の妥当性確認",description:"トライアウト生産を実施し、MSAと初期工程能力調査(SPC)を行う。生産部品承認プロセス(PPAP)を完了。",status:Mt.NOT_STARTED,nextTaskIds:["apqp_5"]},{id:"apqp_5",title:"フェーズ5: フィードバック、評価、是正処置",description:"量産を開始し、ばらつきを低減させる。顧客満足度を評価し、継続的改善を実施する。",status:Mt.NOT_STARTED,nextTaskIds:[]}].map(e=>({...e,extendedDetails:{...ss,...e.extendedDetails||{}}})),UV=()=>[{id:"change_1",title:"1. 変更要求と影響分析",description:"変更要求を特定し、品質、コスト、納期、安全性への影響を評価する。",status:Mt.NOT_STARTED,nextTaskIds:["change_2"]},{id:"change_2",title:"2. 変更計画と承認",description:"詳細な変更計画（スケジュール、リソース、検証計画）を作成し、変更管理委員会(CCB)の承認を得る。",status:Mt.NOT_STARTED,nextTaskIds:["change_3"]},{id:"change_3",title:"3. 変更の実施と検証",description:"計画に基づき変更を実施。変更後のプロセスでトライアル生産を行い、結果を検証する。",status:Mt.NOT_STARTED,nextTaskIds:["change_4"]},{id:"change_4",title:"4. 文書化とトレーニング",description:"FMEA、コントロールプラン、作業手順書等の関連文書をすべて更新し、関係者にトレーニングを実施する。",status:Mt.NOT_STARTED,nextTaskIds:["change_5"]},{id:"change_5",title:"5. 変更のレビューとクローズ",description:"変更後のプロセスパフォーマンスを監視し、有効性をレビュー。問題がなければ変更をクローズする。",status:Mt.NOT_STARTED,nextTaskIds:[]}].map(e=>({...e,extendedDetails:{...ss,...e.extendedDetails||{}}})),BV=()=>[{id:"eval_1",title:"1. 顧客要求の分析",description:"顧客から提供された製品仕様、図面、品質要求、生産量を詳細に分析する。",status:Mt.NOT_STARTED,nextTaskIds:["eval_2"]},{id:"eval_2",title:"2. 既存設備の能力評価 (ギャップ分析)",description:"要求仕様に対し、既存の設備・工程能力を評価し、ギャップ（治工具、精度、サイクルタイム等）を特定する。",status:Mt.NOT_STARTED,nextTaskIds:["eval_3"]},{id:"eval_3",title:"3. 評価用トライアル計画の立案",description:"ギャップを埋めるための暫定対策を講じ、評価用トライアルの計画（材料、段取り、測定項目）を立案する。",status:Mt.NOT_STARTED,nextTaskIds:["eval_4"]},{id:"eval_4",title:"4. 評価トライアルの実施とデータ収集",description:"計画に基づきトライアルを実施し、寸法、性能、外観等のデータを収集する。",status:Mt.NOT_STARTED,nextTaskIds:["eval_5"]},{id:"eval_5",title:"5. 評価レポート作成と顧客への報告",description:"トライアル結果をまとめ、実現可能性、課題、推奨事項を記載したレポートを作成し、顧客に報告する。",status:Mt.NOT_STARTED,nextTaskIds:[]}].map(e=>({...e,extendedDetails:{...ss,...e.extendedDetails||{}}})),jV=()=>[{id:"dmaic_1",title:"フェーズ1: 定義 (Define)",description:"プロジェクトの目的、範囲、目標を明確にし、現状の問題点とビジネスインパクトを特定する。",status:Mt.NOT_STARTED,nextTaskIds:["dmaic_2"]},{id:"dmaic_2",title:"フェーズ2: 測定 (Measure)",description:"現状プロセスのパフォーマンスを測定するためのデータを収集し、KPIを設定してベースラインを確立する。",status:Mt.NOT_STARTED,nextTaskIds:["dmaic_3"]},{id:"dmaic_3",title:"フェーズ3: 分析 (Analyze)",description:"収集データを分析し、問題の根本原因を特定する。特性要因図やパレート図などを活用。",status:Mt.NOT_STARTED,nextTaskIds:["dmaic_4"]},{id:"dmaic_4",title:"フェーズ4: 改善 (Improve)",description:"根本原因に対する解決策を立案・テストし、最も効果的な改善策をパイロット導入する。",status:Mt.NOT_STARTED,nextTaskIds:["dmaic_5"]},{id:"dmaic_5",title:"フェーズ5: 管理 (Control)",description:"改善策を標準化し、効果をモニタリングする管理体制を構築する。成果を文書化し水平展開を検討。",status:Mt.NOT_STARTED,nextTaskIds:[]}].map(e=>({...e,extendedDetails:{...ss,...e.extendedDetails||{}}})),VV=()=>[{id:"mod_1",title:"1. 改造計画の立案と承認",description:"改造の目的（生産性、安全性、品質向上など）、目標仕様、スコープを定義し、関連部署からの承認を得る。",status:Mt.NOT_STARTED,nextTaskIds:["mod_2"]},{id:"mod_2",title:"2. 改造設計と部品手配",description:"具体的な改造内容（機械、電気、ソフトウェア）を設計し、図面を作成する。必要な部品や材料を発注・手配する。",status:Mt.NOT_STARTED,nextTaskIds:["mod_3"]},{id:"mod_3",title:"3. 設備改造の実施と初期トライアル",description:"安全手順に従い、設備の改造作業を実施する。改造後、初期の動作確認とトライアル運転を行う。",status:Mt.NOT_STARTED,nextTaskIds:["mod_4"]},{id:"mod_4",title:"4. パフォーマンス評価と安全性検証",description:"一定期間の連続運転を行い、生産性、品質、サイクルタイムなどのパフォーマンスを評価し、安全性を検証する。",status:Mt.NOT_STARTED,nextTaskIds:["mod_5"]},{id:"mod_5",title:"5. 標準化とプロジェクト完了",description:"設備関連の図面、作業標準書、保全計画を更新する。関係者へのトレーニングを実施し、プロジェクトを完了させる。",status:Mt.NOT_STARTED,nextTaskIds:[]}].map(e=>({...e,extendedDetails:{...ss,...e.extendedDetails||{}}})),HV=()=>{const[t,e]=ce.useState(null),[n,r]=ce.useState(null),[a,i]=ce.useState(""),[l,c]=ce.useState(""),[d,f]=ce.useState([]),[g,y]=ce.useState(null),[_,w]=ce.useState(null),[E,S]=ce.useState(null),[C,R]=ce.useState(!1),[k,b]=ce.useState(null),[O,U]=ce.useState(Cr.INPUT_FORM),[j,F]=ce.useState(!1),[K,P]=ce.useState(!1),[ne,Q]=ce.useState(!1),[te,_e]=ce.useState([]),[Le,Te]=ce.useState([]),[ae,ue]=ce.useState(null);ce.useEffect(()=>{const{data:{subscription:De}}=xa.auth.onAuthStateChange((Ie,Fe)=>{e((Fe==null?void 0:Fe.user)??null),Fe!=null&&Fe.user||(S(null),f([]),i(""),c(""),w(null),U(Cr.INPUT_FORM))});return xa.auth.getSession().then(({data:{session:Ie}})=>{e((Ie==null?void 0:Ie.user)??null)}),()=>De.unsubscribe()},[]),ce.useEffect(()=>{const De=sessionStorage.getItem("gemini-api-key");De&&ie(De)},[]);const re=De=>{_e(Ie=>[...Ie.slice(-10),De]),Te([])},W=ce.useCallback((De="id")=>`${De}-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,[]),N=(De,Ie)=>{const Fe=JSON.stringify(De,null,2),je=new Blob([Fe],{type:"application/json"}),ft=URL.createObjectURL(je),lt=document.createElement("a");lt.href=ft,lt.download=Ie,document.body.appendChild(lt),lt.click(),document.body.removeChild(lt),URL.revokeObjectURL(ft)},Z=De=>new Promise((Ie,Fe)=>{const je=new FileReader;je.onload=ft=>{var lt;try{typeof((lt=ft.target)==null?void 0:lt.result)=="string"?Ie(JSON.parse(ft.target.result)):Fe(new Error("Failed to read file."))}catch(cn){Fe(new Error(`Invalid JSON: ${cn.message}`))}},je.onerror=()=>Fe(new Error("File read error.")),je.readAsText(De)}),M=ce.useCallback(De=>{if(De.length===0)return De;const Ie=new Map(De.map(vt=>[vt.id,vt])),Fe=new Map(De.map(vt=>[vt.id,0])),je=new Map;De.forEach(vt=>{je.set(vt.id,[]),(vt.nextTaskIds||[]).forEach(un=>{var $n;Ie.has(un)&&(Fe.set(un,(Fe.get(un)||0)+1),($n=je.get(vt.id))==null||$n.push(un))})});const ft=De.filter(vt=>(Fe.get(vt.id)||0)===0).map(vt=>vt.id),lt=[];let cn=0;const Gn=new Set;for(;ft.length>0;){const vt=ft.length;lt[cn]=[];for(let un=0;un<vt;un++){const $n=ft.shift();Gn.add($n),lt[cn].push($n),(je.get($n)||[]).forEach(cr=>{Fe.set(cr,(Fe.get(cr)||0)-1),(Fe.get(cr)||0)===0&&ft.push(cr)})}cn++}const vr=De.filter(vt=>!Gn.has(vt.id));vr.length>0&&lt.push(vr.map(vt=>vt.id));const yr=380,Sa=60,Hr=50,Gr=280,$r=new Map;return lt.forEach((vt,un)=>{const $n=vt.length*Gr+(vt.length-1)*Hr,cr=Math.max(20,(500-$n)/2);vt.forEach((oa,la)=>{$r.set(oa,{x:un*(yr+Sa)+20,y:cr+la*(Gr+Hr)})})}),De.map((vt,un)=>({...vt,position:$r.get(vt.id)||vt.position||{x:20,y:20+un*100}}))},[]),V=De=>{re(d),f(De)},Y=()=>{if(te.length>0){const De=te[te.length-1];_e(Ie=>Ie.slice(0,-1)),Te(Ie=>[d,...Ie]),f(De)}},z=()=>{if(Le.length>0){const De=Le[0];Te(Ie=>Ie.slice(1)),_e(Ie=>[...Ie,d]),f(De)}},ie=De=>{De.trim()&&($y(De),sessionStorage.setItem("gemini-api-key",De),r(De),b(null))},ye=()=>{sessionStorage.removeItem("gemini-api-key"),r(null),$y("")},Ce=async()=>{await xa.auth.signOut()},Re=async()=>{if(!(!t||!E))try{await Uc.updateProject(E,{tasks:d,ganttData:_})}catch(De){console.error("プロジェクトの自動保存に失敗しました:",De)}};ce.useEffect(()=>{if(E&&d.length>0){const De=setTimeout(Re,2e3);return()=>clearTimeout(De)}},[d,_,E]);const Ee=()=>{i(""),c(""),f([]),w(null),ue(null),S(null),U(Cr.INPUT_FORM),b(null),_e([]),Te([])},Ke=()=>{N({projectGoal:a,targetDate:l,tasks:d,ganttData:_},"project-plan.json")},J=async De=>{try{const Ie=await Z(De);if(Ie.projectGoal&&Ie.targetDate&&Array.isArray(Ie.tasks))i(Ie.projectGoal),c(Ie.targetDate),f(Ie.tasks.map(Fe=>({...Fe,extendedDetails:{...ss,...Fe.extendedDetails||{}}}))),w(Ie.ganttData||null),ue(null),S(null),U(Cr.PROJECT_FLOW),_e([]),Te([]);else throw new Error("Invalid project file format.")}catch(Ie){const Fe=Ie.message;b(Fe),Fe.toLowerCase().includes("api key")&&ye()}},xt=De=>{i(De.goal),c(De.targetDate),f(De.tasks.map(Ie=>({...Ie,extendedDetails:{...ss,...Ie.extendedDetails||{}}}))),w(De.ganttData||null),S(De.id),ue(null),U(Cr.PROJECT_FLOW),_e([]),Te([]),Q(!1)},et=()=>{Q(!1),Ee()},St=({title:De,description:Ie})=>{const Fe={id:W("task"),title:De,description:Ie,extendedDetails:ss,status:Mt.NOT_STARTED,position:{x:20,y:20}};V(je=>M([...je,Fe])),F(!1)},st=De=>{V(Ie=>Ie.filter(Fe=>Fe.id!==De).map(Fe=>({...Fe,nextTaskIds:(Fe.nextTaskIds||[]).filter(je=>je!==De)})))},Me=(De,Ie)=>{V(Fe=>Fe.map(je=>je.id===De?{...je,status:Ie}:je))},jt=(De,Ie)=>{V(Fe=>Fe.map(je=>je.id===De?{...je,nextTaskIds:Ie}:je))},nn=(De,Ie)=>{f(Fe=>Fe.map(je=>je.id===De?{...je,position:Ie}:je))},xn=(De,Ie)=>{V(Fe=>Fe.map(je=>je.id===De?{...je,...Ie}:je))},on=(De,Ie)=>{V(Fe=>Fe.map(je=>je.id===De?{...je,extendedDetails:Ie}:je))},lr=(De,Ie,Fe)=>{let je=[];switch(De){case"process-design":je=PV();break;case"process-change":je=UV();break;case"new-product-eval":je=BV();break;case"improvement-project":je=jV();break;case"equipment-modification":je=VV();break}i(Ie),c(Fe),f(M(je)),w(null),ue(null),S(null),U(Cr.PROJECT_FLOW),_e([]),Te([]),b(null)},Ct=async(De,Ie)=>{R(!0),b(null);try{i(De),c(Ie);const Fe=await jM(De,Ie),je=M(Fe.map(ft=>({...ft,extendedDetails:ss,status:Mt.NOT_STARTED})));if(f(je),w(null),ue(null),S(null),U(Cr.PROJECT_FLOW),_e([]),Te([]),t)try{const ft=await Uc.createProject(`AI生成プロジェクト - ${new Date().toLocaleDateString("ja-JP")}`,De,Ie,je);S(ft.id)}catch(ft){console.error("プロジェクトの自動保存に失敗しました:",ft)}}catch(Fe){const je=Fe.message;je.toLowerCase().includes("api key")&&ye(),b(je)}finally{R(!1)}},vn=De=>{y(De),U(Cr.TASK_DETAIL)},Nn=()=>{y(null),U(Cr.PROJECT_FLOW)},Xt=De=>{ue(De)},zt=()=>{if(!t)return x.jsx(OV,{isOpen:!0,onClose:()=>{},onSuccess:()=>P(!1)});if(!n)return x.jsx(FV,{onSetApiKey:ie,error:k});if(k)return x.jsxs("div",{className:"p-4",children:[x.jsx(ul,{message:k}),x.jsx("button",{onClick:()=>{b(null),n?U(Cr.INPUT_FORM):ye()},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded",children:"最初に戻る"})]});switch(O){case Cr.PROJECT_FLOW:return x.jsx(_8,{tasks:d,projectGoal:a,targetDate:l,onSelectTask:vn,onUpdateTaskExtendedDetails:()=>{},onUpdateTaskPosition:nn,onStartNewProject:Ee,onExportProject:Ke,onAddTask:()=>F(!0),onRemoveTask:st,onUpdateTaskStatus:Me,onImportSingleTask:()=>{},onAutoLayout:()=>V(De=>M([...De])),onUndo:Y,canUndo:te.length>0,onRedo:z,canRedo:Le.length>0,generateUniqueId:W,onUpdateTaskConnections:jt,ganttData:_,setGanttData:w,onCustomReportGenerated:Xt,onClearApiKey:ye,onOpenProjectList:()=>Q(!0),onLogout:Ce,currentProjectId:E,onSaveProject:Re});case Cr.TASK_DETAIL:return g&&x.jsx(MV,{task:g,onClose:Nn,onUpdateTaskCoreInfo:xn,onUpdateExtendedDetails:on,generateUniqueId:W,projectGoal:a,targetDate:l});case Cr.INPUT_FORM:default:return x.jsx(dF,{onSubmit:Ct,isLoading:C,onImportProject:J,onLoadTemplate:lr,initialGoal:a,initialDate:l,onOpenProjectList:()=>Q(!0),onLogout:Ce,user:t})}};return x.jsxs("div",{className:"h-full w-full",children:[zt(),j&&x.jsx(IV,{onClose:()=>F(!1),onSubmit:St}),ne&&x.jsx(LV,{isOpen:ne,onClose:()=>Q(!1),onSelectProject:xt,onCreateNew:et}),ae&&x.jsx(Qm,{tasks:d,initialDeck:ae,onSave:De=>ue(De),onClose:()=>ue(null),projectGoal:a,targetDate:l,reportScope:"project",generateUniqueId:W})]})},FE=document.getElementById("root");if(!FE)throw new Error("Could not find root element to mount to");const GV=JC.createRoot(FE);GV.render(x.jsx(ls.StrictMode,{children:x.jsx(HV,{})}));
